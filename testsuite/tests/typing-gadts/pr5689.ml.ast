[
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[5,24+0]..[5,24+34])
    Pstr_type Rec
    [
      type_declaration "inkind" (testsuite/tests/typing-gadts/pr5689.ml[5,24+5]..[5,24+11]) (testsuite/tests/typing-gadts/pr5689.ml[5,24+0]..[5,24+34])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (testsuite/tests/typing-gadts/pr5689.ml[5,24+14]..[5,24+34])
              Ptyp_variant closed=Closed
              [
                Rtag "Link" true
                  []
                Rtag "Nonlink" true
                  []
              ]
              None
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[7,60+0]..[11,224+78])
    Pstr_type Rec
    [
      type_declaration "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[7,60+7]..[7,60+15]) (testsuite/tests/typing-gadts/pr5689.ml[7,60+0]..[11,224+78])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr5689.ml[7,60+5]..[7,60+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr5689.ml[8,78+3]..[8,78+52])
                "Text" (testsuite/tests/typing-gadts/pr5689.ml[8,78+5]..[8,78+9])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[8,78+11]..[8,78+17])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/pr5689.ml[8,78+11]..[8,78+17])
                    []
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[8,78+21]..[8,78+52])
                    Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[8,78+44]..[8,78+52])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[8,78+21]..[8,78+43])
                        Ptyp_variant closed=Closed
                        [
                          Rinherit
                            core_type (testsuite/tests/typing-gadts/pr5689.ml[8,78+24]..[8,78+30])
                              Ptyp_constr "inkind" (testsuite/tests/typing-gadts/pr5689.ml[8,78+24]..[8,78+30])
                              []
                        ]
                        Some
                          [
                            "Nonlink"
                          ]
                    ]
              (testsuite/tests/typing-gadts/pr5689.ml[9,131+3]..[9,131+42])
                "Bold" (testsuite/tests/typing-gadts/pr5689.ml[9,131+5]..[9,131+9])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[9,131+11]..[9,131+27])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/pr5689.ml[9,131+23]..[9,131+27])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[9,131+11]..[9,131+22])
                        Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[9,131+14]..[9,131+22])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[9,131+11]..[9,131+13])
                            Ptyp_var a
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[9,131+31]..[9,131+42])
                    Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[9,131+34]..[9,131+42])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[9,131+31]..[9,131+33])
                        Ptyp_var a
                    ]
              (testsuite/tests/typing-gadts/pr5689.ml[10,174+3]..[10,174+49])
                "Link" (testsuite/tests/typing-gadts/pr5689.ml[10,174+5]..[10,174+9])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[10,174+11]..[10,174+17])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/pr5689.ml[10,174+11]..[10,174+17])
                    []
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[10,174+21]..[10,174+49])
                    Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[10,174+41]..[10,174+49])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[10,174+21]..[10,174+40])
                        Ptyp_variant closed=Closed
                        [
                          Rinherit
                            core_type (testsuite/tests/typing-gadts/pr5689.ml[10,174+24]..[10,174+30])
                              Ptyp_constr "inkind" (testsuite/tests/typing-gadts/pr5689.ml[10,174+24]..[10,174+30])
                              []
                        ]
                        Some
                          [
                            "Link"
                          ]
                    ]
              (testsuite/tests/typing-gadts/pr5689.ml[11,224+3]..[11,224+78])
                "Mref" (testsuite/tests/typing-gadts/pr5689.ml[11,224+5]..[11,224+9])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[11,224+11]..[11,224+17])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/pr5689.ml[11,224+11]..[11,224+17])
                    []
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[11,224+20]..[11,224+46])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/pr5689.ml[11,224+42]..[11,224+46])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[11,224+20]..[11,224+41])
                        Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[11,224+33]..[11,224+41])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[11,224+20]..[11,224+32])
                            Ptyp_variant closed=Closed
                            [
                              Rtag "Nonlink" true
                                []
                            ]
                            None
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[11,224+50]..[11,224+78])
                    Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[11,224+70]..[11,224+78])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[11,224+50]..[11,224+69])
                        Ptyp_variant closed=Closed
                        [
                          Rinherit
                            core_type (testsuite/tests/typing-gadts/pr5689.ml[11,224+53]..[11,224+59])
                              Ptyp_constr "inkind" (testsuite/tests/typing-gadts/pr5689.ml[11,224+53]..[11,224+59])
                              []
                        ]
                        Some
                          [
                            "Link"
                          ]
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[14,307+0]..[20,601+26])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr5689.ml[14,307+4]..[14,307+13])
          Ppat_var "uppercase" (testsuite/tests/typing-gadts/pr5689.ml[14,307+4]..[14,307+13])
        expression (testsuite/tests/typing-gadts/pr5689.ml[14,307+14]..[20,601+26]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/pr5689.ml[14,307+14]..[14,307+17])
            Ppat_var "seq" (testsuite/tests/typing-gadts/pr5689.ml[14,307+14]..[14,307+17])
          expression (testsuite/tests/typing-gadts/pr5689.ml[15,327+3]..[20,601+26])
            Pexp_let Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/pr5689.ml[15,327+11]..[15,327+52]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/pr5689.ml[15,327+11]..[15,327+18])
                    Ppat_var "process" (testsuite/tests/typing-gadts/pr5689.ml[15,327+11]..[15,327+18])
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+11]..[19,542+58]) ghost
                    Ptyp_poly 'a
                    core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+28]..[15,327+52])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+28]..[15,327+38])
                        Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[15,327+30]..[15,327+38])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+28]..[15,327+29])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+42]..[15,327+52])
                        Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[15,327+44]..[15,327+52])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+42]..[15,327+43])
                            Ptyp_var a
                        ]
                expression (testsuite/tests/typing-gadts/pr5689.ml[15,327+11]..[19,542+58])
                  Pexp_newtype "a"
                  expression (testsuite/tests/typing-gadts/pr5689.ml[15,327+11]..[19,542+58])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/pr5689.ml[15,327+55]..[19,542+58])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/pr5689.ml[16,391+9]..[16,391+17])
                            Ppat_construct "Text" (testsuite/tests/typing-gadts/pr5689.ml[16,391+9]..[16,391+13])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[16,391+14]..[16,391+17])
                                Ppat_var "txt" (testsuite/tests/typing-gadts/pr5689.ml[16,391+14]..[16,391+17])
                          expression (testsuite/tests/typing-gadts/pr5689.ml[16,391+27]..[16,391+60])
                            Pexp_construct "Text" (testsuite/tests/typing-gadts/pr5689.ml[16,391+27]..[16,391+31])
                            Some
                              expression (testsuite/tests/typing-gadts/pr5689.ml[16,391+32]..[16,391+60])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/pr5689.ml[16,391+33]..[16,391+55])
                                  Pexp_ident "String.uppercase_ascii" (testsuite/tests/typing-gadts/pr5689.ml[16,391+33]..[16,391+55])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/pr5689.ml[16,391+56]..[16,391+59])
                                      Pexp_ident "txt" (testsuite/tests/typing-gadts/pr5689.ml[16,391+56]..[16,391+59])
                                ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/pr5689.ml[17,452+9]..[17,452+16])
                            Ppat_construct "Bold" (testsuite/tests/typing-gadts/pr5689.ml[17,452+9]..[17,452+13])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[17,452+14]..[17,452+16])
                                Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[17,452+14]..[17,452+16])
                          expression (testsuite/tests/typing-gadts/pr5689.ml[17,452+27]..[17,452+53])
                            Pexp_construct "Bold" (testsuite/tests/typing-gadts/pr5689.ml[17,452+27]..[17,452+31])
                            Some
                              expression (testsuite/tests/typing-gadts/pr5689.ml[17,452+32]..[17,452+53])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/pr5689.ml[17,452+33]..[17,452+41])
                                  Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[17,452+33]..[17,452+41])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/pr5689.ml[17,452+42]..[17,452+49])
                                      Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[17,452+42]..[17,452+49])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/pr5689.ml[17,452+50]..[17,452+52])
                                      Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[17,452+50]..[17,452+52])
                                ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/pr5689.ml[18,506+9]..[18,506+17])
                            Ppat_construct "Link" (testsuite/tests/typing-gadts/pr5689.ml[18,506+9]..[18,506+13])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[18,506+14]..[18,506+17])
                                Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[18,506+14]..[18,506+17])
                          expression (testsuite/tests/typing-gadts/pr5689.ml[18,506+27]..[18,506+35])
                            Pexp_construct "Link" (testsuite/tests/typing-gadts/pr5689.ml[18,506+27]..[18,506+31])
                            Some
                              expression (testsuite/tests/typing-gadts/pr5689.ml[18,506+32]..[18,506+35])
                                Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[18,506+32]..[18,506+35])
                        <case>
                          pattern (testsuite/tests/typing-gadts/pr5689.ml[19,542+9]..[19,542+23])
                            Ppat_construct "Mref" (testsuite/tests/typing-gadts/pr5689.ml[19,542+9]..[19,542+13])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[19,542+14]..[19,542+23])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[19,542+15]..[19,542+18])
                                    Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[19,542+15]..[19,542+18])
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[19,542+20]..[19,542+22])
                                    Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[19,542+20]..[19,542+22])
                                ]
                          expression (testsuite/tests/typing-gadts/pr5689.ml[19,542+27]..[19,542+58])
                            Pexp_construct "Mref" (testsuite/tests/typing-gadts/pr5689.ml[19,542+27]..[19,542+31])
                            Some
                              expression (testsuite/tests/typing-gadts/pr5689.ml[19,542+32]..[19,542+58])
                                Pexp_tuple
                                [
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[19,542+33]..[19,542+36])
                                    Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[19,542+33]..[19,542+36])
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[19,542+38]..[19,542+57])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/pr5689.ml[19,542+38]..[19,542+46])
                                      Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[19,542+38]..[19,542+46])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[19,542+47]..[19,542+54])
                                          Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[19,542+47]..[19,542+54])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[19,542+55]..[19,542+57])
                                          Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[19,542+55]..[19,542+57])
                                    ]
                                ]
                      ]
                    core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+28]..[15,327+52])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+28]..[15,327+38])
                        Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[15,327+30]..[15,327+38])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+28]..[15,327+29])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/pr5689.ml[15,327+28]..[15,327+29])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+42]..[15,327+52])
                        Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[15,327+44]..[15,327+52])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[15,327+42]..[15,327+43])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/pr5689.ml[15,327+42]..[15,327+43])
                            []
                        ]
            ]
            expression (testsuite/tests/typing-gadts/pr5689.ml[20,601+6]..[20,601+26])
              Pexp_apply
              expression (testsuite/tests/typing-gadts/pr5689.ml[20,601+6]..[20,601+14])
                Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[20,601+6]..[20,601+14])
              [
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/pr5689.ml[20,601+15]..[20,601+22])
                    Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[20,601+15]..[20,601+22])
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/pr5689.ml[20,601+23]..[20,601+26])
                    Pexp_ident "seq" (testsuite/tests/typing-gadts/pr5689.ml[20,601+23]..[20,601+26])
              ]
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[22,631+0]..[31,988+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr5689.ml[22,631+9]..[31,988+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr5689.ml[22,631+9]..[31,988+2])
          Pexp_constant PConst_string ("\ntype inkind = [ `Link | `Nonlink ]\ntype _ inline_t =\n    Text : string -> [< inkind > `Nonlink ] inline_t\n  | Bold : 'a inline_t list -> 'a inline_t\n  | Link : string -> [< inkind > `Link ] inline_t\n  | Mref : string *\n      [ `Nonlink ] inline_t list -> [< inkind > `Link ] inline_t\nval uppercase : 'a inline_t list -> 'a inline_t list = <fun>\n",(testsuite/tests/typing-gadts/pr5689.ml[22,631+11]..[31,988+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[33,995+0]..[37,1084+36])
    Pstr_type Rec
    [
      type_declaration "ast_t" (testsuite/tests/typing-gadts/pr5689.ml[33,995+5]..[33,995+10]) (testsuite/tests/typing-gadts/pr5689.ml[33,995+0]..[37,1084+36])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr5689.ml[34,1008+3]..[34,1008+23])
                "Ast_Text" (testsuite/tests/typing-gadts/pr5689.ml[34,1008+5]..[34,1008+13])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[34,1008+17]..[34,1008+23])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/pr5689.ml[34,1008+17]..[34,1008+23])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/pr5689.ml[35,1032+3]..[35,1032+27])
                "Ast_Bold" (testsuite/tests/typing-gadts/pr5689.ml[35,1032+5]..[35,1032+13])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[35,1032+17]..[35,1032+27])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/pr5689.ml[35,1032+23]..[35,1032+27])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[35,1032+17]..[35,1032+22])
                        Ptyp_constr "ast_t" (testsuite/tests/typing-gadts/pr5689.ml[35,1032+17]..[35,1032+22])
                        []
                    ]
                ]
                None
              (testsuite/tests/typing-gadts/pr5689.ml[36,1060+3]..[36,1060+23])
                "Ast_Link" (testsuite/tests/typing-gadts/pr5689.ml[36,1060+5]..[36,1060+13])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[36,1060+17]..[36,1060+23])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/pr5689.ml[36,1060+17]..[36,1060+23])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/pr5689.ml[37,1084+3]..[37,1084+36])
                "Ast_Mref" (testsuite/tests/typing-gadts/pr5689.ml[37,1084+5]..[37,1084+13])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[37,1084+17]..[37,1084+23])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/pr5689.ml[37,1084+17]..[37,1084+23])
                    []
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[37,1084+26]..[37,1084+36])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/pr5689.ml[37,1084+32]..[37,1084+36])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[37,1084+26]..[37,1084+31])
                        Ptyp_constr "ast_t" (testsuite/tests/typing-gadts/pr5689.ml[37,1084+26]..[37,1084+31])
                        []
                    ]
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[40,1125+0]..[50,1580+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr5689.ml[40,1125+4]..[40,1125+25])
          Ppat_var "inlineseq_from_astseq" (testsuite/tests/typing-gadts/pr5689.ml[40,1125+4]..[40,1125+25])
        expression (testsuite/tests/typing-gadts/pr5689.ml[40,1125+26]..[50,1580+30]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/pr5689.ml[40,1125+26]..[40,1125+29])
            Ppat_var "seq" (testsuite/tests/typing-gadts/pr5689.ml[40,1125+26]..[40,1125+29])
          expression (testsuite/tests/typing-gadts/pr5689.ml[41,1157+3]..[50,1580+30])
            Pexp_let Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/pr5689.ml[41,1157+11]..[41,1157+26])
                  Ppat_var "process_nonlink" (testsuite/tests/typing-gadts/pr5689.ml[41,1157+11]..[41,1157+26])
                expression (testsuite/tests/typing-gadts/pr5689.ml[41,1157+29]..[44,1291+38])
                  Pexp_function
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/pr5689.ml[42,1195+9]..[42,1195+21])
                        Ppat_construct "Ast_Text" (testsuite/tests/typing-gadts/pr5689.ml[42,1195+9]..[42,1195+17])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/pr5689.ml[42,1195+18]..[42,1195+21])
                            Ppat_var "txt" (testsuite/tests/typing-gadts/pr5689.ml[42,1195+18]..[42,1195+21])
                      expression (testsuite/tests/typing-gadts/pr5689.ml[42,1195+26]..[42,1195+34])
                        Pexp_construct "Text" (testsuite/tests/typing-gadts/pr5689.ml[42,1195+26]..[42,1195+30])
                        Some
                          expression (testsuite/tests/typing-gadts/pr5689.ml[42,1195+31]..[42,1195+34])
                            Pexp_ident "txt" (testsuite/tests/typing-gadts/pr5689.ml[42,1195+31]..[42,1195+34])
                    <case>
                      pattern (testsuite/tests/typing-gadts/pr5689.ml[43,1230+9]..[43,1230+20])
                        Ppat_construct "Ast_Bold" (testsuite/tests/typing-gadts/pr5689.ml[43,1230+9]..[43,1230+17])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/pr5689.ml[43,1230+18]..[43,1230+20])
                            Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[43,1230+18]..[43,1230+20])
                      expression (testsuite/tests/typing-gadts/pr5689.ml[43,1230+26]..[43,1230+60])
                        Pexp_construct "Bold" (testsuite/tests/typing-gadts/pr5689.ml[43,1230+26]..[43,1230+30])
                        Some
                          expression (testsuite/tests/typing-gadts/pr5689.ml[43,1230+31]..[43,1230+60])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/pr5689.ml[43,1230+32]..[43,1230+40])
                              Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[43,1230+32]..[43,1230+40])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/pr5689.ml[43,1230+41]..[43,1230+56])
                                  Pexp_ident "process_nonlink" (testsuite/tests/typing-gadts/pr5689.ml[43,1230+41]..[43,1230+56])
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/pr5689.ml[43,1230+57]..[43,1230+59])
                                  Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[43,1230+57]..[43,1230+59])
                            ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/pr5689.ml[44,1291+9]..[44,1291+10])
                        Ppat_any
                      expression (testsuite/tests/typing-gadts/pr5689.ml[44,1291+26]..[44,1291+38])
                        Pexp_assert
                        expression (testsuite/tests/typing-gadts/pr5689.ml[44,1291+33]..[44,1291+38])
                          Pexp_construct "false" (testsuite/tests/typing-gadts/pr5689.ml[44,1291+33]..[44,1291+38])
                          None
                  ]
            ]
            expression (testsuite/tests/typing-gadts/pr5689.ml[45,1333+3]..[50,1580+30])
              Pexp_let Rec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/pr5689.ml[45,1333+11]..[45,1333+22])
                    Ppat_var "process_any" (testsuite/tests/typing-gadts/pr5689.ml[45,1333+11]..[45,1333+22])
                  expression (testsuite/tests/typing-gadts/pr5689.ml[45,1333+25]..[49,1509+70])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/pr5689.ml[46,1367+9]..[46,1367+21])
                          Ppat_construct "Ast_Text" (testsuite/tests/typing-gadts/pr5689.ml[46,1367+9]..[46,1367+17])
                          Some
                            []
                            pattern (testsuite/tests/typing-gadts/pr5689.ml[46,1367+18]..[46,1367+21])
                              Ppat_var "txt" (testsuite/tests/typing-gadts/pr5689.ml[46,1367+18]..[46,1367+21])
                        expression (testsuite/tests/typing-gadts/pr5689.ml[46,1367+31]..[46,1367+39])
                          Pexp_construct "Text" (testsuite/tests/typing-gadts/pr5689.ml[46,1367+31]..[46,1367+35])
                          Some
                            expression (testsuite/tests/typing-gadts/pr5689.ml[46,1367+36]..[46,1367+39])
                              Pexp_ident "txt" (testsuite/tests/typing-gadts/pr5689.ml[46,1367+36]..[46,1367+39])
                      <case>
                        pattern (testsuite/tests/typing-gadts/pr5689.ml[47,1407+9]..[47,1407+20])
                          Ppat_construct "Ast_Bold" (testsuite/tests/typing-gadts/pr5689.ml[47,1407+9]..[47,1407+17])
                          Some
                            []
                            pattern (testsuite/tests/typing-gadts/pr5689.ml[47,1407+18]..[47,1407+20])
                              Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[47,1407+18]..[47,1407+20])
                        expression (testsuite/tests/typing-gadts/pr5689.ml[47,1407+31]..[47,1407+61])
                          Pexp_construct "Bold" (testsuite/tests/typing-gadts/pr5689.ml[47,1407+31]..[47,1407+35])
                          Some
                            expression (testsuite/tests/typing-gadts/pr5689.ml[47,1407+36]..[47,1407+61])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/pr5689.ml[47,1407+37]..[47,1407+45])
                                Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[47,1407+37]..[47,1407+45])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[47,1407+46]..[47,1407+57])
                                    Pexp_ident "process_any" (testsuite/tests/typing-gadts/pr5689.ml[47,1407+46]..[47,1407+57])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[47,1407+58]..[47,1407+60])
                                    Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[47,1407+58]..[47,1407+60])
                              ]
                      <case>
                        pattern (testsuite/tests/typing-gadts/pr5689.ml[48,1469+9]..[48,1469+21])
                          Ppat_construct "Ast_Link" (testsuite/tests/typing-gadts/pr5689.ml[48,1469+9]..[48,1469+17])
                          Some
                            []
                            pattern (testsuite/tests/typing-gadts/pr5689.ml[48,1469+18]..[48,1469+21])
                              Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[48,1469+18]..[48,1469+21])
                        expression (testsuite/tests/typing-gadts/pr5689.ml[48,1469+31]..[48,1469+39])
                          Pexp_construct "Link" (testsuite/tests/typing-gadts/pr5689.ml[48,1469+31]..[48,1469+35])
                          Some
                            expression (testsuite/tests/typing-gadts/pr5689.ml[48,1469+36]..[48,1469+39])
                              Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[48,1469+36]..[48,1469+39])
                      <case>
                        pattern (testsuite/tests/typing-gadts/pr5689.ml[49,1509+9]..[49,1509+27])
                          Ppat_construct "Ast_Mref" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+9]..[49,1509+17])
                          Some
                            []
                            pattern (testsuite/tests/typing-gadts/pr5689.ml[49,1509+18]..[49,1509+27])
                              Ppat_tuple
                              [
                                pattern (testsuite/tests/typing-gadts/pr5689.ml[49,1509+19]..[49,1509+22])
                                  Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+19]..[49,1509+22])
                                pattern (testsuite/tests/typing-gadts/pr5689.ml[49,1509+24]..[49,1509+26])
                                  Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+24]..[49,1509+26])
                              ]
                        expression (testsuite/tests/typing-gadts/pr5689.ml[49,1509+31]..[49,1509+70])
                          Pexp_construct "Mref" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+31]..[49,1509+35])
                          Some
                            expression (testsuite/tests/typing-gadts/pr5689.ml[49,1509+36]..[49,1509+70])
                              Pexp_tuple
                              [
                                expression (testsuite/tests/typing-gadts/pr5689.ml[49,1509+37]..[49,1509+40])
                                  Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+37]..[49,1509+40])
                                expression (testsuite/tests/typing-gadts/pr5689.ml[49,1509+42]..[49,1509+69])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[49,1509+42]..[49,1509+50])
                                    Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+42]..[49,1509+50])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/pr5689.ml[49,1509+51]..[49,1509+66])
                                        Pexp_ident "process_nonlink" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+51]..[49,1509+66])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/pr5689.ml[49,1509+67]..[49,1509+69])
                                        Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[49,1509+67]..[49,1509+69])
                                  ]
                              ]
                    ]
              ]
              expression (testsuite/tests/typing-gadts/pr5689.ml[50,1580+6]..[50,1580+30])
                Pexp_apply
                expression (testsuite/tests/typing-gadts/pr5689.ml[50,1580+6]..[50,1580+14])
                  Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[50,1580+6]..[50,1580+14])
                [
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/pr5689.ml[50,1580+15]..[50,1580+26])
                      Pexp_ident "process_any" (testsuite/tests/typing-gadts/pr5689.ml[50,1580+15]..[50,1580+26])
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/pr5689.ml[50,1580+27]..[50,1580+30])
                      Pexp_ident "seq" (testsuite/tests/typing-gadts/pr5689.ml[50,1580+27]..[50,1580+30])
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[52,1614+0]..[59,1819+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr5689.ml[52,1614+9]..[59,1819+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr5689.ml[52,1614+9]..[59,1819+2])
          Pexp_constant PConst_string ("\ntype ast_t =\n    Ast_Text of string\n  | Ast_Bold of ast_t list\n  | Ast_Link of string\n  | Ast_Mref of string * ast_t list\nval inlineseq_from_astseq : ast_t list -> inkind inline_t list = <fun>\n",(testsuite/tests/typing-gadts/pr5689.ml[52,1614+11]..[59,1819+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[62,1835+0]..[64,1882+25])
    Pstr_type Rec
    [
      type_declaration "linkp" (testsuite/tests/typing-gadts/pr5689.ml[62,1835+7]..[62,1835+12]) (testsuite/tests/typing-gadts/pr5689.ml[62,1835+0]..[64,1882+25])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr5689.ml[62,1835+5]..[62,1835+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr5689.ml[63,1850+1]..[63,1850+31])
                "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[63,1850+3]..[63,1850+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[63,1850+13]..[63,1850+31])
                    Ptyp_constr "linkp" (testsuite/tests/typing-gadts/pr5689.ml[63,1850+26]..[63,1850+31])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[63,1850+13]..[63,1850+25])
                        Ptyp_variant closed=Closed
                        [
                          Rtag "Nonlink" true
                            []
                        ]
                        None
                    ]
              (testsuite/tests/typing-gadts/pr5689.ml[64,1882+1]..[64,1882+25])
                "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[64,1882+3]..[64,1882+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[64,1882+13]..[64,1882+25])
                    Ptyp_constr "linkp" (testsuite/tests/typing-gadts/pr5689.ml[64,1882+20]..[64,1882+25])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[64,1882+13]..[64,1882+19])
                        Ptyp_constr "inkind" (testsuite/tests/typing-gadts/pr5689.ml[64,1882+13]..[64,1882+19])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[66,1911+0]..[78,2459+36])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr5689.ml[66,1911+4]..[66,1911+25])
          Ppat_var "inlineseq_from_astseq" (testsuite/tests/typing-gadts/pr5689.ml[66,1911+4]..[66,1911+25])
        expression (testsuite/tests/typing-gadts/pr5689.ml[66,1911+26]..[78,2459+36]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/pr5689.ml[66,1911+26]..[66,1911+29])
            Ppat_var "seq" (testsuite/tests/typing-gadts/pr5689.ml[66,1911+26]..[66,1911+29])
          expression (testsuite/tests/typing-gadts/pr5689.ml[67,1943+1]..[78,2459+36])
            Pexp_let Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/pr5689.ml[67,1943+9]..[67,1943+57]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/pr5689.ml[67,1943+9]..[67,1943+16])
                    Ppat_var "process" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+9]..[67,1943+16])
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+9]..[77,2409+49]) ghost
                    Ptyp_poly 'a
                    core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+27]..[67,1943+57])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+27]..[67,1943+34])
                        Ptyp_constr "linkp" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+29]..[67,1943+34])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+27]..[67,1943+28])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+38]..[67,1943+57])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+38]..[67,1943+43])
                          Ptyp_constr "ast_t" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+38]..[67,1943+43])
                          []
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+47]..[67,1943+57])
                          Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+49]..[67,1943+57])
                          [
                            core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+47]..[67,1943+48])
                              Ptyp_var a
                          ]
                expression (testsuite/tests/typing-gadts/pr5689.ml[67,1943+9]..[77,2409+49])
                  Pexp_newtype "a"
                  expression (testsuite/tests/typing-gadts/pr5689.ml[67,1943+9]..[77,2409+49])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/pr5689.ml[68,2003+3]..[77,2409+49])
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/pr5689.ml[68,2003+7]..[68,2003+17])
                        Ppat_var "allow_link" (testsuite/tests/typing-gadts/pr5689.ml[68,2003+7]..[68,2003+17])
                      expression (testsuite/tests/typing-gadts/pr5689.ml[68,2003+18]..[77,2409+49]) ghost
                        Pexp_fun
                        Nolabel
                        None
                        pattern (testsuite/tests/typing-gadts/pr5689.ml[68,2003+18]..[68,2003+21])
                          Ppat_var "ast" (testsuite/tests/typing-gadts/pr5689.ml[68,2003+18]..[68,2003+21])
                        expression (testsuite/tests/typing-gadts/pr5689.ml[69,2028+5]..[77,2409+49])
                          Pexp_match
                          expression (testsuite/tests/typing-gadts/pr5689.ml[69,2028+11]..[69,2028+28])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/pr5689.ml[69,2028+12]..[69,2028+22])
                                Pexp_ident "allow_link" (testsuite/tests/typing-gadts/pr5689.ml[69,2028+12]..[69,2028+22])
                              expression (testsuite/tests/typing-gadts/pr5689.ml[69,2028+24]..[69,2028+27])
                                Pexp_ident "ast" (testsuite/tests/typing-gadts/pr5689.ml[69,2028+24]..[69,2028+27])
                            ]
                          [
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[70,2062+7]..[70,2062+30])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[70,2062+8]..[70,2062+15])
                                    Ppat_construct "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[70,2062+8]..[70,2062+15])
                                    None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[70,2062+17]..[70,2062+29])
                                    Ppat_construct "Ast_Text" (testsuite/tests/typing-gadts/pr5689.ml[70,2062+17]..[70,2062+25])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[70,2062+26]..[70,2062+29])
                                        Ppat_var "txt" (testsuite/tests/typing-gadts/pr5689.ml[70,2062+26]..[70,2062+29])
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[70,2062+37]..[70,2062+45])
                                Pexp_construct "Text" (testsuite/tests/typing-gadts/pr5689.ml[70,2062+37]..[70,2062+41])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[70,2062+42]..[70,2062+45])
                                    Pexp_ident "txt" (testsuite/tests/typing-gadts/pr5689.ml[70,2062+42]..[70,2062+45])
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[71,2108+7]..[71,2108+30])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[71,2108+8]..[71,2108+15])
                                    Ppat_construct "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[71,2108+8]..[71,2108+15])
                                    None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[71,2108+17]..[71,2108+29])
                                    Ppat_construct "Ast_Text" (testsuite/tests/typing-gadts/pr5689.ml[71,2108+17]..[71,2108+25])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[71,2108+26]..[71,2108+29])
                                        Ppat_var "txt" (testsuite/tests/typing-gadts/pr5689.ml[71,2108+26]..[71,2108+29])
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[71,2108+37]..[71,2108+45])
                                Pexp_construct "Text" (testsuite/tests/typing-gadts/pr5689.ml[71,2108+37]..[71,2108+41])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[71,2108+42]..[71,2108+45])
                                    Pexp_ident "txt" (testsuite/tests/typing-gadts/pr5689.ml[71,2108+42]..[71,2108+45])
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[72,2154+7]..[72,2154+23])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[72,2154+8]..[72,2154+9])
                                    Ppat_var "x" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+8]..[72,2154+9])
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[72,2154+11]..[72,2154+22])
                                    Ppat_construct "Ast_Bold" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+11]..[72,2154+19])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[72,2154+20]..[72,2154+22])
                                        Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+20]..[72,2154+22])
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[72,2154+37]..[72,2154+67])
                                Pexp_construct "Bold" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+37]..[72,2154+41])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[72,2154+42]..[72,2154+67])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/pr5689.ml[72,2154+43]..[72,2154+51])
                                      Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+43]..[72,2154+51])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[72,2154+52]..[72,2154+63])
                                          Pexp_apply
                                          expression (testsuite/tests/typing-gadts/pr5689.ml[72,2154+53]..[72,2154+60])
                                            Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+53]..[72,2154+60])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/pr5689.ml[72,2154+61]..[72,2154+62])
                                                Pexp_ident "x" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+61]..[72,2154+62])
                                          ]
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[72,2154+64]..[72,2154+66])
                                          Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[72,2154+64]..[72,2154+66])
                                    ]
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[73,2222+7]..[73,2222+30])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[73,2222+8]..[73,2222+15])
                                    Ppat_construct "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[73,2222+8]..[73,2222+15])
                                    None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[73,2222+17]..[73,2222+29])
                                    Ppat_construct "Ast_Link" (testsuite/tests/typing-gadts/pr5689.ml[73,2222+17]..[73,2222+25])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[73,2222+26]..[73,2222+29])
                                        Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[73,2222+26]..[73,2222+29])
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[73,2222+37]..[73,2222+45])
                                Pexp_construct "Link" (testsuite/tests/typing-gadts/pr5689.ml[73,2222+37]..[73,2222+41])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[73,2222+42]..[73,2222+45])
                                    Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[73,2222+42]..[73,2222+45])
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[74,2268+7]..[74,2268+28])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[74,2268+8]..[74,2268+15])
                                    Ppat_construct "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[74,2268+8]..[74,2268+15])
                                    None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[74,2268+17]..[74,2268+27])
                                    Ppat_construct "Ast_Link" (testsuite/tests/typing-gadts/pr5689.ml[74,2268+17]..[74,2268+25])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[74,2268+26]..[74,2268+27])
                                        Ppat_any
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[74,2268+37]..[74,2268+49])
                                Pexp_assert
                                expression (testsuite/tests/typing-gadts/pr5689.ml[74,2268+44]..[74,2268+49])
                                  Pexp_construct "false" (testsuite/tests/typing-gadts/pr5689.ml[74,2268+44]..[74,2268+49])
                                  None
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[75,2318+7]..[75,2318+36])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[75,2318+8]..[75,2318+15])
                                    Ppat_construct "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[75,2318+8]..[75,2318+15])
                                    None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[75,2318+17]..[75,2318+35])
                                    Ppat_construct "Ast_Mref" (testsuite/tests/typing-gadts/pr5689.ml[75,2318+17]..[75,2318+25])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[75,2318+26]..[75,2318+35])
                                        Ppat_tuple
                                        [
                                          pattern (testsuite/tests/typing-gadts/pr5689.ml[75,2318+27]..[75,2318+30])
                                            Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[75,2318+27]..[75,2318+30])
                                          pattern (testsuite/tests/typing-gadts/pr5689.ml[75,2318+32]..[75,2318+34])
                                            Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[75,2318+32]..[75,2318+34])
                                        ]
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+9]..[76,2358+50])
                                Pexp_construct "Mref" (testsuite/tests/typing-gadts/pr5689.ml[76,2358+9]..[76,2358+13])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+14]..[76,2358+50])
                                    Pexp_tuple
                                    [
                                      expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+15]..[76,2358+18])
                                        Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[76,2358+15]..[76,2358+18])
                                      expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+20]..[76,2358+49])
                                        Pexp_apply
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+20]..[76,2358+28])
                                          Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[76,2358+20]..[76,2358+28])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+29]..[76,2358+46])
                                              Pexp_apply
                                              expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+30]..[76,2358+37])
                                                Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[76,2358+30]..[76,2358+37])
                                              [
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+38]..[76,2358+45])
                                                    Pexp_construct "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[76,2358+38]..[76,2358+45])
                                                    None
                                              ]
                                          <arg>
                                          Nolabel
                                            expression (testsuite/tests/typing-gadts/pr5689.ml[76,2358+47]..[76,2358+49])
                                              Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[76,2358+47]..[76,2358+49])
                                        ]
                                    ]
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[77,2409+7]..[77,2409+28])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[77,2409+8]..[77,2409+15])
                                    Ppat_construct "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[77,2409+8]..[77,2409+15])
                                    None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[77,2409+17]..[77,2409+27])
                                    Ppat_construct "Ast_Mref" (testsuite/tests/typing-gadts/pr5689.ml[77,2409+17]..[77,2409+25])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[77,2409+26]..[77,2409+27])
                                        Ppat_any
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[77,2409+37]..[77,2409+49])
                                Pexp_assert
                                expression (testsuite/tests/typing-gadts/pr5689.ml[77,2409+44]..[77,2409+49])
                                  Pexp_construct "false" (testsuite/tests/typing-gadts/pr5689.ml[77,2409+44]..[77,2409+49])
                                  None
                          ]
                    core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+27]..[67,1943+57])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+27]..[67,1943+34])
                        Ptyp_constr "linkp" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+29]..[67,1943+34])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+27]..[67,1943+28])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+27]..[67,1943+28])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+38]..[67,1943+57])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+38]..[67,1943+43])
                          Ptyp_constr "ast_t" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+38]..[67,1943+43])
                          []
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+47]..[67,1943+57])
                          Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+49]..[67,1943+57])
                          [
                            core_type (testsuite/tests/typing-gadts/pr5689.ml[67,1943+47]..[67,1943+48])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/pr5689.ml[67,1943+47]..[67,1943+48])
                              []
                          ]
            ]
            expression (testsuite/tests/typing-gadts/pr5689.ml[78,2459+6]..[78,2459+36])
              Pexp_apply
              expression (testsuite/tests/typing-gadts/pr5689.ml[78,2459+6]..[78,2459+14])
                Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[78,2459+6]..[78,2459+14])
              [
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/pr5689.ml[78,2459+15]..[78,2459+32])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/pr5689.ml[78,2459+16]..[78,2459+23])
                      Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[78,2459+16]..[78,2459+23])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/pr5689.ml[78,2459+24]..[78,2459+31])
                          Pexp_construct "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[78,2459+24]..[78,2459+31])
                          None
                    ]
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/pr5689.ml[78,2459+33]..[78,2459+36])
                    Pexp_ident "seq" (testsuite/tests/typing-gadts/pr5689.ml[78,2459+33]..[78,2459+36])
              ]
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[80,2499+0]..[83,2651+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr5689.ml[80,2499+9]..[83,2651+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr5689.ml[80,2499+9]..[83,2651+2])
          Pexp_constant PConst_string ("\ntype _ linkp = Nonlink : [ `Nonlink ] linkp | Maylink : inkind linkp\nval inlineseq_from_astseq : ast_t list -> inkind inline_t list = <fun>\n",(testsuite/tests/typing-gadts/pr5689.ml[80,2499+11]..[83,2651+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[86,2668+0]..[86,2668+61])
    Pstr_type Rec
    [
      type_declaration "linkp2" (testsuite/tests/typing-gadts/pr5689.ml[86,2668+7]..[86,2668+13]) (testsuite/tests/typing-gadts/pr5689.ml[86,2668+0]..[86,2668+61])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr5689.ml[86,2668+5]..[86,2668+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr5689.ml[86,2668+16]..[86,2668+61])
                "Kind" (testsuite/tests/typing-gadts/pr5689.ml[86,2668+16]..[86,2668+20])
                [
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[86,2668+23]..[86,2668+31])
                    Ptyp_constr "linkp" (testsuite/tests/typing-gadts/pr5689.ml[86,2668+26]..[86,2668+31])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[86,2668+23]..[86,2668+25])
                        Ptyp_var a
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[86,2668+35]..[86,2668+61])
                    Ptyp_constr "linkp2" (testsuite/tests/typing-gadts/pr5689.ml[86,2668+55]..[86,2668+61])
                    [
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[86,2668+36]..[86,2668+53])
                        Ptyp_alias "a"
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[86,2668+36]..[86,2668+47])
                          Ptyp_variant closed=Closed
                          [
                            Rinherit
                              core_type (testsuite/tests/typing-gadts/pr5689.ml[86,2668+39]..[86,2668+45])
                                Ptyp_constr "inkind" (testsuite/tests/typing-gadts/pr5689.ml[86,2668+39]..[86,2668+45])
                                []
                          ]
                          Some
                            []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[88,2733+0]..[99,3252+42])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr5689.ml[88,2733+4]..[88,2733+25])
          Ppat_var "inlineseq_from_astseq" (testsuite/tests/typing-gadts/pr5689.ml[88,2733+4]..[88,2733+25])
        expression (testsuite/tests/typing-gadts/pr5689.ml[88,2733+26]..[99,3252+42]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/pr5689.ml[88,2733+26]..[88,2733+29])
            Ppat_var "seq" (testsuite/tests/typing-gadts/pr5689.ml[88,2733+26]..[88,2733+29])
          expression (testsuite/tests/typing-gadts/pr5689.ml[89,2765+0]..[99,3252+42])
            Pexp_let Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/pr5689.ml[89,2765+8]..[89,2765+57]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/pr5689.ml[89,2765+8]..[89,2765+15])
                    Ppat_var "process" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+8]..[89,2765+15])
                  core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+8]..[98,3198+53]) ghost
                    Ptyp_poly 'a
                    core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+26]..[89,2765+57])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+26]..[89,2765+34])
                        Ptyp_constr "linkp2" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+28]..[89,2765+34])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+26]..[89,2765+27])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+38]..[89,2765+57])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+38]..[89,2765+43])
                          Ptyp_constr "ast_t" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+38]..[89,2765+43])
                          []
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+47]..[89,2765+57])
                          Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+49]..[89,2765+57])
                          [
                            core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+47]..[89,2765+48])
                              Ptyp_var a
                          ]
                expression (testsuite/tests/typing-gadts/pr5689.ml[89,2765+8]..[98,3198+53])
                  Pexp_newtype "a"
                  expression (testsuite/tests/typing-gadts/pr5689.ml[89,2765+8]..[98,3198+53])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/pr5689.ml[90,2825+2]..[98,3198+53])
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/pr5689.ml[90,2825+6]..[90,2825+16])
                        Ppat_var "allow_link" (testsuite/tests/typing-gadts/pr5689.ml[90,2825+6]..[90,2825+16])
                      expression (testsuite/tests/typing-gadts/pr5689.ml[90,2825+17]..[98,3198+53]) ghost
                        Pexp_fun
                        Nolabel
                        None
                        pattern (testsuite/tests/typing-gadts/pr5689.ml[90,2825+17]..[90,2825+20])
                          Ppat_var "ast" (testsuite/tests/typing-gadts/pr5689.ml[90,2825+17]..[90,2825+20])
                        expression (testsuite/tests/typing-gadts/pr5689.ml[91,2849+4]..[98,3198+53])
                          Pexp_match
                          expression (testsuite/tests/typing-gadts/pr5689.ml[91,2849+10]..[91,2849+27])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/pr5689.ml[91,2849+11]..[91,2849+21])
                                Pexp_ident "allow_link" (testsuite/tests/typing-gadts/pr5689.ml[91,2849+11]..[91,2849+21])
                              expression (testsuite/tests/typing-gadts/pr5689.ml[91,2849+23]..[91,2849+26])
                                Pexp_ident "ast" (testsuite/tests/typing-gadts/pr5689.ml[91,2849+23]..[91,2849+26])
                            ]
                          [
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[92,2882+6]..[92,2882+28])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[92,2882+7]..[92,2882+13])
                                    Ppat_construct "Kind" (testsuite/tests/typing-gadts/pr5689.ml[92,2882+7]..[92,2882+11])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[92,2882+12]..[92,2882+13])
                                        Ppat_any
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[92,2882+15]..[92,2882+27])
                                    Ppat_construct "Ast_Text" (testsuite/tests/typing-gadts/pr5689.ml[92,2882+15]..[92,2882+23])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[92,2882+24]..[92,2882+27])
                                        Ppat_var "txt" (testsuite/tests/typing-gadts/pr5689.ml[92,2882+24]..[92,2882+27])
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[92,2882+35]..[92,2882+43])
                                Pexp_construct "Text" (testsuite/tests/typing-gadts/pr5689.ml[92,2882+35]..[92,2882+39])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[92,2882+40]..[92,2882+43])
                                    Pexp_ident "txt" (testsuite/tests/typing-gadts/pr5689.ml[92,2882+40]..[92,2882+43])
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[93,2926+6]..[93,2926+22])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[93,2926+7]..[93,2926+8])
                                    Ppat_var "x" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+7]..[93,2926+8])
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[93,2926+10]..[93,2926+21])
                                    Ppat_construct "Ast_Bold" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+10]..[93,2926+18])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[93,2926+19]..[93,2926+21])
                                        Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+19]..[93,2926+21])
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[93,2926+36]..[93,2926+66])
                                Pexp_construct "Bold" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+36]..[93,2926+40])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[93,2926+41]..[93,2926+66])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/pr5689.ml[93,2926+42]..[93,2926+50])
                                      Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+42]..[93,2926+50])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[93,2926+51]..[93,2926+62])
                                          Pexp_apply
                                          expression (testsuite/tests/typing-gadts/pr5689.ml[93,2926+52]..[93,2926+59])
                                            Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+52]..[93,2926+59])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/pr5689.ml[93,2926+60]..[93,2926+61])
                                                Pexp_ident "x" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+60]..[93,2926+61])
                                          ]
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[93,2926+63]..[93,2926+65])
                                          Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[93,2926+63]..[93,2926+65])
                                    ]
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[94,2993+6]..[94,2993+34])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[94,2993+7]..[94,2993+19])
                                    Ppat_construct "Kind" (testsuite/tests/typing-gadts/pr5689.ml[94,2993+7]..[94,2993+11])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[94,2993+12]..[94,2993+19])
                                        Ppat_construct "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[94,2993+12]..[94,2993+19])
                                        None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[94,2993+21]..[94,2993+33])
                                    Ppat_construct "Ast_Link" (testsuite/tests/typing-gadts/pr5689.ml[94,2993+21]..[94,2993+29])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[94,2993+30]..[94,2993+33])
                                        Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[94,2993+30]..[94,2993+33])
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[94,2993+41]..[94,2993+49])
                                Pexp_construct "Link" (testsuite/tests/typing-gadts/pr5689.ml[94,2993+41]..[94,2993+45])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[94,2993+46]..[94,2993+49])
                                    Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[94,2993+46]..[94,2993+49])
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[95,3043+6]..[95,3043+32])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[95,3043+7]..[95,3043+19])
                                    Ppat_construct "Kind" (testsuite/tests/typing-gadts/pr5689.ml[95,3043+7]..[95,3043+11])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[95,3043+12]..[95,3043+19])
                                        Ppat_construct "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[95,3043+12]..[95,3043+19])
                                        None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[95,3043+21]..[95,3043+31])
                                    Ppat_construct "Ast_Link" (testsuite/tests/typing-gadts/pr5689.ml[95,3043+21]..[95,3043+29])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[95,3043+30]..[95,3043+31])
                                        Ppat_any
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[95,3043+41]..[95,3043+53])
                                Pexp_assert
                                expression (testsuite/tests/typing-gadts/pr5689.ml[95,3043+48]..[95,3043+53])
                                  Pexp_construct "false" (testsuite/tests/typing-gadts/pr5689.ml[95,3043+48]..[95,3043+53])
                                  None
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[96,3097+6]..[96,3097+40])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[96,3097+7]..[96,3097+19])
                                    Ppat_construct "Kind" (testsuite/tests/typing-gadts/pr5689.ml[96,3097+7]..[96,3097+11])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[96,3097+12]..[96,3097+19])
                                        Ppat_construct "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[96,3097+12]..[96,3097+19])
                                        None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[96,3097+21]..[96,3097+39])
                                    Ppat_construct "Ast_Mref" (testsuite/tests/typing-gadts/pr5689.ml[96,3097+21]..[96,3097+29])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[96,3097+30]..[96,3097+39])
                                        Ppat_tuple
                                        [
                                          pattern (testsuite/tests/typing-gadts/pr5689.ml[96,3097+31]..[96,3097+34])
                                            Ppat_var "lnk" (testsuite/tests/typing-gadts/pr5689.ml[96,3097+31]..[96,3097+34])
                                          pattern (testsuite/tests/typing-gadts/pr5689.ml[96,3097+36]..[96,3097+38])
                                            Ppat_var "xs" (testsuite/tests/typing-gadts/pr5689.ml[96,3097+36]..[96,3097+38])
                                        ]
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+8]..[97,3141+56])
                                Pexp_construct "Mref" (testsuite/tests/typing-gadts/pr5689.ml[97,3141+8]..[97,3141+12])
                                Some
                                  expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+13]..[97,3141+56])
                                    Pexp_tuple
                                    [
                                      expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+14]..[97,3141+17])
                                        Pexp_ident "lnk" (testsuite/tests/typing-gadts/pr5689.ml[97,3141+14]..[97,3141+17])
                                      expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+19]..[97,3141+55])
                                        Pexp_apply
                                        expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+19]..[97,3141+27])
                                          Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[97,3141+19]..[97,3141+27])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+28]..[97,3141+52])
                                              Pexp_apply
                                              expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+29]..[97,3141+36])
                                                Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[97,3141+29]..[97,3141+36])
                                              [
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+37]..[97,3141+51])
                                                    Pexp_construct "Kind" (testsuite/tests/typing-gadts/pr5689.ml[97,3141+38]..[97,3141+42])
                                                    Some
                                                      expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+43]..[97,3141+50])
                                                        Pexp_construct "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[97,3141+43]..[97,3141+50])
                                                        None
                                              ]
                                          <arg>
                                          Nolabel
                                            expression (testsuite/tests/typing-gadts/pr5689.ml[97,3141+53]..[97,3141+55])
                                              Pexp_ident "xs" (testsuite/tests/typing-gadts/pr5689.ml[97,3141+53]..[97,3141+55])
                                        ]
                                    ]
                            <case>
                              pattern (testsuite/tests/typing-gadts/pr5689.ml[98,3198+6]..[98,3198+32])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[98,3198+7]..[98,3198+19])
                                    Ppat_construct "Kind" (testsuite/tests/typing-gadts/pr5689.ml[98,3198+7]..[98,3198+11])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[98,3198+12]..[98,3198+19])
                                        Ppat_construct "Nonlink" (testsuite/tests/typing-gadts/pr5689.ml[98,3198+12]..[98,3198+19])
                                        None
                                  pattern (testsuite/tests/typing-gadts/pr5689.ml[98,3198+21]..[98,3198+31])
                                    Ppat_construct "Ast_Mref" (testsuite/tests/typing-gadts/pr5689.ml[98,3198+21]..[98,3198+29])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/pr5689.ml[98,3198+30]..[98,3198+31])
                                        Ppat_any
                                ]
                              expression (testsuite/tests/typing-gadts/pr5689.ml[98,3198+41]..[98,3198+53])
                                Pexp_assert
                                expression (testsuite/tests/typing-gadts/pr5689.ml[98,3198+48]..[98,3198+53])
                                  Pexp_construct "false" (testsuite/tests/typing-gadts/pr5689.ml[98,3198+48]..[98,3198+53])
                                  None
                          ]
                    core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+26]..[89,2765+57])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+26]..[89,2765+34])
                        Ptyp_constr "linkp2" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+28]..[89,2765+34])
                        [
                          core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+26]..[89,2765+27])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+26]..[89,2765+27])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+38]..[89,2765+57])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+38]..[89,2765+43])
                          Ptyp_constr "ast_t" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+38]..[89,2765+43])
                          []
                        core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+47]..[89,2765+57])
                          Ptyp_constr "inline_t" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+49]..[89,2765+57])
                          [
                            core_type (testsuite/tests/typing-gadts/pr5689.ml[89,2765+47]..[89,2765+48])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/pr5689.ml[89,2765+47]..[89,2765+48])
                              []
                          ]
            ]
            expression (testsuite/tests/typing-gadts/pr5689.ml[99,3252+5]..[99,3252+42])
              Pexp_apply
              expression (testsuite/tests/typing-gadts/pr5689.ml[99,3252+5]..[99,3252+13])
                Pexp_ident "List.map" (testsuite/tests/typing-gadts/pr5689.ml[99,3252+5]..[99,3252+13])
              [
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/pr5689.ml[99,3252+14]..[99,3252+38])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/pr5689.ml[99,3252+15]..[99,3252+22])
                      Pexp_ident "process" (testsuite/tests/typing-gadts/pr5689.ml[99,3252+15]..[99,3252+22])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/pr5689.ml[99,3252+23]..[99,3252+37])
                          Pexp_construct "Kind" (testsuite/tests/typing-gadts/pr5689.ml[99,3252+24]..[99,3252+28])
                          Some
                            expression (testsuite/tests/typing-gadts/pr5689.ml[99,3252+29]..[99,3252+36])
                              Pexp_construct "Maylink" (testsuite/tests/typing-gadts/pr5689.ml[99,3252+29]..[99,3252+36])
                              None
                    ]
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/pr5689.ml[99,3252+39]..[99,3252+42])
                    Pexp_ident "seq" (testsuite/tests/typing-gadts/pr5689.ml[99,3252+39]..[99,3252+42])
              ]
    ]
  structure_item (testsuite/tests/typing-gadts/pr5689.ml[101,3298+0]..[112,3828+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr5689.ml[101,3298+9]..[112,3828+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr5689.ml[101,3298+9]..[112,3828+2])
          Pexp_constant PConst_string ("\ntype _ linkp2 = Kind : 'a linkp -> ([< inkind ] as 'a) linkp2\nLine 7, characters 35-43:\n7 |     | (Kind _, Ast_Text txt)    -> Text txt\n                                       ^^^^^^^^\nError: This expression has type ([< inkind > `Nonlink ] as 'a) inline_t\n       but an expression was expected of type a inline_t\n       Type 'a = [< `Link | `Nonlink > `Nonlink ] is not compatible with type\n         a = [< `Link | `Nonlink ]\n       The second variant type is bound to $'a,\n       it may not allow the tag(s) `Nonlink\n",(testsuite/tests/typing-gadts/pr5689.ml[101,3298+11]..[112,3828+0]),Some "")
    ]
]

