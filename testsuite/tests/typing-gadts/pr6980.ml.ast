[
  structure_item (testsuite/tests/typing-gadts/pr6980.ml[5,24+0]..[5,24+33])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/pr6980.ml[5,24+8]..[5,24+9]) (testsuite/tests/typing-gadts/pr6980.ml[5,24+0]..[5,24+33])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6980.ml[5,24+5]..[5,24+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (testsuite/tests/typing-gadts/pr6980.ml[5,24+12]..[5,24+33])
              Ptyp_alias "a"
              core_type (testsuite/tests/typing-gadts/pr6980.ml[5,24+12]..[5,24+27])
                Ptyp_variant closed=Closed
                [
                  Rtag "Foo" true
                    []
                  Rtag "Bar" true
                    []
                ]
                Some
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/pr6980.ml[6,60+0]..[6,60+47])
    Pstr_type Rec
    [
      type_declaration "s" (testsuite/tests/typing-gadts/pr6980.ml[6,60+8]..[6,60+9]) (testsuite/tests/typing-gadts/pr6980.ml[6,60+0]..[6,60+47])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6980.ml[6,60+5]..[6,60+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (testsuite/tests/typing-gadts/pr6980.ml[6,60+12]..[6,60+47])
              Ptyp_alias "a"
              core_type (testsuite/tests/typing-gadts/pr6980.ml[6,60+12]..[6,60+41])
                Ptyp_variant closed=Closed
                [
                  Rtag "Foo" true
                    []
                  Rtag "Bar" true
                    []
                  Rtag "Baz" true
                    []
                ]
                Some
                  [
                    "Bar"
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/pr6980.ml[8,111+0]..[9,167+44])
    Pstr_type Rec
    [
      type_declaration "first" (testsuite/tests/typing-gadts/pr6980.ml[8,111+8]..[8,111+13]) (testsuite/tests/typing-gadts/pr6980.ml[8,111+0]..[8,111+55])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6980.ml[8,111+5]..[8,111+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr6980.ml[8,111+16]..[8,111+55])
                "First" (testsuite/tests/typing-gadts/pr6980.ml[8,111+16]..[8,111+21])
                [
                  core_type (testsuite/tests/typing-gadts/pr6980.ml[8,111+24]..[8,111+33])
                    Ptyp_constr "second" (testsuite/tests/typing-gadts/pr6980.ml[8,111+27]..[8,111+33])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6980.ml[8,111+24]..[8,111+26])
                        Ptyp_var a
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr6980.ml[8,111+37]..[8,111+55])
                    Ptyp_constr "first" (testsuite/tests/typing-gadts/pr6980.ml[8,111+50]..[8,111+55])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6980.ml[8,111+38]..[8,111+48])
                        Ptyp_alias "a"
                        core_type (testsuite/tests/typing-gadts/pr6980.ml[8,111+38]..[8,111+42])
                          Ptyp_constr "t" (testsuite/tests/typing-gadts/pr6980.ml[8,111+41]..[8,111+42])
                          [
                            core_type (testsuite/tests/typing-gadts/pr6980.ml[8,111+38]..[8,111+40])
                              Ptyp_var b
                          ]
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "second" (testsuite/tests/typing-gadts/pr6980.ml[9,167+7]..[9,167+13]) (testsuite/tests/typing-gadts/pr6980.ml[9,167+0]..[9,167+44])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6980.ml[9,167+4]..[9,167+6])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr6980.ml[9,167+16]..[9,167+44])
                "Second" (testsuite/tests/typing-gadts/pr6980.ml[9,167+16]..[9,167+22])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr6980.ml[9,167+25]..[9,167+44])
                    Ptyp_constr "second" (testsuite/tests/typing-gadts/pr6980.ml[9,167+38]..[9,167+44])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6980.ml[9,167+26]..[9,167+36])
                        Ptyp_alias "a"
                        core_type (testsuite/tests/typing-gadts/pr6980.ml[9,167+26]..[9,167+30])
                          Ptyp_constr "s" (testsuite/tests/typing-gadts/pr6980.ml[9,167+29]..[9,167+30])
                          [
                            core_type (testsuite/tests/typing-gadts/pr6980.ml[9,167+26]..[9,167+28])
                              Ptyp_var b
                          ]
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6980.ml[11,215+0]..[11,215+49])
    Pstr_type Rec
    [
      type_declaration "aux" (testsuite/tests/typing-gadts/pr6980.ml[11,215+5]..[11,215+8]) (testsuite/tests/typing-gadts/pr6980.ml[11,215+0]..[11,215+49])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr6980.ml[11,215+11]..[11,215+49])
                "Aux" (testsuite/tests/typing-gadts/pr6980.ml[11,215+11]..[11,215+14])
                [
                  core_type (testsuite/tests/typing-gadts/pr6980.ml[11,215+17]..[11,215+28])
                    Ptyp_constr "second" (testsuite/tests/typing-gadts/pr6980.ml[11,215+22]..[11,215+28])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6980.ml[11,215+17]..[11,215+21])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/pr6980.ml[11,215+20]..[11,215+21])
                        [
                          core_type (testsuite/tests/typing-gadts/pr6980.ml[11,215+17]..[11,215+19])
                            Ptyp_var a
                        ]
                    ]
                  core_type (testsuite/tests/typing-gadts/pr6980.ml[11,215+32]..[11,215+41])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/pr6980.ml[11,215+32]..[11,215+34])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/pr6980.ml[11,215+38]..[11,215+41])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/pr6980.ml[11,215+38]..[11,215+41])
                      []
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr6980.ml[11,215+46]..[11,215+49])
                    Ptyp_constr "aux" (testsuite/tests/typing-gadts/pr6980.ml[11,215+46]..[11,215+49])
                    []
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6980.ml[13,268+0]..[13,268+49])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr6980.ml[13,268+4]..[13,268+42]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/pr6980.ml[13,268+4]..[13,268+6])
            Ppat_var "it" (testsuite/tests/typing-gadts/pr6980.ml[13,268+4]..[13,268+6])
          core_type (testsuite/tests/typing-gadts/pr6980.ml[13,268+9]..[13,268+42]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/pr6980.ml[13,268+13]..[13,268+42])
              Ptyp_alias "a"
              core_type (testsuite/tests/typing-gadts/pr6980.ml[13,268+13]..[13,268+36])
                Ptyp_variant closed=Closed
                [
                  Rtag "Bar" true
                    []
                  Rtag "Foo" true
                    []
                ]
                Some
                  [
                    "Bar"
                  ]
        expression (testsuite/tests/typing-gadts/pr6980.ml[13,268+45]..[13,268+49])
          Pexp_variant "Bar"
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6980.ml[15,321+0]..[15,321+29])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr6980.ml[15,321+4]..[15,321+5])
          Ppat_var "g" (testsuite/tests/typing-gadts/pr6980.ml[15,321+4]..[15,321+5])
        expression (testsuite/tests/typing-gadts/pr6980.ml[15,321+6]..[15,321+29]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/pr6980.ml[15,321+6]..[15,321+22])
            Ppat_construct "Aux" (testsuite/tests/typing-gadts/pr6980.ml[15,321+7]..[15,321+10])
            Some
              []
              pattern (testsuite/tests/typing-gadts/pr6980.ml[15,321+10]..[15,321+21])
                Ppat_tuple
                [
                  pattern (testsuite/tests/typing-gadts/pr6980.ml[15,321+11]..[15,321+17])
                    Ppat_construct "Second" (testsuite/tests/typing-gadts/pr6980.ml[15,321+11]..[15,321+17])
                    None
                  pattern (testsuite/tests/typing-gadts/pr6980.ml[15,321+19]..[15,321+20])
                    Ppat_var "f" (testsuite/tests/typing-gadts/pr6980.ml[15,321+19]..[15,321+20])
                ]
          expression (testsuite/tests/typing-gadts/pr6980.ml[15,321+25]..[15,321+29])
            Pexp_apply
            expression (testsuite/tests/typing-gadts/pr6980.ml[15,321+25]..[15,321+26])
              Pexp_ident "f" (testsuite/tests/typing-gadts/pr6980.ml[15,321+25]..[15,321+26])
            [
              <arg>
              Nolabel
                expression (testsuite/tests/typing-gadts/pr6980.ml[15,321+27]..[15,321+29])
                  Pexp_ident "it" (testsuite/tests/typing-gadts/pr6980.ml[15,321+27]..[15,321+29])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/pr6980.ml[17,354+0]..[31,1035+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr6980.ml[17,354+9]..[31,1035+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr6980.ml[17,354+9]..[31,1035+2])
          Pexp_constant PConst_string ("\ntype 'a t = 'a constraint 'a = [< `Bar | `Foo ]\ntype 'a s = 'a constraint 'a = [< `Bar | `Baz | `Foo > `Bar ]\ntype 'a first = First : 'a t second -> ([< `Bar | `Foo ] as 'a) t first\nand 'a second = Second : [< `Bar | `Baz | `Foo > `Bar ] s second\ntype aux = Aux : ([< `Bar | `Foo ] as 'a) t second * ('a -> int) -> aux\nval it : [< `Bar | `Foo > `Bar ] = `Bar\nLine 11, characters 27-29:\n11 | let g (Aux(Second, f)) = f it;;\n                                ^^\nError: This expression has type [< `Bar | `Foo > `Bar ]\n       but an expression was expected of type [< `Bar | `Foo ]\n       The second variant type is bound to $Aux_'a,\n       it may not allow the tag(s) `Bar\n",(testsuite/tests/typing-gadts/pr6980.ml[17,354+11]..[31,1035+0]),Some "")
    ]
]

