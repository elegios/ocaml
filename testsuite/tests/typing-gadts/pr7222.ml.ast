[
  structure_item (testsuite/tests/typing-gadts/pr7222.ml[5,24+0]..[5,24+24])
    Pstr_type Rec
    [
      type_declaration "n" (testsuite/tests/typing-gadts/pr7222.ml[5,24+9]..[5,24+10]) (testsuite/tests/typing-gadts/pr7222.ml[5,24+0]..[5,24+24])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr7222.ml[5,24+6]..[5,24+8])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Private
        ptype_manifest =
          Some
            core_type (testsuite/tests/typing-gadts/pr7222.ml[5,24+21]..[5,24+24])
              Ptyp_constr "int" (testsuite/tests/typing-gadts/pr7222.ml[5,24+21]..[5,24+24])
              []
    ]
  structure_item (testsuite/tests/typing-gadts/pr7222.ml[6,49+0]..[6,49+27])
    Pstr_type Rec
    [
      type_declaration "nil" (testsuite/tests/typing-gadts/pr7222.ml[6,49+5]..[6,49+8]) (testsuite/tests/typing-gadts/pr7222.ml[6,49+0]..[6,49+27])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr7222.ml[6,49+19]..[6,49+27])
                "Nil_type" (testsuite/tests/typing-gadts/pr7222.ml[6,49+19]..[6,49+27])
                []
                None
            ]
        ptype_private = Private
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr7222.ml[7,77+0]..[9,137+38])
    Pstr_type Rec
    [
      type_declaration "elt" (testsuite/tests/typing-gadts/pr7222.ml[7,77+11]..[7,77+14]) (testsuite/tests/typing-gadts/pr7222.ml[7,77+0]..[9,137+38])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr7222.ml[7,77+6]..[7,77+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/pr7222.ml[7,77+8]..[7,77+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr7222.ml[8,94+2]..[8,94+42])
                "Elt_fine" (testsuite/tests/typing-gadts/pr7222.ml[8,94+4]..[8,94+12])
                [
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[8,94+14]..[8,94+20])
                    Ptyp_constr "n" (testsuite/tests/typing-gadts/pr7222.ml[8,94+19]..[8,94+20])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[8,94+14]..[8,94+18])
                        Ptyp_var nat
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[8,94+24]..[8,94+42])
                    Ptyp_constr "elt" (testsuite/tests/typing-gadts/pr7222.ml[8,94+39]..[8,94+42])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[8,94+25]..[8,94+27])
                        Ptyp_var l
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[8,94+28]..[8,94+37])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/pr7222.ml[8,94+28]..[8,94+32])
                            Ptyp_var nat
                          core_type (testsuite/tests/typing-gadts/pr7222.ml[8,94+35]..[8,94+37])
                            Ptyp_var l
                        ]
                    ]
              (testsuite/tests/typing-gadts/pr7222.ml[9,137+2]..[9,137+38])
                "Elt" (testsuite/tests/typing-gadts/pr7222.ml[9,137+4]..[9,137+7])
                [
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[9,137+9]..[9,137+15])
                    Ptyp_constr "n" (testsuite/tests/typing-gadts/pr7222.ml[9,137+14]..[9,137+15])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[9,137+9]..[9,137+13])
                        Ptyp_var nat
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[9,137+19]..[9,137+38])
                    Ptyp_constr "elt" (testsuite/tests/typing-gadts/pr7222.ml[9,137+35]..[9,137+38])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[9,137+20]..[9,137+22])
                        Ptyp_var l
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[9,137+23]..[9,137+33])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/pr7222.ml[9,137+23]..[9,137+27])
                          Ptyp_var nat
                        core_type (testsuite/tests/typing-gadts/pr7222.ml[9,137+31]..[9,137+33])
                          Ptyp_var l
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr7222.ml[10,176+0]..[10,176+61])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/pr7222.ml[10,176+7]..[10,176+8]) (testsuite/tests/typing-gadts/pr7222.ml[10,176+0]..[10,176+61])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+5]..[10,176+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr7222.ml[10,176+11]..[10,176+22])
                "Nil" (testsuite/tests/typing-gadts/pr7222.ml[10,176+11]..[10,176+14])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+17]..[10,176+22])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7222.ml[10,176+21]..[10,176+22])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+17]..[10,176+20])
                        Ptyp_constr "nil" (testsuite/tests/typing-gadts/pr7222.ml[10,176+17]..[10,176+20])
                        []
                    ]
              (testsuite/tests/typing-gadts/pr7222.ml[10,176+23]..[10,176+61])
                "Cons" (testsuite/tests/typing-gadts/pr7222.ml[10,176+25]..[10,176+29])
                [
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+32]..[10,176+45])
                    Ptyp_constr "elt" (testsuite/tests/typing-gadts/pr7222.ml[10,176+42]..[10,176+45])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+33]..[10,176+35])
                        Ptyp_var x
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+37]..[10,176+40])
                        Ptyp_var fx
                    ]
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+48]..[10,176+52])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7222.ml[10,176+51]..[10,176+52])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+48]..[10,176+50])
                        Ptyp_var x
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+56]..[10,176+61])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7222.ml[10,176+60]..[10,176+61])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[10,176+56]..[10,176+59])
                        Ptyp_var fx
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr7222.ml[12,241+0]..[13,317+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr7222.ml[12,241+4]..[12,241+59]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/pr7222.ml[12,241+4]..[12,241+14])
            Ppat_var "undetected" (testsuite/tests/typing-gadts/pr7222.ml[12,241+4]..[12,241+14])
          core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+16]..[12,241+59]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+16]..[12,241+59])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+16]..[12,241+35])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7222.ml[12,241+34]..[12,241+35])
                [
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+17]..[12,241+32])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+17]..[12,241+19])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+23]..[12,241+32])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+23]..[12,241+25])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+29]..[12,241+32])
                        Ptyp_constr "nil" (testsuite/tests/typing-gadts/pr7222.ml[12,241+29]..[12,241+32])
                        []
                ]
              core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+39]..[12,241+59])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+39]..[12,241+43])
                  Ptyp_constr "n" (testsuite/tests/typing-gadts/pr7222.ml[12,241+42]..[12,241+43])
                  [
                    core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+39]..[12,241+41])
                      Ptyp_var a
                  ]
                core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+47]..[12,241+59])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+47]..[12,241+51])
                    Ptyp_constr "n" (testsuite/tests/typing-gadts/pr7222.ml[12,241+50]..[12,241+51])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+47]..[12,241+49])
                        Ptyp_var b
                    ]
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+55]..[12,241+59])
                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr7222.ml[12,241+55]..[12,241+59])
                    []
        expression (testsuite/tests/typing-gadts/pr7222.ml[12,241+4]..[13,317+33])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/pr7222.ml[12,241+62]..[13,317+33])
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/pr7222.ml[12,241+66]..[12,241+68])
              Ppat_var "sh" (testsuite/tests/typing-gadts/pr7222.ml[12,241+66]..[12,241+68])
            expression (testsuite/tests/typing-gadts/pr7222.ml[12,241+69]..[13,317+33]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/pr7222.ml[12,241+69]..[12,241+70])
                Ppat_var "i" (testsuite/tests/typing-gadts/pr7222.ml[12,241+69]..[12,241+70])
              expression (testsuite/tests/typing-gadts/pr7222.ml[12,241+71]..[13,317+33]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/pr7222.ml[12,241+71]..[12,241+72])
                  Ppat_var "j" (testsuite/tests/typing-gadts/pr7222.ml[12,241+71]..[12,241+72])
                expression (testsuite/tests/typing-gadts/pr7222.ml[13,317+2]..[13,317+33])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/pr7222.ml[13,317+6]..[13,317+22])
                        Ppat_construct "Cons" (testsuite/tests/typing-gadts/pr7222.ml[13,317+6]..[13,317+10])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/pr7222.ml[13,317+10]..[13,317+22])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/pr7222.ml[13,317+11]..[13,317+18])
                                Ppat_construct "Elt" (testsuite/tests/typing-gadts/pr7222.ml[13,317+11]..[13,317+14])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/pr7222.ml[13,317+15]..[13,317+18])
                                    Ppat_var "dim" (testsuite/tests/typing-gadts/pr7222.ml[13,317+15]..[13,317+18])
                              pattern (testsuite/tests/typing-gadts/pr7222.ml[13,317+20]..[13,317+21])
                                Ppat_any
                            ]
                      expression (testsuite/tests/typing-gadts/pr7222.ml[13,317+25]..[13,317+27])
                        Pexp_ident "sh" (testsuite/tests/typing-gadts/pr7222.ml[13,317+25]..[13,317+27])
                  ]
                  expression (testsuite/tests/typing-gadts/pr7222.ml[13,317+31]..[13,317+33])
                    Pexp_construct "()" (testsuite/tests/typing-gadts/pr7222.ml[13,317+31]..[13,317+33])
                    None
          core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+16]..[12,241+59])
            Ptyp_arrow
            Nolabel
            core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+16]..[12,241+35])
              Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7222.ml[12,241+34]..[12,241+35])
              [
                core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+17]..[12,241+32])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+17]..[12,241+19])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+23]..[12,241+32])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+23]..[12,241+25])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+29]..[12,241+32])
                      Ptyp_constr "nil" (testsuite/tests/typing-gadts/pr7222.ml[12,241+29]..[12,241+32])
                      []
              ]
            core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+39]..[12,241+59])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+39]..[12,241+43])
                Ptyp_constr "n" (testsuite/tests/typing-gadts/pr7222.ml[12,241+42]..[12,241+43])
                [
                  core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+39]..[12,241+41])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+47]..[12,241+59])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+47]..[12,241+51])
                  Ptyp_constr "n" (testsuite/tests/typing-gadts/pr7222.ml[12,241+50]..[12,241+51])
                  [
                    core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+47]..[12,241+49])
                      Ptyp_var b
                  ]
                core_type (testsuite/tests/typing-gadts/pr7222.ml[12,241+55]..[12,241+59])
                  Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr7222.ml[12,241+55]..[12,241+59])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/pr7222.ml[16,355+0]..[30,907+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr7222.ml[16,355+9]..[30,907+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr7222.ml[16,355+9]..[30,907+2])
          Pexp_constant PConst_string ("\ntype +'a n = private int\ntype nil = private Nil_type\ntype (_, _) elt =\n    Elt_fine : 'nat n -> ('l, 'nat * 'l) elt\n  | Elt : 'nat n -> ('l, 'nat -> 'l) elt\ntype _ t = Nil : nil t | Cons : ('x, 'fx) elt * 'x t -> 'fx t\nLine 9, characters 11-18:\n9 |   let Cons(Elt dim, _) = sh in ()\n               ^^^^^^^\nError: This pattern matches values of type ($Cons_'x, 'a -> $Cons_'x) elt\n       but a pattern was expected which matches values of type\n         ($Cons_'x, 'a -> $'b -> nil) elt\n       The type constructor $'b would escape its scope\n",(testsuite/tests/typing-gadts/pr7222.ml[16,355+11]..[30,907+0]),Some "")
    ]
]

