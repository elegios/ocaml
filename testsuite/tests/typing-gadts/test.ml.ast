[
  structure_item (testsuite/tests/typing-gadts/test.ml[5,24+0]..[32,631+5])
    Pstr_module
    "Exp" (testsuite/tests/typing-gadts/test.ml[5,24+7]..[5,24+10])
      module_expr (testsuite/tests/typing-gadts/test.ml[6,37+2]..[32,631+5])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[8,47+4]..[13,209+40])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[8,47+11]..[8,47+12]) (testsuite/tests/typing-gadts/test.ml[8,47+4]..[13,209+40])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[8,47+9]..[8,47+10])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[9,62+6]..[9,62+29])
                        "IntLit" (testsuite/tests/typing-gadts/test.ml[9,62+8]..[9,62+14])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[9,62+17]..[9,62+20])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[9,62+17]..[9,62+20])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[9,62+24]..[9,62+29])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[9,62+28]..[9,62+29])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[9,62+24]..[9,62+27])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[9,62+24]..[9,62+27])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[10,92+6]..[10,92+32])
                        "BoolLit" (testsuite/tests/typing-gadts/test.ml[10,92+8]..[10,92+15])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[10,92+18]..[10,92+22])
                            Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[10,92+18]..[10,92+22])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[10,92+26]..[10,92+32])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[10,92+31]..[10,92+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[10,92+26]..[10,92+30])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[10,92+26]..[10,92+30])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[11,125+6]..[11,125+41])
                        "Pair" (testsuite/tests/typing-gadts/test.ml[11,125+8]..[11,125+12])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[11,125+15]..[11,125+19])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[11,125+18]..[11,125+19])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[11,125+15]..[11,125+17])
                                Ptyp_var a
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[11,125+22]..[11,125+26])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[11,125+25]..[11,125+26])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[11,125+22]..[11,125+24])
                                Ptyp_var b
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[11,125+30]..[11,125+41])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[11,125+40]..[11,125+41])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[11,125+31]..[11,125+38])
                                Ptyp_tuple
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[11,125+31]..[11,125+33])
                                    Ptyp_var a
                                  core_type (testsuite/tests/typing-gadts/test.ml[11,125+36]..[11,125+38])
                                    Ptyp_var b
                                ]
                            ]
                      (testsuite/tests/typing-gadts/test.ml[12,167+6]..[12,167+41])
                        "App" (testsuite/tests/typing-gadts/test.ml[12,167+8]..[12,167+11])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[12,167+14]..[12,167+26])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[12,167+25]..[12,167+26])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[12,167+15]..[12,167+23])
                                Ptyp_arrow
                                Nolabel
                                core_type (testsuite/tests/typing-gadts/test.ml[12,167+15]..[12,167+17])
                                  Ptyp_var a
                                core_type (testsuite/tests/typing-gadts/test.ml[12,167+21]..[12,167+23])
                                  Ptyp_var b
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[12,167+29]..[12,167+33])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[12,167+32]..[12,167+33])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[12,167+29]..[12,167+31])
                                Ptyp_var a
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[12,167+37]..[12,167+41])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[12,167+40]..[12,167+41])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[12,167+37]..[12,167+39])
                                Ptyp_var b
                            ]
                      (testsuite/tests/typing-gadts/test.ml[13,209+6]..[13,209+40])
                        "Abs" (testsuite/tests/typing-gadts/test.ml[13,209+8]..[13,209+11])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[13,209+15]..[13,209+23])
                            Ptyp_arrow
                            Nolabel
                            core_type (testsuite/tests/typing-gadts/test.ml[13,209+15]..[13,209+17])
                              Ptyp_var a
                            core_type (testsuite/tests/typing-gadts/test.ml[13,209+21]..[13,209+23])
                              Ptyp_var b
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[13,209+28]..[13,209+40])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[13,209+39]..[13,209+40])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[13,209+29]..[13,209+37])
                                Ptyp_arrow
                                Nolabel
                                core_type (testsuite/tests/typing-gadts/test.ml[13,209+29]..[13,209+31])
                                  Ptyp_var a
                                core_type (testsuite/tests/typing-gadts/test.ml[13,209+35]..[13,209+37])
                                  Ptyp_var b
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[16,252+4]..[24,460+20])
            Pstr_value Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[16,252+12]..[16,252+36]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[16,252+12]..[16,252+16])
                    Ppat_var "eval" (testsuite/tests/typing-gadts/test.ml[16,252+12]..[16,252+16])
                  core_type (testsuite/tests/typing-gadts/test.ml[16,252+12]..[24,460+20]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[16,252+28]..[16,252+36])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[16,252+28]..[16,252+31])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[16,252+30]..[16,252+31])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[16,252+28]..[16,252+29])
                            Ptyp_var s
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[16,252+35]..[16,252+36])
                        Ptyp_var s
                expression (testsuite/tests/typing-gadts/test.ml[16,252+12]..[24,460+20])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[16,252+12]..[24,460+20])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[17,291+6]..[24,460+20])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[18,306+10]..[18,306+18])
                            Ppat_construct "IntLit" (testsuite/tests/typing-gadts/test.ml[18,306+10]..[18,306+16])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[18,306+17]..[18,306+18])
                                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[18,306+17]..[18,306+18])
                          expression (testsuite/tests/typing-gadts/test.ml[18,306+22]..[18,306+23])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[18,306+22]..[18,306+23])
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[19,330+10]..[19,330+19])
                            Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/test.ml[19,330+10]..[19,330+17])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[19,330+18]..[19,330+19])
                                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[19,330+18]..[19,330+19])
                          expression (testsuite/tests/typing-gadts/test.ml[19,330+23]..[19,330+24])
                            Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[19,330+23]..[19,330+24])
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[20,355+10]..[20,355+20])
                            Ppat_construct "Pair" (testsuite/tests/typing-gadts/test.ml[20,355+10]..[20,355+14])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[20,355+15]..[20,355+20])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/test.ml[20,355+16]..[20,355+17])
                                    Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[20,355+16]..[20,355+17])
                                  pattern (testsuite/tests/typing-gadts/test.ml[20,355+18]..[20,355+19])
                                    Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[20,355+18]..[20,355+19])
                                ]
                          expression (testsuite/tests/typing-gadts/test.ml[21,379+12]..[21,379+27])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/test.ml[21,379+13]..[21,379+19])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/test.ml[21,379+13]..[21,379+17])
                                  Pexp_ident "eval" (testsuite/tests/typing-gadts/test.ml[21,379+13]..[21,379+17])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/test.ml[21,379+18]..[21,379+19])
                                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[21,379+18]..[21,379+19])
                                ]
                              expression (testsuite/tests/typing-gadts/test.ml[21,379+20]..[21,379+26])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/test.ml[21,379+20]..[21,379+24])
                                  Pexp_ident "eval" (testsuite/tests/typing-gadts/test.ml[21,379+20]..[21,379+24])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/test.ml[21,379+25]..[21,379+26])
                                      Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[21,379+25]..[21,379+26])
                                ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[22,407+10]..[22,407+19])
                            Ppat_construct "App" (testsuite/tests/typing-gadts/test.ml[22,407+10]..[22,407+13])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[22,407+14]..[22,407+19])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/test.ml[22,407+15]..[22,407+16])
                                    Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[22,407+15]..[22,407+16])
                                  pattern (testsuite/tests/typing-gadts/test.ml[22,407+17]..[22,407+18])
                                    Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[22,407+17]..[22,407+18])
                                ]
                          expression (testsuite/tests/typing-gadts/test.ml[23,430+12]..[23,430+29])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[23,430+12]..[23,430+20])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/test.ml[23,430+13]..[23,430+17])
                                Pexp_ident "eval" (testsuite/tests/typing-gadts/test.ml[23,430+13]..[23,430+17])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[23,430+18]..[23,430+19])
                                    Pexp_ident "f" (testsuite/tests/typing-gadts/test.ml[23,430+18]..[23,430+19])
                              ]
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[23,430+21]..[23,430+29])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/test.ml[23,430+22]..[23,430+26])
                                    Pexp_ident "eval" (testsuite/tests/typing-gadts/test.ml[23,430+22]..[23,430+26])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/test.ml[23,430+27]..[23,430+28])
                                        Pexp_ident "a" (testsuite/tests/typing-gadts/test.ml[23,430+27]..[23,430+28])
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[24,460+10]..[24,460+15])
                            Ppat_construct "Abs" (testsuite/tests/typing-gadts/test.ml[24,460+10]..[24,460+13])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[24,460+14]..[24,460+15])
                                Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[24,460+14]..[24,460+15])
                          expression (testsuite/tests/typing-gadts/test.ml[24,460+19]..[24,460+20])
                            Pexp_ident "f" (testsuite/tests/typing-gadts/test.ml[24,460+19]..[24,460+20])
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[16,252+28]..[16,252+36])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[16,252+28]..[16,252+31])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[16,252+30]..[16,252+31])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[16,252+28]..[16,252+29])
                            Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[16,252+28]..[16,252+29])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[16,252+35]..[16,252+36])
                        Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[16,252+35]..[16,252+36])
                        []
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[26,482+4]..[31,612+18])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[26,482+8]..[26,482+34]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[26,482+8]..[26,482+15])
                    Ppat_var "discern" (testsuite/tests/typing-gadts/test.ml[26,482+8]..[26,482+15])
                  core_type (testsuite/tests/typing-gadts/test.ml[26,482+8]..[31,612+18]) ghost
                    Ptyp_poly 'a
                    core_type (testsuite/tests/typing-gadts/test.ml[26,482+26]..[26,482+34])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[26,482+26]..[26,482+29])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[26,482+28]..[26,482+29])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[26,482+26]..[26,482+27])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[26,482+33]..[26,482+34])
                        Ptyp_any
                expression (testsuite/tests/typing-gadts/test.ml[26,482+8]..[31,612+18])
                  Pexp_newtype "a"
                  expression (testsuite/tests/typing-gadts/test.ml[26,482+8]..[31,612+18])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[26,482+37]..[31,612+18])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[27,528+8]..[27,528+16])
                            Ppat_construct "IntLit" (testsuite/tests/typing-gadts/test.ml[27,528+8]..[27,528+14])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[27,528+15]..[27,528+16])
                                Ppat_any
                          expression (testsuite/tests/typing-gadts/test.ml[27,528+20]..[27,528+21])
                            Pexp_constant PConst_int (1,None)
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[28,550+8]..[28,550+17])
                            Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/test.ml[28,550+8]..[28,550+15])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[28,550+16]..[28,550+17])
                                Ppat_any
                          expression (testsuite/tests/typing-gadts/test.ml[28,550+21]..[28,550+22])
                            Pexp_constant PConst_int (2,None)
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[29,573+8]..[29,573+14])
                            Ppat_construct "Pair" (testsuite/tests/typing-gadts/test.ml[29,573+8]..[29,573+12])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[29,573+13]..[29,573+14])
                                Ppat_any
                          expression (testsuite/tests/typing-gadts/test.ml[29,573+18]..[29,573+19])
                            Pexp_constant PConst_int (3,None)
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[30,593+8]..[30,593+13])
                            Ppat_construct "App" (testsuite/tests/typing-gadts/test.ml[30,593+8]..[30,593+11])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[30,593+12]..[30,593+13])
                                Ppat_any
                          expression (testsuite/tests/typing-gadts/test.ml[30,593+17]..[30,593+18])
                            Pexp_constant PConst_int (4,None)
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[31,612+8]..[31,612+13])
                            Ppat_construct "Abs" (testsuite/tests/typing-gadts/test.ml[31,612+8]..[31,612+11])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[31,612+12]..[31,612+13])
                                Ppat_any
                          expression (testsuite/tests/typing-gadts/test.ml[31,612+17]..[31,612+18])
                            Pexp_constant PConst_int (5,None)
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[26,482+26]..[26,482+34])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[26,482+26]..[26,482+29])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[26,482+28]..[26,482+29])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[26,482+26]..[26,482+27])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[26,482+26]..[26,482+27])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[26,482+33]..[26,482+34])
                        Ptyp_any
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[34,640+0]..[46,936+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[34,640+9]..[46,936+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[34,640+9]..[46,936+2])
          Pexp_constant PConst_string ("\nmodule Exp :\n  sig\n    type _ t =\n        IntLit : int -> int t\n      | BoolLit : bool -> bool t\n      | Pair : 'a t * 'b t -> ('a * 'b) t\n      | App : ('a -> 'b) t * 'a t -> 'b t\n      | Abs : ('a -> 'b) -> ('a -> 'b) t\n    val eval : 's t -> 's\n    val discern : 'a t -> int\n  end\n",(testsuite/tests/typing-gadts/test.ml[34,640+11]..[46,936+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[48,943+0]..[64,1278+5])
    Pstr_module
    "List" (testsuite/tests/typing-gadts/test.ml[48,943+7]..[48,943+11])
      module_expr (testsuite/tests/typing-gadts/test.ml[49,957+2]..[64,1278+5])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[50,966+4]..[50,966+13])
            Pstr_type Rec
            [
              type_declaration "zero" (testsuite/tests/typing-gadts/test.ml[50,966+9]..[50,966+13]) (testsuite/tests/typing-gadts/test.ml[50,966+4]..[50,966+13])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[51,980+4]..[53,1016+39])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[51,980+11]..[51,980+12]) (testsuite/tests/typing-gadts/test.ml[51,980+4]..[53,1016+39])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[51,980+9]..[51,980+10])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[52,995+6]..[52,995+20])
                        "Nil" (testsuite/tests/typing-gadts/test.ml[52,995+8]..[52,995+11])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[52,995+14]..[52,995+20])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[52,995+19]..[52,995+20])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[52,995+14]..[52,995+18])
                                Ptyp_constr "zero" (testsuite/tests/typing-gadts/test.ml[52,995+14]..[52,995+18])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[53,1016+6]..[53,1016+39])
                        "Cons" (testsuite/tests/typing-gadts/test.ml[53,1016+8]..[53,1016+12])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[53,1016+15]..[53,1016+17])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/test.ml[53,1016+20]..[53,1016+24])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[53,1016+23]..[53,1016+24])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[53,1016+20]..[53,1016+22])
                                Ptyp_var b
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[53,1016+28]..[53,1016+39])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[53,1016+38]..[53,1016+39])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[53,1016+29]..[53,1016+36])
                                Ptyp_tuple
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[53,1016+29]..[53,1016+31])
                                    Ptyp_var a
                                  core_type (testsuite/tests/typing-gadts/test.ml[53,1016+34]..[53,1016+36])
                                    Ptyp_var b
                                ]
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[54,1056+4]..[56,1086+25])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[54,1056+8]..[54,1056+12])
                  Ppat_var "head" (testsuite/tests/typing-gadts/test.ml[54,1056+8]..[54,1056+12])
                expression (testsuite/tests/typing-gadts/test.ml[55,1071+6]..[56,1086+25])
                  Pexp_function
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[56,1086+10]..[56,1086+20])
                        Ppat_construct "Cons" (testsuite/tests/typing-gadts/test.ml[56,1086+10]..[56,1086+14])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/test.ml[56,1086+15]..[56,1086+20])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[56,1086+16]..[56,1086+17])
                                Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[56,1086+16]..[56,1086+17])
                              pattern (testsuite/tests/typing-gadts/test.ml[56,1086+18]..[56,1086+19])
                                Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[56,1086+18]..[56,1086+19])
                            ]
                      expression (testsuite/tests/typing-gadts/test.ml[56,1086+24]..[56,1086+25])
                        Pexp_ident "a" (testsuite/tests/typing-gadts/test.ml[56,1086+24]..[56,1086+25])
                  ]
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[57,1112+4]..[59,1142+25])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[57,1112+8]..[57,1112+12])
                  Ppat_var "tail" (testsuite/tests/typing-gadts/test.ml[57,1112+8]..[57,1112+12])
                expression (testsuite/tests/typing-gadts/test.ml[58,1127+6]..[59,1142+25])
                  Pexp_function
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[59,1142+10]..[59,1142+20])
                        Ppat_construct "Cons" (testsuite/tests/typing-gadts/test.ml[59,1142+10]..[59,1142+14])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/test.ml[59,1142+15]..[59,1142+20])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[59,1142+16]..[59,1142+17])
                                Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[59,1142+16]..[59,1142+17])
                              pattern (testsuite/tests/typing-gadts/test.ml[59,1142+18]..[59,1142+19])
                                Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[59,1142+18]..[59,1142+19])
                            ]
                      expression (testsuite/tests/typing-gadts/test.ml[59,1142+24]..[59,1142+25])
                        Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[59,1142+24]..[59,1142+25])
                  ]
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[60,1168+4]..[63,1245+32])
            Pstr_value Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[60,1168+12]..[60,1168+40]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[60,1168+12]..[60,1168+18])
                    Ppat_var "length" (testsuite/tests/typing-gadts/test.ml[60,1168+12]..[60,1168+18])
                  core_type (testsuite/tests/typing-gadts/test.ml[60,1168+12]..[63,1245+32]) ghost
                    Ptyp_poly 'a
                    core_type (testsuite/tests/typing-gadts/test.ml[60,1168+30]..[60,1168+40])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[60,1168+30]..[60,1168+33])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[60,1168+32]..[60,1168+33])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[60,1168+30]..[60,1168+31])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[60,1168+37]..[60,1168+40])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[60,1168+37]..[60,1168+40])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[60,1168+12]..[63,1245+32])
                  Pexp_newtype "a"
                  expression (testsuite/tests/typing-gadts/test.ml[60,1168+12]..[63,1245+32])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[61,1211+6]..[63,1245+32])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[62,1226+10]..[62,1226+13])
                            Ppat_construct "Nil" (testsuite/tests/typing-gadts/test.ml[62,1226+10]..[62,1226+13])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[62,1226+17]..[62,1226+18])
                            Pexp_constant PConst_int (0,None)
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[63,1245+10]..[63,1245+20])
                            Ppat_construct "Cons" (testsuite/tests/typing-gadts/test.ml[63,1245+10]..[63,1245+14])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[63,1245+15]..[63,1245+20])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/test.ml[63,1245+16]..[63,1245+17])
                                    Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[63,1245+16]..[63,1245+17])
                                  pattern (testsuite/tests/typing-gadts/test.ml[63,1245+18]..[63,1245+19])
                                    Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[63,1245+18]..[63,1245+19])
                                ]
                          expression (testsuite/tests/typing-gadts/test.ml[63,1245+24]..[63,1245+32])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[63,1245+24]..[63,1245+30])
                              Pexp_ident "length" (testsuite/tests/typing-gadts/test.ml[63,1245+24]..[63,1245+30])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[63,1245+31]..[63,1245+32])
                                  Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[63,1245+31]..[63,1245+32])
                            ]
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[60,1168+30]..[60,1168+40])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[60,1168+30]..[60,1168+33])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[60,1168+32]..[60,1168+33])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[60,1168+30]..[60,1168+31])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[60,1168+30]..[60,1168+31])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[60,1168+37]..[60,1168+40])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[60,1168+37]..[60,1168+40])
                        []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[66,1287+0]..[75,1498+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[66,1287+9]..[75,1498+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[66,1287+9]..[75,1498+2])
          Pexp_constant PConst_string ("\nmodule List :\n  sig\n    type zero\n    type _ t = Nil : zero t | Cons : 'a * 'b t -> ('a * 'b) t\n    val head : ('a * 'b) t -> 'a\n    val tail : ('a * 'b) t -> 'b t\n    val length : 'a t -> int\n  end\n",(testsuite/tests/typing-gadts/test.ml[66,1287+11]..[75,1498+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[77,1505+0]..[103,2034+5])
    Pstr_module
    "Nonexhaustive" (testsuite/tests/typing-gadts/test.ml[77,1505+7]..[77,1505+20])
      module_expr (testsuite/tests/typing-gadts/test.ml[78,1528+2]..[103,2034+5])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[79,1537+4]..[81,1579+27])
            Pstr_type Rec
            [
              type_declaration "u" (testsuite/tests/typing-gadts/test.ml[79,1537+12]..[79,1537+13]) (testsuite/tests/typing-gadts/test.ml[79,1537+4]..[81,1579+27])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[79,1537+9]..[79,1537+11])
                      Ptyp_var a
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[80,1553+6]..[80,1553+25])
                        "C1" (testsuite/tests/typing-gadts/test.ml[80,1553+8]..[80,1553+10])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[80,1553+13]..[80,1553+16])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[80,1553+13]..[80,1553+16])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[80,1553+20]..[80,1553+25])
                            Ptyp_constr "u" (testsuite/tests/typing-gadts/test.ml[80,1553+24]..[80,1553+25])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[80,1553+20]..[80,1553+23])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[80,1553+20]..[80,1553+23])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[81,1579+6]..[81,1579+27])
                        "C2" (testsuite/tests/typing-gadts/test.ml[81,1579+8]..[81,1579+10])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[81,1579+13]..[81,1579+17])
                            Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[81,1579+13]..[81,1579+17])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[81,1579+21]..[81,1579+27])
                            Ptyp_constr "u" (testsuite/tests/typing-gadts/test.ml[81,1579+26]..[81,1579+27])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[81,1579+21]..[81,1579+25])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[81,1579+21]..[81,1579+25])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[83,1608+4]..[84,1624+25])
            Pstr_type Rec
            [
              type_declaration "v" (testsuite/tests/typing-gadts/test.ml[83,1608+12]..[83,1608+13]) (testsuite/tests/typing-gadts/test.ml[83,1608+4]..[84,1624+25])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[83,1608+9]..[83,1608+11])
                      Ptyp_var a
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[84,1624+6]..[84,1624+25])
                        "C1" (testsuite/tests/typing-gadts/test.ml[84,1624+8]..[84,1624+10])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[84,1624+13]..[84,1624+16])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[84,1624+13]..[84,1624+16])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[84,1624+20]..[84,1624+25])
                            Ptyp_constr "v" (testsuite/tests/typing-gadts/test.ml[84,1624+24]..[84,1624+25])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[84,1624+20]..[84,1624+23])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[84,1624+20]..[84,1624+23])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[86,1651+4]..[88,1709+19])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[86,1651+8]..[86,1651+40]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[86,1651+8]..[86,1651+20])
                    Ppat_var "unexhaustive" (testsuite/tests/typing-gadts/test.ml[86,1651+8]..[86,1651+20])
                  core_type (testsuite/tests/typing-gadts/test.ml[86,1651+8]..[88,1709+19]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[86,1651+32]..[86,1651+40])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[86,1651+32]..[86,1651+35])
                        Ptyp_constr "u" (testsuite/tests/typing-gadts/test.ml[86,1651+34]..[86,1651+35])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[86,1651+32]..[86,1651+33])
                            Ptyp_var s
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[86,1651+39]..[86,1651+40])
                        Ptyp_var s
                expression (testsuite/tests/typing-gadts/test.ml[86,1651+8]..[88,1709+19])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[86,1651+8]..[88,1709+19])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[87,1694+6]..[88,1709+19])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[88,1709+10]..[88,1709+14])
                            Ppat_construct "C2" (testsuite/tests/typing-gadts/test.ml[88,1709+10]..[88,1709+12])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[88,1709+13]..[88,1709+14])
                                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[88,1709+13]..[88,1709+14])
                          expression (testsuite/tests/typing-gadts/test.ml[88,1709+18]..[88,1709+19])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[88,1709+18]..[88,1709+19])
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[86,1651+32]..[86,1651+40])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[86,1651+32]..[86,1651+35])
                        Ptyp_constr "u" (testsuite/tests/typing-gadts/test.ml[86,1651+34]..[86,1651+35])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[86,1651+32]..[86,1651+33])
                            Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[86,1651+32]..[86,1651+33])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[86,1651+39]..[86,1651+40])
                        Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[86,1651+39]..[86,1651+40])
                        []
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[91,1731+4]..[95,1826+9])
            Pstr_module
            "M" (testsuite/tests/typing-gadts/test.ml[91,1731+11]..[91,1731+12])
              module_expr (testsuite/tests/typing-gadts/test.ml[91,1731+13]..[95,1826+9])
                Pmod_constraint
                module_expr (testsuite/tests/typing-gadts/test.ml[92,1770+6]..[95,1826+9])
                  Pmod_structure
                  [
                    structure_item (testsuite/tests/typing-gadts/test.ml[93,1783+8]..[93,1783+20])
                      Pstr_type Rec
                      [
                        type_declaration "t" (testsuite/tests/typing-gadts/test.ml[93,1783+13]..[93,1783+14]) (testsuite/tests/typing-gadts/test.ml[93,1783+8]..[93,1783+20])
                          ptype_params =
                            []
                          ptype_cstrs =
                            []
                          ptype_kind =
                            Ptype_abstract
                          ptype_private = Public
                          ptype_manifest =
                            Some
                              core_type (testsuite/tests/typing-gadts/test.ml[93,1783+17]..[93,1783+20])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[93,1783+17]..[93,1783+20])
                                []
                      ]
                    structure_item (testsuite/tests/typing-gadts/test.ml[94,1804+8]..[94,1804+21])
                      Pstr_type Rec
                      [
                        type_declaration "u" (testsuite/tests/typing-gadts/test.ml[94,1804+13]..[94,1804+14]) (testsuite/tests/typing-gadts/test.ml[94,1804+8]..[94,1804+21])
                          ptype_params =
                            []
                          ptype_cstrs =
                            []
                          ptype_kind =
                            Ptype_abstract
                          ptype_private = Public
                          ptype_manifest =
                            Some
                              core_type (testsuite/tests/typing-gadts/test.ml[94,1804+17]..[94,1804+21])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[94,1804+17]..[94,1804+21])
                                []
                      ]
                  ]
                module_type (testsuite/tests/typing-gadts/test.ml[91,1731+15]..[91,1731+36])
                  Pmty_signature
                  [
                    signature_item (testsuite/tests/typing-gadts/test.ml[91,1731+19]..[91,1731+25])
                      Psig_type Rec
                      [
                        type_declaration "t" (testsuite/tests/typing-gadts/test.ml[91,1731+24]..[91,1731+25]) (testsuite/tests/typing-gadts/test.ml[91,1731+19]..[91,1731+25])
                          ptype_params =
                            []
                          ptype_cstrs =
                            []
                          ptype_kind =
                            Ptype_abstract
                          ptype_private = Public
                          ptype_manifest =
                            None
                      ]
                    signature_item (testsuite/tests/typing-gadts/test.ml[91,1731+26]..[91,1731+32])
                      Psig_type Rec
                      [
                        type_declaration "u" (testsuite/tests/typing-gadts/test.ml[91,1731+31]..[91,1731+32]) (testsuite/tests/typing-gadts/test.ml[91,1731+26]..[91,1731+32])
                          ptype_params =
                            []
                          ptype_cstrs =
                            []
                          ptype_kind =
                            Ptype_abstract
                          ptype_private = Public
                          ptype_manifest =
                            None
                      ]
                  ]
          structure_item (testsuite/tests/typing-gadts/test.ml[96,1836+4]..[98,1879+26])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[96,1836+12]..[96,1836+13]) (testsuite/tests/typing-gadts/test.ml[96,1836+4]..[98,1879+26])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[96,1836+9]..[96,1836+11])
                      Ptyp_var a
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[97,1852+6]..[97,1852+26])
                        "Foo" (testsuite/tests/typing-gadts/test.ml[97,1852+8]..[97,1852+11])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[97,1852+14]..[97,1852+17])
                            Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[97,1852+14]..[97,1852+17])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[97,1852+21]..[97,1852+26])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[97,1852+25]..[97,1852+26])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[97,1852+21]..[97,1852+24])
                                Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[97,1852+21]..[97,1852+24])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[98,1879+6]..[98,1879+26])
                        "Bar" (testsuite/tests/typing-gadts/test.ml[98,1879+8]..[98,1879+11])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[98,1879+14]..[98,1879+17])
                            Ptyp_constr "M.u" (testsuite/tests/typing-gadts/test.ml[98,1879+14]..[98,1879+17])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[98,1879+21]..[98,1879+26])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[98,1879+25]..[98,1879+26])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[98,1879+21]..[98,1879+24])
                                Ptyp_constr "M.u" (testsuite/tests/typing-gadts/test.ml[98,1879+21]..[98,1879+24])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[99,1906+4]..[102,2003+30])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[99,1906+8]..[99,1906+46]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[99,1906+8]..[99,1906+17])
                    Ppat_var "same_type" (testsuite/tests/typing-gadts/test.ml[99,1906+8]..[99,1906+17])
                  core_type (testsuite/tests/typing-gadts/test.ml[99,1906+8]..[102,2003+30]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+46])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+38])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+32])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[99,1906+31]..[99,1906+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+30])
                                Ptyp_var s
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[99,1906+35]..[99,1906+38])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[99,1906+37]..[99,1906+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[99,1906+35]..[99,1906+36])
                                Ptyp_var s
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[99,1906+42]..[99,1906+46])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[99,1906+42]..[99,1906+46])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[99,1906+8]..[102,2003+30])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[99,1906+8]..[102,2003+30])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[100,1956+6]..[102,2003+30])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[101,1971+10]..[101,1971+23])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[101,1971+10]..[101,1971+15])
                                Ppat_construct "Foo" (testsuite/tests/typing-gadts/test.ml[101,1971+10]..[101,1971+13])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[101,1971+14]..[101,1971+15])
                                    Ppat_any
                              pattern (testsuite/tests/typing-gadts/test.ml[101,1971+18]..[101,1971+23])
                                Ppat_construct "Foo" (testsuite/tests/typing-gadts/test.ml[101,1971+18]..[101,1971+21])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[101,1971+22]..[101,1971+23])
                                    Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/test.ml[101,1971+27]..[101,1971+31])
                            Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[101,1971+27]..[101,1971+31])
                            None
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[102,2003+10]..[102,2003+22])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[102,2003+10]..[102,2003+15])
                                Ppat_construct "Bar" (testsuite/tests/typing-gadts/test.ml[102,2003+10]..[102,2003+13])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[102,2003+14]..[102,2003+15])
                                    Ppat_any
                              pattern (testsuite/tests/typing-gadts/test.ml[102,2003+17]..[102,2003+22])
                                Ppat_construct "Bar" (testsuite/tests/typing-gadts/test.ml[102,2003+17]..[102,2003+20])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[102,2003+21]..[102,2003+22])
                                    Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/test.ml[102,2003+26]..[102,2003+30])
                            Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[102,2003+26]..[102,2003+30])
                            None
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+46])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+38])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+32])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[99,1906+31]..[99,1906+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+30])
                                Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[99,1906+29]..[99,1906+30])
                                []
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[99,1906+35]..[99,1906+38])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[99,1906+37]..[99,1906+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[99,1906+35]..[99,1906+36])
                                Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[99,1906+35]..[99,1906+36])
                                []
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[99,1906+42]..[99,1906+46])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[99,1906+42]..[99,1906+46])
                        []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[105,2043+0]..[128,2801+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[105,2043+9]..[128,2801+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[105,2043+9]..[128,2801+2])
          Pexp_constant PConst_string ("\nLines 11-12, characters 6-19:\n11 | ......function\n12 |         | C2 x -> x\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\nC1 _\nLines 24-26, characters 6-30:\n24 | ......function\n25 |         | Foo _ , Foo _ -> true\n26 |         | Bar _, Bar _ -> true\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\n(Foo _, Bar _)\nmodule Nonexhaustive :\n  sig\n    type 'a u = C1 : int -> int u | C2 : bool -> bool u\n    type 'a v = C1 : int -> int v\n    val unexhaustive : 's u -> 's\n    module M : sig type t type u end\n    type 'a t = Foo : M.t -> M.t t | Bar : M.u -> M.u t\n    val same_type : 's t * 's t -> bool\n  end\n",(testsuite/tests/typing-gadts/test.ml[105,2043+11]..[128,2801+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[130,2808+0]..[142,3063+5])
    Pstr_module
    "Exhaustive" (testsuite/tests/typing-gadts/test.ml[130,2808+7]..[130,2808+17])
      module_expr (testsuite/tests/typing-gadts/test.ml[131,2828+2]..[142,3063+5])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[132,2837+4]..[132,2837+16])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[132,2837+9]..[132,2837+10]) (testsuite/tests/typing-gadts/test.ml[132,2837+4]..[132,2837+16])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  Some
                    core_type (testsuite/tests/typing-gadts/test.ml[132,2837+13]..[132,2837+16])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[132,2837+13]..[132,2837+16])
                      []
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[133,2854+4]..[133,2854+17])
            Pstr_type Rec
            [
              type_declaration "u" (testsuite/tests/typing-gadts/test.ml[133,2854+9]..[133,2854+10]) (testsuite/tests/typing-gadts/test.ml[133,2854+4]..[133,2854+17])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  Some
                    core_type (testsuite/tests/typing-gadts/test.ml[133,2854+13]..[133,2854+17])
                      Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[133,2854+13]..[133,2854+17])
                      []
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[134,2872+4]..[136,2911+22])
            Pstr_type Rec
            [
              type_declaration "v" (testsuite/tests/typing-gadts/test.ml[134,2872+12]..[134,2872+13]) (testsuite/tests/typing-gadts/test.ml[134,2872+4]..[136,2911+22])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[134,2872+9]..[134,2872+11])
                      Ptyp_var a
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[135,2888+6]..[135,2888+22])
                        "Foo" (testsuite/tests/typing-gadts/test.ml[135,2888+8]..[135,2888+11])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[135,2888+14]..[135,2888+15])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[135,2888+14]..[135,2888+15])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[135,2888+19]..[135,2888+22])
                            Ptyp_constr "v" (testsuite/tests/typing-gadts/test.ml[135,2888+21]..[135,2888+22])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[135,2888+19]..[135,2888+20])
                                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[135,2888+19]..[135,2888+20])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[136,2911+6]..[136,2911+22])
                        "Bar" (testsuite/tests/typing-gadts/test.ml[136,2911+8]..[136,2911+11])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[136,2911+14]..[136,2911+15])
                            Ptyp_constr "u" (testsuite/tests/typing-gadts/test.ml[136,2911+14]..[136,2911+15])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[136,2911+19]..[136,2911+22])
                            Ptyp_constr "v" (testsuite/tests/typing-gadts/test.ml[136,2911+21]..[136,2911+22])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[136,2911+19]..[136,2911+20])
                                Ptyp_constr "u" (testsuite/tests/typing-gadts/test.ml[136,2911+19]..[136,2911+20])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[138,2935+4]..[141,3032+30])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[138,2935+8]..[138,2935+46]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[138,2935+8]..[138,2935+17])
                    Ppat_var "same_type" (testsuite/tests/typing-gadts/test.ml[138,2935+8]..[138,2935+17])
                  core_type (testsuite/tests/typing-gadts/test.ml[138,2935+8]..[141,3032+30]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+46])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+38])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+32])
                            Ptyp_constr "v" (testsuite/tests/typing-gadts/test.ml[138,2935+31]..[138,2935+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+30])
                                Ptyp_var s
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[138,2935+35]..[138,2935+38])
                            Ptyp_constr "v" (testsuite/tests/typing-gadts/test.ml[138,2935+37]..[138,2935+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[138,2935+35]..[138,2935+36])
                                Ptyp_var s
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[138,2935+42]..[138,2935+46])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[138,2935+42]..[138,2935+46])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[138,2935+8]..[141,3032+30])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[138,2935+8]..[141,3032+30])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[139,2985+6]..[141,3032+30])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[140,3000+10]..[140,3000+23])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[140,3000+10]..[140,3000+15])
                                Ppat_construct "Foo" (testsuite/tests/typing-gadts/test.ml[140,3000+10]..[140,3000+13])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[140,3000+14]..[140,3000+15])
                                    Ppat_any
                              pattern (testsuite/tests/typing-gadts/test.ml[140,3000+18]..[140,3000+23])
                                Ppat_construct "Foo" (testsuite/tests/typing-gadts/test.ml[140,3000+18]..[140,3000+21])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[140,3000+22]..[140,3000+23])
                                    Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/test.ml[140,3000+27]..[140,3000+31])
                            Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[140,3000+27]..[140,3000+31])
                            None
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[141,3032+10]..[141,3032+22])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[141,3032+10]..[141,3032+15])
                                Ppat_construct "Bar" (testsuite/tests/typing-gadts/test.ml[141,3032+10]..[141,3032+13])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[141,3032+14]..[141,3032+15])
                                    Ppat_any
                              pattern (testsuite/tests/typing-gadts/test.ml[141,3032+17]..[141,3032+22])
                                Ppat_construct "Bar" (testsuite/tests/typing-gadts/test.ml[141,3032+17]..[141,3032+20])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[141,3032+21]..[141,3032+22])
                                    Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/test.ml[141,3032+26]..[141,3032+30])
                            Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[141,3032+26]..[141,3032+30])
                            None
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+46])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+38])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+32])
                            Ptyp_constr "v" (testsuite/tests/typing-gadts/test.ml[138,2935+31]..[138,2935+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+30])
                                Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[138,2935+29]..[138,2935+30])
                                []
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[138,2935+35]..[138,2935+38])
                            Ptyp_constr "v" (testsuite/tests/typing-gadts/test.ml[138,2935+37]..[138,2935+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[138,2935+35]..[138,2935+36])
                                Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[138,2935+35]..[138,2935+36])
                                []
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[138,2935+42]..[138,2935+46])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[138,2935+42]..[138,2935+46])
                        []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[144,3072+0]..[152,3239+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[144,3072+9]..[152,3239+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[144,3072+9]..[152,3239+2])
          Pexp_constant PConst_string ("\nmodule Exhaustive :\n  sig\n    type t = int\n    type u = bool\n    type 'a v = Foo : t -> t v | Bar : u -> u v\n    val same_type : 's v * 's v -> bool\n  end\n",(testsuite/tests/typing-gadts/test.ml[144,3072+11]..[152,3239+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[154,3246+0]..[158,3425+3])
    Pstr_module
    "PR6862" (testsuite/tests/typing-gadts/test.ml[154,3246+7]..[154,3246+13])
      module_expr (testsuite/tests/typing-gadts/test.ml[154,3246+16]..[158,3425+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[155,3269+2]..[155,3269+50])
            Pstr_class
            [
              class_declaration (testsuite/tests/typing-gadts/test.ml[155,3269+2]..[155,3269+50])
                pci_virt = Concrete
                pci_params =
                  []
                pci_name = "c" (testsuite/tests/typing-gadts/test.ml[155,3269+8]..[155,3269+9])
                pci_expr =
                  class_expr (testsuite/tests/typing-gadts/test.ml[155,3269+10]..[155,3269+50])
                    Pcl_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[155,3269+10]..[155,3269+18])
                      Ppat_construct "Some" (testsuite/tests/typing-gadts/test.ml[155,3269+11]..[155,3269+15])
                      Some
                        []
                        pattern (testsuite/tests/typing-gadts/test.ml[155,3269+16]..[155,3269+17])
                          Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[155,3269+16]..[155,3269+17])
                    class_expr (testsuite/tests/typing-gadts/test.ml[155,3269+21]..[155,3269+50])
                      Pcl_structure
                      class_structure
                        pattern (testsuite/tests/typing-gadts/test.ml[155,3269+27]..[155,3269+27]) ghost
                          Ppat_any
                        [
                          class_field (testsuite/tests/typing-gadts/test.ml[155,3269+28]..[155,3269+46])
                            Pcf_method Public
                              "x" (testsuite/tests/typing-gadts/test.ml[155,3269+35]..[155,3269+36])
                              Concrete Fresh
                              expression (testsuite/tests/typing-gadts/test.ml[155,3269+39]..[155,3269+46]) ghost
                                Pexp_poly
                                expression (testsuite/tests/typing-gadts/test.ml[155,3269+45]..[155,3269+46])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[155,3269+45]..[155,3269+46])
                                Some
                                  core_type (testsuite/tests/typing-gadts/test.ml[155,3269+39]..[155,3269+42])
                                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[155,3269+39]..[155,3269+42])
                                    []
                        ]
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[156,3320+2]..[156,3320+53])
            Pstr_type Rec
            [
              type_declaration "opt" (testsuite/tests/typing-gadts/test.ml[156,3320+9]..[156,3320+12]) (testsuite/tests/typing-gadts/test.ml[156,3320+2]..[156,3320+53])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[156,3320+7]..[156,3320+8])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[156,3320+15]..[156,3320+34])
                        "Just" (testsuite/tests/typing-gadts/test.ml[156,3320+15]..[156,3320+19])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[156,3320+22]..[156,3320+24])
                            Ptyp_var a
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[156,3320+28]..[156,3320+34])
                            Ptyp_constr "opt" (testsuite/tests/typing-gadts/test.ml[156,3320+31]..[156,3320+34])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[156,3320+28]..[156,3320+30])
                                Ptyp_var a
                            ]
                      (testsuite/tests/typing-gadts/test.ml[156,3320+35]..[156,3320+53])
                        "Nothing" (testsuite/tests/typing-gadts/test.ml[156,3320+37]..[156,3320+44])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[156,3320+47]..[156,3320+53])
                            Ptyp_constr "opt" (testsuite/tests/typing-gadts/test.ml[156,3320+50]..[156,3320+53])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[156,3320+47]..[156,3320+49])
                                Ptyp_var a
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[157,3374+2]..[157,3374+50])
            Pstr_class
            [
              class_declaration (testsuite/tests/typing-gadts/test.ml[157,3374+2]..[157,3374+50])
                pci_virt = Concrete
                pci_params =
                  []
                pci_name = "d" (testsuite/tests/typing-gadts/test.ml[157,3374+8]..[157,3374+9])
                pci_expr =
                  class_expr (testsuite/tests/typing-gadts/test.ml[157,3374+10]..[157,3374+50])
                    Pcl_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[157,3374+10]..[157,3374+18])
                      Ppat_construct "Just" (testsuite/tests/typing-gadts/test.ml[157,3374+11]..[157,3374+15])
                      Some
                        []
                        pattern (testsuite/tests/typing-gadts/test.ml[157,3374+16]..[157,3374+17])
                          Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[157,3374+16]..[157,3374+17])
                    class_expr (testsuite/tests/typing-gadts/test.ml[157,3374+21]..[157,3374+50])
                      Pcl_structure
                      class_structure
                        pattern (testsuite/tests/typing-gadts/test.ml[157,3374+27]..[157,3374+27]) ghost
                          Ppat_any
                        [
                          class_field (testsuite/tests/typing-gadts/test.ml[157,3374+28]..[157,3374+46])
                            Pcf_method Public
                              "x" (testsuite/tests/typing-gadts/test.ml[157,3374+35]..[157,3374+36])
                              Concrete Fresh
                              expression (testsuite/tests/typing-gadts/test.ml[157,3374+39]..[157,3374+46]) ghost
                                Pexp_poly
                                expression (testsuite/tests/typing-gadts/test.ml[157,3374+45]..[157,3374+46])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[157,3374+45]..[157,3374+46])
                                Some
                                  core_type (testsuite/tests/typing-gadts/test.ml[157,3374+39]..[157,3374+42])
                                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[157,3374+39]..[157,3374+42])
                                    []
                        ]
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[159,3431+0]..[178,4089+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[159,3431+9]..[178,4089+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[159,3431+9]..[178,4089+2])
          Pexp_constant PConst_string ("\nLine 2, characters 10-18:\n2 |   class c (Some x) = object method x : int = x end\n              ^^^^^^^^\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\nNone\nLine 4, characters 10-18:\n4 |   class d (Just x) = object method x : int = x end\n              ^^^^^^^^\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\nNothing\nmodule PR6862 :\n  sig\n    class c : int option -> object method x : int end\n    type _ opt = Just : 'a -> 'a opt | Nothing : 'a opt\n    class d : int opt -> object method x : int end\n  end\n",(testsuite/tests/typing-gadts/test.ml[159,3431+11]..[178,4089+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[180,4096+0]..[183,4203+3])
    Pstr_module
    "Exhaustive2" (testsuite/tests/typing-gadts/test.ml[180,4096+7]..[180,4096+18])
      module_expr (testsuite/tests/typing-gadts/test.ml[180,4096+21]..[183,4203+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[181,4124+2]..[181,4124+24])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[181,4124+9]..[181,4124+10]) (testsuite/tests/typing-gadts/test.ml[181,4124+2]..[181,4124+24])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[181,4124+7]..[181,4124+8])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[181,4124+13]..[181,4124+24])
                        "Int" (testsuite/tests/typing-gadts/test.ml[181,4124+13]..[181,4124+16])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[181,4124+19]..[181,4124+24])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[181,4124+23]..[181,4124+24])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[181,4124+19]..[181,4124+22])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[181,4124+19]..[181,4124+22])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[182,4149+2]..[182,4149+53])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[182,4149+6]..[182,4149+7])
                  Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[182,4149+6]..[182,4149+7])
                expression (testsuite/tests/typing-gadts/test.ml[182,4149+8]..[182,4149+53]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[182,4149+8]..[182,4149+27])
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/test.ml[182,4149+9]..[182,4149+10])
                      Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[182,4149+9]..[182,4149+10])
                    core_type (testsuite/tests/typing-gadts/test.ml[182,4149+13]..[182,4149+26])
                      Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[182,4149+20]..[182,4149+26])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[182,4149+13]..[182,4149+19])
                          Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[182,4149+18]..[182,4149+19])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[182,4149+13]..[182,4149+17])
                              Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[182,4149+13]..[182,4149+17])
                              []
                          ]
                      ]
                  expression (testsuite/tests/typing-gadts/test.ml[182,4149+30]..[182,4149+53])
                    Pexp_match
                    expression (testsuite/tests/typing-gadts/test.ml[182,4149+36]..[182,4149+37])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[182,4149+36]..[182,4149+37])
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[182,4149+43]..[182,4149+47])
                          Ppat_construct "None" (testsuite/tests/typing-gadts/test.ml[182,4149+43]..[182,4149+47])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[182,4149+51]..[182,4149+53])
                          Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[182,4149+51]..[182,4149+53])
                          None
                    ]
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[184,4209+0]..[187,4305+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[184,4209+9]..[187,4305+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[184,4209+9]..[187,4305+2])
          Pexp_constant PConst_string ("\nmodule Exhaustive2 :\n  sig type _ t = Int : int t val f : bool t option -> unit end\n",(testsuite/tests/typing-gadts/test.ml[184,4209+11]..[187,4305+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[189,4312+0]..[193,4475+3])
    Pstr_module
    "PR6220" (testsuite/tests/typing-gadts/test.ml[189,4312+7]..[189,4312+13])
      module_expr (testsuite/tests/typing-gadts/test.ml[189,4312+16]..[193,4475+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[190,4335+2]..[190,4335+37])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[190,4335+10]..[190,4335+11]) (testsuite/tests/typing-gadts/test.ml[190,4335+2]..[190,4335+37])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[190,4335+7]..[190,4335+9])
                      Ptyp_var a
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[190,4335+14]..[190,4335+23])
                        "I" (testsuite/tests/typing-gadts/test.ml[190,4335+14]..[190,4335+15])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[190,4335+18]..[190,4335+23])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[190,4335+22]..[190,4335+23])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[190,4335+18]..[190,4335+21])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[190,4335+18]..[190,4335+21])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[190,4335+24]..[190,4335+37])
                        "F" (testsuite/tests/typing-gadts/test.ml[190,4335+26]..[190,4335+27])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[190,4335+30]..[190,4335+37])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[190,4335+36]..[190,4335+37])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[190,4335+30]..[190,4335+35])
                                Ptyp_constr "float" (testsuite/tests/typing-gadts/test.ml[190,4335+30]..[190,4335+35])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[191,4373+2]..[191,4373+40])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[191,4373+6]..[191,4373+22]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[191,4373+6]..[191,4373+7])
                    Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[191,4373+6]..[191,4373+7])
                  core_type (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+22]) ghost
                    Ptyp_poly
                    core_type (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+22])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+15])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[191,4373+14]..[191,4373+15])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+13])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+13])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[191,4373+19]..[191,4373+22])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[191,4373+19]..[191,4373+22])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[191,4373+6]..[191,4373+40])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/test.ml[191,4373+25]..[191,4373+40])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[191,4373+34]..[191,4373+35])
                          Ppat_construct "I" (testsuite/tests/typing-gadts/test.ml[191,4373+34]..[191,4373+35])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[191,4373+39]..[191,4373+40])
                          Pexp_constant PConst_int (1,None)
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+22])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+15])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[191,4373+14]..[191,4373+15])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+13])
                          Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[191,4373+10]..[191,4373+13])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[191,4373+19]..[191,4373+22])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[191,4373+19]..[191,4373+22])
                      []
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[192,4414+2]..[192,4414+49])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[192,4414+6]..[192,4414+22]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[192,4414+6]..[192,4414+7])
                    Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[192,4414+6]..[192,4414+7])
                  core_type (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+22]) ghost
                    Ptyp_poly
                    core_type (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+22])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+15])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[192,4414+14]..[192,4414+15])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+13])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+13])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[192,4414+19]..[192,4414+22])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[192,4414+19]..[192,4414+22])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[192,4414+6]..[192,4414+49])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/test.ml[192,4414+25]..[192,4414+49])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[192,4414+34]..[192,4414+35])
                          Ppat_construct "I" (testsuite/tests/typing-gadts/test.ml[192,4414+34]..[192,4414+35])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[192,4414+39]..[192,4414+40])
                          Pexp_constant PConst_int (1,None)
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[192,4414+43]..[192,4414+44])
                          Ppat_any
                        expression (testsuite/tests/typing-gadts/test.ml[192,4414+48]..[192,4414+49])
                          Pexp_constant PConst_int (2,None)
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+22])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+15])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[192,4414+14]..[192,4414+15])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+13])
                          Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[192,4414+10]..[192,4414+13])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[192,4414+19]..[192,4414+22])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[192,4414+19]..[192,4414+22])
                      []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[194,4481+0]..[206,4872+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[194,4481+9]..[206,4872+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[194,4481+9]..[206,4872+2])
          Pexp_constant PConst_string ("\nLine 4, characters 43-44:\n4 |   let g : int t -> int = function I -> 1 | _ -> 2 (* warn *)\n                                               ^\nWarning 56 [unreachable-case]: this match case is unreachable.\nConsider replacing it with a refutation case '<pat> -> .'\nmodule PR6220 :\n  sig\n    type 'a t = I : int t | F : float t\n    val f : int t -> int\n    val g : int t -> int\n  end\n",(testsuite/tests/typing-gadts/test.ml[194,4481+11]..[206,4872+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[208,4879+0]..[215,5116+3])
    Pstr_module
    "PR6403" (testsuite/tests/typing-gadts/test.ml[208,4879+7]..[208,4879+13])
      module_expr (testsuite/tests/typing-gadts/test.ml[208,4879+16]..[215,5116+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[209,4902+2]..[209,4902+37])
            Pstr_type Rec
            [
              type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[209,4902+14]..[209,4902+16]) (testsuite/tests/typing-gadts/test.ml[209,4902+2]..[209,4902+37])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[209,4902+8]..[209,4902+9])
                      Ptyp_any
                    core_type (testsuite/tests/typing-gadts/test.ml[209,4902+11]..[209,4902+12])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[209,4902+19]..[209,4902+37])
                        "Refl" (testsuite/tests/typing-gadts/test.ml[209,4902+19]..[209,4902+23])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[209,4902+26]..[209,4902+37])
                            Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[209,4902+35]..[209,4902+37])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[209,4902+27]..[209,4902+29])
                                Ptyp_var a
                              core_type (testsuite/tests/typing-gadts/test.ml[209,4902+31]..[209,4902+33])
                                Ptyp_var a
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[210,4940+2]..[210,4940+35])
            Pstr_type Rec
            [
              type_declaration "empty" (testsuite/tests/typing-gadts/test.ml[210,4940+7]..[210,4940+12]) (testsuite/tests/typing-gadts/test.ml[210,4940+2]..[210,4940+35])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_record
                    [
                      (testsuite/tests/typing-gadts/test.ml[210,4940+17]..[210,4940+33])
                        Immutable
                        "bottom" (testsuite/tests/typing-gadts/test.ml[210,4940+17]..[210,4940+23])                        core_type (testsuite/tests/typing-gadts/test.ml[210,4940+26]..[210,4940+33])
                          Ptyp_poly 'a
                          core_type (testsuite/tests/typing-gadts/test.ml[210,4940+31]..[210,4940+33])
                            Ptyp_var a
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[211,4976+2]..[211,4976+46])
            Pstr_type Rec
            [
              type_declaration "sum" (testsuite/tests/typing-gadts/test.ml[211,4976+16]..[211,4976+19]) (testsuite/tests/typing-gadts/test.ml[211,4976+2]..[211,4976+46])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[211,4976+8]..[211,4976+10])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/test.ml[211,4976+12]..[211,4976+14])
                      Ptyp_var b
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[211,4976+22]..[211,4976+32])
                        "Left" (testsuite/tests/typing-gadts/test.ml[211,4976+22]..[211,4976+26])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[211,4976+30]..[211,4976+32])
                            Ptyp_var a
                        ]
                        None
                      (testsuite/tests/typing-gadts/test.ml[211,4976+33]..[211,4976+46])
                        "Right" (testsuite/tests/typing-gadts/test.ml[211,4976+35]..[211,4976+40])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[211,4976+44]..[211,4976+46])
                            Ptyp_var b
                        ]
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[213,5024+2]..[214,5089+26])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[213,5024+6]..[213,5024+53]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[213,5024+6]..[213,5024+14])
                    Ppat_var "notequal" (testsuite/tests/typing-gadts/test.ml[213,5024+6]..[213,5024+14])
                  core_type (testsuite/tests/typing-gadts/test.ml[213,5024+17]..[213,5024+53]) ghost
                    Ptyp_poly
                    core_type (testsuite/tests/typing-gadts/test.ml[213,5024+17]..[213,5024+53])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[213,5024+17]..[213,5024+44])
                        Ptyp_constr "sum" (testsuite/tests/typing-gadts/test.ml[213,5024+41]..[213,5024+44])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[213,5024+18]..[213,5024+32])
                            Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[213,5024+30]..[213,5024+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[213,5024+19]..[213,5024+22])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[213,5024+19]..[213,5024+22])
                                []
                              core_type (testsuite/tests/typing-gadts/test.ml[213,5024+24]..[213,5024+28])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[213,5024+24]..[213,5024+28])
                                []
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[213,5024+34]..[213,5024+39])
                            Ptyp_constr "empty" (testsuite/tests/typing-gadts/test.ml[213,5024+34]..[213,5024+39])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[213,5024+48]..[213,5024+53])
                        Ptyp_constr "empty" (testsuite/tests/typing-gadts/test.ml[213,5024+48]..[213,5024+53])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[213,5024+6]..[214,5089+26])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/test.ml[213,5024+56]..[214,5089+26])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[214,5089+6]..[214,5089+17])
                          Ppat_construct "Right" (testsuite/tests/typing-gadts/test.ml[214,5089+6]..[214,5089+11])
                          Some
                            []
                            pattern (testsuite/tests/typing-gadts/test.ml[214,5089+12]..[214,5089+17])
                              Ppat_var "empty" (testsuite/tests/typing-gadts/test.ml[214,5089+12]..[214,5089+17])
                        expression (testsuite/tests/typing-gadts/test.ml[214,5089+21]..[214,5089+26])
                          Pexp_ident "empty" (testsuite/tests/typing-gadts/test.ml[214,5089+21]..[214,5089+26])
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[213,5024+17]..[213,5024+53])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[213,5024+17]..[213,5024+44])
                      Ptyp_constr "sum" (testsuite/tests/typing-gadts/test.ml[213,5024+41]..[213,5024+44])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[213,5024+18]..[213,5024+32])
                          Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[213,5024+30]..[213,5024+32])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[213,5024+19]..[213,5024+22])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[213,5024+19]..[213,5024+22])
                              []
                            core_type (testsuite/tests/typing-gadts/test.ml[213,5024+24]..[213,5024+28])
                              Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[213,5024+24]..[213,5024+28])
                              []
                          ]
                        core_type (testsuite/tests/typing-gadts/test.ml[213,5024+34]..[213,5024+39])
                          Ptyp_constr "empty" (testsuite/tests/typing-gadts/test.ml[213,5024+34]..[213,5024+39])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[213,5024+48]..[213,5024+53])
                      Ptyp_constr "empty" (testsuite/tests/typing-gadts/test.ml[213,5024+48]..[213,5024+53])
                      []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[216,5122+0]..[224,5345+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[216,5122+9]..[224,5345+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[216,5122+9]..[224,5345+2])
          Pexp_constant PConst_string ("\nmodule PR6403 :\n  sig\n    type (_, _) eq = Refl : ('a, 'a) eq\n    type empty = { bottom : 'a. 'a; }\n    type ('a, 'b) sum = Left of 'a | Right of 'b\n    val notequal : ((int, bool) eq, empty) sum -> empty\n  end\n",(testsuite/tests/typing-gadts/test.ml[216,5122+11]..[224,5345+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[226,5352+0]..[240,5761+3])
    Pstr_module
    "PR6437" (testsuite/tests/typing-gadts/test.ml[226,5352+7]..[226,5352+13])
      module_expr (testsuite/tests/typing-gadts/test.ml[226,5352+16]..[240,5761+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[227,5375+2]..[229,5426+55])
            Pstr_type Rec
            [
              type_declaration "ctx" (testsuite/tests/typing-gadts/test.ml[227,5375+16]..[227,5375+19]) (testsuite/tests/typing-gadts/test.ml[227,5375+2]..[229,5426+55])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[227,5375+8]..[227,5375+10])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/test.ml[227,5375+12]..[227,5375+14])
                      Ptyp_var b
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[228,5397+4]..[228,5397+28])
                        "Nil" (testsuite/tests/typing-gadts/test.ml[228,5397+6]..[228,5397+9])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[228,5397+12]..[228,5397+28])
                            Ptyp_constr "ctx" (testsuite/tests/typing-gadts/test.ml[228,5397+25]..[228,5397+28])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[228,5397+13]..[228,5397+17])
                                Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[228,5397+13]..[228,5397+17])
                                []
                              core_type (testsuite/tests/typing-gadts/test.ml[228,5397+19]..[228,5397+23])
                                Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[228,5397+19]..[228,5397+23])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[229,5426+4]..[229,5426+55])
                        "Cons" (testsuite/tests/typing-gadts/test.ml[229,5426+6]..[229,5426+10])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[229,5426+13]..[229,5426+25])
                            Ptyp_constr "ctx" (testsuite/tests/typing-gadts/test.ml[229,5426+22]..[229,5426+25])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[229,5426+14]..[229,5426+16])
                                Ptyp_var a
                              core_type (testsuite/tests/typing-gadts/test.ml[229,5426+18]..[229,5426+20])
                                Ptyp_var b
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[229,5426+29]..[229,5426+55])
                            Ptyp_constr "ctx" (testsuite/tests/typing-gadts/test.ml[229,5426+52]..[229,5426+55])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[229,5426+30]..[229,5426+39])
                                Ptyp_tuple
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[229,5426+30]..[229,5426+32])
                                    Ptyp_var a
                                  core_type (testsuite/tests/typing-gadts/test.ml[229,5426+35]..[229,5426+39])
                                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[229,5426+35]..[229,5426+39])
                                    []
                                ]
                              core_type (testsuite/tests/typing-gadts/test.ml[229,5426+41]..[229,5426+50])
                                Ptyp_tuple
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[229,5426+41]..[229,5426+43])
                                    Ptyp_var b
                                  core_type (testsuite/tests/typing-gadts/test.ml[229,5426+46]..[229,5426+50])
                                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[229,5426+46]..[229,5426+50])
                                    []
                                ]
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[231,5483+2]..[233,5525+35])
            Pstr_type Rec
            [
              type_declaration "var" (testsuite/tests/typing-gadts/test.ml[231,5483+10]..[231,5483+13]) (testsuite/tests/typing-gadts/test.ml[231,5483+2]..[233,5525+35])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[231,5483+7]..[231,5483+9])
                      Ptyp_var a
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[232,5499+4]..[232,5499+25])
                        "O" (testsuite/tests/typing-gadts/test.ml[232,5499+6]..[232,5499+7])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[232,5499+10]..[232,5499+25])
                            Ptyp_constr "var" (testsuite/tests/typing-gadts/test.ml[232,5499+22]..[232,5499+25])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[232,5499+11]..[232,5499+20])
                                Ptyp_tuple
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[232,5499+11]..[232,5499+13])
                                    Ptyp_var a
                                  core_type (testsuite/tests/typing-gadts/test.ml[232,5499+16]..[232,5499+20])
                                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[232,5499+16]..[232,5499+20])
                                    []
                                ]
                            ]
                      (testsuite/tests/typing-gadts/test.ml[233,5525+4]..[233,5525+35])
                        "S" (testsuite/tests/typing-gadts/test.ml[233,5525+6]..[233,5525+7])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[233,5525+10]..[233,5525+16])
                            Ptyp_constr "var" (testsuite/tests/typing-gadts/test.ml[233,5525+13]..[233,5525+16])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[233,5525+10]..[233,5525+12])
                                Ptyp_var a
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[233,5525+20]..[233,5525+35])
                            Ptyp_constr "var" (testsuite/tests/typing-gadts/test.ml[233,5525+32]..[233,5525+35])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[233,5525+21]..[233,5525+30])
                                Ptyp_tuple
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[233,5525+21]..[233,5525+23])
                                    Ptyp_var a
                                  core_type (testsuite/tests/typing-gadts/test.ml[233,5525+26]..[233,5525+30])
                                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[233,5525+26]..[233,5525+30])
                                    []
                                ]
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[235,5562+2]..[238,5686+12])
            Pstr_value Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[235,5562+10]..[235,5562+57]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[235,5562+10]..[235,5562+11])
                    Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[235,5562+10]..[235,5562+11])
                  core_type (testsuite/tests/typing-gadts/test.ml[235,5562+10]..[238,5686+12]) ghost
                    Ptyp_poly 'g1 'g2
                    core_type (testsuite/tests/typing-gadts/test.ml[235,5562+26]..[235,5562+57])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[235,5562+26]..[235,5562+47])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[235,5562+26]..[235,5562+38])
                            Ptyp_constr "ctx" (testsuite/tests/typing-gadts/test.ml[235,5562+35]..[235,5562+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[235,5562+27]..[235,5562+29])
                                Ptyp_var g1
                              core_type (testsuite/tests/typing-gadts/test.ml[235,5562+31]..[235,5562+33])
                                Ptyp_var g2
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[235,5562+41]..[235,5562+47])
                            Ptyp_constr "var" (testsuite/tests/typing-gadts/test.ml[235,5562+44]..[235,5562+47])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[235,5562+41]..[235,5562+43])
                                Ptyp_var g1
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[235,5562+51]..[235,5562+57])
                        Ptyp_constr "var" (testsuite/tests/typing-gadts/test.ml[235,5562+54]..[235,5562+57])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[235,5562+51]..[235,5562+53])
                            Ptyp_var g2
                        ]
                expression (testsuite/tests/typing-gadts/test.ml[235,5562+10]..[238,5686+12])
                  Pexp_newtype "g1"
                  expression (testsuite/tests/typing-gadts/test.ml[235,5562+10]..[238,5686+12])
                    Pexp_newtype "g2"
                    expression (testsuite/tests/typing-gadts/test.ml[235,5562+10]..[238,5686+12])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/test.ml[235,5562+60]..[238,5686+12])
                        Pexp_function
                        [
                          <case>
                            pattern (testsuite/tests/typing-gadts/test.ml[236,5631+6]..[236,5631+15])
                              Ppat_tuple
                              [
                                pattern (testsuite/tests/typing-gadts/test.ml[236,5631+6]..[236,5631+12])
                                  Ppat_construct "Cons" (testsuite/tests/typing-gadts/test.ml[236,5631+6]..[236,5631+10])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/test.ml[236,5631+11]..[236,5631+12])
                                      Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[236,5631+11]..[236,5631+12])
                                pattern (testsuite/tests/typing-gadts/test.ml[236,5631+14]..[236,5631+15])
                                  Ppat_construct "O" (testsuite/tests/typing-gadts/test.ml[236,5631+14]..[236,5631+15])
                                  None
                              ]
                            expression (testsuite/tests/typing-gadts/test.ml[236,5631+19]..[236,5631+20])
                              Pexp_construct "O" (testsuite/tests/typing-gadts/test.ml[236,5631+19]..[236,5631+20])
                              None
                          <case>
                            pattern (testsuite/tests/typing-gadts/test.ml[237,5652+6]..[237,5652+17])
                              Ppat_tuple
                              [
                                pattern (testsuite/tests/typing-gadts/test.ml[237,5652+6]..[237,5652+12])
                                  Ppat_construct "Cons" (testsuite/tests/typing-gadts/test.ml[237,5652+6]..[237,5652+10])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/test.ml[237,5652+11]..[237,5652+12])
                                      Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[237,5652+11]..[237,5652+12])
                                pattern (testsuite/tests/typing-gadts/test.ml[237,5652+14]..[237,5652+17])
                                  Ppat_construct "S" (testsuite/tests/typing-gadts/test.ml[237,5652+14]..[237,5652+15])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/test.ml[237,5652+16]..[237,5652+17])
                                      Ppat_var "n" (testsuite/tests/typing-gadts/test.ml[237,5652+16]..[237,5652+17])
                              ]
                            expression (testsuite/tests/typing-gadts/test.ml[237,5652+21]..[237,5652+33])
                              Pexp_construct "S" (testsuite/tests/typing-gadts/test.ml[237,5652+21]..[237,5652+22])
                              Some
                                expression (testsuite/tests/typing-gadts/test.ml[237,5652+23]..[237,5652+33])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/test.ml[237,5652+24]..[237,5652+25])
                                    Pexp_ident "f" (testsuite/tests/typing-gadts/test.ml[237,5652+24]..[237,5652+25])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/test.ml[237,5652+26]..[237,5652+32])
                                        Pexp_tuple
                                        [
                                          expression (testsuite/tests/typing-gadts/test.ml[237,5652+27]..[237,5652+28])
                                            Pexp_ident "g" (testsuite/tests/typing-gadts/test.ml[237,5652+27]..[237,5652+28])
                                          expression (testsuite/tests/typing-gadts/test.ml[237,5652+30]..[237,5652+31])
                                            Pexp_ident "n" (testsuite/tests/typing-gadts/test.ml[237,5652+30]..[237,5652+31])
                                        ]
                                  ]
                          <case>
                            pattern (testsuite/tests/typing-gadts/test.ml[238,5686+6]..[238,5686+7])
                              Ppat_any
                            expression (testsuite/tests/typing-gadts/test.ml[238,5686+11]..[238,5686+12])
                              Pexp_unreachable                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[235,5562+26]..[235,5562+57])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/test.ml[235,5562+26]..[235,5562+47])
                          Ptyp_tuple
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[235,5562+26]..[235,5562+38])
                              Ptyp_constr "ctx" (testsuite/tests/typing-gadts/test.ml[235,5562+35]..[235,5562+38])
                              [
                                core_type (testsuite/tests/typing-gadts/test.ml[235,5562+27]..[235,5562+29])
                                  Ptyp_constr "g1" (testsuite/tests/typing-gadts/test.ml[235,5562+27]..[235,5562+29])
                                  []
                                core_type (testsuite/tests/typing-gadts/test.ml[235,5562+31]..[235,5562+33])
                                  Ptyp_constr "g2" (testsuite/tests/typing-gadts/test.ml[235,5562+31]..[235,5562+33])
                                  []
                              ]
                            core_type (testsuite/tests/typing-gadts/test.ml[235,5562+41]..[235,5562+47])
                              Ptyp_constr "var" (testsuite/tests/typing-gadts/test.ml[235,5562+44]..[235,5562+47])
                              [
                                core_type (testsuite/tests/typing-gadts/test.ml[235,5562+41]..[235,5562+43])
                                  Ptyp_constr "g1" (testsuite/tests/typing-gadts/test.ml[235,5562+41]..[235,5562+43])
                                  []
                              ]
                          ]
                        core_type (testsuite/tests/typing-gadts/test.ml[235,5562+51]..[235,5562+57])
                          Ptyp_constr "var" (testsuite/tests/typing-gadts/test.ml[235,5562+54]..[235,5562+57])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[235,5562+51]..[235,5562+53])
                              Ptyp_constr "g2" (testsuite/tests/typing-gadts/test.ml[235,5562+51]..[235,5562+53])
                              []
                          ]
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[241,5767+0]..[250,6038+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[241,5767+9]..[250,6038+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[241,5767+9]..[250,6038+2])
          Pexp_constant PConst_string ("\nmodule PR6437 :\n  sig\n    type ('a, 'b) ctx =\n        Nil : (unit, unit) ctx\n      | Cons : ('a, 'b) ctx -> ('a * unit, 'b * unit) ctx\n    type 'a var = O : ('a * unit) var | S : 'a var -> ('a * unit) var\n    val f : ('g1, 'g2) ctx * 'g1 var -> 'g2 var\n  end\n",(testsuite/tests/typing-gadts/test.ml[241,5767+11]..[250,6038+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[252,6045+0]..[261,6283+3])
    Pstr_module
    "PR6801" (testsuite/tests/typing-gadts/test.ml[252,6045+7]..[252,6045+13])
      module_expr (testsuite/tests/typing-gadts/test.ml[252,6045+16]..[261,6283+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[253,6068+2]..[256,6158+9])
            Pstr_type Rec
            [
              type_declaration "value" (testsuite/tests/typing-gadts/test.ml[253,6068+9]..[253,6068+14]) (testsuite/tests/typing-gadts/test.ml[253,6068+2]..[256,6158+9])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[253,6068+7]..[253,6068+8])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[254,6085+4]..[254,6085+37])
                        "String" (testsuite/tests/typing-gadts/test.ml[254,6085+6]..[254,6085+12])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[254,6085+15]..[254,6085+21])
                            Ptyp_constr "string" (testsuite/tests/typing-gadts/test.ml[254,6085+15]..[254,6085+21])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[254,6085+25]..[254,6085+37])
                            Ptyp_constr "value" (testsuite/tests/typing-gadts/test.ml[254,6085+32]..[254,6085+37])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[254,6085+25]..[254,6085+31])
                                Ptyp_constr "string" (testsuite/tests/typing-gadts/test.ml[254,6085+25]..[254,6085+31])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[255,6123+4]..[255,6123+34])
                        "Float" (testsuite/tests/typing-gadts/test.ml[255,6123+6]..[255,6123+11])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[255,6123+14]..[255,6123+19])
                            Ptyp_constr "float" (testsuite/tests/typing-gadts/test.ml[255,6123+14]..[255,6123+19])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[255,6123+23]..[255,6123+34])
                            Ptyp_constr "value" (testsuite/tests/typing-gadts/test.ml[255,6123+29]..[255,6123+34])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[255,6123+23]..[255,6123+28])
                                Ptyp_constr "float" (testsuite/tests/typing-gadts/test.ml[255,6123+23]..[255,6123+28])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[256,6158+4]..[256,6158+9])
                        "Any" (testsuite/tests/typing-gadts/test.ml[256,6158+6]..[256,6158+9])
                        []
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[258,6169+2]..[260,6232+33])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[258,6169+6]..[258,6169+24])
                  Ppat_var "print_string_value" (testsuite/tests/typing-gadts/test.ml[258,6169+6]..[258,6169+24])
                expression (testsuite/tests/typing-gadts/test.ml[258,6169+25]..[260,6232+33]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[258,6169+25]..[258,6169+43])
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/test.ml[258,6169+26]..[258,6169+27])
                      Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[258,6169+26]..[258,6169+27])
                    core_type (testsuite/tests/typing-gadts/test.ml[258,6169+30]..[258,6169+42])
                      Ptyp_constr "value" (testsuite/tests/typing-gadts/test.ml[258,6169+37]..[258,6169+42])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[258,6169+30]..[258,6169+36])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/test.ml[258,6169+30]..[258,6169+36])
                          []
                      ]
                  expression (testsuite/tests/typing-gadts/test.ml[259,6215+4]..[260,6232+33])
                    Pexp_match
                    expression (testsuite/tests/typing-gadts/test.ml[259,6215+10]..[259,6215+11])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[259,6215+10]..[259,6215+11])
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[260,6232+6]..[260,6232+14])
                          Ppat_construct "String" (testsuite/tests/typing-gadts/test.ml[260,6232+6]..[260,6232+12])
                          Some
                            []
                            pattern (testsuite/tests/typing-gadts/test.ml[260,6232+13]..[260,6232+14])
                              Ppat_var "s" (testsuite/tests/typing-gadts/test.ml[260,6232+13]..[260,6232+14])
                        expression (testsuite/tests/typing-gadts/test.ml[260,6232+18]..[260,6232+33])
                          Pexp_apply
                          expression (testsuite/tests/typing-gadts/test.ml[260,6232+18]..[260,6232+31])
                            Pexp_ident "print_endline" (testsuite/tests/typing-gadts/test.ml[260,6232+18]..[260,6232+31])
                          [
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[260,6232+32]..[260,6232+33])
                                Pexp_ident "s" (testsuite/tests/typing-gadts/test.ml[260,6232+32]..[260,6232+33])
                          ]
                    ]
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[262,6289+0]..[277,6713+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[262,6289+9]..[277,6713+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[262,6289+9]..[277,6713+2])
          Pexp_constant PConst_string ("\nLines 8-9, characters 4-33:\n8 | ....match x with\n9 |     | String s -> print_endline s.................\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\nAny\nmodule PR6801 :\n  sig\n    type _ value =\n        String : string -> string value\n      | Float : float -> float value\n      | Any\n    val print_string_value : string value -> unit\n  end\n",(testsuite/tests/typing-gadts/test.ml[262,6289+11]..[277,6713+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[279,6720+0]..[284,6839+5])
    Pstr_module
    "Existential_escape" (testsuite/tests/typing-gadts/test.ml[279,6720+7]..[279,6720+25])
      module_expr (testsuite/tests/typing-gadts/test.ml[280,6748+2]..[284,6839+5])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[281,6757+4]..[281,6757+31])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[281,6757+11]..[281,6757+12]) (testsuite/tests/typing-gadts/test.ml[281,6757+4]..[281,6757+31])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[281,6757+9]..[281,6757+10])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[281,6757+15]..[281,6757+31])
                        "C" (testsuite/tests/typing-gadts/test.ml[281,6757+15]..[281,6757+16])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[281,6757+19]..[281,6757+22])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[281,6757+19]..[281,6757+22])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[281,6757+26]..[281,6757+31])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[281,6757+30]..[281,6757+31])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[281,6757+26]..[281,6757+29])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[281,6757+26]..[281,6757+29])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[282,6789+4]..[282,6789+26])
            Pstr_type Rec
            [
              type_declaration "u" (testsuite/tests/typing-gadts/test.ml[282,6789+9]..[282,6789+10]) (testsuite/tests/typing-gadts/test.ml[282,6789+4]..[282,6789+26])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[282,6789+13]..[282,6789+26])
                        "D" (testsuite/tests/typing-gadts/test.ml[282,6789+13]..[282,6789+14])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[282,6789+17]..[282,6789+21])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[282,6789+20]..[282,6789+21])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[282,6789+17]..[282,6789+19])
                                Ptyp_var a
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[282,6789+25]..[282,6789+26])
                            Ptyp_constr "u" (testsuite/tests/typing-gadts/test.ml[282,6789+25]..[282,6789+26])
                            []
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[283,6816+4]..[283,6816+22])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[283,6816+8]..[283,6816+12])
                  Ppat_var "eval" (testsuite/tests/typing-gadts/test.ml[283,6816+8]..[283,6816+12])
                expression (testsuite/tests/typing-gadts/test.ml[283,6816+13]..[283,6816+22]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[283,6816+13]..[283,6816+18])
                    Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[283,6816+14]..[283,6816+15])
                    Some
                      []
                      pattern (testsuite/tests/typing-gadts/test.ml[283,6816+16]..[283,6816+17])
                        Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[283,6816+16]..[283,6816+17])
                  expression (testsuite/tests/typing-gadts/test.ml[283,6816+21]..[283,6816+22])
                    Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[283,6816+21]..[283,6816+22])
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[286,6848+0]..[293,7086+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[286,6848+9]..[293,7086+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[286,6848+9]..[293,7086+2])
          Pexp_constant PConst_string ("\nLine 5, characters 21-22:\n5 |     let eval (D x) = x\n                         ^\nError: This expression has type $D_'a t\n       but an expression was expected of type 'a\n       The type constructor $D_'a would escape its scope\n",(testsuite/tests/typing-gadts/test.ml[286,6848+11]..[293,7086+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[295,7093+0]..[300,7231+5])
    Pstr_module
    "Rectype" (testsuite/tests/typing-gadts/test.ml[295,7093+7]..[295,7093+14])
      module_expr (testsuite/tests/typing-gadts/test.ml[296,7110+2]..[300,7231+5])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[297,7119+4]..[297,7119+32])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[297,7119+15]..[297,7119+16]) (testsuite/tests/typing-gadts/test.ml[297,7119+4]..[297,7119+32])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[297,7119+10]..[297,7119+11])
                      Ptyp_any
                    core_type (testsuite/tests/typing-gadts/test.ml[297,7119+12]..[297,7119+13])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[297,7119+19]..[297,7119+32])
                        "C" (testsuite/tests/typing-gadts/test.ml[297,7119+19]..[297,7119+20])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[297,7119+23]..[297,7119+32])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[297,7119+31]..[297,7119+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[297,7119+24]..[297,7119+26])
                                Ptyp_var a
                              core_type (testsuite/tests/typing-gadts/test.ml[297,7119+27]..[297,7119+29])
                                Ptyp_var a
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[298,7152+4]..[299,7193+17])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[298,7152+8]..[298,7152+38]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[298,7152+8]..[298,7152+9])
                    Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[298,7152+8]..[298,7152+9])
                  core_type (testsuite/tests/typing-gadts/test.ml[298,7152+8]..[299,7193+17]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[298,7152+20]..[298,7152+38])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[298,7152+20]..[298,7152+30])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[298,7152+29]..[298,7152+30])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[298,7152+21]..[298,7152+22])
                            Ptyp_var s
                          core_type (testsuite/tests/typing-gadts/test.ml[298,7152+24]..[298,7152+27])
                            Ptyp_tuple
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[298,7152+24]..[298,7152+25])
                                Ptyp_var s
                              core_type (testsuite/tests/typing-gadts/test.ml[298,7152+26]..[298,7152+27])
                                Ptyp_var s
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[298,7152+34]..[298,7152+38])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[298,7152+34]..[298,7152+38])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[298,7152+8]..[299,7193+17])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[298,7152+8]..[299,7193+17])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[299,7193+6]..[299,7193+17])
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[299,7193+10]..[299,7193+11])
                        Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[299,7193+10]..[299,7193+11])
                        None
                      expression (testsuite/tests/typing-gadts/test.ml[299,7193+15]..[299,7193+17])
                        Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[299,7193+15]..[299,7193+17])
                        None
                    core_type (testsuite/tests/typing-gadts/test.ml[298,7152+20]..[298,7152+38])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[298,7152+20]..[298,7152+30])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[298,7152+29]..[298,7152+30])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[298,7152+21]..[298,7152+22])
                            Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[298,7152+21]..[298,7152+22])
                            []
                          core_type (testsuite/tests/typing-gadts/test.ml[298,7152+24]..[298,7152+27])
                            Ptyp_tuple
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[298,7152+24]..[298,7152+25])
                                Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[298,7152+24]..[298,7152+25])
                                []
                              core_type (testsuite/tests/typing-gadts/test.ml[298,7152+26]..[298,7152+27])
                                Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[298,7152+26]..[298,7152+27])
                                []
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[298,7152+34]..[298,7152+38])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[298,7152+34]..[298,7152+38])
                        []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[302,7240+0]..[305,7342+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[302,7240+9]..[305,7342+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[302,7240+9]..[305,7342+2])
          Pexp_constant PConst_string ("\nmodule Rectype :\n  sig type (_, _) t = C : ('a, 'a) t val f : ('s, 's * 's) t -> unit end\n",(testsuite/tests/typing-gadts/test.ml[302,7240+11]..[305,7342+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[307,7349+0]..[317,7557+3])
    Pstr_module
    "Or_patterns" (testsuite/tests/typing-gadts/test.ml[307,7349+7]..[307,7349+18])
      module_expr (testsuite/tests/typing-gadts/test.ml[308,7370+2]..[317,7557+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[309,7379+6]..[311,7426+32])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[309,7379+13]..[309,7379+14]) (testsuite/tests/typing-gadts/test.ml[309,7379+6]..[311,7426+32])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[309,7379+11]..[309,7379+12])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[310,7396+6]..[310,7396+29])
                        "IntLit" (testsuite/tests/typing-gadts/test.ml[310,7396+8]..[310,7396+14])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[310,7396+17]..[310,7396+20])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[310,7396+17]..[310,7396+20])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[310,7396+24]..[310,7396+29])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[310,7396+28]..[310,7396+29])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[310,7396+24]..[310,7396+27])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[310,7396+24]..[310,7396+27])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[311,7426+6]..[311,7426+32])
                        "BoolLit" (testsuite/tests/typing-gadts/test.ml[311,7426+8]..[311,7426+15])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[311,7426+18]..[311,7426+22])
                            Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[311,7426+18]..[311,7426+22])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[311,7426+26]..[311,7426+32])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[311,7426+31]..[311,7426+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[311,7426+26]..[311,7426+30])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[311,7426+26]..[311,7426+30])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[313,7460+4]..[315,7517+38])
            Pstr_value Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[313,7460+12]..[313,7460+39]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[313,7460+12]..[313,7460+16])
                    Ppat_var "eval" (testsuite/tests/typing-gadts/test.ml[313,7460+12]..[313,7460+16])
                  core_type (testsuite/tests/typing-gadts/test.ml[313,7460+12]..[315,7517+38]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[313,7460+28]..[313,7460+39])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[313,7460+28]..[313,7460+31])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[313,7460+30]..[313,7460+31])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[313,7460+28]..[313,7460+29])
                            Ptyp_var s
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[313,7460+35]..[313,7460+39])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[313,7460+35]..[313,7460+39])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[313,7460+12]..[315,7517+38])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[313,7460+12]..[315,7517+38])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[314,7502+6]..[315,7517+38])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[315,7517+10]..[315,7517+32])
                            Ppat_or
                            pattern (testsuite/tests/typing-gadts/test.ml[315,7517+11]..[315,7517+19])
                              Ppat_construct "IntLit" (testsuite/tests/typing-gadts/test.ml[315,7517+11]..[315,7517+17])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[315,7517+18]..[315,7517+19])
                                  Ppat_any
                            pattern (testsuite/tests/typing-gadts/test.ml[315,7517+22]..[315,7517+31])
                              Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/test.ml[315,7517+22]..[315,7517+29])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[315,7517+30]..[315,7517+31])
                                  Ppat_any
                          expression (testsuite/tests/typing-gadts/test.ml[315,7517+36]..[315,7517+38])
                            Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[315,7517+36]..[315,7517+38])
                            None
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[313,7460+28]..[313,7460+39])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[313,7460+28]..[313,7460+31])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[313,7460+30]..[313,7460+31])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[313,7460+28]..[313,7460+29])
                            Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[313,7460+28]..[313,7460+29])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[313,7460+35]..[313,7460+39])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[313,7460+35]..[313,7460+39])
                        []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[319,7564+0]..[325,7701+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[319,7564+9]..[325,7701+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[319,7564+9]..[325,7701+2])
          Pexp_constant PConst_string ("\nmodule Or_patterns :\n  sig\n    type _ t = IntLit : int -> int t | BoolLit : bool -> bool t\n    val eval : 's t -> unit\n  end\n",(testsuite/tests/typing-gadts/test.ml[319,7564+11]..[325,7701+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[327,7708+0]..[337,7951+5])
    Pstr_module
    "Polymorphic_variants" (testsuite/tests/typing-gadts/test.ml[327,7708+7]..[327,7708+27])
      module_expr (testsuite/tests/typing-gadts/test.ml[328,7738+2]..[337,7951+5])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[329,7747+6]..[331,7794+32])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[329,7747+13]..[329,7747+14]) (testsuite/tests/typing-gadts/test.ml[329,7747+6]..[331,7794+32])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[329,7747+11]..[329,7747+12])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[330,7764+6]..[330,7764+29])
                        "IntLit" (testsuite/tests/typing-gadts/test.ml[330,7764+8]..[330,7764+14])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[330,7764+17]..[330,7764+20])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[330,7764+17]..[330,7764+20])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[330,7764+24]..[330,7764+29])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[330,7764+28]..[330,7764+29])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[330,7764+24]..[330,7764+27])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[330,7764+24]..[330,7764+27])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[331,7794+6]..[331,7794+32])
                        "BoolLit" (testsuite/tests/typing-gadts/test.ml[331,7794+8]..[331,7794+15])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[331,7794+18]..[331,7794+22])
                            Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[331,7794+18]..[331,7794+22])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[331,7794+26]..[331,7794+32])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[331,7794+31]..[331,7794+32])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[331,7794+26]..[331,7794+30])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[331,7794+26]..[331,7794+30])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[333,7828+4]..[336,7921+29])
            Pstr_value Rec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[333,7828+12]..[333,7828+46]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[333,7828+12]..[333,7828+16])
                    Ppat_var "eval" (testsuite/tests/typing-gadts/test.ml[333,7828+12]..[333,7828+16])
                  core_type (testsuite/tests/typing-gadts/test.ml[333,7828+12]..[336,7921+29]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[333,7828+28]..[333,7828+46])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[333,7828+28]..[333,7828+38])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[333,7828+28]..[333,7828+32])
                            Ptyp_variant closed=Closed
                            [
                              Rtag "A" true
                                []
                            ]
                            None
                          core_type (testsuite/tests/typing-gadts/test.ml[333,7828+35]..[333,7828+38])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[333,7828+37]..[333,7828+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[333,7828+35]..[333,7828+36])
                                Ptyp_var s
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[333,7828+42]..[333,7828+46])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[333,7828+42]..[333,7828+46])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[333,7828+12]..[336,7921+29])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[333,7828+12]..[336,7921+29])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[334,7877+6]..[336,7921+29])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[335,7892+10]..[335,7892+22])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[335,7892+10]..[335,7892+12])
                                Ppat_variant "A"
                                None
                              pattern (testsuite/tests/typing-gadts/test.ml[335,7892+14]..[335,7892+22])
                                Ppat_construct "IntLit" (testsuite/tests/typing-gadts/test.ml[335,7892+14]..[335,7892+20])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[335,7892+21]..[335,7892+22])
                                    Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/test.ml[335,7892+26]..[335,7892+28])
                            Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[335,7892+26]..[335,7892+28])
                            None
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[336,7921+10]..[336,7921+23])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/test.ml[336,7921+10]..[336,7921+12])
                                Ppat_variant "A"
                                None
                              pattern (testsuite/tests/typing-gadts/test.ml[336,7921+14]..[336,7921+23])
                                Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/test.ml[336,7921+14]..[336,7921+21])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/test.ml[336,7921+22]..[336,7921+23])
                                    Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/test.ml[336,7921+27]..[336,7921+29])
                            Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[336,7921+27]..[336,7921+29])
                            None
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[333,7828+28]..[333,7828+46])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[333,7828+28]..[333,7828+38])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[333,7828+28]..[333,7828+32])
                            Ptyp_variant closed=Closed
                            [
                              Rtag "A" true
                                []
                            ]
                            None
                          core_type (testsuite/tests/typing-gadts/test.ml[333,7828+35]..[333,7828+38])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[333,7828+37]..[333,7828+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[333,7828+35]..[333,7828+36])
                                Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[333,7828+35]..[333,7828+36])
                                []
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[333,7828+42]..[333,7828+46])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/test.ml[333,7828+42]..[333,7828+46])
                        []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[339,7960+0]..[345,8115+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[339,7960+9]..[345,8115+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[339,7960+9]..[345,8115+2])
          Pexp_constant PConst_string ("\nmodule Polymorphic_variants :\n  sig\n    type _ t = IntLit : int -> int t | BoolLit : bool -> bool t\n    val eval : [ `A ] * 's t -> unit\n  end\n",(testsuite/tests/typing-gadts/test.ml[339,7960+11]..[345,8115+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[347,8122+0]..[361,8431+3])
    Pstr_module
    "Propagation" (testsuite/tests/typing-gadts/test.ml[347,8122+7]..[347,8122+18])
      module_expr (testsuite/tests/typing-gadts/test.ml[347,8122+21]..[361,8431+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[348,8150+2]..[350,8191+30])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[348,8150+9]..[348,8150+10]) (testsuite/tests/typing-gadts/test.ml[348,8150+2]..[350,8191+30])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[348,8150+7]..[348,8150+8])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[349,8163+6]..[349,8163+27])
                        "IntLit" (testsuite/tests/typing-gadts/test.ml[349,8163+6]..[349,8163+12])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[349,8163+15]..[349,8163+18])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[349,8163+15]..[349,8163+18])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[349,8163+22]..[349,8163+27])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[349,8163+26]..[349,8163+27])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[349,8163+22]..[349,8163+25])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[349,8163+22]..[349,8163+25])
                                []
                            ]
                      (testsuite/tests/typing-gadts/test.ml[350,8191+4]..[350,8191+30])
                        "BoolLit" (testsuite/tests/typing-gadts/test.ml[350,8191+6]..[350,8191+13])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[350,8191+16]..[350,8191+20])
                            Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[350,8191+16]..[350,8191+20])
                            []
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[350,8191+24]..[350,8191+30])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[350,8191+29]..[350,8191+30])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[350,8191+24]..[350,8191+28])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[350,8191+24]..[350,8191+28])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[352,8223+2]..[354,8285+20])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[352,8223+6]..[352,8223+30]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[352,8223+6]..[352,8223+11])
                    Ppat_var "check" (testsuite/tests/typing-gadts/test.ml[352,8223+6]..[352,8223+11])
                  core_type (testsuite/tests/typing-gadts/test.ml[352,8223+6]..[354,8285+20]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[352,8223+22]..[352,8223+30])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[352,8223+22]..[352,8223+25])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[352,8223+24]..[352,8223+25])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[352,8223+22]..[352,8223+23])
                            Ptyp_var s
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[352,8223+29]..[352,8223+30])
                        Ptyp_var s
                expression (testsuite/tests/typing-gadts/test.ml[352,8223+6]..[354,8285+20])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[352,8223+6]..[354,8285+20])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[352,8223+33]..[354,8285+20])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[353,8265+6]..[353,8265+14])
                            Ppat_construct "IntLit" (testsuite/tests/typing-gadts/test.ml[353,8265+6]..[353,8265+12])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[353,8265+13]..[353,8265+14])
                                Ppat_var "n" (testsuite/tests/typing-gadts/test.ml[353,8265+13]..[353,8265+14])
                          expression (testsuite/tests/typing-gadts/test.ml[353,8265+18]..[353,8265+19])
                            Pexp_ident "n" (testsuite/tests/typing-gadts/test.ml[353,8265+18]..[353,8265+19])
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[354,8285+6]..[354,8285+15])
                            Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/test.ml[354,8285+6]..[354,8285+13])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[354,8285+14]..[354,8285+15])
                                Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[354,8285+14]..[354,8285+15])
                          expression (testsuite/tests/typing-gadts/test.ml[354,8285+19]..[354,8285+20])
                            Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[354,8285+19]..[354,8285+20])
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[352,8223+22]..[352,8223+30])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[352,8223+22]..[352,8223+25])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[352,8223+24]..[352,8223+25])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[352,8223+22]..[352,8223+23])
                            Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[352,8223+22]..[352,8223+23])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[352,8223+29]..[352,8223+30])
                        Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[352,8223+29]..[352,8223+30])
                        []
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[356,8307+2]..[360,8422+8])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[356,8307+6]..[356,8307+30]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[356,8307+6]..[356,8307+11])
                    Ppat_var "check" (testsuite/tests/typing-gadts/test.ml[356,8307+6]..[356,8307+11])
                  core_type (testsuite/tests/typing-gadts/test.ml[356,8307+6]..[360,8422+8]) ghost
                    Ptyp_poly 's
                    core_type (testsuite/tests/typing-gadts/test.ml[356,8307+22]..[356,8307+30])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[356,8307+22]..[356,8307+25])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[356,8307+24]..[356,8307+25])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[356,8307+22]..[356,8307+23])
                            Ptyp_var s
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[356,8307+29]..[356,8307+30])
                        Ptyp_var s
                expression (testsuite/tests/typing-gadts/test.ml[356,8307+6]..[360,8422+8])
                  Pexp_newtype "s"
                  expression (testsuite/tests/typing-gadts/test.ml[356,8307+6]..[360,8422+8])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[356,8307+33]..[360,8422+8])
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[356,8307+37]..[356,8307+38])
                        Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[356,8307+37]..[356,8307+38])
                      expression (testsuite/tests/typing-gadts/test.ml[357,8349+4]..[360,8422+8])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (testsuite/tests/typing-gadts/test.ml[357,8349+8]..[357,8349+9])
                              Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[357,8349+8]..[357,8349+9])
                            expression (testsuite/tests/typing-gadts/test.ml[357,8349+12]..[359,8401+20])
                              Pexp_match
                              expression (testsuite/tests/typing-gadts/test.ml[357,8349+18]..[357,8349+19])
                                Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[357,8349+18]..[357,8349+19])
                              [
                                <case>
                                  pattern (testsuite/tests/typing-gadts/test.ml[358,8374+6]..[358,8374+14])
                                    Ppat_construct "IntLit" (testsuite/tests/typing-gadts/test.ml[358,8374+6]..[358,8374+12])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/test.ml[358,8374+13]..[358,8374+14])
                                        Ppat_var "n" (testsuite/tests/typing-gadts/test.ml[358,8374+13]..[358,8374+14])
                                  expression (testsuite/tests/typing-gadts/test.ml[358,8374+18]..[358,8374+26])
                                    Pexp_constraint
                                    expression (testsuite/tests/typing-gadts/test.ml[358,8374+19]..[358,8374+20])
                                      Pexp_ident "n" (testsuite/tests/typing-gadts/test.ml[358,8374+19]..[358,8374+20])
                                    core_type (testsuite/tests/typing-gadts/test.ml[358,8374+23]..[358,8374+24])
                                      Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[358,8374+23]..[358,8374+24])
                                      []
                                <case>
                                  pattern (testsuite/tests/typing-gadts/test.ml[359,8401+6]..[359,8401+15])
                                    Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/test.ml[359,8401+6]..[359,8401+13])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/test.ml[359,8401+14]..[359,8401+15])
                                        Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[359,8401+14]..[359,8401+15])
                                  expression (testsuite/tests/typing-gadts/test.ml[359,8401+19]..[359,8401+20])
                                    Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[359,8401+19]..[359,8401+20])
                              ]
                        ]
                        expression (testsuite/tests/typing-gadts/test.ml[360,8422+7]..[360,8422+8])
                          Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[360,8422+7]..[360,8422+8])
                    core_type (testsuite/tests/typing-gadts/test.ml[356,8307+22]..[356,8307+30])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[356,8307+22]..[356,8307+25])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[356,8307+24]..[356,8307+25])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[356,8307+22]..[356,8307+23])
                            Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[356,8307+22]..[356,8307+23])
                            []
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[356,8307+29]..[356,8307+30])
                        Ptyp_constr "s" (testsuite/tests/typing-gadts/test.ml[356,8307+29]..[356,8307+30])
                        []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[363,8438+0]..[374,8747+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[363,8438+9]..[374,8747+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[363,8438+9]..[374,8747+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/test.ml[363,8438+9]..[369,8574+2])
              Pexp_constant PConst_string ("\nmodule Propagation :\n  sig\n    type _ t = IntLit : int -> int t | BoolLit : bool -> bool t\n    val check : 's t -> 's\n  end\n",(testsuite/tests/typing-gadts/test.ml[363,8438+11]..[369,8574+0]),Some "")
            expression (testsuite/tests/typing-gadts/test.ml[369,8574+4]..[374,8747+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/test.ml[369,8574+4]..[369,8574+13])
              Some
                expression (testsuite/tests/typing-gadts/test.ml[369,8574+13]..[374,8747+2])
                  Pexp_constant PConst_string ("\nLine 13, characters 19-20:\n13 |     | BoolLit b -> b\n                        ^\nError: This expression has type bool but an expression was expected of type s\n",(testsuite/tests/typing-gadts/test.ml[369,8574+15]..[374,8747+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[376,8754+0]..[381,8847+3])
    Pstr_module
    "Normal_constrs" (testsuite/tests/typing-gadts/test.ml[376,8754+7]..[376,8754+21])
      module_expr (testsuite/tests/typing-gadts/test.ml[376,8754+24]..[381,8847+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[377,8785+2]..[377,8785+12])
            Pstr_type Rec
            [
              type_declaration "a" (testsuite/tests/typing-gadts/test.ml[377,8785+7]..[377,8785+8]) (testsuite/tests/typing-gadts/test.ml[377,8785+2]..[377,8785+12])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[377,8785+11]..[377,8785+12])
                        "A" (testsuite/tests/typing-gadts/test.ml[377,8785+11]..[377,8785+12])
                        []
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[378,8798+2]..[378,8798+12])
            Pstr_type Rec
            [
              type_declaration "b" (testsuite/tests/typing-gadts/test.ml[378,8798+7]..[378,8798+8]) (testsuite/tests/typing-gadts/test.ml[378,8798+2]..[378,8798+12])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[378,8798+11]..[378,8798+12])
                        "B" (testsuite/tests/typing-gadts/test.ml[378,8798+11]..[378,8798+12])
                        []
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[380,8812+2]..[380,8812+34])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[380,8812+6]..[380,8812+7])
                  Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[380,8812+6]..[380,8812+7])
                expression (testsuite/tests/typing-gadts/test.ml[380,8812+10]..[380,8812+34])
                  Pexp_function
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[380,8812+19]..[380,8812+20])
                        Ppat_construct "A" (testsuite/tests/typing-gadts/test.ml[380,8812+19]..[380,8812+20])
                        None
                      expression (testsuite/tests/typing-gadts/test.ml[380,8812+24]..[380,8812+25])
                        Pexp_constant PConst_int (1,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[380,8812+28]..[380,8812+29])
                        Ppat_construct "B" (testsuite/tests/typing-gadts/test.ml[380,8812+28]..[380,8812+29])
                        None
                      expression (testsuite/tests/typing-gadts/test.ml[380,8812+33]..[380,8812+34])
                        Pexp_constant PConst_int (2,None)
                  ]
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[382,8853+0]..[388,9066+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[382,8853+9]..[388,9066+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[382,8853+9]..[388,9066+2])
          Pexp_constant PConst_string ("\nLine 5, characters 28-29:\n5 |   let f = function A -> 1 | B -> 2\n                                ^\nError: This variant pattern is expected to have type a\n       There is no constructor B within type a\n",(testsuite/tests/typing-gadts/test.ml[382,8853+11]..[388,9066+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[390,9073+0]..[395,9170+3])
    Pstr_module
    "PR6849" (testsuite/tests/typing-gadts/test.ml[390,9073+7]..[390,9073+13])
      module_expr (testsuite/tests/typing-gadts/test.ml[390,9073+16]..[395,9170+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[391,9096+2]..[391,9096+25])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[391,9096+10]..[391,9096+11]) (testsuite/tests/typing-gadts/test.ml[391,9096+2]..[391,9096+25])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[391,9096+7]..[391,9096+9])
                      Ptyp_var a
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[391,9096+14]..[391,9096+25])
                        "Foo" (testsuite/tests/typing-gadts/test.ml[391,9096+14]..[391,9096+17])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[391,9096+20]..[391,9096+25])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[391,9096+24]..[391,9096+25])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[391,9096+20]..[391,9096+23])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[391,9096+20]..[391,9096+23])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (testsuite/tests/typing-gadts/test.ml[393,9123+2]..[394,9155+14])
            Pstr_value Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[393,9123+6]..[393,9123+20]) ghost
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[393,9123+6]..[393,9123+7])
                    Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[393,9123+6]..[393,9123+7])
                  core_type (testsuite/tests/typing-gadts/test.ml[393,9123+10]..[393,9123+20]) ghost
                    Ptyp_poly
                    core_type (testsuite/tests/typing-gadts/test.ml[393,9123+10]..[393,9123+20])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[393,9123+10]..[393,9123+13])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[393,9123+10]..[393,9123+13])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[393,9123+17]..[393,9123+20])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[393,9123+17]..[393,9123+20])
                        []
                expression (testsuite/tests/typing-gadts/test.ml[393,9123+6]..[394,9155+14])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/test.ml[393,9123+23]..[394,9155+14])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[394,9155+6]..[394,9155+9])
                          Ppat_construct "Foo" (testsuite/tests/typing-gadts/test.ml[394,9155+6]..[394,9155+9])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[394,9155+13]..[394,9155+14])
                          Pexp_constant PConst_int (5,None)
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[393,9123+10]..[393,9123+20])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[393,9123+10]..[393,9123+13])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[393,9123+10]..[393,9123+13])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[393,9123+17]..[393,9123+20])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[393,9123+17]..[393,9123+20])
                      []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[396,9176+0]..[402,9360+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[396,9176+9]..[402,9360+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[396,9176+9]..[402,9360+2])
          Pexp_constant PConst_string ("\nLine 5, characters 6-9:\n5 |       Foo -> 5\n          ^^^\nError: This pattern matches values of type 'a t\n       but a pattern was expected which matches values of type int\n",(testsuite/tests/typing-gadts/test.ml[396,9176+11]..[402,9360+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[404,9367+0]..[404,9367+22])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/test.ml[404,9367+7]..[404,9367+8]) (testsuite/tests/typing-gadts/test.ml[404,9367+0]..[404,9367+22])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[404,9367+5]..[404,9367+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[404,9367+11]..[404,9367+22])
                "Int" (testsuite/tests/typing-gadts/test.ml[404,9367+11]..[404,9367+14])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[404,9367+17]..[404,9367+22])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[404,9367+21]..[404,9367+22])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[404,9367+17]..[404,9367+20])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[404,9367+17]..[404,9367+20])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[406,9394+0]..[406,9394+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[406,9394+4]..[406,9394+6])
          Ppat_var "ky" (testsuite/tests/typing-gadts/test.ml[406,9394+4]..[406,9394+6])
        expression (testsuite/tests/typing-gadts/test.ml[406,9394+7]..[406,9394+30]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/test.ml[406,9394+7]..[406,9394+8])
            Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[406,9394+7]..[406,9394+8])
          expression (testsuite/tests/typing-gadts/test.ml[406,9394+9]..[406,9394+30]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[406,9394+9]..[406,9394+10])
              Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[406,9394+9]..[406,9394+10])
            expression (testsuite/tests/typing-gadts/test.ml[406,9394+13]..[406,9394+30])
              Pexp_sequence
              expression (testsuite/tests/typing-gadts/test.ml[406,9394+13]..[406,9394+27])
                Pexp_apply
                expression (testsuite/tests/typing-gadts/test.ml[406,9394+13]..[406,9394+19])
                  Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[406,9394+13]..[406,9394+19])
                [
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/test.ml[406,9394+20]..[406,9394+27])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[406,9394+23]..[406,9394+24])
                        Pexp_ident "=" (testsuite/tests/typing-gadts/test.ml[406,9394+23]..[406,9394+24])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[406,9394+21]..[406,9394+22])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[406,9394+21]..[406,9394+22])
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[406,9394+25]..[406,9394+26])
                            Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[406,9394+25]..[406,9394+26])
                      ]
                ]
              expression (testsuite/tests/typing-gadts/test.ml[406,9394+29]..[406,9394+30])
                Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[406,9394+29]..[406,9394+30])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[408,9429+0]..[409,9459+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[408,9429+4]..[408,9429+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[408,9429+4]..[408,9429+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[408,9429+4]..[408,9429+8])
          core_type (testsuite/tests/typing-gadts/test.ml[408,9429+4]..[409,9459+30]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[408,9429+19]..[408,9429+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[408,9429+19]..[408,9429+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[408,9429+21]..[408,9429+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[408,9429+19]..[408,9429+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[408,9429+26]..[408,9429+27])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[408,9429+4]..[409,9459+30])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[408,9429+4]..[409,9459+30])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[409,9459+2]..[409,9459+30])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[409,9459+11]..[409,9459+14])
                    Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[409,9459+11]..[409,9459+14])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[409,9459+18]..[409,9459+30])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[409,9459+18]..[409,9459+20])
                      Pexp_ident "ky" (testsuite/tests/typing-gadts/test.ml[409,9459+18]..[409,9459+20])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[409,9459+21]..[409,9459+28])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/test.ml[409,9459+22]..[409,9459+23])
                            Pexp_constant PConst_int (1,None)
                          core_type (testsuite/tests/typing-gadts/test.ml[409,9459+26]..[409,9459+27])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[409,9459+26]..[409,9459+27])
                            []
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[409,9459+29]..[409,9459+30])
                          Pexp_constant PConst_int (1,None)
                    ]
              ]
            core_type (testsuite/tests/typing-gadts/test.ml[408,9429+19]..[408,9429+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[408,9429+19]..[408,9429+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[408,9429+21]..[408,9429+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[408,9429+19]..[408,9429+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[408,9429+19]..[408,9429+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[408,9429+26]..[408,9429+27])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[408,9429+26]..[408,9429+27])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[411,9493+0]..[415,9590+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[411,9493+9]..[415,9590+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[411,9493+9]..[415,9590+2])
          Pexp_constant PConst_string ("\ntype _ t = Int : int t\nval ky : 'a -> 'a -> 'a = <fun>\nval test : 'a t -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[411,9493+11]..[415,9590+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[417,9597+0]..[418,9627+19])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[417,9597+4]..[417,9597+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[417,9597+4]..[417,9597+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[417,9597+4]..[417,9597+8])
          core_type (testsuite/tests/typing-gadts/test.ml[417,9597+4]..[418,9627+19]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[417,9597+19]..[417,9597+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[417,9597+19]..[417,9597+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[417,9597+21]..[417,9597+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[417,9597+19]..[417,9597+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[417,9597+26]..[417,9597+27])
                Ptyp_any
        expression (testsuite/tests/typing-gadts/test.ml[417,9597+4]..[418,9627+19])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[417,9597+4]..[418,9627+19])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[418,9627+2]..[418,9627+19])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[418,9627+11]..[418,9627+14])
                    Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[418,9627+11]..[418,9627+14])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[418,9627+18]..[418,9627+19])
                    Pexp_constant PConst_int (1,None)
              ]
            core_type (testsuite/tests/typing-gadts/test.ml[417,9597+19]..[417,9597+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[417,9597+19]..[417,9597+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[417,9597+21]..[417,9597+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[417,9597+19]..[417,9597+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[417,9597+19]..[417,9597+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[417,9597+26]..[417,9597+27])
                Ptyp_any
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[420,9665+0]..[422,9708+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[420,9665+9]..[422,9708+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[420,9665+9]..[422,9708+2])
          Pexp_constant PConst_string ("\nval test : 'a t -> int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[420,9665+11]..[422,9708+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[424,9715+0]..[425,9745+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[424,9715+4]..[424,9715+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[424,9715+4]..[424,9715+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[424,9715+4]..[424,9715+8])
          core_type (testsuite/tests/typing-gadts/test.ml[424,9715+4]..[425,9745+30]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[424,9715+19]..[424,9715+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[424,9715+19]..[424,9715+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[424,9715+21]..[424,9715+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[424,9715+19]..[424,9715+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[424,9715+26]..[424,9715+27])
                Ptyp_any
        expression (testsuite/tests/typing-gadts/test.ml[424,9715+4]..[425,9745+30])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[424,9715+4]..[425,9745+30])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[425,9745+2]..[425,9745+30])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[425,9745+11]..[425,9745+14])
                    Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[425,9745+11]..[425,9745+14])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[425,9745+18]..[425,9745+30])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[425,9745+18]..[425,9745+20])
                      Pexp_ident "ky" (testsuite/tests/typing-gadts/test.ml[425,9745+18]..[425,9745+20])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[425,9745+21]..[425,9745+28])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/test.ml[425,9745+22]..[425,9745+23])
                            Pexp_constant PConst_int (1,None)
                          core_type (testsuite/tests/typing-gadts/test.ml[425,9745+26]..[425,9745+27])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[425,9745+26]..[425,9745+27])
                            []
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[425,9745+29]..[425,9745+30])
                          Pexp_constant PConst_int (1,None)
                    ]
              ]
            core_type (testsuite/tests/typing-gadts/test.ml[424,9715+19]..[424,9715+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[424,9715+19]..[424,9715+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[424,9715+21]..[424,9715+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[424,9715+19]..[424,9715+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[424,9715+19]..[424,9715+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[424,9715+26]..[424,9715+27])
                Ptyp_any
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[427,9792+0]..[435,10093+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[427,9792+9]..[435,10093+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[427,9792+9]..[435,10093+2])
          Pexp_constant PConst_string ("\nLine 2, characters 18-30:\n2 |   function Int -> ky (1 : a) 1  (* fails *)\n                      ^^^^^^^^^^^^\nError: This expression has type a = int\n       but an expression was expected of type 'a\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[427,9792+11]..[435,10093+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[437,10100+0]..[439,10195+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[437,10100+4]..[437,10100+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[437,10100+4]..[437,10100+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[437,10100+4]..[437,10100+8])
          core_type (testsuite/tests/typing-gadts/test.ml[437,10100+4]..[439,10195+6]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[437,10100+19]..[437,10100+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[437,10100+19]..[437,10100+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[437,10100+21]..[437,10100+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[437,10100+19]..[437,10100+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[437,10100+26]..[437,10100+27])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[437,10100+4]..[439,10195+6])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[437,10100+4]..[439,10195+6])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[437,10100+30]..[439,10195+6])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[437,10100+34]..[437,10100+35])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[437,10100+34]..[437,10100+35])
              expression (testsuite/tests/typing-gadts/test.ml[438,10139+2]..[439,10195+6])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[438,10139+6]..[438,10139+7])
                      Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[438,10139+6]..[438,10139+7])
                    expression (testsuite/tests/typing-gadts/test.ml[438,10139+10]..[438,10139+42])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[438,10139+16]..[438,10139+17])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[438,10139+16]..[438,10139+17])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[438,10139+23]..[438,10139+26])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[438,10139+23]..[438,10139+26])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[438,10139+30]..[438,10139+42])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[438,10139+30]..[438,10139+32])
                              Pexp_ident "ky" (testsuite/tests/typing-gadts/test.ml[438,10139+30]..[438,10139+32])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[438,10139+33]..[438,10139+40])
                                  Pexp_constraint
                                  expression (testsuite/tests/typing-gadts/test.ml[438,10139+34]..[438,10139+35])
                                    Pexp_constant PConst_int (1,None)
                                  core_type (testsuite/tests/typing-gadts/test.ml[438,10139+38]..[438,10139+39])
                                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[438,10139+38]..[438,10139+39])
                                    []
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[438,10139+41]..[438,10139+42])
                                  Pexp_constant PConst_int (1,None)
                            ]
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[439,10195+5]..[439,10195+6])
                  Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[439,10195+5]..[439,10195+6])
            core_type (testsuite/tests/typing-gadts/test.ml[437,10100+19]..[437,10100+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[437,10100+19]..[437,10100+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[437,10100+21]..[437,10100+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[437,10100+19]..[437,10100+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[437,10100+19]..[437,10100+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[437,10100+26]..[437,10100+27])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[437,10100+26]..[437,10100+27])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[441,10205+0]..[449,10530+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[441,10205+9]..[449,10530+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[441,10205+9]..[449,10530+2])
          Pexp_constant PConst_string ("\nLine 2, characters 30-42:\n2 |   let r = match x with Int -> ky (1 : a) 1  (* fails *)\n                                  ^^^^^^^^^^^^\nError: This expression has type a = int\n       but an expression was expected of type 'a\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[441,10205+11]..[449,10530+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[451,10537+0]..[453,10632+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[451,10537+4]..[451,10537+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[451,10537+4]..[451,10537+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[451,10537+4]..[451,10537+8])
          core_type (testsuite/tests/typing-gadts/test.ml[451,10537+4]..[453,10632+6]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[451,10537+19]..[451,10537+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[451,10537+19]..[451,10537+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[451,10537+21]..[451,10537+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[451,10537+19]..[451,10537+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[451,10537+26]..[451,10537+27])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[451,10537+4]..[453,10632+6])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[451,10537+4]..[453,10632+6])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[451,10537+30]..[453,10632+6])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[451,10537+34]..[451,10537+35])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[451,10537+34]..[451,10537+35])
              expression (testsuite/tests/typing-gadts/test.ml[452,10576+2]..[453,10632+6])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[452,10576+6]..[452,10576+7])
                      Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[452,10576+6]..[452,10576+7])
                    expression (testsuite/tests/typing-gadts/test.ml[452,10576+10]..[452,10576+42])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[452,10576+16]..[452,10576+17])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[452,10576+16]..[452,10576+17])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[452,10576+23]..[452,10576+26])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[452,10576+23]..[452,10576+26])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[452,10576+30]..[452,10576+42])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[452,10576+30]..[452,10576+32])
                              Pexp_ident "ky" (testsuite/tests/typing-gadts/test.ml[452,10576+30]..[452,10576+32])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[452,10576+33]..[452,10576+34])
                                  Pexp_constant PConst_int (1,None)
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[452,10576+35]..[452,10576+42])
                                  Pexp_constraint
                                  expression (testsuite/tests/typing-gadts/test.ml[452,10576+36]..[452,10576+37])
                                    Pexp_constant PConst_int (1,None)
                                  core_type (testsuite/tests/typing-gadts/test.ml[452,10576+40]..[452,10576+41])
                                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[452,10576+40]..[452,10576+41])
                                    []
                            ]
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[453,10632+5]..[453,10632+6])
                  Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[453,10632+5]..[453,10632+6])
            core_type (testsuite/tests/typing-gadts/test.ml[451,10537+19]..[451,10537+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[451,10537+19]..[451,10537+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[451,10537+21]..[451,10537+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[451,10537+19]..[451,10537+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[451,10537+19]..[451,10537+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[451,10537+26]..[451,10537+27])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[451,10537+26]..[451,10537+27])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[455,10642+0]..[463,10967+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[455,10642+9]..[463,10967+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[455,10642+9]..[463,10967+2])
          Pexp_constant PConst_string ("\nLine 2, characters 30-42:\n2 |   let r = match x with Int -> ky 1 (1 : a)  (* fails *)\n                                  ^^^^^^^^^^^^\nError: This expression has type a = int\n       but an expression was expected of type 'a\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[455,10642+11]..[463,10967+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[465,10974+0]..[467,11041+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[465,10974+4]..[465,10974+8])
          Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[465,10974+4]..[465,10974+8])
        expression (testsuite/tests/typing-gadts/test.ml[465,10974+9]..[467,11041+6])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[465,10974+18]..[467,11041+6]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[465,10974+18]..[465,10974+19])
              Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[465,10974+18]..[465,10974+19])
            expression (testsuite/tests/typing-gadts/test.ml[466,10996+2]..[467,11041+6])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/test.ml[466,10996+6]..[466,10996+7])
                    Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[466,10996+6]..[466,10996+7])
                  expression (testsuite/tests/typing-gadts/test.ml[466,10996+10]..[466,10996+44])
                    Pexp_match
                    expression (testsuite/tests/typing-gadts/test.ml[466,10996+16]..[466,10996+25])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/test.ml[466,10996+17]..[466,10996+18])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[466,10996+17]..[466,10996+18])
                      core_type (testsuite/tests/typing-gadts/test.ml[466,10996+21]..[466,10996+24])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[466,10996+23]..[466,10996+24])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[466,10996+21]..[466,10996+22])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[466,10996+21]..[466,10996+22])
                            []
                        ]
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[466,10996+31]..[466,10996+34])
                          Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[466,10996+31]..[466,10996+34])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[466,10996+38]..[466,10996+44])
                          Pexp_apply
                          expression (testsuite/tests/typing-gadts/test.ml[466,10996+38]..[466,10996+40])
                            Pexp_ident "ky" (testsuite/tests/typing-gadts/test.ml[466,10996+38]..[466,10996+40])
                          [
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[466,10996+41]..[466,10996+42])
                                Pexp_constant PConst_int (1,None)
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[466,10996+43]..[466,10996+44])
                                Pexp_constant PConst_int (1,None)
                          ]
                    ]
              ]
              expression (testsuite/tests/typing-gadts/test.ml[467,11041+5]..[467,11041+6])
                Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[467,11041+5]..[467,11041+6])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[469,11051+0]..[471,11094+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[469,11051+9]..[471,11094+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[469,11051+9]..[471,11094+2])
          Pexp_constant PConst_string ("\nval test : 'a t -> int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[469,11051+11]..[471,11094+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[473,11101+0]..[475,11194+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[473,11101+4]..[473,11101+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[473,11101+4]..[473,11101+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[473,11101+4]..[473,11101+8])
          core_type (testsuite/tests/typing-gadts/test.ml[473,11101+4]..[475,11194+6]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[473,11101+19]..[473,11101+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[473,11101+19]..[473,11101+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[473,11101+21]..[473,11101+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[473,11101+19]..[473,11101+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[473,11101+26]..[473,11101+27])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[473,11101+4]..[475,11194+6])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[473,11101+4]..[475,11194+6])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[473,11101+30]..[475,11194+6])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[473,11101+34]..[473,11101+35])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[473,11101+34]..[473,11101+35])
              expression (testsuite/tests/typing-gadts/test.ml[474,11140+2]..[475,11194+6])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[474,11140+6]..[474,11140+7])
                      Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[474,11140+6]..[474,11140+7])
                    expression (testsuite/tests/typing-gadts/test.ml[474,11140+10]..[474,11140+37])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[474,11140+16]..[474,11140+17])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[474,11140+16]..[474,11140+17])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[474,11140+23]..[474,11140+26])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[474,11140+23]..[474,11140+26])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[474,11140+30]..[474,11140+37])
                            Pexp_constraint
                            expression (testsuite/tests/typing-gadts/test.ml[474,11140+31]..[474,11140+32])
                              Pexp_constant PConst_int (1,None)
                            core_type (testsuite/tests/typing-gadts/test.ml[474,11140+35]..[474,11140+36])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[474,11140+35]..[474,11140+36])
                              []
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[475,11194+5]..[475,11194+6])
                  Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[475,11194+5]..[475,11194+6])
            core_type (testsuite/tests/typing-gadts/test.ml[473,11101+19]..[473,11101+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[473,11101+19]..[473,11101+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[473,11101+21]..[473,11101+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[473,11101+19]..[473,11101+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[473,11101+19]..[473,11101+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[473,11101+26]..[473,11101+27])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[473,11101+26]..[473,11101+27])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[477,11204+0]..[479,11246+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[477,11204+9]..[479,11246+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[477,11204+9]..[479,11246+2])
          Pexp_constant PConst_string ("\nval test : 'a t -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[477,11204+11]..[479,11246+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[481,11253+0]..[483,11340+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[481,11253+4]..[481,11253+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[481,11253+4]..[481,11253+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[481,11253+4]..[481,11253+8])
          core_type (testsuite/tests/typing-gadts/test.ml[481,11253+4]..[483,11340+6]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[481,11253+19]..[481,11253+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[481,11253+19]..[481,11253+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[481,11253+21]..[481,11253+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[481,11253+19]..[481,11253+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[481,11253+26]..[481,11253+27])
                Ptyp_any
        expression (testsuite/tests/typing-gadts/test.ml[481,11253+4]..[483,11340+6])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[481,11253+4]..[483,11340+6])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[481,11253+30]..[483,11340+6])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[481,11253+34]..[481,11253+35])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[481,11253+34]..[481,11253+35])
              expression (testsuite/tests/typing-gadts/test.ml[482,11292+2]..[483,11340+6])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[482,11292+6]..[482,11292+7])
                      Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[482,11292+6]..[482,11292+7])
                    expression (testsuite/tests/typing-gadts/test.ml[482,11292+10]..[482,11292+31])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[482,11292+16]..[482,11292+17])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[482,11292+16]..[482,11292+17])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[482,11292+23]..[482,11292+26])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[482,11292+23]..[482,11292+26])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[482,11292+30]..[482,11292+31])
                            Pexp_constant PConst_int (1,None)
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[483,11340+5]..[483,11340+6])
                  Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[483,11340+5]..[483,11340+6])
            core_type (testsuite/tests/typing-gadts/test.ml[481,11253+19]..[481,11253+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[481,11253+19]..[481,11253+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[481,11253+21]..[481,11253+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[481,11253+19]..[481,11253+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[481,11253+19]..[481,11253+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[481,11253+26]..[481,11253+27])
                Ptyp_any
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[485,11350+0]..[487,11393+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[485,11350+9]..[487,11393+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[485,11350+9]..[487,11393+2])
          Pexp_constant PConst_string ("\nval test : 'a t -> int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[485,11350+11]..[487,11393+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[489,11400+0]..[491,11475+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[489,11400+4]..[489,11400+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[489,11400+4]..[489,11400+8])
            Ppat_var "test" (testsuite/tests/typing-gadts/test.ml[489,11400+4]..[489,11400+8])
          core_type (testsuite/tests/typing-gadts/test.ml[489,11400+4]..[491,11475+6]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[489,11400+19]..[489,11400+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[489,11400+19]..[489,11400+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[489,11400+21]..[489,11400+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[489,11400+19]..[489,11400+20])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[489,11400+26]..[489,11400+27])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[489,11400+4]..[491,11475+6])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[489,11400+4]..[491,11475+6])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[489,11400+30]..[491,11475+6])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[489,11400+34]..[489,11400+35])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[489,11400+34]..[489,11400+35])
              expression (testsuite/tests/typing-gadts/test.ml[490,11439+2]..[491,11475+6])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[490,11439+6]..[490,11439+11]) ghost
                      Ppat_constraint
                      pattern (testsuite/tests/typing-gadts/test.ml[490,11439+6]..[490,11439+7])
                        Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[490,11439+6]..[490,11439+7])
                      core_type (testsuite/tests/typing-gadts/test.ml[490,11439+10]..[490,11439+11]) ghost
                        Ptyp_poly
                        core_type (testsuite/tests/typing-gadts/test.ml[490,11439+10]..[490,11439+11])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[490,11439+10]..[490,11439+11])
                          []
                    expression (testsuite/tests/typing-gadts/test.ml[490,11439+6]..[490,11439+35])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/test.ml[490,11439+14]..[490,11439+35])
                        Pexp_match
                        expression (testsuite/tests/typing-gadts/test.ml[490,11439+20]..[490,11439+21])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[490,11439+20]..[490,11439+21])
                        [
                          <case>
                            pattern (testsuite/tests/typing-gadts/test.ml[490,11439+27]..[490,11439+30])
                              Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[490,11439+27]..[490,11439+30])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[490,11439+34]..[490,11439+35])
                              Pexp_constant PConst_int (1,None)
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[490,11439+10]..[490,11439+11])
                        Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[490,11439+10]..[490,11439+11])
                        []
                ]
                expression (testsuite/tests/typing-gadts/test.ml[491,11475+5]..[491,11475+6])
                  Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[491,11475+5]..[491,11475+6])
            core_type (testsuite/tests/typing-gadts/test.ml[489,11400+19]..[489,11400+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[489,11400+19]..[489,11400+22])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[489,11400+21]..[489,11400+22])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[489,11400+19]..[489,11400+20])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[489,11400+19]..[489,11400+20])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[489,11400+26]..[489,11400+27])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[489,11400+26]..[489,11400+27])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[493,11494+0]..[495,11536+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[493,11494+9]..[495,11536+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[493,11494+9]..[495,11536+2])
          Pexp_constant PConst_string ("\nval test : 'a t -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[493,11494+11]..[495,11536+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[497,11543+0]..[500,11663+4])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[497,11543+4]..[497,11543+35]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[497,11543+4]..[497,11543+9])
            Ppat_var "test2" (testsuite/tests/typing-gadts/test.ml[497,11543+4]..[497,11543+9])
          core_type (testsuite/tests/typing-gadts/test.ml[497,11543+4]..[500,11663+4]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[497,11543+20]..[497,11543+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[497,11543+20]..[497,11543+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[497,11543+22]..[497,11543+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[497,11543+20]..[497,11543+21])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[497,11543+27]..[497,11543+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[497,11543+29]..[497,11543+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[497,11543+27]..[497,11543+28])
                    Ptyp_var a
                ]
        expression (testsuite/tests/typing-gadts/test.ml[497,11543+4]..[500,11663+4])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[497,11543+4]..[500,11663+4])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[497,11543+38]..[500,11663+4])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[497,11543+42]..[497,11543+43])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[497,11543+42]..[497,11543+43])
              expression (testsuite/tests/typing-gadts/test.ml[498,11590+2]..[500,11663+4])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[498,11590+6]..[498,11590+7])
                      Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[498,11590+6]..[498,11590+7])
                    expression (testsuite/tests/typing-gadts/test.ml[498,11590+10]..[498,11590+18])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[498,11590+10]..[498,11590+13])
                        Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[498,11590+10]..[498,11590+13])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[498,11590+14]..[498,11590+18])
                            Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[498,11590+14]..[498,11590+18])
                            None
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[499,11612+2]..[500,11663+4])
                  Pexp_sequence
                  expression (testsuite/tests/typing-gadts/test.ml[499,11612+2]..[499,11612+49])
                    Pexp_match
                    expression (testsuite/tests/typing-gadts/test.ml[499,11612+14]..[499,11612+15])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[499,11612+14]..[499,11612+15])
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[499,11612+21]..[499,11612+24])
                          Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[499,11612+21]..[499,11612+24])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[499,11612+28]..[499,11612+45])
                          Pexp_apply
                          expression (testsuite/tests/typing-gadts/test.ml[499,11612+30]..[499,11612+32])
                            Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[499,11612+30]..[499,11612+32])
                          [
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[499,11612+28]..[499,11612+29])
                                Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[499,11612+28]..[499,11612+29])
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[499,11612+33]..[499,11612+45])
                                Pexp_construct "Some" (testsuite/tests/typing-gadts/test.ml[499,11612+33]..[499,11612+37])
                                Some
                                  expression (testsuite/tests/typing-gadts/test.ml[499,11612+38]..[499,11612+45])
                                    Pexp_constraint
                                    expression (testsuite/tests/typing-gadts/test.ml[499,11612+39]..[499,11612+40])
                                      Pexp_constant PConst_int (1,None)
                                    core_type (testsuite/tests/typing-gadts/test.ml[499,11612+43]..[499,11612+44])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[499,11612+43]..[499,11612+44])
                                      []
                          ]
                    ]
                  expression (testsuite/tests/typing-gadts/test.ml[500,11663+2]..[500,11663+4])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[500,11663+2]..[500,11663+3])
                      Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[500,11663+2]..[500,11663+3])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[500,11663+3]..[500,11663+4])
                          Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[500,11663+3]..[500,11663+4])
                    ]
            core_type (testsuite/tests/typing-gadts/test.ml[497,11543+20]..[497,11543+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[497,11543+20]..[497,11543+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[497,11543+22]..[497,11543+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[497,11543+20]..[497,11543+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[497,11543+20]..[497,11543+21])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[497,11543+27]..[497,11543+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[497,11543+29]..[497,11543+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[497,11543+27]..[497,11543+28])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[497,11543+27]..[497,11543+28])
                    []
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[502,11680+0]..[504,11730+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[502,11680+9]..[504,11730+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[502,11680+9]..[504,11730+2])
          Pexp_constant PConst_string ("\nval test2 : 'a t -> 'a option = <fun>\n",(testsuite/tests/typing-gadts/test.ml[502,11680+11]..[504,11730+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[506,11737+0]..[509,11866+4])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[506,11737+4]..[506,11737+35]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[506,11737+4]..[506,11737+9])
            Ppat_var "test2" (testsuite/tests/typing-gadts/test.ml[506,11737+4]..[506,11737+9])
          core_type (testsuite/tests/typing-gadts/test.ml[506,11737+4]..[509,11866+4]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[506,11737+20]..[506,11737+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[506,11737+20]..[506,11737+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[506,11737+22]..[506,11737+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[506,11737+20]..[506,11737+21])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[506,11737+27]..[506,11737+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[506,11737+29]..[506,11737+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[506,11737+27]..[506,11737+28])
                    Ptyp_var a
                ]
        expression (testsuite/tests/typing-gadts/test.ml[506,11737+4]..[509,11866+4])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[506,11737+4]..[509,11866+4])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[506,11737+38]..[509,11866+4])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[506,11737+42]..[506,11737+43])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[506,11737+42]..[506,11737+43])
              expression (testsuite/tests/typing-gadts/test.ml[507,11784+2]..[509,11866+4])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[507,11784+6]..[507,11784+22]) ghost
                      Ppat_constraint
                      pattern (testsuite/tests/typing-gadts/test.ml[507,11784+6]..[507,11784+7])
                        Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[507,11784+6]..[507,11784+7])
                      core_type (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+22]) ghost
                        Ptyp_poly
                        core_type (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+22])
                          Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[507,11784+19]..[507,11784+22])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+18])
                              Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[507,11784+12]..[507,11784+18])
                              [
                                core_type (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+11])
                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+11])
                                  []
                              ]
                          ]
                    expression (testsuite/tests/typing-gadts/test.ml[507,11784+6]..[507,11784+33])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/test.ml[507,11784+25]..[507,11784+33])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[507,11784+25]..[507,11784+28])
                          Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[507,11784+25]..[507,11784+28])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[507,11784+29]..[507,11784+33])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[507,11784+29]..[507,11784+33])
                              None
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+22])
                        Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[507,11784+19]..[507,11784+22])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+18])
                            Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[507,11784+12]..[507,11784+18])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+11])
                                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[507,11784+10]..[507,11784+11])
                                []
                            ]
                        ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[508,11821+2]..[509,11866+4])
                  Pexp_sequence
                  expression (testsuite/tests/typing-gadts/test.ml[508,11821+2]..[508,11821+43])
                    Pexp_match
                    expression (testsuite/tests/typing-gadts/test.ml[508,11821+14]..[508,11821+15])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[508,11821+14]..[508,11821+15])
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[508,11821+21]..[508,11821+24])
                          Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[508,11821+21]..[508,11821+24])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[508,11821+28]..[508,11821+39])
                          Pexp_apply
                          expression (testsuite/tests/typing-gadts/test.ml[508,11821+30]..[508,11821+32])
                            Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[508,11821+30]..[508,11821+32])
                          [
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[508,11821+28]..[508,11821+29])
                                Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[508,11821+28]..[508,11821+29])
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[508,11821+33]..[508,11821+39])
                                Pexp_construct "Some" (testsuite/tests/typing-gadts/test.ml[508,11821+33]..[508,11821+37])
                                Some
                                  expression (testsuite/tests/typing-gadts/test.ml[508,11821+38]..[508,11821+39])
                                    Pexp_constant PConst_int (1,None)
                          ]
                    ]
                  expression (testsuite/tests/typing-gadts/test.ml[509,11866+2]..[509,11866+4])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[509,11866+2]..[509,11866+3])
                      Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[509,11866+2]..[509,11866+3])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[509,11866+3]..[509,11866+4])
                          Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[509,11866+3]..[509,11866+4])
                    ]
            core_type (testsuite/tests/typing-gadts/test.ml[506,11737+20]..[506,11737+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[506,11737+20]..[506,11737+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[506,11737+22]..[506,11737+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[506,11737+20]..[506,11737+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[506,11737+20]..[506,11737+21])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[506,11737+27]..[506,11737+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[506,11737+29]..[506,11737+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[506,11737+27]..[506,11737+28])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[506,11737+27]..[506,11737+28])
                    []
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[511,11883+0]..[513,11933+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[511,11883+9]..[513,11933+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[511,11883+9]..[513,11933+2])
          Pexp_constant PConst_string ("\nval test2 : 'a t -> 'a option = <fun>\n",(testsuite/tests/typing-gadts/test.ml[511,11883+11]..[513,11933+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[515,11940+0]..[519,12100+4])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[515,11940+4]..[515,11940+35]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[515,11940+4]..[515,11940+9])
            Ppat_var "test2" (testsuite/tests/typing-gadts/test.ml[515,11940+4]..[515,11940+9])
          core_type (testsuite/tests/typing-gadts/test.ml[515,11940+4]..[519,12100+4]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[515,11940+20]..[515,11940+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[515,11940+20]..[515,11940+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[515,11940+22]..[515,11940+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[515,11940+20]..[515,11940+21])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[515,11940+27]..[515,11940+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[515,11940+29]..[515,11940+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[515,11940+27]..[515,11940+28])
                    Ptyp_var a
                ]
        expression (testsuite/tests/typing-gadts/test.ml[515,11940+4]..[519,12100+4])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[515,11940+4]..[519,12100+4])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[515,11940+38]..[519,12100+4])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[515,11940+42]..[515,11940+43])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[515,11940+42]..[515,11940+43])
              expression (testsuite/tests/typing-gadts/test.ml[516,11987+2]..[519,12100+4])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[516,11987+6]..[516,11987+22]) ghost
                      Ppat_constraint
                      pattern (testsuite/tests/typing-gadts/test.ml[516,11987+6]..[516,11987+7])
                        Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[516,11987+6]..[516,11987+7])
                      core_type (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+22]) ghost
                        Ptyp_poly
                        core_type (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+22])
                          Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[516,11987+19]..[516,11987+22])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+18])
                              Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[516,11987+12]..[516,11987+18])
                              [
                                core_type (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+11])
                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+11])
                                  []
                              ]
                          ]
                    expression (testsuite/tests/typing-gadts/test.ml[516,11987+6]..[516,11987+33])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/test.ml[516,11987+25]..[516,11987+33])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[516,11987+25]..[516,11987+28])
                          Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[516,11987+25]..[516,11987+28])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[516,11987+29]..[516,11987+33])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[516,11987+29]..[516,11987+33])
                              None
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+22])
                        Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[516,11987+19]..[516,11987+22])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+18])
                            Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[516,11987+12]..[516,11987+18])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+11])
                                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[516,11987+10]..[516,11987+11])
                                []
                            ]
                        ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[517,12024+2]..[519,12100+4])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[517,12024+6]..[517,12024+7])
                        Ppat_var "u" (testsuite/tests/typing-gadts/test.ml[517,12024+6]..[517,12024+7])
                      expression (testsuite/tests/typing-gadts/test.ml[517,12024+10]..[517,12024+18])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[517,12024+10]..[517,12024+13])
                          Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[517,12024+10]..[517,12024+13])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[517,12024+14]..[517,12024+18])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[517,12024+14]..[517,12024+18])
                              None
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[518,12046+2]..[519,12100+4])
                    Pexp_sequence
                    expression (testsuite/tests/typing-gadts/test.ml[518,12046+2]..[518,12046+52])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[518,12046+14]..[518,12046+15])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[518,12046+14]..[518,12046+15])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[518,12046+21]..[518,12046+24])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[518,12046+21]..[518,12046+24])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[518,12046+28]..[518,12046+48])
                            Pexp_sequence
                            expression (testsuite/tests/typing-gadts/test.ml[518,12046+28]..[518,12046+39])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/test.ml[518,12046+30]..[518,12046+32])
                                Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[518,12046+30]..[518,12046+32])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[518,12046+28]..[518,12046+29])
                                    Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[518,12046+28]..[518,12046+29])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[518,12046+33]..[518,12046+39])
                                    Pexp_construct "Some" (testsuite/tests/typing-gadts/test.ml[518,12046+33]..[518,12046+37])
                                    Some
                                      expression (testsuite/tests/typing-gadts/test.ml[518,12046+38]..[518,12046+39])
                                        Pexp_constant PConst_int (1,None)
                              ]
                            expression (testsuite/tests/typing-gadts/test.ml[518,12046+41]..[518,12046+48])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/test.ml[518,12046+43]..[518,12046+45])
                                Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[518,12046+43]..[518,12046+45])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[518,12046+41]..[518,12046+42])
                                    Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[518,12046+41]..[518,12046+42])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[518,12046+46]..[518,12046+48])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/test.ml[518,12046+46]..[518,12046+47])
                                      Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[518,12046+46]..[518,12046+47])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/test.ml[518,12046+47]..[518,12046+48])
                                          Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[518,12046+47]..[518,12046+48])
                                    ]
                              ]
                      ]
                    expression (testsuite/tests/typing-gadts/test.ml[519,12100+2]..[519,12100+4])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[519,12100+2]..[519,12100+3])
                        Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[519,12100+2]..[519,12100+3])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[519,12100+3]..[519,12100+4])
                            Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[519,12100+3]..[519,12100+4])
                      ]
            core_type (testsuite/tests/typing-gadts/test.ml[515,11940+20]..[515,11940+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[515,11940+20]..[515,11940+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[515,11940+22]..[515,11940+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[515,11940+20]..[515,11940+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[515,11940+20]..[515,11940+21])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[515,11940+27]..[515,11940+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[515,11940+29]..[515,11940+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[515,11940+27]..[515,11940+28])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[515,11940+27]..[515,11940+28])
                    []
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[521,12135+0]..[523,12185+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[521,12135+9]..[523,12185+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[521,12135+9]..[523,12185+2])
          Pexp_constant PConst_string ("\nval test2 : 'a t -> 'a option = <fun>\n",(testsuite/tests/typing-gadts/test.ml[521,12135+11]..[523,12185+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[525,12192+0]..[529,12352+4])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[525,12192+4]..[525,12192+35]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[525,12192+4]..[525,12192+9])
            Ppat_var "test2" (testsuite/tests/typing-gadts/test.ml[525,12192+4]..[525,12192+9])
          core_type (testsuite/tests/typing-gadts/test.ml[525,12192+4]..[529,12352+4]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[525,12192+20]..[525,12192+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[525,12192+20]..[525,12192+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[525,12192+22]..[525,12192+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[525,12192+20]..[525,12192+21])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[525,12192+27]..[525,12192+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[525,12192+29]..[525,12192+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[525,12192+27]..[525,12192+28])
                    Ptyp_var a
                ]
        expression (testsuite/tests/typing-gadts/test.ml[525,12192+4]..[529,12352+4])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[525,12192+4]..[529,12352+4])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[525,12192+38]..[529,12352+4])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[525,12192+42]..[525,12192+43])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[525,12192+42]..[525,12192+43])
              expression (testsuite/tests/typing-gadts/test.ml[526,12239+2]..[529,12352+4])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[526,12239+6]..[526,12239+22]) ghost
                      Ppat_constraint
                      pattern (testsuite/tests/typing-gadts/test.ml[526,12239+6]..[526,12239+7])
                        Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[526,12239+6]..[526,12239+7])
                      core_type (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+22]) ghost
                        Ptyp_poly
                        core_type (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+22])
                          Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[526,12239+19]..[526,12239+22])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+18])
                              Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[526,12239+12]..[526,12239+18])
                              [
                                core_type (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+11])
                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+11])
                                  []
                              ]
                          ]
                    expression (testsuite/tests/typing-gadts/test.ml[526,12239+6]..[526,12239+33])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/test.ml[526,12239+25]..[526,12239+33])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[526,12239+25]..[526,12239+28])
                          Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[526,12239+25]..[526,12239+28])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[526,12239+29]..[526,12239+33])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[526,12239+29]..[526,12239+33])
                              None
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+22])
                        Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[526,12239+19]..[526,12239+22])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+18])
                            Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[526,12239+12]..[526,12239+18])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+11])
                                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[526,12239+10]..[526,12239+11])
                                []
                            ]
                        ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[527,12276+2]..[529,12352+4])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[527,12276+6]..[527,12276+7])
                        Ppat_var "u" (testsuite/tests/typing-gadts/test.ml[527,12276+6]..[527,12276+7])
                      expression (testsuite/tests/typing-gadts/test.ml[527,12276+10]..[527,12276+18])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[527,12276+10]..[527,12276+13])
                          Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[527,12276+10]..[527,12276+13])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[527,12276+14]..[527,12276+18])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[527,12276+14]..[527,12276+18])
                              None
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[528,12298+2]..[529,12352+4])
                    Pexp_sequence
                    expression (testsuite/tests/typing-gadts/test.ml[528,12298+2]..[528,12298+52])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[528,12298+14]..[528,12298+15])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[528,12298+14]..[528,12298+15])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[528,12298+21]..[528,12298+24])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[528,12298+21]..[528,12298+24])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[528,12298+28]..[528,12298+48])
                            Pexp_sequence
                            expression (testsuite/tests/typing-gadts/test.ml[528,12298+28]..[528,12298+39])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/test.ml[528,12298+30]..[528,12298+32])
                                Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[528,12298+30]..[528,12298+32])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[528,12298+28]..[528,12298+29])
                                    Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[528,12298+28]..[528,12298+29])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[528,12298+33]..[528,12298+39])
                                    Pexp_construct "Some" (testsuite/tests/typing-gadts/test.ml[528,12298+33]..[528,12298+37])
                                    Some
                                      expression (testsuite/tests/typing-gadts/test.ml[528,12298+38]..[528,12298+39])
                                        Pexp_constant PConst_int (1,None)
                              ]
                            expression (testsuite/tests/typing-gadts/test.ml[528,12298+41]..[528,12298+48])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/test.ml[528,12298+43]..[528,12298+45])
                                Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[528,12298+43]..[528,12298+45])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[528,12298+41]..[528,12298+42])
                                    Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[528,12298+41]..[528,12298+42])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[528,12298+46]..[528,12298+48])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/test.ml[528,12298+46]..[528,12298+47])
                                      Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[528,12298+46]..[528,12298+47])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/test.ml[528,12298+47]..[528,12298+48])
                                          Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[528,12298+47]..[528,12298+48])
                                    ]
                              ]
                      ]
                    expression (testsuite/tests/typing-gadts/test.ml[529,12352+2]..[529,12352+4])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[529,12352+2]..[529,12352+3])
                        Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[529,12352+2]..[529,12352+3])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[529,12352+3]..[529,12352+4])
                            Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[529,12352+3]..[529,12352+4])
                      ]
            core_type (testsuite/tests/typing-gadts/test.ml[525,12192+20]..[525,12192+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[525,12192+20]..[525,12192+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[525,12192+22]..[525,12192+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[525,12192+20]..[525,12192+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[525,12192+20]..[525,12192+21])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[525,12192+27]..[525,12192+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[525,12192+29]..[525,12192+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[525,12192+27]..[525,12192+28])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[525,12192+27]..[525,12192+28])
                    []
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[531,12405+0]..[540,12795+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[531,12405+9]..[540,12795+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[531,12405+9]..[540,12795+2])
          Pexp_constant PConst_string ("\nLine 4, characters 46-48:\n4 |   begin match x with Int -> u := Some 1; r := !u end;\n                                                  ^^\nError: This expression has type int option\n       but an expression was expected of type a option\n       Type int is not compatible with type a = int\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[531,12405+11]..[540,12795+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[542,12802+0]..[546,12962+4])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[542,12802+4]..[542,12802+35]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[542,12802+4]..[542,12802+9])
            Ppat_var "test2" (testsuite/tests/typing-gadts/test.ml[542,12802+4]..[542,12802+9])
          core_type (testsuite/tests/typing-gadts/test.ml[542,12802+4]..[546,12962+4]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[542,12802+20]..[542,12802+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[542,12802+20]..[542,12802+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[542,12802+22]..[542,12802+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[542,12802+20]..[542,12802+21])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[542,12802+27]..[542,12802+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[542,12802+29]..[542,12802+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[542,12802+27]..[542,12802+28])
                    Ptyp_var a
                ]
        expression (testsuite/tests/typing-gadts/test.ml[542,12802+4]..[546,12962+4])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[542,12802+4]..[546,12962+4])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[542,12802+38]..[546,12962+4])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[542,12802+42]..[542,12802+43])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[542,12802+42]..[542,12802+43])
              expression (testsuite/tests/typing-gadts/test.ml[543,12849+2]..[546,12962+4])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[543,12849+6]..[543,12849+7])
                      Ppat_var "u" (testsuite/tests/typing-gadts/test.ml[543,12849+6]..[543,12849+7])
                    expression (testsuite/tests/typing-gadts/test.ml[543,12849+10]..[543,12849+18])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[543,12849+10]..[543,12849+13])
                        Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[543,12849+10]..[543,12849+13])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[543,12849+14]..[543,12849+18])
                            Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[543,12849+14]..[543,12849+18])
                            None
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[544,12871+2]..[546,12962+4])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[544,12871+6]..[544,12871+22]) ghost
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/test.ml[544,12871+6]..[544,12871+7])
                          Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[544,12871+6]..[544,12871+7])
                        core_type (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+22]) ghost
                          Ptyp_poly
                          core_type (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+22])
                            Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[544,12871+19]..[544,12871+22])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+18])
                                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[544,12871+12]..[544,12871+18])
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+11])
                                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+11])
                                    []
                                ]
                            ]
                      expression (testsuite/tests/typing-gadts/test.ml[544,12871+6]..[544,12871+33])
                        Pexp_constraint
                        expression (testsuite/tests/typing-gadts/test.ml[544,12871+25]..[544,12871+33])
                          Pexp_apply
                          expression (testsuite/tests/typing-gadts/test.ml[544,12871+25]..[544,12871+28])
                            Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[544,12871+25]..[544,12871+28])
                          [
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/test.ml[544,12871+29]..[544,12871+33])
                                Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[544,12871+29]..[544,12871+33])
                                None
                          ]
                        core_type (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+22])
                          Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[544,12871+19]..[544,12871+22])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+18])
                              Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[544,12871+12]..[544,12871+18])
                              [
                                core_type (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+11])
                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[544,12871+10]..[544,12871+11])
                                  []
                              ]
                          ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[545,12908+2]..[546,12962+4])
                    Pexp_sequence
                    expression (testsuite/tests/typing-gadts/test.ml[545,12908+2]..[545,12908+52])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[545,12908+14]..[545,12908+15])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[545,12908+14]..[545,12908+15])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[545,12908+21]..[545,12908+24])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[545,12908+21]..[545,12908+24])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[545,12908+28]..[545,12908+48])
                            Pexp_sequence
                            expression (testsuite/tests/typing-gadts/test.ml[545,12908+28]..[545,12908+39])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/test.ml[545,12908+30]..[545,12908+32])
                                Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[545,12908+30]..[545,12908+32])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[545,12908+28]..[545,12908+29])
                                    Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[545,12908+28]..[545,12908+29])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[545,12908+33]..[545,12908+39])
                                    Pexp_construct "Some" (testsuite/tests/typing-gadts/test.ml[545,12908+33]..[545,12908+37])
                                    Some
                                      expression (testsuite/tests/typing-gadts/test.ml[545,12908+38]..[545,12908+39])
                                        Pexp_constant PConst_int (1,None)
                              ]
                            expression (testsuite/tests/typing-gadts/test.ml[545,12908+41]..[545,12908+48])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/test.ml[545,12908+43]..[545,12908+45])
                                Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[545,12908+43]..[545,12908+45])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[545,12908+41]..[545,12908+42])
                                    Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[545,12908+41]..[545,12908+42])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/test.ml[545,12908+46]..[545,12908+48])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/test.ml[545,12908+46]..[545,12908+47])
                                      Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[545,12908+46]..[545,12908+47])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/test.ml[545,12908+47]..[545,12908+48])
                                          Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[545,12908+47]..[545,12908+48])
                                    ]
                              ]
                      ]
                    expression (testsuite/tests/typing-gadts/test.ml[546,12962+2]..[546,12962+4])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[546,12962+2]..[546,12962+3])
                        Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[546,12962+2]..[546,12962+3])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[546,12962+3]..[546,12962+4])
                            Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[546,12962+3]..[546,12962+4])
                      ]
            core_type (testsuite/tests/typing-gadts/test.ml[542,12802+20]..[542,12802+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[542,12802+20]..[542,12802+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[542,12802+22]..[542,12802+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[542,12802+20]..[542,12802+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[542,12802+20]..[542,12802+21])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[542,12802+27]..[542,12802+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[542,12802+29]..[542,12802+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[542,12802+27]..[542,12802+28])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[542,12802+27]..[542,12802+28])
                    []
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[548,12979+0]..[550,13029+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[548,12979+9]..[550,13029+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[548,12979+9]..[550,13029+2])
          Pexp_constant PConst_string ("\nval test2 : 'a t -> 'a option = <fun>\n",(testsuite/tests/typing-gadts/test.ml[548,12979+11]..[550,13029+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[552,13036+0]..[558,13217+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[552,13036+4]..[552,13036+35]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[552,13036+4]..[552,13036+9])
            Ppat_var "test2" (testsuite/tests/typing-gadts/test.ml[552,13036+4]..[552,13036+9])
          core_type (testsuite/tests/typing-gadts/test.ml[552,13036+4]..[558,13217+6]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[552,13036+20]..[552,13036+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[552,13036+20]..[552,13036+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[552,13036+22]..[552,13036+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[552,13036+20]..[552,13036+21])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[552,13036+27]..[552,13036+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[552,13036+29]..[552,13036+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[552,13036+27]..[552,13036+28])
                    Ptyp_var a
                ]
        expression (testsuite/tests/typing-gadts/test.ml[552,13036+4]..[558,13217+6])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[552,13036+4]..[558,13217+6])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[552,13036+38]..[558,13217+6])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[552,13036+42]..[552,13036+43])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[552,13036+42]..[552,13036+43])
              expression (testsuite/tests/typing-gadts/test.ml[553,13083+2]..[558,13217+6])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[553,13083+6]..[553,13083+7])
                      Ppat_var "u" (testsuite/tests/typing-gadts/test.ml[553,13083+6]..[553,13083+7])
                    expression (testsuite/tests/typing-gadts/test.ml[553,13083+10]..[553,13083+18])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[553,13083+10]..[553,13083+13])
                        Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[553,13083+10]..[553,13083+13])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[553,13083+14]..[553,13083+18])
                            Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[553,13083+14]..[553,13083+18])
                            None
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[554,13105+2]..[558,13217+6])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[554,13105+6]..[554,13105+7])
                        Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[554,13105+6]..[554,13105+7])
                      expression (testsuite/tests/typing-gadts/test.ml[555,13115+4]..[557,13210+6])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (testsuite/tests/typing-gadts/test.ml[555,13115+8]..[555,13115+24]) ghost
                              Ppat_constraint
                              pattern (testsuite/tests/typing-gadts/test.ml[555,13115+8]..[555,13115+9])
                                Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[555,13115+8]..[555,13115+9])
                              core_type (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+24]) ghost
                                Ptyp_poly
                                core_type (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+24])
                                  Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[555,13115+21]..[555,13115+24])
                                  [
                                    core_type (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+20])
                                      Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[555,13115+14]..[555,13115+20])
                                      [
                                        core_type (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+13])
                                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+13])
                                          []
                                      ]
                                  ]
                            expression (testsuite/tests/typing-gadts/test.ml[555,13115+8]..[555,13115+35])
                              Pexp_constraint
                              expression (testsuite/tests/typing-gadts/test.ml[555,13115+27]..[555,13115+35])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/test.ml[555,13115+27]..[555,13115+30])
                                  Pexp_ident "ref" (testsuite/tests/typing-gadts/test.ml[555,13115+27]..[555,13115+30])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/test.ml[555,13115+31]..[555,13115+35])
                                      Pexp_construct "None" (testsuite/tests/typing-gadts/test.ml[555,13115+31]..[555,13115+35])
                                      None
                                ]
                              core_type (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+24])
                                Ptyp_constr "ref" (testsuite/tests/typing-gadts/test.ml[555,13115+21]..[555,13115+24])
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+20])
                                    Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[555,13115+14]..[555,13115+20])
                                    [
                                      core_type (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+13])
                                        Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[555,13115+12]..[555,13115+13])
                                        []
                                    ]
                                ]
                        ]
                        expression (testsuite/tests/typing-gadts/test.ml[556,13154+4]..[557,13210+6])
                          Pexp_sequence
                          expression (testsuite/tests/typing-gadts/test.ml[556,13154+4]..[556,13154+54])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/test.ml[556,13154+16]..[556,13154+17])
                              Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[556,13154+16]..[556,13154+17])
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/test.ml[556,13154+23]..[556,13154+26])
                                  Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[556,13154+23]..[556,13154+26])
                                  None
                                expression (testsuite/tests/typing-gadts/test.ml[556,13154+30]..[556,13154+50])
                                  Pexp_sequence
                                  expression (testsuite/tests/typing-gadts/test.ml[556,13154+30]..[556,13154+41])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/test.ml[556,13154+32]..[556,13154+34])
                                      Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[556,13154+32]..[556,13154+34])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/test.ml[556,13154+30]..[556,13154+31])
                                          Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[556,13154+30]..[556,13154+31])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/test.ml[556,13154+35]..[556,13154+41])
                                          Pexp_construct "Some" (testsuite/tests/typing-gadts/test.ml[556,13154+35]..[556,13154+39])
                                          Some
                                            expression (testsuite/tests/typing-gadts/test.ml[556,13154+40]..[556,13154+41])
                                              Pexp_constant PConst_int (1,None)
                                    ]
                                  expression (testsuite/tests/typing-gadts/test.ml[556,13154+43]..[556,13154+50])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/test.ml[556,13154+45]..[556,13154+47])
                                      Pexp_ident ":=" (testsuite/tests/typing-gadts/test.ml[556,13154+45]..[556,13154+47])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/test.ml[556,13154+43]..[556,13154+44])
                                          Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[556,13154+43]..[556,13154+44])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/test.ml[556,13154+48]..[556,13154+50])
                                          Pexp_apply
                                          expression (testsuite/tests/typing-gadts/test.ml[556,13154+48]..[556,13154+49])
                                            Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[556,13154+48]..[556,13154+49])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/test.ml[556,13154+49]..[556,13154+50])
                                                Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[556,13154+49]..[556,13154+50])
                                          ]
                                    ]
                            ]
                          expression (testsuite/tests/typing-gadts/test.ml[557,13210+4]..[557,13210+6])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[557,13210+4]..[557,13210+5])
                              Pexp_ident "!" (testsuite/tests/typing-gadts/test.ml[557,13210+4]..[557,13210+5])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[557,13210+5]..[557,13210+6])
                                  Pexp_ident "u" (testsuite/tests/typing-gadts/test.ml[557,13210+5]..[557,13210+6])
                            ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[558,13217+5]..[558,13217+6])
                    Pexp_ident "a" (testsuite/tests/typing-gadts/test.ml[558,13217+5]..[558,13217+6])
            core_type (testsuite/tests/typing-gadts/test.ml[552,13036+20]..[552,13036+35])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[552,13036+20]..[552,13036+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[552,13036+22]..[552,13036+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[552,13036+20]..[552,13036+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[552,13036+20]..[552,13036+21])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[552,13036+27]..[552,13036+35])
                Ptyp_constr "option" (testsuite/tests/typing-gadts/test.ml[552,13036+29]..[552,13036+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[552,13036+27]..[552,13036+28])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[552,13036+27]..[552,13036+28])
                    []
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[560,13236+0]..[562,13286+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[560,13236+9]..[562,13286+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[560,13236+9]..[562,13286+2])
          Pexp_constant PConst_string ("\nval test2 : 'a t -> 'a option = <fun>\n",(testsuite/tests/typing-gadts/test.ml[560,13236+11]..[562,13286+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[564,13293+0]..[564,13293+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[564,13293+4]..[564,13293+10])
          Ppat_var "either" (testsuite/tests/typing-gadts/test.ml[564,13293+4]..[564,13293+10])
        expression (testsuite/tests/typing-gadts/test.ml[564,13293+13]..[564,13293+15])
          Pexp_ident "ky" (testsuite/tests/typing-gadts/test.ml[564,13293+13]..[564,13293+15])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[565,13309+0]..[566,13349+45])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[565,13309+4]..[565,13309+10])
          Ppat_var "we_y1x" (testsuite/tests/typing-gadts/test.ml[565,13309+4]..[565,13309+10])
        expression (testsuite/tests/typing-gadts/test.ml[565,13309+11]..[566,13349+45])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[565,13309+20]..[566,13349+45]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[565,13309+20]..[565,13309+27])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[565,13309+21]..[565,13309+22])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[565,13309+21]..[565,13309+22])
              core_type (testsuite/tests/typing-gadts/test.ml[565,13309+25]..[565,13309+26])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[565,13309+25]..[565,13309+26])
                []
            expression (testsuite/tests/typing-gadts/test.ml[565,13309+28]..[566,13349+45]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[565,13309+28]..[565,13309+37])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[565,13309+29]..[565,13309+30])
                  Ppat_var "v" (testsuite/tests/typing-gadts/test.ml[565,13309+29]..[565,13309+30])
                core_type (testsuite/tests/typing-gadts/test.ml[565,13309+33]..[565,13309+36])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[565,13309+35]..[565,13309+36])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[565,13309+33]..[565,13309+34])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[565,13309+33]..[565,13309+34])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[566,13349+2]..[566,13349+45])
                Pexp_match
                expression (testsuite/tests/typing-gadts/test.ml[566,13349+8]..[566,13349+9])
                  Pexp_ident "v" (testsuite/tests/typing-gadts/test.ml[566,13349+8]..[566,13349+9])
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[566,13349+15]..[566,13349+18])
                      Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[566,13349+15]..[566,13349+18])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[566,13349+22]..[566,13349+45])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (testsuite/tests/typing-gadts/test.ml[566,13349+26]..[566,13349+27])
                            Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[566,13349+26]..[566,13349+27])
                          expression (testsuite/tests/typing-gadts/test.ml[566,13349+30]..[566,13349+40])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[566,13349+30]..[566,13349+36])
                              Pexp_ident "either" (testsuite/tests/typing-gadts/test.ml[566,13349+30]..[566,13349+36])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[566,13349+37]..[566,13349+38])
                                  Pexp_constant PConst_int (1,None)
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[566,13349+39]..[566,13349+40])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[566,13349+39]..[566,13349+40])
                            ]
                      ]
                      expression (testsuite/tests/typing-gadts/test.ml[566,13349+44]..[566,13349+45])
                        Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[566,13349+44]..[566,13349+45])
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[568,13409+0]..[577,13763+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[568,13409+9]..[577,13763+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[568,13409+9]..[577,13763+2])
          Pexp_constant PConst_string ("\nval either : 'a -> 'a -> 'a = <fun>\nLine 3, characters 44-45:\n3 |   match v with Int -> let y = either 1 x in y\n                                                ^\nError: This expression has type a = int\n       but an expression was expected of type 'a\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[568,13409+11]..[577,13763+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[580,13806+0]..[583,13903+3])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[580,13806+4]..[580,13806+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[580,13806+4]..[580,13806+5])
        expression (testsuite/tests/typing-gadts/test.ml[580,13806+6]..[583,13903+3])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[580,13806+15]..[583,13903+3]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[580,13806+15]..[580,13806+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[580,13806+16]..[580,13806+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[580,13806+16]..[580,13806+17])
              core_type (testsuite/tests/typing-gadts/test.ml[580,13806+20]..[580,13806+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[580,13806+22]..[580,13806+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[580,13806+20]..[580,13806+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[580,13806+20]..[580,13806+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[580,13806+25]..[583,13903+3]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[580,13806+25]..[580,13806+26])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[580,13806+25]..[580,13806+26])
              expression (testsuite/tests/typing-gadts/test.ml[581,13835+2]..[583,13903+3])
                Pexp_sequence
                expression (testsuite/tests/typing-gadts/test.ml[581,13835+2]..[581,13835+16])
                  Pexp_apply
                  expression (testsuite/tests/typing-gadts/test.ml[581,13835+2]..[581,13835+8])
                    Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[581,13835+2]..[581,13835+8])
                  [
                    <arg>
                    Nolabel
                      expression (testsuite/tests/typing-gadts/test.ml[581,13835+9]..[581,13835+16])
                        Pexp_constraint
                        expression (testsuite/tests/typing-gadts/test.ml[581,13835+10]..[581,13835+11])
                          Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[581,13835+10]..[581,13835+11])
                        core_type (testsuite/tests/typing-gadts/test.ml[581,13835+14]..[581,13835+15])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[581,13835+14]..[581,13835+15])
                          []
                  ]
                expression (testsuite/tests/typing-gadts/test.ml[582,13853+2]..[583,13903+3])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[582,13853+6]..[582,13853+7])
                        Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[582,13853+6]..[582,13853+7])
                      expression (testsuite/tests/typing-gadts/test.ml[582,13853+10]..[582,13853+37])
                        Pexp_match
                        expression (testsuite/tests/typing-gadts/test.ml[582,13853+16]..[582,13853+17])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[582,13853+16]..[582,13853+17])
                        [
                          <case>
                            pattern (testsuite/tests/typing-gadts/test.ml[582,13853+23]..[582,13853+26])
                              Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[582,13853+23]..[582,13853+26])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[582,13853+30]..[582,13853+37])
                              Pexp_constraint
                              expression (testsuite/tests/typing-gadts/test.ml[582,13853+31]..[582,13853+32])
                                Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[582,13853+31]..[582,13853+32])
                              core_type (testsuite/tests/typing-gadts/test.ml[582,13853+35]..[582,13853+36])
                                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[582,13853+35]..[582,13853+36])
                                []
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[583,13903+2]..[583,13903+3])
                    Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[583,13903+2]..[583,13903+3])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[585,13910+0]..[587,13955+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[585,13910+9]..[587,13955+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[585,13910+9]..[587,13955+2])
          Pexp_constant PConst_string ("\nval f : 'a t -> 'a -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[585,13910+11]..[587,13955+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[589,13962+0]..[592,14059+3])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[589,13962+4]..[589,13962+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[589,13962+4]..[589,13962+5])
        expression (testsuite/tests/typing-gadts/test.ml[589,13962+6]..[592,14059+3])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[589,13962+15]..[592,14059+3]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[589,13962+15]..[589,13962+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[589,13962+16]..[589,13962+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[589,13962+16]..[589,13962+17])
              core_type (testsuite/tests/typing-gadts/test.ml[589,13962+20]..[589,13962+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[589,13962+22]..[589,13962+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[589,13962+20]..[589,13962+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[589,13962+20]..[589,13962+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[589,13962+25]..[592,14059+3]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[589,13962+25]..[589,13962+26])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[589,13962+25]..[589,13962+26])
              expression (testsuite/tests/typing-gadts/test.ml[590,13991+2]..[592,14059+3])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[590,13991+6]..[590,13991+7])
                      Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[590,13991+6]..[590,13991+7])
                    expression (testsuite/tests/typing-gadts/test.ml[590,13991+10]..[590,13991+37])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[590,13991+16]..[590,13991+17])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[590,13991+16]..[590,13991+17])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[590,13991+23]..[590,13991+26])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[590,13991+23]..[590,13991+26])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[590,13991+30]..[590,13991+37])
                            Pexp_constraint
                            expression (testsuite/tests/typing-gadts/test.ml[590,13991+31]..[590,13991+32])
                              Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[590,13991+31]..[590,13991+32])
                            core_type (testsuite/tests/typing-gadts/test.ml[590,13991+35]..[590,13991+36])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[590,13991+35]..[590,13991+36])
                              []
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[591,14032+2]..[592,14059+3])
                  Pexp_sequence
                  expression (testsuite/tests/typing-gadts/test.ml[591,14032+2]..[591,14032+16])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[591,14032+2]..[591,14032+8])
                      Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[591,14032+2]..[591,14032+8])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[591,14032+9]..[591,14032+16])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/test.ml[591,14032+10]..[591,14032+11])
                            Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[591,14032+10]..[591,14032+11])
                          core_type (testsuite/tests/typing-gadts/test.ml[591,14032+14]..[591,14032+15])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[591,14032+14]..[591,14032+15])
                            []
                    ]
                  expression (testsuite/tests/typing-gadts/test.ml[592,14059+2]..[592,14059+3])
                    Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[592,14059+2]..[592,14059+3])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[594,14066+0]..[596,14111+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[594,14066+9]..[596,14111+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[594,14066+9]..[596,14111+2])
          Pexp_constant PConst_string ("\nval f : 'a t -> 'a -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[594,14066+11]..[596,14111+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[598,14118+0]..[601,14209+3])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[598,14118+4]..[598,14118+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[598,14118+4]..[598,14118+5])
        expression (testsuite/tests/typing-gadts/test.ml[598,14118+6]..[601,14209+3])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[598,14118+15]..[601,14209+3]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[598,14118+15]..[598,14118+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[598,14118+16]..[598,14118+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[598,14118+16]..[598,14118+17])
              core_type (testsuite/tests/typing-gadts/test.ml[598,14118+20]..[598,14118+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[598,14118+22]..[598,14118+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[598,14118+20]..[598,14118+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[598,14118+20]..[598,14118+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[598,14118+25]..[601,14209+3]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[598,14118+25]..[598,14118+26])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[598,14118+25]..[598,14118+26])
              expression (testsuite/tests/typing-gadts/test.ml[599,14147+2]..[601,14209+3])
                Pexp_sequence
                expression (testsuite/tests/typing-gadts/test.ml[599,14147+2]..[599,14147+16])
                  Pexp_apply
                  expression (testsuite/tests/typing-gadts/test.ml[599,14147+2]..[599,14147+8])
                    Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[599,14147+2]..[599,14147+8])
                  [
                    <arg>
                    Nolabel
                      expression (testsuite/tests/typing-gadts/test.ml[599,14147+9]..[599,14147+16])
                        Pexp_constraint
                        expression (testsuite/tests/typing-gadts/test.ml[599,14147+10]..[599,14147+11])
                          Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[599,14147+10]..[599,14147+11])
                        core_type (testsuite/tests/typing-gadts/test.ml[599,14147+14]..[599,14147+15])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[599,14147+14]..[599,14147+15])
                          []
                  ]
                expression (testsuite/tests/typing-gadts/test.ml[600,14165+2]..[601,14209+3])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[600,14165+6]..[600,14165+7])
                        Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[600,14165+6]..[600,14165+7])
                      expression (testsuite/tests/typing-gadts/test.ml[600,14165+10]..[600,14165+31])
                        Pexp_match
                        expression (testsuite/tests/typing-gadts/test.ml[600,14165+16]..[600,14165+17])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[600,14165+16]..[600,14165+17])
                        [
                          <case>
                            pattern (testsuite/tests/typing-gadts/test.ml[600,14165+23]..[600,14165+26])
                              Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[600,14165+23]..[600,14165+26])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[600,14165+30]..[600,14165+31])
                              Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[600,14165+30]..[600,14165+31])
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[601,14209+2]..[601,14209+3])
                    Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[601,14209+2]..[601,14209+3])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[603,14216+0]..[605,14261+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[603,14216+9]..[605,14261+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[603,14216+9]..[605,14261+2])
          Pexp_constant PConst_string ("\nval f : 'a t -> 'a -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[603,14216+11]..[605,14261+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[607,14268+0]..[610,14359+3])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[607,14268+4]..[607,14268+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[607,14268+4]..[607,14268+5])
        expression (testsuite/tests/typing-gadts/test.ml[607,14268+6]..[610,14359+3])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[607,14268+15]..[610,14359+3]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[607,14268+15]..[607,14268+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[607,14268+16]..[607,14268+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[607,14268+16]..[607,14268+17])
              core_type (testsuite/tests/typing-gadts/test.ml[607,14268+20]..[607,14268+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[607,14268+22]..[607,14268+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[607,14268+20]..[607,14268+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[607,14268+20]..[607,14268+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[607,14268+25]..[610,14359+3]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[607,14268+25]..[607,14268+26])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[607,14268+25]..[607,14268+26])
              expression (testsuite/tests/typing-gadts/test.ml[608,14297+2]..[610,14359+3])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[608,14297+6]..[608,14297+7])
                      Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[608,14297+6]..[608,14297+7])
                    expression (testsuite/tests/typing-gadts/test.ml[608,14297+10]..[608,14297+31])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/test.ml[608,14297+16]..[608,14297+17])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[608,14297+16]..[608,14297+17])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/test.ml[608,14297+23]..[608,14297+26])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[608,14297+23]..[608,14297+26])
                            None
                          expression (testsuite/tests/typing-gadts/test.ml[608,14297+30]..[608,14297+31])
                            Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[608,14297+30]..[608,14297+31])
                      ]
                ]
                expression (testsuite/tests/typing-gadts/test.ml[609,14332+2]..[610,14359+3])
                  Pexp_sequence
                  expression (testsuite/tests/typing-gadts/test.ml[609,14332+2]..[609,14332+16])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[609,14332+2]..[609,14332+8])
                      Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[609,14332+2]..[609,14332+8])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[609,14332+9]..[609,14332+16])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/test.ml[609,14332+10]..[609,14332+11])
                            Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[609,14332+10]..[609,14332+11])
                          core_type (testsuite/tests/typing-gadts/test.ml[609,14332+14]..[609,14332+15])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[609,14332+14]..[609,14332+15])
                            []
                    ]
                  expression (testsuite/tests/typing-gadts/test.ml[610,14359+2]..[610,14359+3])
                    Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[610,14359+2]..[610,14359+3])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[612,14366+0]..[614,14411+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[612,14366+9]..[614,14411+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[612,14366+9]..[614,14411+2])
          Pexp_constant PConst_string ("\nval f : 'a t -> 'a -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[612,14366+11]..[614,14411+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[616,14418+0]..[617,14453+23])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[616,14418+4]..[616,14418+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[616,14418+4]..[616,14418+5])
        expression (testsuite/tests/typing-gadts/test.ml[616,14418+6]..[617,14453+23])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[616,14418+15]..[617,14453+23]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[616,14418+15]..[616,14418+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[616,14418+16]..[616,14418+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[616,14418+16]..[616,14418+17])
              core_type (testsuite/tests/typing-gadts/test.ml[616,14418+20]..[616,14418+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[616,14418+22]..[616,14418+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[616,14418+20]..[616,14418+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[616,14418+20]..[616,14418+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[616,14418+25]..[617,14453+23]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[616,14418+25]..[616,14418+32])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[616,14418+26]..[616,14418+27])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[616,14418+26]..[616,14418+27])
                core_type (testsuite/tests/typing-gadts/test.ml[616,14418+30]..[616,14418+31])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[616,14418+30]..[616,14418+31])
                  []
              expression (testsuite/tests/typing-gadts/test.ml[617,14453+2]..[617,14453+23])
                Pexp_match
                expression (testsuite/tests/typing-gadts/test.ml[617,14453+8]..[617,14453+9])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[617,14453+8]..[617,14453+9])
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[617,14453+15]..[617,14453+18])
                      Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[617,14453+15]..[617,14453+18])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[617,14453+22]..[617,14453+23])
                      Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[617,14453+22]..[617,14453+23])
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[619,14497+0]..[621,14542+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[619,14497+9]..[621,14542+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[619,14497+9]..[621,14542+2])
          Pexp_constant PConst_string ("\nval f : 'a t -> 'a -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[619,14497+11]..[621,14542+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[625,14587+0]..[628,14695+10])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[625,14587+4]..[625,14587+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[625,14587+4]..[625,14587+5])
        expression (testsuite/tests/typing-gadts/test.ml[625,14587+6]..[628,14695+10])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[625,14587+15]..[628,14695+10]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[625,14587+15]..[625,14587+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[625,14587+16]..[625,14587+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[625,14587+16]..[625,14587+17])
              core_type (testsuite/tests/typing-gadts/test.ml[625,14587+20]..[625,14587+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[625,14587+22]..[625,14587+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[625,14587+20]..[625,14587+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[625,14587+20]..[625,14587+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[625,14587+25]..[628,14695+10]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[625,14587+25]..[625,14587+26])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[625,14587+25]..[625,14587+26])
              expression (testsuite/tests/typing-gadts/test.ml[626,14616+2]..[628,14695+10])
                Pexp_match
                expression (testsuite/tests/typing-gadts/test.ml[626,14616+8]..[626,14616+9])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[626,14616+8]..[626,14616+9])
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[626,14616+15]..[626,14616+18])
                      Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[626,14616+15]..[626,14616+18])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[627,14638+4]..[628,14695+10])
                      Pexp_letmodule "M" (testsuite/tests/typing-gadts/test.ml[627,14638+15]..[627,14638+16])
                      module_expr (testsuite/tests/typing-gadts/test.ml[627,14638+19]..[627,14638+56])
                        Pmod_structure
                        [
                          structure_item (testsuite/tests/typing-gadts/test.ml[627,14638+26]..[627,14638+36])
                            Pstr_type Rec
                            [
                              type_declaration "b" (testsuite/tests/typing-gadts/test.ml[627,14638+31]..[627,14638+32]) (testsuite/tests/typing-gadts/test.ml[627,14638+26]..[627,14638+36])
                                ptype_params =
                                  []
                                ptype_cstrs =
                                  []
                                ptype_kind =
                                  Ptype_abstract
                                ptype_private = Public
                                ptype_manifest =
                                  Some
                                    core_type (testsuite/tests/typing-gadts/test.ml[627,14638+35]..[627,14638+36])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[627,14638+35]..[627,14638+36])
                                      []
                            ]
                          structure_item (testsuite/tests/typing-gadts/test.ml[627,14638+37]..[627,14638+52])
                            Pstr_value Nonrec
                            [
                              <def>
                                pattern (testsuite/tests/typing-gadts/test.ml[627,14638+41]..[627,14638+42])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[627,14638+41]..[627,14638+42])
                                expression (testsuite/tests/typing-gadts/test.ml[627,14638+45]..[627,14638+52])
                                  Pexp_constraint
                                  expression (testsuite/tests/typing-gadts/test.ml[627,14638+46]..[627,14638+47])
                                    Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[627,14638+46]..[627,14638+47])
                                  core_type (testsuite/tests/typing-gadts/test.ml[627,14638+50]..[627,14638+51])
                                    Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[627,14638+50]..[627,14638+51])
                                    []
                            ]
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[628,14695+7]..[628,14695+10])
                        Pexp_ident "M.z" (testsuite/tests/typing-gadts/test.ml[628,14695+7]..[628,14695+10])
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[630,14744+0]..[638,15080+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[630,14744+9]..[638,15080+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[630,14744+9]..[638,15080+2])
          Pexp_constant PConst_string ("\nLine 3, characters 46-47:\n3 |     let module M = struct type b = a let z = (y : b) end\n                                                  ^\nError: This expression has type a = int\n       but an expression was expected of type b = int\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[630,14744+11]..[638,15080+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[640,15087+0]..[643,15197+10])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[640,15087+4]..[640,15087+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[640,15087+4]..[640,15087+5])
        expression (testsuite/tests/typing-gadts/test.ml[640,15087+6]..[643,15197+10])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[640,15087+15]..[643,15197+10]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[640,15087+15]..[640,15087+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[640,15087+16]..[640,15087+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[640,15087+16]..[640,15087+17])
              core_type (testsuite/tests/typing-gadts/test.ml[640,15087+20]..[640,15087+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[640,15087+22]..[640,15087+23])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[640,15087+20]..[640,15087+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[640,15087+20]..[640,15087+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[640,15087+25]..[643,15197+10]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[640,15087+25]..[640,15087+26])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[640,15087+25]..[640,15087+26])
              expression (testsuite/tests/typing-gadts/test.ml[641,15116+2]..[643,15197+10])
                Pexp_match
                expression (testsuite/tests/typing-gadts/test.ml[641,15116+8]..[641,15116+9])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[641,15116+8]..[641,15116+9])
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[641,15116+15]..[641,15116+18])
                      Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[641,15116+15]..[641,15116+18])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[642,15138+4]..[643,15197+10])
                      Pexp_letmodule "M" (testsuite/tests/typing-gadts/test.ml[642,15138+15]..[642,15138+16])
                      module_expr (testsuite/tests/typing-gadts/test.ml[642,15138+19]..[642,15138+58])
                        Pmod_structure
                        [
                          structure_item (testsuite/tests/typing-gadts/test.ml[642,15138+26]..[642,15138+38])
                            Pstr_type Rec
                            [
                              type_declaration "b" (testsuite/tests/typing-gadts/test.ml[642,15138+31]..[642,15138+32]) (testsuite/tests/typing-gadts/test.ml[642,15138+26]..[642,15138+38])
                                ptype_params =
                                  []
                                ptype_cstrs =
                                  []
                                ptype_kind =
                                  Ptype_abstract
                                ptype_private = Public
                                ptype_manifest =
                                  Some
                                    core_type (testsuite/tests/typing-gadts/test.ml[642,15138+35]..[642,15138+38])
                                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[642,15138+35]..[642,15138+38])
                                      []
                            ]
                          structure_item (testsuite/tests/typing-gadts/test.ml[642,15138+39]..[642,15138+54])
                            Pstr_value Nonrec
                            [
                              <def>
                                pattern (testsuite/tests/typing-gadts/test.ml[642,15138+43]..[642,15138+44])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[642,15138+43]..[642,15138+44])
                                expression (testsuite/tests/typing-gadts/test.ml[642,15138+47]..[642,15138+54])
                                  Pexp_constraint
                                  expression (testsuite/tests/typing-gadts/test.ml[642,15138+48]..[642,15138+49])
                                    Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[642,15138+48]..[642,15138+49])
                                  core_type (testsuite/tests/typing-gadts/test.ml[642,15138+52]..[642,15138+53])
                                    Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[642,15138+52]..[642,15138+53])
                                    []
                            ]
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[643,15197+7]..[643,15197+10])
                        Pexp_ident "M.z" (testsuite/tests/typing-gadts/test.ml[643,15197+7]..[643,15197+10])
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[645,15220+0]..[647,15267+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[645,15220+9]..[647,15267+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[645,15220+9]..[647,15267+2])
          Pexp_constant PConst_string ("\nval f : 'a t -> int -> int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[645,15220+11]..[647,15267+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[651,15302+0]..[653,15337+24])
    Pstr_type Rec
    [
      type_declaration "h" (testsuite/tests/typing-gadts/test.ml[651,15302+7]..[651,15302+8]) (testsuite/tests/typing-gadts/test.ml[651,15302+0]..[653,15337+24])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[651,15302+5]..[651,15302+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[652,15313+2]..[652,15313+23])
                "Has_m" (testsuite/tests/typing-gadts/test.ml[652,15313+4]..[652,15313+9])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[652,15313+12]..[652,15313+23])
                    Ptyp_constr "h" (testsuite/tests/typing-gadts/test.ml[652,15313+22]..[652,15313+23])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[652,15313+12]..[652,15313+21])
                        Ptyp_object Closed
                          method m
                            core_type (testsuite/tests/typing-gadts/test.ml[652,15313+17]..[652,15313+20])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[652,15313+17]..[652,15313+20])
                              []
                    ]
              (testsuite/tests/typing-gadts/test.ml[653,15337+2]..[653,15337+24])
                "Has_b" (testsuite/tests/typing-gadts/test.ml[653,15337+4]..[653,15337+9])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[653,15337+12]..[653,15337+24])
                    Ptyp_constr "h" (testsuite/tests/typing-gadts/test.ml[653,15337+23]..[653,15337+24])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[653,15337+12]..[653,15337+22])
                        Ptyp_object Closed
                          method b
                            core_type (testsuite/tests/typing-gadts/test.ml[653,15337+17]..[653,15337+21])
                              Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[653,15337+17]..[653,15337+21])
                              []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[655,15363+0]..[657,15436+39])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[655,15363+4]..[655,15363+24]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[655,15363+4]..[655,15363+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[655,15363+4]..[655,15363+5])
          core_type (testsuite/tests/typing-gadts/test.ml[655,15363+4]..[657,15436+39]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[655,15363+16]..[655,15363+24])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[655,15363+16]..[655,15363+19])
                Ptyp_constr "h" (testsuite/tests/typing-gadts/test.ml[655,15363+18]..[655,15363+19])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[655,15363+16]..[655,15363+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[655,15363+23]..[655,15363+24])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[655,15363+4]..[657,15436+39])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[655,15363+4]..[657,15436+39])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[655,15363+27]..[657,15436+39])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[656,15399+4]..[656,15399+9])
                    Ppat_construct "Has_m" (testsuite/tests/typing-gadts/test.ml[656,15399+4]..[656,15399+9])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[656,15399+13]..[656,15399+36])
                    Pexp_object
                    class_structure
                      pattern (testsuite/tests/typing-gadts/test.ml[656,15399+19]..[656,15399+19]) ghost
                        Ppat_any
                      [
                        class_field (testsuite/tests/typing-gadts/test.ml[656,15399+20]..[656,15399+32])
                          Pcf_method Public
                            "m" (testsuite/tests/typing-gadts/test.ml[656,15399+27]..[656,15399+28])
                            Concrete Fresh
                            expression (testsuite/tests/typing-gadts/test.ml[656,15399+31]..[656,15399+32]) ghost
                              Pexp_poly
                              expression (testsuite/tests/typing-gadts/test.ml[656,15399+31]..[656,15399+32])
                                Pexp_constant PConst_int (1,None)
                              None
                      ]
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[657,15436+4]..[657,15436+9])
                    Ppat_construct "Has_b" (testsuite/tests/typing-gadts/test.ml[657,15436+4]..[657,15436+9])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[657,15436+13]..[657,15436+39])
                    Pexp_object
                    class_structure
                      pattern (testsuite/tests/typing-gadts/test.ml[657,15436+19]..[657,15436+19]) ghost
                        Ppat_any
                      [
                        class_field (testsuite/tests/typing-gadts/test.ml[657,15436+20]..[657,15436+35])
                          Pcf_method Public
                            "b" (testsuite/tests/typing-gadts/test.ml[657,15436+27]..[657,15436+28])
                            Concrete Fresh
                            expression (testsuite/tests/typing-gadts/test.ml[657,15436+31]..[657,15436+35]) ghost
                              Pexp_poly
                              expression (testsuite/tests/typing-gadts/test.ml[657,15436+31]..[657,15436+35])
                                Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[657,15436+31]..[657,15436+35])
                                None
                              None
                      ]
              ]
            core_type (testsuite/tests/typing-gadts/test.ml[655,15363+16]..[655,15363+24])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[655,15363+16]..[655,15363+19])
                Ptyp_constr "h" (testsuite/tests/typing-gadts/test.ml[655,15363+18]..[655,15363+19])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[655,15363+16]..[655,15363+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[655,15363+16]..[655,15363+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[655,15363+23]..[655,15363+24])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[655,15363+23]..[655,15363+24])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[659,15479+0]..[662,15576+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[659,15479+9]..[662,15576+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[659,15479+9]..[662,15576+2])
          Pexp_constant PConst_string ("\ntype _ h = Has_m : < m : int > h | Has_b : < b : bool > h\nval f : 'a h -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[659,15479+11]..[662,15576+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[664,15583+0]..[666,15620+26])
    Pstr_type Rec
    [
      type_declaration "j" (testsuite/tests/typing-gadts/test.ml[664,15583+7]..[664,15583+8]) (testsuite/tests/typing-gadts/test.ml[664,15583+0]..[666,15620+26])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[664,15583+5]..[664,15583+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[665,15594+2]..[665,15594+25])
                "Has_A" (testsuite/tests/typing-gadts/test.ml[665,15594+4]..[665,15594+9])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[665,15594+12]..[665,15594+25])
                    Ptyp_constr "j" (testsuite/tests/typing-gadts/test.ml[665,15594+24]..[665,15594+25])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[665,15594+12]..[665,15594+23])
                        Ptyp_variant closed=Closed
                        [
                          Rtag "A" false
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[665,15594+19]..[665,15594+22])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[665,15594+19]..[665,15594+22])
                                []
                            ]
                        ]
                        None
                    ]
              (testsuite/tests/typing-gadts/test.ml[666,15620+2]..[666,15620+26])
                "Has_B" (testsuite/tests/typing-gadts/test.ml[666,15620+4]..[666,15620+9])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[666,15620+12]..[666,15620+26])
                    Ptyp_constr "j" (testsuite/tests/typing-gadts/test.ml[666,15620+25]..[666,15620+26])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[666,15620+12]..[666,15620+24])
                        Ptyp_variant closed=Closed
                        [
                          Rtag "B" false
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[666,15620+19]..[666,15620+23])
                                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[666,15620+19]..[666,15620+23])
                                []
                            ]
                        ]
                        None
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[668,15648+0]..[670,15702+20])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[668,15648+4]..[668,15648+24]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[668,15648+4]..[668,15648+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[668,15648+4]..[668,15648+5])
          core_type (testsuite/tests/typing-gadts/test.ml[668,15648+4]..[670,15702+20]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[668,15648+16]..[668,15648+24])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[668,15648+16]..[668,15648+19])
                Ptyp_constr "j" (testsuite/tests/typing-gadts/test.ml[668,15648+18]..[668,15648+19])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[668,15648+16]..[668,15648+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[668,15648+23]..[668,15648+24])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[668,15648+4]..[670,15702+20])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[668,15648+4]..[670,15702+20])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[668,15648+27]..[670,15702+20])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[669,15684+4]..[669,15684+9])
                    Ppat_construct "Has_A" (testsuite/tests/typing-gadts/test.ml[669,15684+4]..[669,15684+9])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[669,15684+13]..[669,15684+17])
                    Pexp_variant "A"
                    Some
                      expression (testsuite/tests/typing-gadts/test.ml[669,15684+16]..[669,15684+17])
                        Pexp_constant PConst_int (1,None)
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[670,15702+4]..[670,15702+9])
                    Ppat_construct "Has_B" (testsuite/tests/typing-gadts/test.ml[670,15702+4]..[670,15702+9])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[670,15702+13]..[670,15702+20])
                    Pexp_variant "B"
                    Some
                      expression (testsuite/tests/typing-gadts/test.ml[670,15702+16]..[670,15702+20])
                        Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[670,15702+16]..[670,15702+20])
                        None
              ]
            core_type (testsuite/tests/typing-gadts/test.ml[668,15648+16]..[668,15648+24])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[668,15648+16]..[668,15648+19])
                Ptyp_constr "j" (testsuite/tests/typing-gadts/test.ml[668,15648+18]..[668,15648+19])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[668,15648+16]..[668,15648+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[668,15648+16]..[668,15648+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[668,15648+23]..[668,15648+24])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[668,15648+23]..[668,15648+24])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[672,15726+0]..[675,15827+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[672,15726+9]..[675,15827+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[672,15726+9]..[675,15827+2])
          Pexp_constant PConst_string ("\ntype _ j = Has_A : [ `A of int ] j | Has_B : [ `B of bool ] j\nval f : 'a j -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[672,15726+11]..[675,15827+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[677,15834+0]..[677,15834+31])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[677,15834+11]..[677,15834+13]) (testsuite/tests/typing-gadts/test.ml[677,15834+0]..[677,15834+31])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[677,15834+6]..[677,15834+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/test.ml[677,15834+8]..[677,15834+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[677,15834+16]..[677,15834+31])
                "Eq" (testsuite/tests/typing-gadts/test.ml[677,15834+16]..[677,15834+18])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[677,15834+21]..[677,15834+31])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[677,15834+29]..[677,15834+31])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[677,15834+22]..[677,15834+24])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[677,15834+25]..[677,15834+27])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[679,15870+0]..[680,15945+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[679,15870+4]..[679,15870+72]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[679,15870+4]..[679,15870+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[679,15870+4]..[679,15870+5])
          core_type (testsuite/tests/typing-gadts/test.ml[679,15870+4]..[680,15945+15]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[679,15870+18]..[679,15870+72])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[679,15870+18]..[679,15870+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[679,15870+24]..[679,15870+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[679,15870+19]..[679,15870+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[679,15870+21]..[679,15870+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[679,15870+30]..[679,15870+72])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[679,15870+31]..[679,15870+48])
                  Ptyp_alias "c"
                  core_type (testsuite/tests/typing-gadts/test.ml[679,15870+31]..[679,15870+42])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[679,15870+36]..[679,15870+37])
                          Ptyp_var a
                core_type (testsuite/tests/typing-gadts/test.ml[679,15870+54]..[679,15870+71])
                  Ptyp_alias "c"
                  core_type (testsuite/tests/typing-gadts/test.ml[679,15870+54]..[679,15870+65])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[679,15870+59]..[679,15870+60])
                          Ptyp_var b
        expression (testsuite/tests/typing-gadts/test.ml[679,15870+4]..[680,15945+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[679,15870+4]..[680,15945+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[679,15870+4]..[680,15945+15])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[680,15945+2]..[680,15945+15])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[680,15945+6]..[680,15945+8])
                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[680,15945+6]..[680,15945+8])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[680,15945+9]..[680,15945+15]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[680,15945+9]..[680,15945+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[680,15945+9]..[680,15945+10])
                  expression (testsuite/tests/typing-gadts/test.ml[680,15945+14]..[680,15945+15])
                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[680,15945+14]..[680,15945+15])
              core_type (testsuite/tests/typing-gadts/test.ml[679,15870+18]..[679,15870+72])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[679,15870+18]..[679,15870+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[679,15870+24]..[679,15870+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[679,15870+19]..[679,15870+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[679,15870+19]..[679,15870+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[679,15870+21]..[679,15870+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[679,15870+21]..[679,15870+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[679,15870+30]..[679,15870+72])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[679,15870+31]..[679,15870+48])
                    Ptyp_alias "c"
                    core_type (testsuite/tests/typing-gadts/test.ml[679,15870+31]..[679,15870+42])
                      Ptyp_object Open
                        method m
                          core_type (testsuite/tests/typing-gadts/test.ml[679,15870+36]..[679,15870+37])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[679,15870+36]..[679,15870+37])
                            []
                  core_type (testsuite/tests/typing-gadts/test.ml[679,15870+54]..[679,15870+71])
                    Ptyp_alias "c"
                    core_type (testsuite/tests/typing-gadts/test.ml[679,15870+54]..[679,15870+65])
                      Ptyp_object Open
                        method m
                          core_type (testsuite/tests/typing-gadts/test.ml[679,15870+59]..[679,15870+60])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[679,15870+59]..[679,15870+60])
                            []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[682,15975+0]..[689,16257+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[682,15975+9]..[689,16257+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[682,15975+9]..[689,16257+2])
          Pexp_constant PConst_string ("\ntype (_, _) eq = Eq : ('a, 'a) eq\nLines 3-4, characters 4-15:\n3 | ....f : type a b. (a,b) eq -> (<m : a; ..> as 'c) -> (<m : b; ..> as 'c) =\n4 |   fun Eq o -> o\nError: The universal type variable 'b cannot be generalized:\n       it is already bound to another variable.\n",(testsuite/tests/typing-gadts/test.ml[682,15975+11]..[689,16257+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[691,16264+0]..[692,16323+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[691,16264+4]..[691,16264+56]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[691,16264+4]..[691,16264+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[691,16264+4]..[691,16264+5])
          core_type (testsuite/tests/typing-gadts/test.ml[691,16264+4]..[692,16323+15]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[691,16264+18]..[691,16264+56])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[691,16264+18]..[691,16264+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[691,16264+24]..[691,16264+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[691,16264+19]..[691,16264+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[691,16264+21]..[691,16264+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[691,16264+30]..[691,16264+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[691,16264+30]..[691,16264+41])
                  Ptyp_object Open
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[691,16264+35]..[691,16264+36])
                        Ptyp_var a
                core_type (testsuite/tests/typing-gadts/test.ml[691,16264+45]..[691,16264+56])
                  Ptyp_object Open
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[691,16264+50]..[691,16264+51])
                        Ptyp_var b
        expression (testsuite/tests/typing-gadts/test.ml[691,16264+4]..[692,16323+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[691,16264+4]..[692,16323+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[691,16264+4]..[692,16323+15])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[692,16323+2]..[692,16323+15])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[692,16323+6]..[692,16323+8])
                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[692,16323+6]..[692,16323+8])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[692,16323+9]..[692,16323+15]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[692,16323+9]..[692,16323+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[692,16323+9]..[692,16323+10])
                  expression (testsuite/tests/typing-gadts/test.ml[692,16323+14]..[692,16323+15])
                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[692,16323+14]..[692,16323+15])
              core_type (testsuite/tests/typing-gadts/test.ml[691,16264+18]..[691,16264+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[691,16264+18]..[691,16264+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[691,16264+24]..[691,16264+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[691,16264+19]..[691,16264+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[691,16264+19]..[691,16264+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[691,16264+21]..[691,16264+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[691,16264+21]..[691,16264+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[691,16264+30]..[691,16264+56])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[691,16264+30]..[691,16264+41])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[691,16264+35]..[691,16264+36])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[691,16264+35]..[691,16264+36])
                          []
                  core_type (testsuite/tests/typing-gadts/test.ml[691,16264+45]..[691,16264+56])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[691,16264+50]..[691,16264+51])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[691,16264+50]..[691,16264+51])
                          []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[694,16353+0]..[703,16674+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[694,16353+9]..[703,16674+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[694,16353+9]..[703,16674+2])
          Pexp_constant PConst_string ("\nLine 2, characters 14-15:\n2 |   fun Eq o -> o\n                  ^\nError: This expression has type < m : a; .. >\n       but an expression was expected of type < m : b; .. >\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[694,16353+11]..[703,16674+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[705,16681+0]..[706,16755+23])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[705,16681+4]..[705,16681+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[705,16681+4]..[705,16681+5])
        expression (testsuite/tests/typing-gadts/test.ml[705,16681+6]..[706,16755+23])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[705,16681+15]..[706,16755+23])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[705,16681+24]..[706,16755+23]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[705,16681+24]..[705,16681+39])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[705,16681+25]..[705,16681+27])
                  Ppat_var "eq" (testsuite/tests/typing-gadts/test.ml[705,16681+25]..[705,16681+27])
                core_type (testsuite/tests/typing-gadts/test.ml[705,16681+30]..[705,16681+38])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[705,16681+36]..[705,16681+38])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[705,16681+31]..[705,16681+32])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[705,16681+31]..[705,16681+32])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[705,16681+33]..[705,16681+34])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[705,16681+33]..[705,16681+34])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[705,16681+40]..[706,16755+23]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[705,16681+40]..[705,16681+57])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[705,16681+41]..[705,16681+42])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[705,16681+41]..[705,16681+42])
                  core_type (testsuite/tests/typing-gadts/test.ml[705,16681+45]..[705,16681+56])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[705,16681+50]..[705,16681+51])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[705,16681+50]..[705,16681+51])
                          []
                expression (testsuite/tests/typing-gadts/test.ml[705,16681+58]..[706,16755+23])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/test.ml[706,16755+2]..[706,16755+23])
                    Pexp_match
                    expression (testsuite/tests/typing-gadts/test.ml[706,16755+8]..[706,16755+10])
                      Pexp_ident "eq" (testsuite/tests/typing-gadts/test.ml[706,16755+8]..[706,16755+10])
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[706,16755+16]..[706,16755+18])
                          Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[706,16755+16]..[706,16755+18])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[706,16755+22]..[706,16755+23])
                          Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[706,16755+22]..[706,16755+23])
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[705,16681+60]..[705,16681+71])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[705,16681+65]..[705,16681+66])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[705,16681+65]..[705,16681+66])
                          []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[707,16800+0]..[716,17158+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[707,16800+9]..[716,17158+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[707,16800+9]..[716,17158+2])
          Pexp_constant PConst_string ("\nLine 2, characters 22-23:\n2 |   match eq with Eq -> o ;; (* should fail *)\n                          ^\nError: This expression has type < m : a; .. >\n       but an expression was expected of type < m : b; .. >\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[707,16800+11]..[716,17158+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[718,17165+0]..[719,17216+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[718,17165+4]..[718,17165+48]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[718,17165+4]..[718,17165+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[718,17165+4]..[718,17165+5])
          core_type (testsuite/tests/typing-gadts/test.ml[718,17165+4]..[719,17216+15]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[718,17165+18]..[718,17165+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[718,17165+18]..[718,17165+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[718,17165+24]..[718,17165+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[718,17165+19]..[718,17165+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[718,17165+21]..[718,17165+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[718,17165+30]..[718,17165+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[718,17165+30]..[718,17165+37])
                  Ptyp_object Closed
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[718,17165+35]..[718,17165+36])
                        Ptyp_var a
                core_type (testsuite/tests/typing-gadts/test.ml[718,17165+41]..[718,17165+48])
                  Ptyp_object Closed
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[718,17165+46]..[718,17165+47])
                        Ptyp_var b
        expression (testsuite/tests/typing-gadts/test.ml[718,17165+4]..[719,17216+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[718,17165+4]..[719,17216+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[718,17165+4]..[719,17216+15])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[719,17216+2]..[719,17216+15])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[719,17216+6]..[719,17216+8])
                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[719,17216+6]..[719,17216+8])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[719,17216+9]..[719,17216+15]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[719,17216+9]..[719,17216+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[719,17216+9]..[719,17216+10])
                  expression (testsuite/tests/typing-gadts/test.ml[719,17216+14]..[719,17216+15])
                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[719,17216+14]..[719,17216+15])
              core_type (testsuite/tests/typing-gadts/test.ml[718,17165+18]..[718,17165+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[718,17165+18]..[718,17165+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[718,17165+24]..[718,17165+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[718,17165+19]..[718,17165+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[718,17165+19]..[718,17165+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[718,17165+21]..[718,17165+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[718,17165+21]..[718,17165+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[718,17165+30]..[718,17165+48])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[718,17165+30]..[718,17165+37])
                    Ptyp_object Closed
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[718,17165+35]..[718,17165+36])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[718,17165+35]..[718,17165+36])
                          []
                  core_type (testsuite/tests/typing-gadts/test.ml[718,17165+41]..[718,17165+48])
                    Ptyp_object Closed
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[718,17165+46]..[718,17165+47])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[718,17165+46]..[718,17165+47])
                          []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[721,17244+0]..[723,17312+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[721,17244+9]..[723,17312+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[721,17244+9]..[723,17312+2])
          Pexp_constant PConst_string ("\nval f : ('a, 'b) eq -> < m : 'a > -> < m : 'b > = <fun>\n",(testsuite/tests/typing-gadts/test.ml[721,17244+11]..[723,17312+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[725,17319+0]..[725,17319+46])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[725,17319+4]..[725,17319+31]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[725,17319+4]..[725,17319+15])
            Ppat_var "int_of_bool" (testsuite/tests/typing-gadts/test.ml[725,17319+4]..[725,17319+15])
          core_type (testsuite/tests/typing-gadts/test.ml[725,17319+18]..[725,17319+31]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/test.ml[725,17319+18]..[725,17319+31])
              Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[725,17319+29]..[725,17319+31])
              [
                core_type (testsuite/tests/typing-gadts/test.ml[725,17319+19]..[725,17319+23])
                  Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[725,17319+19]..[725,17319+23])
                  []
                core_type (testsuite/tests/typing-gadts/test.ml[725,17319+24]..[725,17319+27])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[725,17319+24]..[725,17319+27])
                  []
              ]
        expression (testsuite/tests/typing-gadts/test.ml[725,17319+4]..[725,17319+46])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/test.ml[725,17319+34]..[725,17319+46])
            Pexp_apply
            expression (testsuite/tests/typing-gadts/test.ml[725,17319+34]..[725,17319+43])
              Pexp_ident "Obj.magic" (testsuite/tests/typing-gadts/test.ml[725,17319+34]..[725,17319+43])
            [
              <arg>
              Nolabel
                expression (testsuite/tests/typing-gadts/test.ml[725,17319+44]..[725,17319+46])
                  Pexp_construct "Eq" (testsuite/tests/typing-gadts/test.ml[725,17319+44]..[725,17319+46])
                  None
            ]
          core_type (testsuite/tests/typing-gadts/test.ml[725,17319+18]..[725,17319+31])
            Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[725,17319+29]..[725,17319+31])
            [
              core_type (testsuite/tests/typing-gadts/test.ml[725,17319+19]..[725,17319+23])
                Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[725,17319+19]..[725,17319+23])
                []
              core_type (testsuite/tests/typing-gadts/test.ml[725,17319+24]..[725,17319+27])
                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[725,17319+24]..[725,17319+27])
                []
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[727,17369+0]..[727,17369+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[727,17369+4]..[727,17369+5])
          Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[727,17369+4]..[727,17369+5])
        expression (testsuite/tests/typing-gadts/test.ml[727,17369+8]..[727,17369+34])
          Pexp_object
          class_structure
            pattern (testsuite/tests/typing-gadts/test.ml[727,17369+14]..[727,17369+14]) ghost
              Ppat_any
            [
              class_field (testsuite/tests/typing-gadts/test.ml[727,17369+15]..[727,17369+30])
                Pcf_method Public
                  "m" (testsuite/tests/typing-gadts/test.ml[727,17369+22]..[727,17369+23])
                  Concrete Fresh
                  expression (testsuite/tests/typing-gadts/test.ml[727,17369+26]..[727,17369+30]) ghost
                    Pexp_poly
                    expression (testsuite/tests/typing-gadts/test.ml[727,17369+26]..[727,17369+30])
                      Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[727,17369+26]..[727,17369+30])
                      None
                    None
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[728,17406+0]..[728,17406+28])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[728,17406+4]..[728,17406+5])
          Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[728,17406+4]..[728,17406+5])
        expression (testsuite/tests/typing-gadts/test.ml[728,17406+8]..[728,17406+28])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/test.ml[728,17406+9]..[728,17406+10])
              Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[728,17406+9]..[728,17406+10])
            expression (testsuite/tests/typing-gadts/test.ml[728,17406+12]..[728,17406+27])
              Pexp_apply
              expression (testsuite/tests/typing-gadts/test.ml[728,17406+12]..[728,17406+13])
                Pexp_ident "f" (testsuite/tests/typing-gadts/test.ml[728,17406+12]..[728,17406+13])
              [
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/test.ml[728,17406+14]..[728,17406+25])
                    Pexp_ident "int_of_bool" (testsuite/tests/typing-gadts/test.ml[728,17406+14]..[728,17406+25])
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/test.ml[728,17406+26]..[728,17406+27])
                    Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[728,17406+26]..[728,17406+27])
              ]
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[730,17438+0]..[731,17487+49])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[730,17438+4]..[730,17438+46]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[730,17438+4]..[730,17438+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[730,17438+4]..[730,17438+5])
          core_type (testsuite/tests/typing-gadts/test.ml[730,17438+4]..[731,17487+49]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[730,17438+16]..[730,17438+46])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[730,17438+16]..[730,17438+27])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[730,17438+25]..[730,17438+27])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[730,17438+17]..[730,17438+18])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[730,17438+20]..[730,17438+23])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[730,17438+20]..[730,17438+23])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[730,17438+31]..[730,17438+46])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[730,17438+31]..[730,17438+38])
                  Ptyp_object Closed
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[730,17438+36]..[730,17438+37])
                        Ptyp_var a
                core_type (testsuite/tests/typing-gadts/test.ml[730,17438+42]..[730,17438+46])
                  Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[730,17438+42]..[730,17438+46])
                  []
        expression (testsuite/tests/typing-gadts/test.ml[730,17438+4]..[731,17487+49])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[730,17438+4]..[731,17487+49])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[731,17487+2]..[731,17487+49])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[731,17487+6]..[731,17487+8])
                Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[731,17487+6]..[731,17487+8])
                None
              expression (testsuite/tests/typing-gadts/test.ml[731,17487+9]..[731,17487+49]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[731,17487+9]..[731,17487+10])
                  Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[731,17487+9]..[731,17487+10])
                expression (testsuite/tests/typing-gadts/test.ml[731,17487+14]..[731,17487+49])
                  Pexp_sequence
                  expression (testsuite/tests/typing-gadts/test.ml[731,17487+14]..[731,17487+40])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[731,17487+14]..[731,17487+20])
                      Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[731,17487+14]..[731,17487+20])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[731,17487+21]..[731,17487+40])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/test.ml[731,17487+22]..[731,17487+23])
                            Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[731,17487+22]..[731,17487+23])
                          core_type (testsuite/tests/typing-gadts/test.ml[731,17487+26]..[731,17487+39])
                            Ptyp_object Open
                              method m
                                core_type (testsuite/tests/typing-gadts/test.ml[731,17487+31]..[731,17487+34])
                                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[731,17487+31]..[731,17487+34])
                                  []
                    ]
                  expression (testsuite/tests/typing-gadts/test.ml[731,17487+42]..[731,17487+49])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[731,17487+46]..[731,17487+47])
                      Pexp_ident "=" (testsuite/tests/typing-gadts/test.ml[731,17487+46]..[731,17487+47])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[731,17487+42]..[731,17487+45])
                          Pexp_send "m"
                          expression (testsuite/tests/typing-gadts/test.ml[731,17487+42]..[731,17487+43])
                            Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[731,17487+42]..[731,17487+43])
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[731,17487+48]..[731,17487+49])
                          Pexp_constant PConst_int (3,None)
                    ]
            core_type (testsuite/tests/typing-gadts/test.ml[730,17438+16]..[730,17438+46])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[730,17438+16]..[730,17438+27])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[730,17438+25]..[730,17438+27])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[730,17438+17]..[730,17438+18])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[730,17438+17]..[730,17438+18])
                    []
                  core_type (testsuite/tests/typing-gadts/test.ml[730,17438+20]..[730,17438+23])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[730,17438+20]..[730,17438+23])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[730,17438+31]..[730,17438+46])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[730,17438+31]..[730,17438+38])
                  Ptyp_object Closed
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[730,17438+36]..[730,17438+37])
                        Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[730,17438+36]..[730,17438+37])
                        []
                core_type (testsuite/tests/typing-gadts/test.ml[730,17438+42]..[730,17438+46])
                  Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[730,17438+42]..[730,17438+46])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[733,17559+0]..[738,17741+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[733,17559+9]..[738,17741+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[733,17559+9]..[738,17741+2])
          Pexp_constant PConst_string ("\nval int_of_bool : (bool, int) eq = Eq\nval x : < m : bool > = <obj>\nval y : < m : bool > * < m : int > = (<obj>, <obj>)\nval f : ('a, int) eq -> < m : 'a > -> bool = <fun>\n",(testsuite/tests/typing-gadts/test.ml[733,17559+11]..[738,17741+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[740,17748+0]..[744,17924+5])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[740,17748+4]..[740,17748+56]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[740,17748+4]..[740,17748+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[740,17748+4]..[740,17748+5])
          core_type (testsuite/tests/typing-gadts/test.ml[740,17748+4]..[744,17924+5]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[740,17748+18]..[740,17748+56])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[740,17748+18]..[740,17748+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[740,17748+24]..[740,17748+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[740,17748+19]..[740,17748+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[740,17748+21]..[740,17748+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[740,17748+30]..[740,17748+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[740,17748+30]..[740,17748+43])
                  Ptyp_object Open
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[740,17748+36]..[740,17748+37])
                        Ptyp_var a
                core_type (testsuite/tests/typing-gadts/test.ml[740,17748+47]..[740,17748+56])
                  Ptyp_object Closed
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[740,17748+53]..[740,17748+54])
                        Ptyp_var b
        expression (testsuite/tests/typing-gadts/test.ml[740,17748+4]..[744,17924+5])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[740,17748+4]..[744,17924+5])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[740,17748+4]..[744,17924+5])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[741,17807+2]..[744,17924+5])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[741,17807+6]..[741,17807+8])
                  Ppat_var "eq" (testsuite/tests/typing-gadts/test.ml[741,17807+6]..[741,17807+8])
                expression (testsuite/tests/typing-gadts/test.ml[741,17807+9]..[744,17924+5]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[741,17807+9]..[741,17807+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[741,17807+9]..[741,17807+10])
                  expression (testsuite/tests/typing-gadts/test.ml[742,17821+4]..[744,17924+5])
                    Pexp_sequence
                    expression (testsuite/tests/typing-gadts/test.ml[742,17821+4]..[742,17821+26])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[742,17821+4]..[742,17821+10])
                        Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[742,17821+4]..[742,17821+10])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[742,17821+11]..[742,17821+26])
                            Pexp_constraint
                            expression (testsuite/tests/typing-gadts/test.ml[742,17821+12]..[742,17821+13])
                              Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[742,17821+12]..[742,17821+13])
                            core_type (testsuite/tests/typing-gadts/test.ml[742,17821+16]..[742,17821+25])
                              Ptyp_object Closed
                                method m
                                  core_type (testsuite/tests/typing-gadts/test.ml[742,17821+22]..[742,17821+23])
                                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[742,17821+22]..[742,17821+23])
                                    []
                      ]
                    expression (testsuite/tests/typing-gadts/test.ml[743,17849+4]..[744,17924+5])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (testsuite/tests/typing-gadts/test.ml[743,17849+8]..[743,17849+21]) ghost
                            Ppat_constraint
                            pattern (testsuite/tests/typing-gadts/test.ml[743,17849+8]..[743,17849+9])
                              Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[743,17849+8]..[743,17849+9])
                            core_type (testsuite/tests/typing-gadts/test.ml[743,17849+12]..[743,17849+21]) ghost
                              Ptyp_poly
                              core_type (testsuite/tests/typing-gadts/test.ml[743,17849+12]..[743,17849+21])
                                Ptyp_object Closed
                                  method m
                                    core_type (testsuite/tests/typing-gadts/test.ml[743,17849+18]..[743,17849+19])
                                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[743,17849+18]..[743,17849+19])
                                      []
                          expression (testsuite/tests/typing-gadts/test.ml[743,17849+8]..[743,17849+45])
                            Pexp_constraint
                            expression (testsuite/tests/typing-gadts/test.ml[743,17849+24]..[743,17849+45])
                              Pexp_match
                              expression (testsuite/tests/typing-gadts/test.ml[743,17849+30]..[743,17849+32])
                                Pexp_ident "eq" (testsuite/tests/typing-gadts/test.ml[743,17849+30]..[743,17849+32])
                              [
                                <case>
                                  pattern (testsuite/tests/typing-gadts/test.ml[743,17849+38]..[743,17849+40])
                                    Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[743,17849+38]..[743,17849+40])
                                    None
                                  expression (testsuite/tests/typing-gadts/test.ml[743,17849+44]..[743,17849+45])
                                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[743,17849+44]..[743,17849+45])
                              ]
                            core_type (testsuite/tests/typing-gadts/test.ml[743,17849+12]..[743,17849+21])
                              Ptyp_object Closed
                                method m
                                  core_type (testsuite/tests/typing-gadts/test.ml[743,17849+18]..[743,17849+19])
                                    Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[743,17849+18]..[743,17849+19])
                                    []
                      ]
                      expression (testsuite/tests/typing-gadts/test.ml[744,17924+4]..[744,17924+5])
                        Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[744,17924+4]..[744,17924+5])
              core_type (testsuite/tests/typing-gadts/test.ml[740,17748+18]..[740,17748+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[740,17748+18]..[740,17748+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[740,17748+24]..[740,17748+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[740,17748+19]..[740,17748+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[740,17748+19]..[740,17748+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[740,17748+21]..[740,17748+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[740,17748+21]..[740,17748+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[740,17748+30]..[740,17748+56])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[740,17748+30]..[740,17748+43])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[740,17748+36]..[740,17748+37])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[740,17748+36]..[740,17748+37])
                          []
                  core_type (testsuite/tests/typing-gadts/test.ml[740,17748+47]..[740,17748+56])
                    Ptyp_object Closed
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[740,17748+53]..[740,17748+54])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[740,17748+53]..[740,17748+54])
                          []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[745,17932+0]..[756,18406+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[745,17932+9]..[756,18406+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[745,17932+9]..[756,18406+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/test.ml[745,17932+9]..[747,18000+2])
              Pexp_constant PConst_string ("\nval f : ('a, 'b) eq -> < m : 'a > -> < m : 'b > = <fun>\n",(testsuite/tests/typing-gadts/test.ml[745,17932+11]..[747,18000+0]),Some "")
            expression (testsuite/tests/typing-gadts/test.ml[747,18000+4]..[756,18406+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/test.ml[747,18000+4]..[747,18000+13])
              Some
                expression (testsuite/tests/typing-gadts/test.ml[747,18000+13]..[756,18406+2])
                  Pexp_constant PConst_string ("\nLine 4, characters 44-45:\n4 |     let r : < m : b > = match eq with Eq -> o in (* fail with principal *)\n                                                ^\nError: This expression has type < m : a >\n       but an expression was expected of type < m : b >\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[747,18000+15]..[756,18406+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[758,18413+0]..[762,18574+5])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[758,18413+4]..[758,18413+56]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[758,18413+4]..[758,18413+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[758,18413+4]..[758,18413+5])
          core_type (testsuite/tests/typing-gadts/test.ml[758,18413+4]..[762,18574+5]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[758,18413+18]..[758,18413+56])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[758,18413+18]..[758,18413+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[758,18413+24]..[758,18413+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[758,18413+19]..[758,18413+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[758,18413+21]..[758,18413+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[758,18413+30]..[758,18413+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[758,18413+30]..[758,18413+43])
                  Ptyp_object Open
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[758,18413+36]..[758,18413+37])
                        Ptyp_var a
                core_type (testsuite/tests/typing-gadts/test.ml[758,18413+47]..[758,18413+56])
                  Ptyp_object Closed
                    method m
                      core_type (testsuite/tests/typing-gadts/test.ml[758,18413+53]..[758,18413+54])
                        Ptyp_var b
        expression (testsuite/tests/typing-gadts/test.ml[758,18413+4]..[762,18574+5])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[758,18413+4]..[762,18574+5])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[758,18413+4]..[762,18574+5])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[759,18472+2]..[762,18574+5])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[759,18472+6]..[759,18472+8])
                  Ppat_var "eq" (testsuite/tests/typing-gadts/test.ml[759,18472+6]..[759,18472+8])
                expression (testsuite/tests/typing-gadts/test.ml[759,18472+9]..[762,18574+5]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[759,18472+9]..[759,18472+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[759,18472+9]..[759,18472+10])
                  expression (testsuite/tests/typing-gadts/test.ml[760,18486+4]..[762,18574+5])
                    Pexp_let Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/test.ml[760,18486+8]..[760,18486+21]) ghost
                          Ppat_constraint
                          pattern (testsuite/tests/typing-gadts/test.ml[760,18486+8]..[760,18486+9])
                            Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[760,18486+8]..[760,18486+9])
                          core_type (testsuite/tests/typing-gadts/test.ml[760,18486+12]..[760,18486+21]) ghost
                            Ptyp_poly
                            core_type (testsuite/tests/typing-gadts/test.ml[760,18486+12]..[760,18486+21])
                              Ptyp_object Closed
                                method m
                                  core_type (testsuite/tests/typing-gadts/test.ml[760,18486+18]..[760,18486+19])
                                    Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[760,18486+18]..[760,18486+19])
                                    []
                        expression (testsuite/tests/typing-gadts/test.ml[760,18486+8]..[760,18486+45])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/test.ml[760,18486+24]..[760,18486+45])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/test.ml[760,18486+30]..[760,18486+32])
                              Pexp_ident "eq" (testsuite/tests/typing-gadts/test.ml[760,18486+30]..[760,18486+32])
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/test.ml[760,18486+38]..[760,18486+40])
                                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[760,18486+38]..[760,18486+40])
                                  None
                                expression (testsuite/tests/typing-gadts/test.ml[760,18486+44]..[760,18486+45])
                                  Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[760,18486+44]..[760,18486+45])
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[760,18486+12]..[760,18486+21])
                            Ptyp_object Closed
                              method m
                                core_type (testsuite/tests/typing-gadts/test.ml[760,18486+18]..[760,18486+19])
                                  Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[760,18486+18]..[760,18486+19])
                                  []
                    ]
                    expression (testsuite/tests/typing-gadts/test.ml[761,18546+4]..[762,18574+5])
                      Pexp_sequence
                      expression (testsuite/tests/typing-gadts/test.ml[761,18546+4]..[761,18546+26])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[761,18546+4]..[761,18546+10])
                          Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[761,18546+4]..[761,18546+10])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[761,18546+11]..[761,18546+26])
                              Pexp_constraint
                              expression (testsuite/tests/typing-gadts/test.ml[761,18546+12]..[761,18546+13])
                                Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[761,18546+12]..[761,18546+13])
                              core_type (testsuite/tests/typing-gadts/test.ml[761,18546+16]..[761,18546+25])
                                Ptyp_object Closed
                                  method m
                                    core_type (testsuite/tests/typing-gadts/test.ml[761,18546+22]..[761,18546+23])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[761,18546+22]..[761,18546+23])
                                      []
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[762,18574+4]..[762,18574+5])
                        Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[762,18574+4]..[762,18574+5])
              core_type (testsuite/tests/typing-gadts/test.ml[758,18413+18]..[758,18413+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[758,18413+18]..[758,18413+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[758,18413+24]..[758,18413+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[758,18413+19]..[758,18413+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[758,18413+19]..[758,18413+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[758,18413+21]..[758,18413+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[758,18413+21]..[758,18413+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[758,18413+30]..[758,18413+56])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[758,18413+30]..[758,18413+43])
                    Ptyp_object Open
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[758,18413+36]..[758,18413+37])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[758,18413+36]..[758,18413+37])
                          []
                  core_type (testsuite/tests/typing-gadts/test.ml[758,18413+47]..[758,18413+56])
                    Ptyp_object Closed
                      method m
                        core_type (testsuite/tests/typing-gadts/test.ml[758,18413+53]..[758,18413+54])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[758,18413+53]..[758,18413+54])
                          []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[763,18582+0]..[772,18973+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[763,18582+9]..[772,18973+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[763,18582+9]..[772,18973+2])
          Pexp_constant PConst_string ("\nLine 3, characters 44-45:\n3 |     let r : < m : b > = match eq with Eq -> o in (* fail *)\n                                                ^\nError: This expression has type < m : a; .. >\n       but an expression was expected of type < m : b >\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[763,18582+11]..[772,18973+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[774,18980+0]..[775,19039+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[774,18980+4]..[774,18980+56]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[774,18980+4]..[774,18980+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[774,18980+4]..[774,18980+5])
          core_type (testsuite/tests/typing-gadts/test.ml[774,18980+4]..[775,19039+15]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[774,18980+18]..[774,18980+56])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[774,18980+18]..[774,18980+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[774,18980+24]..[774,18980+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[774,18980+19]..[774,18980+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[774,18980+21]..[774,18980+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[774,18980+30]..[774,18980+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[774,18980+30]..[774,18980+41])
                  Ptyp_variant closed=Open
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[774,18980+39]..[774,18980+40])
                          Ptyp_var a
                      ]
                  ]
                  None
                core_type (testsuite/tests/typing-gadts/test.ml[774,18980+45]..[774,18980+56])
                  Ptyp_variant closed=Open
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[774,18980+54]..[774,18980+55])
                          Ptyp_var b
                      ]
                  ]
                  None
        expression (testsuite/tests/typing-gadts/test.ml[774,18980+4]..[775,19039+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[774,18980+4]..[775,19039+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[774,18980+4]..[775,19039+15])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[775,19039+2]..[775,19039+15])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[775,19039+6]..[775,19039+8])
                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[775,19039+6]..[775,19039+8])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[775,19039+9]..[775,19039+15]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[775,19039+9]..[775,19039+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[775,19039+9]..[775,19039+10])
                  expression (testsuite/tests/typing-gadts/test.ml[775,19039+14]..[775,19039+15])
                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[775,19039+14]..[775,19039+15])
              core_type (testsuite/tests/typing-gadts/test.ml[774,18980+18]..[774,18980+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[774,18980+18]..[774,18980+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[774,18980+24]..[774,18980+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[774,18980+19]..[774,18980+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[774,18980+19]..[774,18980+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[774,18980+21]..[774,18980+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[774,18980+21]..[774,18980+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[774,18980+30]..[774,18980+56])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[774,18980+30]..[774,18980+41])
                    Ptyp_variant closed=Open
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[774,18980+39]..[774,18980+40])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[774,18980+39]..[774,18980+40])
                            []
                        ]
                    ]
                    None
                  core_type (testsuite/tests/typing-gadts/test.ml[774,18980+45]..[774,18980+56])
                    Ptyp_variant closed=Open
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[774,18980+54]..[774,18980+55])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[774,18980+54]..[774,18980+55])
                            []
                        ]
                    ]
                    None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[776,19069+0]..[792,19672+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[776,19069+9]..[792,19672+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[776,19069+9]..[792,19672+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/test.ml[776,19069+9]..[785,19402+2])
              Pexp_constant PConst_string ("\nLine 2, characters 14-15:\n2 |   fun Eq o -> o ;; (* fail *)\n                  ^\nError: This expression has type [> `A of a ]\n       but an expression was expected of type [> `A of b ]\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[776,19069+11]..[785,19402+0]),Some "")
            expression (testsuite/tests/typing-gadts/test.ml[785,19402+4]..[792,19672+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/test.ml[785,19402+4]..[785,19402+13])
              Some
                expression (testsuite/tests/typing-gadts/test.ml[785,19402+13]..[792,19672+2])
                  Pexp_constant PConst_string ("\nLine 2, characters 9-15:\n2 |   fun Eq o -> o ;; (* fail *)\n             ^^^^^^\nError: This expression has type ([> `A of b ] as 'a) -> 'a\n       but an expression was expected of type [> `A of a ] -> [> `A of b ]\n       Types for tag `A are incompatible\n",(testsuite/tests/typing-gadts/test.ml[785,19402+15]..[792,19672+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[794,19679+0]..[795,19746+23])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[794,19679+4]..[794,19679+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[794,19679+4]..[794,19679+5])
        expression (testsuite/tests/typing-gadts/test.ml[794,19679+6]..[795,19746+23])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[794,19679+6]..[795,19746+23])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[794,19679+17]..[795,19746+23]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[794,19679+17]..[794,19679+32])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[794,19679+18]..[794,19679+20])
                  Ppat_var "eq" (testsuite/tests/typing-gadts/test.ml[794,19679+18]..[794,19679+20])
                core_type (testsuite/tests/typing-gadts/test.ml[794,19679+23]..[794,19679+31])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[794,19679+29]..[794,19679+31])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[794,19679+24]..[794,19679+25])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[794,19679+24]..[794,19679+25])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[794,19679+26]..[794,19679+27])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[794,19679+26]..[794,19679+27])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[794,19679+33]..[795,19746+23]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[794,19679+33]..[794,19679+50])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[794,19679+34]..[794,19679+35])
                    Ppat_var "v" (testsuite/tests/typing-gadts/test.ml[794,19679+34]..[794,19679+35])
                  core_type (testsuite/tests/typing-gadts/test.ml[794,19679+38]..[794,19679+49])
                    Ptyp_variant closed=Open
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[794,19679+47]..[794,19679+48])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[794,19679+47]..[794,19679+48])
                            []
                        ]
                    ]
                    None
                expression (testsuite/tests/typing-gadts/test.ml[794,19679+51]..[795,19746+23])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/test.ml[795,19746+2]..[795,19746+23])
                    Pexp_match
                    expression (testsuite/tests/typing-gadts/test.ml[795,19746+8]..[795,19746+10])
                      Pexp_ident "eq" (testsuite/tests/typing-gadts/test.ml[795,19746+8]..[795,19746+10])
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/test.ml[795,19746+16]..[795,19746+18])
                          Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[795,19746+16]..[795,19746+18])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[795,19746+22]..[795,19746+23])
                          Pexp_ident "v" (testsuite/tests/typing-gadts/test.ml[795,19746+22]..[795,19746+23])
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[794,19679+53]..[794,19679+64])
                    Ptyp_variant closed=Open
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[794,19679+62]..[794,19679+63])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[794,19679+62]..[794,19679+63])
                            []
                        ]
                    ]
                    None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[796,19791+0]..[805,20147+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[796,19791+9]..[805,20147+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[796,19791+9]..[805,20147+2])
          Pexp_constant PConst_string ("\nLine 2, characters 22-23:\n2 |   match eq with Eq -> v ;; (* should fail *)\n                          ^\nError: This expression has type [> `A of a ]\n       but an expression was expected of type [> `A of b ]\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[796,19791+11]..[805,20147+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[807,20154+0]..[808,20223+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[807,20154+4]..[807,20154+66]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[807,20154+4]..[807,20154+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[807,20154+4]..[807,20154+5])
          core_type (testsuite/tests/typing-gadts/test.ml[807,20154+4]..[808,20223+15]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[807,20154+18]..[807,20154+66])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[807,20154+18]..[807,20154+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[807,20154+24]..[807,20154+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[807,20154+19]..[807,20154+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[807,20154+21]..[807,20154+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[807,20154+30]..[807,20154+66])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[807,20154+30]..[807,20154+46])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[807,20154+39]..[807,20154+40])
                          Ptyp_var a
                      ]
                    Rtag "B" true
                      []
                  ]
                  Some
                    []
                core_type (testsuite/tests/typing-gadts/test.ml[807,20154+50]..[807,20154+66])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[807,20154+59]..[807,20154+60])
                          Ptyp_var b
                      ]
                    Rtag "B" true
                      []
                  ]
                  Some
                    []
        expression (testsuite/tests/typing-gadts/test.ml[807,20154+4]..[808,20223+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[807,20154+4]..[808,20223+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[807,20154+4]..[808,20223+15])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[808,20223+2]..[808,20223+15])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[808,20223+6]..[808,20223+8])
                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[808,20223+6]..[808,20223+8])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[808,20223+9]..[808,20223+15]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[808,20223+9]..[808,20223+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[808,20223+9]..[808,20223+10])
                  expression (testsuite/tests/typing-gadts/test.ml[808,20223+14]..[808,20223+15])
                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[808,20223+14]..[808,20223+15])
              core_type (testsuite/tests/typing-gadts/test.ml[807,20154+18]..[807,20154+66])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[807,20154+18]..[807,20154+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[807,20154+24]..[807,20154+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[807,20154+19]..[807,20154+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[807,20154+19]..[807,20154+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[807,20154+21]..[807,20154+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[807,20154+21]..[807,20154+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[807,20154+30]..[807,20154+66])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[807,20154+30]..[807,20154+46])
                    Ptyp_variant closed=Closed
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[807,20154+39]..[807,20154+40])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[807,20154+39]..[807,20154+40])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    Some
                      []
                  core_type (testsuite/tests/typing-gadts/test.ml[807,20154+50]..[807,20154+66])
                    Ptyp_variant closed=Closed
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[807,20154+59]..[807,20154+60])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[807,20154+59]..[807,20154+60])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    Some
                      []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[809,20253+0]..[817,20606+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[809,20253+9]..[817,20606+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[809,20253+9]..[817,20606+2])
          Pexp_constant PConst_string ("\nLines 1-2, characters 4-15:\n1 | ....f : type a b. (a,b) eq -> [< `A of a | `B] -> [< `A of b | `B] =\n2 |   fun Eq o -> o..............\nError: This definition has type\n         'c. ('d, 'c) eq -> ([< `A of 'c & 'f & 'd | `B ] as 'e) -> 'e\n       which is less general than\n         'a 'b. ('a, 'b) eq -> ([< `A of 'b & 'h | `B ] as 'g) -> 'g\n",(testsuite/tests/typing-gadts/test.ml[809,20253+11]..[817,20606+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[819,20613+0]..[820,20678+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[819,20613+4]..[819,20613+62]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[819,20613+4]..[819,20613+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[819,20613+4]..[819,20613+5])
          core_type (testsuite/tests/typing-gadts/test.ml[819,20613+4]..[820,20678+15]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[819,20613+18]..[819,20613+62])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[819,20613+18]..[819,20613+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[819,20613+24]..[819,20613+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[819,20613+19]..[819,20613+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[819,20613+21]..[819,20613+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[819,20613+30]..[819,20613+62])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[819,20613+30]..[819,20613+44])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[819,20613+37]..[819,20613+38])
                          Ptyp_var a
                      ]
                    Rtag "B" true
                      []
                  ]
                  None
                core_type (testsuite/tests/typing-gadts/test.ml[819,20613+48]..[819,20613+62])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[819,20613+55]..[819,20613+56])
                          Ptyp_var b
                      ]
                    Rtag "B" true
                      []
                  ]
                  None
        expression (testsuite/tests/typing-gadts/test.ml[819,20613+4]..[820,20678+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[819,20613+4]..[820,20678+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[819,20613+4]..[820,20678+15])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[820,20678+2]..[820,20678+15])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[820,20678+6]..[820,20678+8])
                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[820,20678+6]..[820,20678+8])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[820,20678+9]..[820,20678+15]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[820,20678+9]..[820,20678+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[820,20678+9]..[820,20678+10])
                  expression (testsuite/tests/typing-gadts/test.ml[820,20678+14]..[820,20678+15])
                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[820,20678+14]..[820,20678+15])
              core_type (testsuite/tests/typing-gadts/test.ml[819,20613+18]..[819,20613+62])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[819,20613+18]..[819,20613+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[819,20613+24]..[819,20613+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[819,20613+19]..[819,20613+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[819,20613+19]..[819,20613+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[819,20613+21]..[819,20613+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[819,20613+21]..[819,20613+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[819,20613+30]..[819,20613+62])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[819,20613+30]..[819,20613+44])
                    Ptyp_variant closed=Closed
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[819,20613+37]..[819,20613+38])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[819,20613+37]..[819,20613+38])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    None
                  core_type (testsuite/tests/typing-gadts/test.ml[819,20613+48]..[819,20613+62])
                    Ptyp_variant closed=Closed
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[819,20613+55]..[819,20613+56])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[819,20613+55]..[819,20613+56])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[821,20706+0]..[823,20788+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[821,20706+9]..[823,20788+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[821,20706+9]..[823,20788+2])
          Pexp_constant PConst_string ("\nval f : ('a, 'b) eq -> [ `A of 'a | `B ] -> [ `A of 'b | `B ] = <fun>\n",(testsuite/tests/typing-gadts/test.ml[821,20706+11]..[823,20788+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[825,20795+0]..[826,20846+52])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[825,20795+4]..[825,20795+48]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[825,20795+4]..[825,20795+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[825,20795+4]..[825,20795+5])
          core_type (testsuite/tests/typing-gadts/test.ml[825,20795+4]..[826,20846+52]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[825,20795+16]..[825,20795+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[825,20795+16]..[825,20795+27])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[825,20795+25]..[825,20795+27])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[825,20795+17]..[825,20795+18])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[825,20795+20]..[825,20795+23])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[825,20795+20]..[825,20795+23])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[825,20795+31]..[825,20795+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[825,20795+31]..[825,20795+40])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[825,20795+38]..[825,20795+39])
                          Ptyp_var a
                      ]
                  ]
                  None
                core_type (testsuite/tests/typing-gadts/test.ml[825,20795+44]..[825,20795+48])
                  Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[825,20795+44]..[825,20795+48])
                  []
        expression (testsuite/tests/typing-gadts/test.ml[825,20795+4]..[826,20846+52])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[825,20795+4]..[826,20846+52])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[826,20846+2]..[826,20846+52])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[826,20846+6]..[826,20846+8])
                Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[826,20846+6]..[826,20846+8])
                None
              expression (testsuite/tests/typing-gadts/test.ml[826,20846+9]..[826,20846+52]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[826,20846+9]..[826,20846+10])
                  Ppat_var "v" (testsuite/tests/typing-gadts/test.ml[826,20846+9]..[826,20846+10])
                expression (testsuite/tests/typing-gadts/test.ml[826,20846+14]..[826,20846+52])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/test.ml[826,20846+20]..[826,20846+21])
                    Pexp_ident "v" (testsuite/tests/typing-gadts/test.ml[826,20846+20]..[826,20846+21])
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[826,20846+27]..[826,20846+31])
                        Ppat_variant "A"
                        Some
                          pattern (testsuite/tests/typing-gadts/test.ml[826,20846+30]..[826,20846+31])
                            Ppat_constant PConst_int (1,None)
                      expression (testsuite/tests/typing-gadts/test.ml[826,20846+35]..[826,20846+39])
                        Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[826,20846+35]..[826,20846+39])
                        None
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[826,20846+42]..[826,20846+43])
                        Ppat_any
                      expression (testsuite/tests/typing-gadts/test.ml[826,20846+47]..[826,20846+52])
                        Pexp_construct "false" (testsuite/tests/typing-gadts/test.ml[826,20846+47]..[826,20846+52])
                        None
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[825,20795+16]..[825,20795+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[825,20795+16]..[825,20795+27])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[825,20795+25]..[825,20795+27])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[825,20795+17]..[825,20795+18])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[825,20795+17]..[825,20795+18])
                    []
                  core_type (testsuite/tests/typing-gadts/test.ml[825,20795+20]..[825,20795+23])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[825,20795+20]..[825,20795+23])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[825,20795+31]..[825,20795+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[825,20795+31]..[825,20795+40])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[825,20795+38]..[825,20795+39])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[825,20795+38]..[825,20795+39])
                          []
                      ]
                  ]
                  None
                core_type (testsuite/tests/typing-gadts/test.ml[825,20795+44]..[825,20795+48])
                  Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[825,20795+44]..[825,20795+48])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[828,20911+0]..[830,20976+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[828,20911+9]..[830,20976+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[828,20911+9]..[830,20976+2])
          Pexp_constant PConst_string ("\nval f : ('a, int) eq -> [ `A of 'a ] -> bool = <fun>\n",(testsuite/tests/typing-gadts/test.ml[828,20911+11]..[830,20976+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[832,20983+0]..[836,21179+5])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[832,20983+4]..[832,20983+64]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[832,20983+4]..[832,20983+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[832,20983+4]..[832,20983+5])
          core_type (testsuite/tests/typing-gadts/test.ml[832,20983+4]..[836,21179+5]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[832,20983+18]..[832,20983+64])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[832,20983+18]..[832,20983+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[832,20983+24]..[832,20983+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[832,20983+19]..[832,20983+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[832,20983+21]..[832,20983+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[832,20983+30]..[832,20983+64])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[832,20983+30]..[832,20983+46])
                  Ptyp_variant closed=Open
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[832,20983+39]..[832,20983+40])
                          Ptyp_var a
                      ]
                    Rtag "B" true
                      []
                  ]
                  None
                core_type (testsuite/tests/typing-gadts/test.ml[832,20983+50]..[832,20983+64])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[832,20983+57]..[832,20983+58])
                          Ptyp_var b
                      ]
                    Rtag "B" true
                      []
                  ]
                  None
        expression (testsuite/tests/typing-gadts/test.ml[832,20983+4]..[836,21179+5])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[832,20983+4]..[836,21179+5])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[832,20983+4]..[836,21179+5])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[833,21050+2]..[836,21179+5])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[833,21050+6]..[833,21050+8])
                  Ppat_var "eq" (testsuite/tests/typing-gadts/test.ml[833,21050+6]..[833,21050+8])
                expression (testsuite/tests/typing-gadts/test.ml[833,21050+9]..[836,21179+5]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[833,21050+9]..[833,21050+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[833,21050+9]..[833,21050+10])
                  expression (testsuite/tests/typing-gadts/test.ml[834,21064+4]..[836,21179+5])
                    Pexp_sequence
                    expression (testsuite/tests/typing-gadts/test.ml[834,21064+4]..[834,21064+33])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[834,21064+4]..[834,21064+10])
                        Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[834,21064+4]..[834,21064+10])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[834,21064+11]..[834,21064+33])
                            Pexp_constraint
                            expression (testsuite/tests/typing-gadts/test.ml[834,21064+12]..[834,21064+13])
                              Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[834,21064+12]..[834,21064+13])
                            core_type (testsuite/tests/typing-gadts/test.ml[834,21064+16]..[834,21064+32])
                              Ptyp_variant closed=Closed
                              [
                                Rtag "A" false
                                  [
                                    core_type (testsuite/tests/typing-gadts/test.ml[834,21064+25]..[834,21064+26])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[834,21064+25]..[834,21064+26])
                                      []
                                  ]
                                Rtag "B" true
                                  []
                              ]
                              Some
                                []
                      ]
                    expression (testsuite/tests/typing-gadts/test.ml[835,21099+4]..[836,21179+5])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (testsuite/tests/typing-gadts/test.ml[835,21099+8]..[835,21099+26]) ghost
                            Ppat_constraint
                            pattern (testsuite/tests/typing-gadts/test.ml[835,21099+8]..[835,21099+9])
                              Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[835,21099+8]..[835,21099+9])
                            core_type (testsuite/tests/typing-gadts/test.ml[835,21099+12]..[835,21099+26]) ghost
                              Ptyp_poly
                              core_type (testsuite/tests/typing-gadts/test.ml[835,21099+12]..[835,21099+26])
                                Ptyp_variant closed=Closed
                                [
                                  Rtag "A" false
                                    [
                                      core_type (testsuite/tests/typing-gadts/test.ml[835,21099+19]..[835,21099+20])
                                        Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[835,21099+19]..[835,21099+20])
                                        []
                                    ]
                                  Rtag "B" true
                                    []
                                ]
                                None
                          expression (testsuite/tests/typing-gadts/test.ml[835,21099+8]..[835,21099+50])
                            Pexp_constraint
                            expression (testsuite/tests/typing-gadts/test.ml[835,21099+29]..[835,21099+50])
                              Pexp_match
                              expression (testsuite/tests/typing-gadts/test.ml[835,21099+35]..[835,21099+37])
                                Pexp_ident "eq" (testsuite/tests/typing-gadts/test.ml[835,21099+35]..[835,21099+37])
                              [
                                <case>
                                  pattern (testsuite/tests/typing-gadts/test.ml[835,21099+43]..[835,21099+45])
                                    Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[835,21099+43]..[835,21099+45])
                                    None
                                  expression (testsuite/tests/typing-gadts/test.ml[835,21099+49]..[835,21099+50])
                                    Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[835,21099+49]..[835,21099+50])
                              ]
                            core_type (testsuite/tests/typing-gadts/test.ml[835,21099+12]..[835,21099+26])
                              Ptyp_variant closed=Closed
                              [
                                Rtag "A" false
                                  [
                                    core_type (testsuite/tests/typing-gadts/test.ml[835,21099+19]..[835,21099+20])
                                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[835,21099+19]..[835,21099+20])
                                      []
                                  ]
                                Rtag "B" true
                                  []
                              ]
                              None
                      ]
                      expression (testsuite/tests/typing-gadts/test.ml[836,21179+4]..[836,21179+5])
                        Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[836,21179+4]..[836,21179+5])
              core_type (testsuite/tests/typing-gadts/test.ml[832,20983+18]..[832,20983+64])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[832,20983+18]..[832,20983+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[832,20983+24]..[832,20983+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[832,20983+19]..[832,20983+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[832,20983+19]..[832,20983+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[832,20983+21]..[832,20983+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[832,20983+21]..[832,20983+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[832,20983+30]..[832,20983+64])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[832,20983+30]..[832,20983+46])
                    Ptyp_variant closed=Open
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[832,20983+39]..[832,20983+40])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[832,20983+39]..[832,20983+40])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    None
                  core_type (testsuite/tests/typing-gadts/test.ml[832,20983+50]..[832,20983+64])
                    Ptyp_variant closed=Closed
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[832,20983+57]..[832,20983+58])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[832,20983+57]..[832,20983+58])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[837,21187+0]..[848,21699+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[837,21187+9]..[848,21699+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[837,21187+9]..[848,21699+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/test.ml[837,21187+9]..[839,21269+2])
              Pexp_constant PConst_string ("\nval f : ('a, 'b) eq -> [ `A of 'a | `B ] -> [ `A of 'b | `B ] = <fun>\n",(testsuite/tests/typing-gadts/test.ml[837,21187+11]..[839,21269+0]),Some "")
            expression (testsuite/tests/typing-gadts/test.ml[839,21269+4]..[848,21699+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/test.ml[839,21269+4]..[839,21269+13])
              Some
                expression (testsuite/tests/typing-gadts/test.ml[839,21269+13]..[848,21699+2])
                  Pexp_constant PConst_string ("\nLine 4, characters 49-50:\n4 |     let r : [`A of b | `B] = match eq with Eq -> o in (* fail with principal *)\n                                                     ^\nError: This expression has type [ `A of a | `B ]\n       but an expression was expected of type [ `A of b | `B ]\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[839,21269+15]..[848,21699+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[850,21706+0]..[854,21887+5])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[850,21706+4]..[850,21706+64]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[850,21706+4]..[850,21706+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[850,21706+4]..[850,21706+5])
          core_type (testsuite/tests/typing-gadts/test.ml[850,21706+4]..[854,21887+5]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[850,21706+18]..[850,21706+64])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[850,21706+18]..[850,21706+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[850,21706+24]..[850,21706+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[850,21706+19]..[850,21706+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[850,21706+21]..[850,21706+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[850,21706+30]..[850,21706+64])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[850,21706+30]..[850,21706+46])
                  Ptyp_variant closed=Open
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[850,21706+39]..[850,21706+40])
                          Ptyp_var a
                      ]
                    Rtag "B" true
                      []
                  ]
                  None
                core_type (testsuite/tests/typing-gadts/test.ml[850,21706+50]..[850,21706+64])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[850,21706+57]..[850,21706+58])
                          Ptyp_var b
                      ]
                    Rtag "B" true
                      []
                  ]
                  None
        expression (testsuite/tests/typing-gadts/test.ml[850,21706+4]..[854,21887+5])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[850,21706+4]..[854,21887+5])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[850,21706+4]..[854,21887+5])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[851,21773+2]..[854,21887+5])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[851,21773+6]..[851,21773+8])
                  Ppat_var "eq" (testsuite/tests/typing-gadts/test.ml[851,21773+6]..[851,21773+8])
                expression (testsuite/tests/typing-gadts/test.ml[851,21773+9]..[854,21887+5]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[851,21773+9]..[851,21773+10])
                    Ppat_var "o" (testsuite/tests/typing-gadts/test.ml[851,21773+9]..[851,21773+10])
                  expression (testsuite/tests/typing-gadts/test.ml[852,21787+4]..[854,21887+5])
                    Pexp_let Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/test.ml[852,21787+8]..[852,21787+26]) ghost
                          Ppat_constraint
                          pattern (testsuite/tests/typing-gadts/test.ml[852,21787+8]..[852,21787+9])
                            Ppat_var "r" (testsuite/tests/typing-gadts/test.ml[852,21787+8]..[852,21787+9])
                          core_type (testsuite/tests/typing-gadts/test.ml[852,21787+12]..[852,21787+26]) ghost
                            Ptyp_poly
                            core_type (testsuite/tests/typing-gadts/test.ml[852,21787+12]..[852,21787+26])
                              Ptyp_variant closed=Closed
                              [
                                Rtag "A" false
                                  [
                                    core_type (testsuite/tests/typing-gadts/test.ml[852,21787+19]..[852,21787+20])
                                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[852,21787+19]..[852,21787+20])
                                      []
                                  ]
                                Rtag "B" true
                                  []
                              ]
                              None
                        expression (testsuite/tests/typing-gadts/test.ml[852,21787+8]..[852,21787+50])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/test.ml[852,21787+29]..[852,21787+50])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/test.ml[852,21787+35]..[852,21787+37])
                              Pexp_ident "eq" (testsuite/tests/typing-gadts/test.ml[852,21787+35]..[852,21787+37])
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/test.ml[852,21787+43]..[852,21787+45])
                                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[852,21787+43]..[852,21787+45])
                                  None
                                expression (testsuite/tests/typing-gadts/test.ml[852,21787+49]..[852,21787+50])
                                  Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[852,21787+49]..[852,21787+50])
                            ]
                          core_type (testsuite/tests/typing-gadts/test.ml[852,21787+12]..[852,21787+26])
                            Ptyp_variant closed=Closed
                            [
                              Rtag "A" false
                                [
                                  core_type (testsuite/tests/typing-gadts/test.ml[852,21787+19]..[852,21787+20])
                                    Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[852,21787+19]..[852,21787+20])
                                    []
                                ]
                              Rtag "B" true
                                []
                            ]
                            None
                    ]
                    expression (testsuite/tests/typing-gadts/test.ml[853,21852+4]..[854,21887+5])
                      Pexp_sequence
                      expression (testsuite/tests/typing-gadts/test.ml[853,21852+4]..[853,21852+33])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[853,21852+4]..[853,21852+10])
                          Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[853,21852+4]..[853,21852+10])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[853,21852+11]..[853,21852+33])
                              Pexp_constraint
                              expression (testsuite/tests/typing-gadts/test.ml[853,21852+12]..[853,21852+13])
                                Pexp_ident "o" (testsuite/tests/typing-gadts/test.ml[853,21852+12]..[853,21852+13])
                              core_type (testsuite/tests/typing-gadts/test.ml[853,21852+16]..[853,21852+32])
                                Ptyp_variant closed=Closed
                                [
                                  Rtag "A" false
                                    [
                                      core_type (testsuite/tests/typing-gadts/test.ml[853,21852+25]..[853,21852+26])
                                        Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[853,21852+25]..[853,21852+26])
                                        []
                                    ]
                                  Rtag "B" true
                                    []
                                ]
                                Some
                                  []
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[854,21887+4]..[854,21887+5])
                        Pexp_ident "r" (testsuite/tests/typing-gadts/test.ml[854,21887+4]..[854,21887+5])
              core_type (testsuite/tests/typing-gadts/test.ml[850,21706+18]..[850,21706+64])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[850,21706+18]..[850,21706+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[850,21706+24]..[850,21706+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[850,21706+19]..[850,21706+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[850,21706+19]..[850,21706+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[850,21706+21]..[850,21706+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[850,21706+21]..[850,21706+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[850,21706+30]..[850,21706+64])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[850,21706+30]..[850,21706+46])
                    Ptyp_variant closed=Open
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[850,21706+39]..[850,21706+40])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[850,21706+39]..[850,21706+40])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    None
                  core_type (testsuite/tests/typing-gadts/test.ml[850,21706+50]..[850,21706+64])
                    Ptyp_variant closed=Closed
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[850,21706+57]..[850,21706+58])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[850,21706+57]..[850,21706+58])
                            []
                        ]
                      Rtag "B" true
                        []
                    ]
                    None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[855,21895+0]..[864,22307+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[855,21895+9]..[864,22307+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[855,21895+9]..[864,22307+2])
          Pexp_constant PConst_string ("\nLine 3, characters 49-50:\n3 |     let r : [`A of b | `B] = match eq with Eq -> o in (* fail *)\n                                                     ^\nError: This expression has type [> `A of a | `B ]\n       but an expression was expected of type [ `A of b | `B ]\n       Type a is not compatible with type b = a\n       This instance of a is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[855,21895+11]..[864,22307+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[868,22338+0]..[869,22350+47])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/test.ml[868,22338+8]..[868,22338+9]) (testsuite/tests/typing-gadts/test.ml[868,22338+0]..[869,22350+47])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[868,22338+5]..[868,22338+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[869,22350+4]..[869,22350+12])
                "A" (testsuite/tests/typing-gadts/test.ml[869,22350+4]..[869,22350+5])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[869,22350+9]..[869,22350+12])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[869,22350+9]..[869,22350+12])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/test.ml[869,22350+13]..[869,22350+24])
                "B" (testsuite/tests/typing-gadts/test.ml[869,22350+15]..[869,22350+16])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[869,22350+20]..[869,22350+24])
                    Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[869,22350+20]..[869,22350+24])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/test.ml[869,22350+25]..[869,22350+37])
                "C" (testsuite/tests/typing-gadts/test.ml[869,22350+27]..[869,22350+28])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[869,22350+32]..[869,22350+37])
                    Ptyp_constr "float" (testsuite/tests/typing-gadts/test.ml[869,22350+32]..[869,22350+37])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/test.ml[869,22350+38]..[869,22350+47])
                "D" (testsuite/tests/typing-gadts/test.ml[869,22350+40]..[869,22350+41])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[869,22350+45]..[869,22350+47])
                    Ptyp_var a
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[871,22399+0]..[876,22492+26])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/test.ml[871,22399+7]..[871,22399+9]) (testsuite/tests/typing-gadts/test.ml[871,22399+0]..[876,22492+26])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[871,22399+5]..[871,22399+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[872,22411+2]..[872,22411+29])
                "TE" (testsuite/tests/typing-gadts/test.ml[872,22411+4]..[872,22411+6])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[872,22411+9]..[872,22411+14])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[872,22411+12]..[872,22411+14])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[872,22411+9]..[872,22411+11])
                        Ptyp_var a
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[872,22411+18]..[872,22411+29])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[872,22411+27]..[872,22411+29])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[872,22411+18]..[872,22411+26])
                        Ptyp_constr "array" (testsuite/tests/typing-gadts/test.ml[872,22411+21]..[872,22411+26])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[872,22411+18]..[872,22411+20])
                            Ptyp_var a
                        ]
                    ]
              (testsuite/tests/typing-gadts/test.ml[873,22441+2]..[873,22441+15])
                "TA" (testsuite/tests/typing-gadts/test.ml[873,22441+4]..[873,22441+6])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[873,22441+9]..[873,22441+15])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[873,22441+13]..[873,22441+15])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[873,22441+9]..[873,22441+12])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[873,22441+9]..[873,22441+12])
                        []
                    ]
              (testsuite/tests/typing-gadts/test.ml[874,22457+2]..[874,22457+16])
                "TB" (testsuite/tests/typing-gadts/test.ml[874,22457+4]..[874,22457+6])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[874,22457+9]..[874,22457+16])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[874,22457+14]..[874,22457+16])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[874,22457+9]..[874,22457+13])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[874,22457+9]..[874,22457+13])
                        []
                    ]
              (testsuite/tests/typing-gadts/test.ml[875,22474+2]..[875,22474+17])
                "TC" (testsuite/tests/typing-gadts/test.ml[875,22474+4]..[875,22474+6])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[875,22474+9]..[875,22474+17])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[875,22474+15]..[875,22474+17])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[875,22474+9]..[875,22474+14])
                        Ptyp_constr "float" (testsuite/tests/typing-gadts/test.ml[875,22474+9]..[875,22474+14])
                        []
                    ]
              (testsuite/tests/typing-gadts/test.ml[876,22492+2]..[876,22492+26])
                "TD" (testsuite/tests/typing-gadts/test.ml[876,22492+4]..[876,22492+6])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[876,22492+9]..[876,22492+15])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/test.ml[876,22492+9]..[876,22492+15])
                    []
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[876,22492+19]..[876,22492+26])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[876,22492+24]..[876,22492+26])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[876,22492+19]..[876,22492+23])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[876,22492+19]..[876,22492+23])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[878,22520+0]..[890,22844+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[878,22520+4]..[878,22520+34]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[878,22520+4]..[878,22520+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[878,22520+4]..[878,22520+5])
          core_type (testsuite/tests/typing-gadts/test.ml[878,22520+4]..[890,22844+15]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[878,22520+16]..[878,22520+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[878,22520+16]..[878,22520+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[878,22520+18]..[878,22520+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[878,22520+16]..[878,22520+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[878,22520+24]..[878,22520+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[878,22520+24]..[878,22520+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[878,22520+26]..[878,22520+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[878,22520+24]..[878,22520+25])
                      Ptyp_var a
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[878,22520+31]..[878,22520+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[878,22520+31]..[878,22520+34])
                  []
        expression (testsuite/tests/typing-gadts/test.ml[878,22520+4]..[890,22844+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[878,22520+4]..[890,22844+15])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[878,22520+37]..[890,22844+15])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[878,22520+41]..[878,22520+42])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[878,22520+41]..[878,22520+42])
              expression (testsuite/tests/typing-gadts/test.ml[878,22520+43]..[890,22844+15]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[878,22520+43]..[878,22520+44])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[878,22520+43]..[878,22520+44])
                expression (testsuite/tests/typing-gadts/test.ml[879,22568+2]..[890,22844+15])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/test.ml[879,22568+8]..[879,22568+12])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/test.ml[879,22568+8]..[879,22568+9])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[879,22568+8]..[879,22568+9])
                      expression (testsuite/tests/typing-gadts/test.ml[879,22568+11]..[879,22568+12])
                        Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[879,22568+11]..[879,22568+12])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[880,22586+4]..[880,22586+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[880,22586+4]..[880,22586+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/test.ml[880,22586+7]..[880,22586+10])
                            Ppat_construct "A" (testsuite/tests/typing-gadts/test.ml[880,22586+7]..[880,22586+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[880,22586+9]..[880,22586+10])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[880,22586+9]..[880,22586+10])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[880,22586+14]..[880,22586+15])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[880,22586+14]..[880,22586+15])
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[881,22602+4]..[881,22602+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[881,22602+4]..[881,22602+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/test.ml[881,22602+7]..[881,22602+10])
                            Ppat_construct "B" (testsuite/tests/typing-gadts/test.ml[881,22602+7]..[881,22602+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[881,22602+9]..[881,22602+10])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[881,22602+9]..[881,22602+10])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[881,22602+14]..[881,22602+32])
                        Pexp_ifthenelse
                        expression (testsuite/tests/typing-gadts/test.ml[881,22602+17]..[881,22602+18])
                          Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[881,22602+17]..[881,22602+18])
                        expression (testsuite/tests/typing-gadts/test.ml[881,22602+24]..[881,22602+25])
                          Pexp_constant PConst_int (1,None)
                        Some
                          expression (testsuite/tests/typing-gadts/test.ml[881,22602+31]..[881,22602+32])
                            Pexp_constant PConst_int (2,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[882,22635+4]..[882,22635+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[882,22635+4]..[882,22635+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/test.ml[882,22635+7]..[882,22635+10])
                            Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[882,22635+7]..[882,22635+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[882,22635+9]..[882,22635+10])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[882,22635+9]..[882,22635+10])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[882,22635+14]..[882,22635+24])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[882,22635+14]..[882,22635+22])
                          Pexp_ident "truncate" (testsuite/tests/typing-gadts/test.ml[882,22635+14]..[882,22635+22])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[882,22635+23]..[882,22635+24])
                              Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[882,22635+23]..[882,22635+24])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[883,22660+4]..[883,22660+20])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[883,22660+4]..[883,22660+9])
                            Ppat_construct "TE" (testsuite/tests/typing-gadts/test.ml[883,22660+4]..[883,22660+6])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[883,22660+7]..[883,22660+9])
                                Ppat_construct "TC" (testsuite/tests/typing-gadts/test.ml[883,22660+7]..[883,22660+9])
                                None
                          pattern (testsuite/tests/typing-gadts/test.ml[883,22660+11]..[883,22660+20])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[883,22660+11]..[883,22660+12])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[883,22660+13]..[883,22660+20])
                                Ppat_array
                                [
                                  pattern (testsuite/tests/typing-gadts/test.ml[883,22660+15]..[883,22660+18])
                                    Ppat_constant PConst_float (1.0,None)
                                ]
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[883,22660+24]..[883,22660+26])
                        Pexp_constant PConst_int (14,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[884,22687+4]..[884,22687+11])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[884,22687+4]..[884,22687+6])
                            Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[884,22687+4]..[884,22687+6])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[884,22687+8]..[884,22687+11])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[884,22687+8]..[884,22687+9])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[884,22687+10]..[884,22687+11])
                                Ppat_constant PConst_int (0,None)
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[884,22687+15]..[884,22687+17])
                        Pexp_constant PConst_int (-1,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[885,22705+4]..[885,22705+11])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[885,22705+4]..[885,22705+6])
                            Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[885,22705+4]..[885,22705+6])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[885,22705+8]..[885,22705+11])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[885,22705+8]..[885,22705+9])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[885,22705+10]..[885,22705+11])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[885,22705+10]..[885,22705+11])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[885,22705+15]..[885,22705+16])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[885,22705+15]..[885,22705+16])
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[886,22722+4]..[886,22722+21])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[886,22722+4]..[886,22722+12])
                            Ppat_construct "TD" (testsuite/tests/typing-gadts/test.ml[886,22722+4]..[886,22722+6])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[886,22722+7]..[886,22722+12])
                                Ppat_constant PConst_string("bye",(testsuite/tests/typing-gadts/test.ml[886,22722+8]..[886,22722+11]),None)
                          pattern (testsuite/tests/typing-gadts/test.ml[886,22722+14]..[886,22722+21])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[886,22722+14]..[886,22722+15])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[886,22722+16]..[886,22722+21])
                                Ppat_construct "false" (testsuite/tests/typing-gadts/test.ml[886,22722+16]..[886,22722+21])
                                None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[886,22722+25]..[886,22722+27])
                        Pexp_constant PConst_int (13,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[887,22750+4]..[887,22750+22])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[887,22750+4]..[887,22750+14])
                            Ppat_construct "TD" (testsuite/tests/typing-gadts/test.ml[887,22750+4]..[887,22750+6])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[887,22750+7]..[887,22750+14])
                                Ppat_constant PConst_string("hello",(testsuite/tests/typing-gadts/test.ml[887,22750+8]..[887,22750+13]),None)
                          pattern (testsuite/tests/typing-gadts/test.ml[887,22750+16]..[887,22750+22])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[887,22750+16]..[887,22750+17])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[887,22750+18]..[887,22750+22])
                                Ppat_construct "true" (testsuite/tests/typing-gadts/test.ml[887,22750+18]..[887,22750+22])
                                None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[887,22750+26]..[887,22750+28])
                        Pexp_constant PConst_int (12,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[889,22818+4]..[889,22818+11])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[889,22818+4]..[889,22818+6])
                            Ppat_construct "TC" (testsuite/tests/typing-gadts/test.ml[889,22818+4]..[889,22818+6])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[889,22818+8]..[889,22818+11])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[889,22818+8]..[889,22818+9])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[889,22818+10]..[889,22818+11])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[889,22818+10]..[889,22818+11])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[889,22818+15]..[889,22818+25])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[889,22818+15]..[889,22818+23])
                          Pexp_ident "truncate" (testsuite/tests/typing-gadts/test.ml[889,22818+15]..[889,22818+23])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[889,22818+24]..[889,22818+25])
                              Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[889,22818+24]..[889,22818+25])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[890,22844+4]..[890,22844+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[890,22844+4]..[890,22844+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/test.ml[890,22844+7]..[890,22844+10])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[890,22844+7]..[890,22844+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[890,22844+9]..[890,22844+10])
                                Ppat_any
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[890,22844+14]..[890,22844+15])
                        Pexp_constant PConst_int (0,None)
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[878,22520+16]..[878,22520+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[878,22520+16]..[878,22520+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[878,22520+18]..[878,22520+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[878,22520+16]..[878,22520+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[878,22520+16]..[878,22520+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[878,22520+24]..[878,22520+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[878,22520+24]..[878,22520+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[878,22520+26]..[878,22520+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[878,22520+24]..[878,22520+25])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[878,22520+24]..[878,22520+25])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[878,22520+31]..[878,22520+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[878,22520+31]..[878,22520+34])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[892,22863+0]..[901,23088+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[892,22863+9]..[901,23088+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[892,22863+9]..[901,23088+2])
          Pexp_constant PConst_string ("\ntype 'a t = A of int | B of bool | C of float | D of 'a\ntype _ ty =\n    TE : 'a ty -> 'a array ty\n  | TA : int ty\n  | TB : bool ty\n  | TC : float ty\n  | TD : string -> bool ty\nval f : 'a ty -> 'a t -> int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[892,22863+11]..[901,23088+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[903,23095+0]..[910,23280+16])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[903,23095+4]..[903,23095+34]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[903,23095+4]..[903,23095+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[903,23095+4]..[903,23095+5])
          core_type (testsuite/tests/typing-gadts/test.ml[903,23095+4]..[910,23280+16]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[903,23095+16]..[903,23095+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[903,23095+16]..[903,23095+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[903,23095+18]..[903,23095+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[903,23095+16]..[903,23095+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[903,23095+24]..[903,23095+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[903,23095+24]..[903,23095+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[903,23095+26]..[903,23095+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[903,23095+24]..[903,23095+25])
                      Ptyp_var a
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[903,23095+31]..[903,23095+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[903,23095+31]..[903,23095+34])
                  []
        expression (testsuite/tests/typing-gadts/test.ml[903,23095+4]..[910,23280+16])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[903,23095+4]..[910,23280+16])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[903,23095+37]..[910,23280+16])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[903,23095+41]..[903,23095+42])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[903,23095+41]..[903,23095+42])
              expression (testsuite/tests/typing-gadts/test.ml[903,23095+43]..[910,23280+16]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[903,23095+43]..[903,23095+44])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[903,23095+43]..[903,23095+44])
                expression (testsuite/tests/typing-gadts/test.ml[904,23143+2]..[910,23280+16])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/test.ml[904,23143+8]..[904,23143+12])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/test.ml[904,23143+8]..[904,23143+9])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[904,23143+8]..[904,23143+9])
                      expression (testsuite/tests/typing-gadts/test.ml[904,23143+11]..[904,23143+12])
                        Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[904,23143+11]..[904,23143+12])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[905,23161+4]..[905,23161+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[905,23161+4]..[905,23161+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/test.ml[905,23161+7]..[905,23161+10])
                            Ppat_construct "A" (testsuite/tests/typing-gadts/test.ml[905,23161+7]..[905,23161+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[905,23161+9]..[905,23161+10])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[905,23161+9]..[905,23161+10])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[905,23161+14]..[905,23161+15])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[905,23161+14]..[905,23161+15])
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[906,23177+4]..[906,23177+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[906,23177+4]..[906,23177+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/test.ml[906,23177+7]..[906,23177+10])
                            Ppat_construct "B" (testsuite/tests/typing-gadts/test.ml[906,23177+7]..[906,23177+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[906,23177+9]..[906,23177+10])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[906,23177+9]..[906,23177+10])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[906,23177+14]..[906,23177+32])
                        Pexp_ifthenelse
                        expression (testsuite/tests/typing-gadts/test.ml[906,23177+17]..[906,23177+18])
                          Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[906,23177+17]..[906,23177+18])
                        expression (testsuite/tests/typing-gadts/test.ml[906,23177+24]..[906,23177+25])
                          Pexp_constant PConst_int (1,None)
                        Some
                          expression (testsuite/tests/typing-gadts/test.ml[906,23177+31]..[906,23177+32])
                            Pexp_constant PConst_int (2,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[907,23210+4]..[907,23210+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[907,23210+4]..[907,23210+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/test.ml[907,23210+7]..[907,23210+10])
                            Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[907,23210+7]..[907,23210+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[907,23210+9]..[907,23210+10])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[907,23210+9]..[907,23210+10])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[907,23210+14]..[907,23210+24])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[907,23210+14]..[907,23210+22])
                          Pexp_ident "truncate" (testsuite/tests/typing-gadts/test.ml[907,23210+14]..[907,23210+22])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[907,23210+23]..[907,23210+24])
                              Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[907,23210+23]..[907,23210+24])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[908,23235+4]..[908,23235+20])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[908,23235+4]..[908,23235+9])
                            Ppat_construct "TE" (testsuite/tests/typing-gadts/test.ml[908,23235+4]..[908,23235+6])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[908,23235+7]..[908,23235+9])
                                Ppat_construct "TC" (testsuite/tests/typing-gadts/test.ml[908,23235+7]..[908,23235+9])
                                None
                          pattern (testsuite/tests/typing-gadts/test.ml[908,23235+11]..[908,23235+20])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[908,23235+11]..[908,23235+12])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[908,23235+13]..[908,23235+20])
                                Ppat_array
                                [
                                  pattern (testsuite/tests/typing-gadts/test.ml[908,23235+15]..[908,23235+18])
                                    Ppat_constant PConst_float (1.0,None)
                                ]
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[908,23235+24]..[908,23235+26])
                        Pexp_constant PConst_int (14,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[909,23262+4]..[909,23262+11])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[909,23262+4]..[909,23262+6])
                            Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[909,23262+4]..[909,23262+6])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[909,23262+8]..[909,23262+11])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[909,23262+8]..[909,23262+9])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[909,23262+10]..[909,23262+11])
                                Ppat_constant PConst_int (0,None)
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[909,23262+15]..[909,23262+17])
                        Pexp_constant PConst_int (-1,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[910,23280+4]..[910,23280+11])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[910,23280+4]..[910,23280+6])
                            Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[910,23280+4]..[910,23280+6])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[910,23280+8]..[910,23280+11])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[910,23280+8]..[910,23280+9])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[910,23280+10]..[910,23280+11])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[910,23280+10]..[910,23280+11])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[910,23280+15]..[910,23280+16])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[910,23280+15]..[910,23280+16])
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[903,23095+16]..[903,23095+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[903,23095+16]..[903,23095+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[903,23095+18]..[903,23095+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[903,23095+16]..[903,23095+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[903,23095+16]..[903,23095+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[903,23095+24]..[903,23095+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[903,23095+24]..[903,23095+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[903,23095+26]..[903,23095+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[903,23095+24]..[903,23095+25])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[903,23095+24]..[903,23095+25])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[903,23095+31]..[903,23095+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[903,23095+31]..[903,23095+34])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[912,23311+0]..[925,23708+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[912,23311+9]..[925,23708+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[912,23311+9]..[925,23708+2])
          Pexp_constant PConst_string ("\nLines 2-8, characters 2-16:\n2 | ..match x, y with\n3 |   | _, A z -> z\n4 |   | _, B z -> if z then 1 else 2\n5 |   | _, C z -> truncate z\n6 |   | TE TC, D [|1.0|] -> 14\n7 |   | TA, D 0 -> -1\n8 |   | TA, D z -> z\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\n(TE TC, D [| 0. |])\nval f : 'a ty -> 'a t -> int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[912,23311+11]..[925,23708+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[927,23715+0]..[934,23900+16])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[927,23715+4]..[927,23715+34]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[927,23715+4]..[927,23715+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[927,23715+4]..[927,23715+5])
          core_type (testsuite/tests/typing-gadts/test.ml[927,23715+4]..[934,23900+16]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[927,23715+16]..[927,23715+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[927,23715+16]..[927,23715+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[927,23715+18]..[927,23715+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[927,23715+16]..[927,23715+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[927,23715+24]..[927,23715+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[927,23715+24]..[927,23715+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[927,23715+26]..[927,23715+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[927,23715+24]..[927,23715+25])
                      Ptyp_var a
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[927,23715+31]..[927,23715+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[927,23715+31]..[927,23715+34])
                  []
        expression (testsuite/tests/typing-gadts/test.ml[927,23715+4]..[934,23900+16])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[927,23715+4]..[934,23900+16])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[927,23715+37]..[934,23900+16])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[927,23715+41]..[927,23715+42])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[927,23715+41]..[927,23715+42])
              expression (testsuite/tests/typing-gadts/test.ml[927,23715+43]..[934,23900+16]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[927,23715+43]..[927,23715+44])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[927,23715+43]..[927,23715+44])
                expression (testsuite/tests/typing-gadts/test.ml[928,23763+2]..[934,23900+16])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/test.ml[928,23763+8]..[928,23763+12])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/test.ml[928,23763+8]..[928,23763+9])
                        Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[928,23763+8]..[928,23763+9])
                      expression (testsuite/tests/typing-gadts/test.ml[928,23763+11]..[928,23763+12])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[928,23763+11]..[928,23763+12])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[929,23781+4]..[929,23781+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[929,23781+4]..[929,23781+7])
                            Ppat_construct "A" (testsuite/tests/typing-gadts/test.ml[929,23781+4]..[929,23781+5])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[929,23781+6]..[929,23781+7])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[929,23781+6]..[929,23781+7])
                          pattern (testsuite/tests/typing-gadts/test.ml[929,23781+9]..[929,23781+10])
                            Ppat_any
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[929,23781+14]..[929,23781+15])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[929,23781+14]..[929,23781+15])
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[930,23797+4]..[930,23797+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[930,23797+4]..[930,23797+7])
                            Ppat_construct "B" (testsuite/tests/typing-gadts/test.ml[930,23797+4]..[930,23797+5])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[930,23797+6]..[930,23797+7])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[930,23797+6]..[930,23797+7])
                          pattern (testsuite/tests/typing-gadts/test.ml[930,23797+9]..[930,23797+10])
                            Ppat_any
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[930,23797+14]..[930,23797+32])
                        Pexp_ifthenelse
                        expression (testsuite/tests/typing-gadts/test.ml[930,23797+17]..[930,23797+18])
                          Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[930,23797+17]..[930,23797+18])
                        expression (testsuite/tests/typing-gadts/test.ml[930,23797+24]..[930,23797+25])
                          Pexp_constant PConst_int (1,None)
                        Some
                          expression (testsuite/tests/typing-gadts/test.ml[930,23797+31]..[930,23797+32])
                            Pexp_constant PConst_int (2,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[931,23830+4]..[931,23830+10])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[931,23830+4]..[931,23830+7])
                            Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[931,23830+4]..[931,23830+5])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[931,23830+6]..[931,23830+7])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[931,23830+6]..[931,23830+7])
                          pattern (testsuite/tests/typing-gadts/test.ml[931,23830+9]..[931,23830+10])
                            Ppat_any
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[931,23830+14]..[931,23830+24])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[931,23830+14]..[931,23830+22])
                          Pexp_ident "truncate" (testsuite/tests/typing-gadts/test.ml[931,23830+14]..[931,23830+22])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[931,23830+23]..[931,23830+24])
                              Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[931,23830+23]..[931,23830+24])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[932,23855+4]..[932,23855+20])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[932,23855+4]..[932,23855+13])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[932,23855+4]..[932,23855+5])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[932,23855+6]..[932,23855+13])
                                Ppat_array
                                [
                                  pattern (testsuite/tests/typing-gadts/test.ml[932,23855+8]..[932,23855+11])
                                    Ppat_constant PConst_float (1.0,None)
                                ]
                          pattern (testsuite/tests/typing-gadts/test.ml[932,23855+15]..[932,23855+20])
                            Ppat_construct "TE" (testsuite/tests/typing-gadts/test.ml[932,23855+15]..[932,23855+17])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[932,23855+18]..[932,23855+20])
                                Ppat_construct "TC" (testsuite/tests/typing-gadts/test.ml[932,23855+18]..[932,23855+20])
                                None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[932,23855+24]..[932,23855+26])
                        Pexp_constant PConst_int (14,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[933,23882+4]..[933,23882+11])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[933,23882+4]..[933,23882+7])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[933,23882+4]..[933,23882+5])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[933,23882+6]..[933,23882+7])
                                Ppat_constant PConst_int (0,None)
                          pattern (testsuite/tests/typing-gadts/test.ml[933,23882+9]..[933,23882+11])
                            Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[933,23882+9]..[933,23882+11])
                            None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[933,23882+15]..[933,23882+17])
                        Pexp_constant PConst_int (-1,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[934,23900+4]..[934,23900+11])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[934,23900+4]..[934,23900+7])
                            Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[934,23900+4]..[934,23900+5])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/test.ml[934,23900+6]..[934,23900+7])
                                Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[934,23900+6]..[934,23900+7])
                          pattern (testsuite/tests/typing-gadts/test.ml[934,23900+9]..[934,23900+11])
                            Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[934,23900+9]..[934,23900+11])
                            None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[934,23900+15]..[934,23900+16])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[934,23900+15]..[934,23900+16])
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[927,23715+16]..[927,23715+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[927,23715+16]..[927,23715+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[927,23715+18]..[927,23715+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[927,23715+16]..[927,23715+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[927,23715+16]..[927,23715+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[927,23715+24]..[927,23715+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[927,23715+24]..[927,23715+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[927,23715+26]..[927,23715+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[927,23715+24]..[927,23715+25])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[927,23715+24]..[927,23715+25])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[927,23715+31]..[927,23715+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[927,23715+31]..[927,23715+34])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[936,23931+0]..[942,24134+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[936,23931+9]..[942,24134+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[936,23931+9]..[942,24134+2])
          Pexp_constant PConst_string ("\nLine 6, characters 6-13:\n6 |   | D [|1.0|], TE TC -> 14\n          ^^^^^^^\nError: This pattern matches values of type 'a array\n       but a pattern was expected which matches values of type a\n",(testsuite/tests/typing-gadts/test.ml[936,23931+11]..[942,24134+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[944,24141+0]..[944,24141+39])
    Pstr_type Rec
    [
      type_declaration "pair" (testsuite/tests/typing-gadts/test.ml[944,24141+13]..[944,24141+17]) (testsuite/tests/typing-gadts/test.ml[944,24141+0]..[944,24141+39])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[944,24141+6]..[944,24141+8])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/test.ml[944,24141+9]..[944,24141+11])
              Ptyp_var b
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/test.ml[944,24141+21]..[944,24141+30])
                Immutable
                "right" (testsuite/tests/typing-gadts/test.ml[944,24141+21]..[944,24141+26])                core_type (testsuite/tests/typing-gadts/test.ml[944,24141+27]..[944,24141+29])
                  Ptyp_var a
              (testsuite/tests/typing-gadts/test.ml[944,24141+31]..[944,24141+38])
                Immutable
                "left" (testsuite/tests/typing-gadts/test.ml[944,24141+31]..[944,24141+35])                core_type (testsuite/tests/typing-gadts/test.ml[944,24141+36]..[944,24141+38])
                  Ptyp_var b
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[946,24182+0]..[953,24445+29])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[946,24182+4]..[946,24182+34]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[946,24182+4]..[946,24182+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[946,24182+4]..[946,24182+5])
          core_type (testsuite/tests/typing-gadts/test.ml[946,24182+4]..[953,24445+29]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[946,24182+16]..[946,24182+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[946,24182+16]..[946,24182+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[946,24182+18]..[946,24182+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[946,24182+16]..[946,24182+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[946,24182+24]..[946,24182+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[946,24182+24]..[946,24182+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[946,24182+26]..[946,24182+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[946,24182+24]..[946,24182+25])
                      Ptyp_var a
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[946,24182+31]..[946,24182+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[946,24182+31]..[946,24182+34])
                  []
        expression (testsuite/tests/typing-gadts/test.ml[946,24182+4]..[953,24445+29])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[946,24182+4]..[953,24445+29])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[946,24182+37]..[953,24445+29])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[946,24182+41]..[946,24182+42])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[946,24182+41]..[946,24182+42])
              expression (testsuite/tests/typing-gadts/test.ml[946,24182+43]..[953,24445+29]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[946,24182+43]..[946,24182+44])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[946,24182+43]..[946,24182+44])
                expression (testsuite/tests/typing-gadts/test.ml[947,24230+2]..[953,24445+29])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/test.ml[947,24230+8]..[947,24230+25])
                    Pexp_record
                    [
                      "left" (testsuite/tests/typing-gadts/test.ml[947,24230+9]..[947,24230+13])
                        expression (testsuite/tests/typing-gadts/test.ml[947,24230+14]..[947,24230+15])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[947,24230+14]..[947,24230+15])
                      "right" (testsuite/tests/typing-gadts/test.ml[947,24230+17]..[947,24230+22])
                        expression (testsuite/tests/typing-gadts/test.ml[947,24230+23]..[947,24230+24])
                          Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[947,24230+23]..[947,24230+24])
                    ]
                    None
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[948,24261+4]..[948,24261+23])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[948,24261+5]..[948,24261+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[948,24261+10]..[948,24261+11])
                              Ppat_any
                          "right" (testsuite/tests/typing-gadts/test.ml[948,24261+13]..[948,24261+18])
                            pattern (testsuite/tests/typing-gadts/test.ml[948,24261+19]..[948,24261+22])
                              Ppat_construct "A" (testsuite/tests/typing-gadts/test.ml[948,24261+19]..[948,24261+20])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[948,24261+21]..[948,24261+22])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[948,24261+21]..[948,24261+22])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[948,24261+27]..[948,24261+28])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[948,24261+27]..[948,24261+28])
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[949,24290+4]..[949,24290+23])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[949,24290+5]..[949,24290+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[949,24290+10]..[949,24290+11])
                              Ppat_any
                          "right" (testsuite/tests/typing-gadts/test.ml[949,24290+13]..[949,24290+18])
                            pattern (testsuite/tests/typing-gadts/test.ml[949,24290+19]..[949,24290+22])
                              Ppat_construct "B" (testsuite/tests/typing-gadts/test.ml[949,24290+19]..[949,24290+20])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[949,24290+21]..[949,24290+22])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[949,24290+21]..[949,24290+22])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[949,24290+27]..[949,24290+45])
                        Pexp_ifthenelse
                        expression (testsuite/tests/typing-gadts/test.ml[949,24290+30]..[949,24290+31])
                          Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[949,24290+30]..[949,24290+31])
                        expression (testsuite/tests/typing-gadts/test.ml[949,24290+37]..[949,24290+38])
                          Pexp_constant PConst_int (1,None)
                        Some
                          expression (testsuite/tests/typing-gadts/test.ml[949,24290+44]..[949,24290+45])
                            Pexp_constant PConst_int (2,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[950,24336+4]..[950,24336+23])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[950,24336+5]..[950,24336+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[950,24336+10]..[950,24336+11])
                              Ppat_any
                          "right" (testsuite/tests/typing-gadts/test.ml[950,24336+13]..[950,24336+18])
                            pattern (testsuite/tests/typing-gadts/test.ml[950,24336+19]..[950,24336+22])
                              Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[950,24336+19]..[950,24336+20])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[950,24336+21]..[950,24336+22])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[950,24336+21]..[950,24336+22])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[950,24336+27]..[950,24336+37])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[950,24336+27]..[950,24336+35])
                          Pexp_ident "truncate" (testsuite/tests/typing-gadts/test.ml[950,24336+27]..[950,24336+35])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[950,24336+36]..[950,24336+37])
                              Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[950,24336+36]..[950,24336+37])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[951,24374+4]..[951,24374+33])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[951,24374+5]..[951,24374+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[951,24374+10]..[951,24374+15])
                              Ppat_construct "TE" (testsuite/tests/typing-gadts/test.ml[951,24374+10]..[951,24374+12])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[951,24374+13]..[951,24374+15])
                                  Ppat_construct "TC" (testsuite/tests/typing-gadts/test.ml[951,24374+13]..[951,24374+15])
                                  None
                          "right" (testsuite/tests/typing-gadts/test.ml[951,24374+17]..[951,24374+22])
                            pattern (testsuite/tests/typing-gadts/test.ml[951,24374+23]..[951,24374+32])
                              Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[951,24374+23]..[951,24374+24])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[951,24374+25]..[951,24374+32])
                                  Ppat_array
                                  [
                                    pattern (testsuite/tests/typing-gadts/test.ml[951,24374+27]..[951,24374+30])
                                      Ppat_constant PConst_float (1.0,None)
                                  ]
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[951,24374+37]..[951,24374+39])
                        Pexp_constant PConst_int (14,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[952,24414+4]..[952,24414+24])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[952,24414+5]..[952,24414+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[952,24414+10]..[952,24414+12])
                              Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[952,24414+10]..[952,24414+12])
                              None
                          "right" (testsuite/tests/typing-gadts/test.ml[952,24414+14]..[952,24414+19])
                            pattern (testsuite/tests/typing-gadts/test.ml[952,24414+20]..[952,24414+23])
                              Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[952,24414+20]..[952,24414+21])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[952,24414+22]..[952,24414+23])
                                  Ppat_constant PConst_int (0,None)
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[952,24414+28]..[952,24414+30])
                        Pexp_constant PConst_int (-1,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[953,24445+4]..[953,24445+24])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[953,24445+5]..[953,24445+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[953,24445+10]..[953,24445+12])
                              Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[953,24445+10]..[953,24445+12])
                              None
                          "right" (testsuite/tests/typing-gadts/test.ml[953,24445+14]..[953,24445+19])
                            pattern (testsuite/tests/typing-gadts/test.ml[953,24445+20]..[953,24445+23])
                              Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[953,24445+20]..[953,24445+21])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[953,24445+22]..[953,24445+23])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[953,24445+22]..[953,24445+23])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[953,24445+28]..[953,24445+29])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[953,24445+28]..[953,24445+29])
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[946,24182+16]..[946,24182+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[946,24182+16]..[946,24182+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[946,24182+18]..[946,24182+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[946,24182+16]..[946,24182+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[946,24182+16]..[946,24182+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[946,24182+24]..[946,24182+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[946,24182+24]..[946,24182+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[946,24182+26]..[946,24182+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[946,24182+24]..[946,24182+25])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[946,24182+24]..[946,24182+25])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[946,24182+31]..[946,24182+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[946,24182+31]..[946,24182+34])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[955,24489+0]..[962,24773+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[955,24489+9]..[962,24773+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[955,24489+9]..[962,24773+2])
          Pexp_constant PConst_string ("\ntype ('a, 'b) pair = { right : 'a; left : 'b; }\nLine 8, characters 25-32:\n8 |   | {left=TE TC; right=D [|1.0|]} -> 14\n                             ^^^^^^^\nError: This pattern matches values of type 'a array\n       but a pattern was expected which matches values of type a\n",(testsuite/tests/typing-gadts/test.ml[955,24489+11]..[962,24773+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[964,24780+0]..[964,24780+39])
    Pstr_type Rec
    [
      type_declaration "pair" (testsuite/tests/typing-gadts/test.ml[964,24780+13]..[964,24780+17]) (testsuite/tests/typing-gadts/test.ml[964,24780+0]..[964,24780+39])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[964,24780+6]..[964,24780+8])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/test.ml[964,24780+9]..[964,24780+11])
              Ptyp_var b
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/test.ml[964,24780+21]..[964,24780+29])
                Immutable
                "left" (testsuite/tests/typing-gadts/test.ml[964,24780+21]..[964,24780+25])                core_type (testsuite/tests/typing-gadts/test.ml[964,24780+26]..[964,24780+28])
                  Ptyp_var a
              (testsuite/tests/typing-gadts/test.ml[964,24780+30]..[964,24780+38])
                Immutable
                "right" (testsuite/tests/typing-gadts/test.ml[964,24780+30]..[964,24780+35])                core_type (testsuite/tests/typing-gadts/test.ml[964,24780+36]..[964,24780+38])
                  Ptyp_var b
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[966,24821+0]..[973,25084+29])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[966,24821+4]..[966,24821+34]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[966,24821+4]..[966,24821+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[966,24821+4]..[966,24821+5])
          core_type (testsuite/tests/typing-gadts/test.ml[966,24821+4]..[973,25084+29]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[966,24821+16]..[966,24821+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[966,24821+16]..[966,24821+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[966,24821+18]..[966,24821+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[966,24821+16]..[966,24821+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[966,24821+24]..[966,24821+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[966,24821+24]..[966,24821+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[966,24821+26]..[966,24821+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[966,24821+24]..[966,24821+25])
                      Ptyp_var a
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[966,24821+31]..[966,24821+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[966,24821+31]..[966,24821+34])
                  []
        expression (testsuite/tests/typing-gadts/test.ml[966,24821+4]..[973,25084+29])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[966,24821+4]..[973,25084+29])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[966,24821+37]..[973,25084+29])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[966,24821+41]..[966,24821+42])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[966,24821+41]..[966,24821+42])
              expression (testsuite/tests/typing-gadts/test.ml[966,24821+43]..[973,25084+29]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[966,24821+43]..[966,24821+44])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[966,24821+43]..[966,24821+44])
                expression (testsuite/tests/typing-gadts/test.ml[967,24869+2]..[973,25084+29])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/test.ml[967,24869+8]..[967,24869+25])
                    Pexp_record
                    [
                      "left" (testsuite/tests/typing-gadts/test.ml[967,24869+9]..[967,24869+13])
                        expression (testsuite/tests/typing-gadts/test.ml[967,24869+14]..[967,24869+15])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[967,24869+14]..[967,24869+15])
                      "right" (testsuite/tests/typing-gadts/test.ml[967,24869+17]..[967,24869+22])
                        expression (testsuite/tests/typing-gadts/test.ml[967,24869+23]..[967,24869+24])
                          Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[967,24869+23]..[967,24869+24])
                    ]
                    None
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[968,24900+4]..[968,24900+23])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[968,24900+5]..[968,24900+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[968,24900+10]..[968,24900+11])
                              Ppat_any
                          "right" (testsuite/tests/typing-gadts/test.ml[968,24900+13]..[968,24900+18])
                            pattern (testsuite/tests/typing-gadts/test.ml[968,24900+19]..[968,24900+22])
                              Ppat_construct "A" (testsuite/tests/typing-gadts/test.ml[968,24900+19]..[968,24900+20])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[968,24900+21]..[968,24900+22])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[968,24900+21]..[968,24900+22])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[968,24900+27]..[968,24900+28])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[968,24900+27]..[968,24900+28])
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[969,24929+4]..[969,24929+23])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[969,24929+5]..[969,24929+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[969,24929+10]..[969,24929+11])
                              Ppat_any
                          "right" (testsuite/tests/typing-gadts/test.ml[969,24929+13]..[969,24929+18])
                            pattern (testsuite/tests/typing-gadts/test.ml[969,24929+19]..[969,24929+22])
                              Ppat_construct "B" (testsuite/tests/typing-gadts/test.ml[969,24929+19]..[969,24929+20])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[969,24929+21]..[969,24929+22])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[969,24929+21]..[969,24929+22])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[969,24929+27]..[969,24929+45])
                        Pexp_ifthenelse
                        expression (testsuite/tests/typing-gadts/test.ml[969,24929+30]..[969,24929+31])
                          Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[969,24929+30]..[969,24929+31])
                        expression (testsuite/tests/typing-gadts/test.ml[969,24929+37]..[969,24929+38])
                          Pexp_constant PConst_int (1,None)
                        Some
                          expression (testsuite/tests/typing-gadts/test.ml[969,24929+44]..[969,24929+45])
                            Pexp_constant PConst_int (2,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[970,24975+4]..[970,24975+23])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[970,24975+5]..[970,24975+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[970,24975+10]..[970,24975+11])
                              Ppat_any
                          "right" (testsuite/tests/typing-gadts/test.ml[970,24975+13]..[970,24975+18])
                            pattern (testsuite/tests/typing-gadts/test.ml[970,24975+19]..[970,24975+22])
                              Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[970,24975+19]..[970,24975+20])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[970,24975+21]..[970,24975+22])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[970,24975+21]..[970,24975+22])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[970,24975+27]..[970,24975+37])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/test.ml[970,24975+27]..[970,24975+35])
                          Pexp_ident "truncate" (testsuite/tests/typing-gadts/test.ml[970,24975+27]..[970,24975+35])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/test.ml[970,24975+36]..[970,24975+37])
                              Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[970,24975+36]..[970,24975+37])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[971,25013+4]..[971,25013+33])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[971,25013+5]..[971,25013+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[971,25013+10]..[971,25013+15])
                              Ppat_construct "TE" (testsuite/tests/typing-gadts/test.ml[971,25013+10]..[971,25013+12])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[971,25013+13]..[971,25013+15])
                                  Ppat_construct "TC" (testsuite/tests/typing-gadts/test.ml[971,25013+13]..[971,25013+15])
                                  None
                          "right" (testsuite/tests/typing-gadts/test.ml[971,25013+17]..[971,25013+22])
                            pattern (testsuite/tests/typing-gadts/test.ml[971,25013+23]..[971,25013+32])
                              Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[971,25013+23]..[971,25013+24])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[971,25013+25]..[971,25013+32])
                                  Ppat_array
                                  [
                                    pattern (testsuite/tests/typing-gadts/test.ml[971,25013+27]..[971,25013+30])
                                      Ppat_constant PConst_float (1.0,None)
                                  ]
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[971,25013+37]..[971,25013+39])
                        Pexp_constant PConst_int (14,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[972,25053+4]..[972,25053+24])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[972,25053+5]..[972,25053+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[972,25053+10]..[972,25053+12])
                              Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[972,25053+10]..[972,25053+12])
                              None
                          "right" (testsuite/tests/typing-gadts/test.ml[972,25053+14]..[972,25053+19])
                            pattern (testsuite/tests/typing-gadts/test.ml[972,25053+20]..[972,25053+23])
                              Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[972,25053+20]..[972,25053+21])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[972,25053+22]..[972,25053+23])
                                  Ppat_constant PConst_int (0,None)
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[972,25053+28]..[972,25053+30])
                        Pexp_constant PConst_int (-1,None)
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[973,25084+4]..[973,25084+24])
                        Ppat_record Closed
                        [
                          "left" (testsuite/tests/typing-gadts/test.ml[973,25084+5]..[973,25084+9])
                            pattern (testsuite/tests/typing-gadts/test.ml[973,25084+10]..[973,25084+12])
                              Ppat_construct "TA" (testsuite/tests/typing-gadts/test.ml[973,25084+10]..[973,25084+12])
                              None
                          "right" (testsuite/tests/typing-gadts/test.ml[973,25084+14]..[973,25084+19])
                            pattern (testsuite/tests/typing-gadts/test.ml[973,25084+20]..[973,25084+23])
                              Ppat_construct "D" (testsuite/tests/typing-gadts/test.ml[973,25084+20]..[973,25084+21])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/test.ml[973,25084+22]..[973,25084+23])
                                  Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[973,25084+22]..[973,25084+23])
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[973,25084+28]..[973,25084+29])
                        Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[973,25084+28]..[973,25084+29])
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[966,24821+16]..[966,24821+34])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[966,24821+16]..[966,24821+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[966,24821+18]..[966,24821+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[966,24821+16]..[966,24821+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[966,24821+16]..[966,24821+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[966,24821+24]..[966,24821+34])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[966,24821+24]..[966,24821+27])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[966,24821+26]..[966,24821+27])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[966,24821+24]..[966,24821+25])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[966,24821+24]..[966,24821+25])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[966,24821+31]..[966,24821+34])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[966,24821+31]..[966,24821+34])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[975,25126+0]..[989,25681+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[975,25126+9]..[989,25681+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[975,25126+9]..[989,25681+2])
          Pexp_constant PConst_string ("\ntype ('a, 'b) pair = { left : 'a; right : 'b; }\nLines 4-10, characters 2-29:\n 4 | ..match {left=x; right=y} with\n 5 |   | {left=_; right=A z} -> z\n 6 |   | {left=_; right=B z} -> if z then 1 else 2\n 7 |   | {left=_; right=C z} -> truncate z\n 8 |   | {left=TE TC; right=D [|1.0|]} -> 14\n 9 |   | {left=TA; right=D 0} -> -1\n10 |   | {left=TA; right=D z} -> z\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\n{left=TE TC; right=D [| 0. |]}\nval f : 'a ty -> 'a t -> int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[975,25126+11]..[989,25681+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[993,25707+0]..[994,25763+40])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[993,25707+7]..[993,25707+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[993,25707+9]..[994,25763+40])
        Pmod_constraint
        module_expr (testsuite/tests/typing-gadts/test.ml[994,25763+2]..[994,25763+40])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/test.ml[994,25763+9]..[994,25763+24])
              Pstr_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/test.ml[994,25763+17]..[994,25763+18]) (testsuite/tests/typing-gadts/test.ml[994,25763+9]..[994,25763+24])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[994,25763+14]..[994,25763+16])
                        Ptyp_var a
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (testsuite/tests/typing-gadts/test.ml[994,25763+21]..[994,25763+24])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[994,25763+21]..[994,25763+24])
                        []
              ]
            structure_item (testsuite/tests/typing-gadts/test.ml[994,25763+25]..[994,25763+36])
              Pstr_value Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/test.ml[994,25763+29]..[994,25763+31])
                    Ppat_var "eq" (testsuite/tests/typing-gadts/test.ml[994,25763+29]..[994,25763+31])
                  expression (testsuite/tests/typing-gadts/test.ml[994,25763+34]..[994,25763+36])
                    Pexp_construct "Eq" (testsuite/tests/typing-gadts/test.ml[994,25763+34]..[994,25763+36])
                    None
              ]
          ]
        module_type (testsuite/tests/typing-gadts/test.ml[993,25707+11]..[993,25707+53])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/test.ml[993,25707+15]..[993,25707+24])
              Psig_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/test.ml[993,25707+23]..[993,25707+24]) (testsuite/tests/typing-gadts/test.ml[993,25707+15]..[993,25707+24])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[993,25707+20]..[993,25707+22])
                        Ptyp_var a
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            signature_item (testsuite/tests/typing-gadts/test.ml[993,25707+25]..[993,25707+49])
              Psig_value
              value_description "eq" (testsuite/tests/typing-gadts/test.ml[993,25707+29]..[993,25707+31]) (testsuite/tests/typing-gadts/test.ml[993,25707+25]..[993,25707+49])
                core_type (testsuite/tests/typing-gadts/test.ml[993,25707+34]..[993,25707+49])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[993,25707+47]..[993,25707+49])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[993,25707+35]..[993,25707+39])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[993,25707+38]..[993,25707+39])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[993,25707+35]..[993,25707+37])
                          Ptyp_var a
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[993,25707+41]..[993,25707+45])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[993,25707+44]..[993,25707+45])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[993,25707+41]..[993,25707+43])
                          Ptyp_var b
                      ]
                  ]
                []
          ]
  structure_item (testsuite/tests/typing-gadts/test.ml[997,25808+0]..[998,25859+19])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[997,25808+4]..[997,25808+48]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[997,25808+4]..[997,25808+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[997,25808+4]..[997,25808+5])
          core_type (testsuite/tests/typing-gadts/test.ml[997,25808+4]..[998,25859+19]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[997,25808+18]..[997,25808+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[997,25808+18]..[997,25808+35])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[997,25808+33]..[997,25808+35])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[997,25808+19]..[997,25808+24])
                    Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[997,25808+21]..[997,25808+24])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[997,25808+19]..[997,25808+20])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[997,25808+26]..[997,25808+31])
                    Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[997,25808+28]..[997,25808+31])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[997,25808+26]..[997,25808+27])
                        Ptyp_var b
                    ]
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[997,25808+39]..[997,25808+48])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[997,25808+46]..[997,25808+48])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[997,25808+40]..[997,25808+41])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[997,25808+43]..[997,25808+44])
                    Ptyp_var b
                ]
        expression (testsuite/tests/typing-gadts/test.ml[997,25808+4]..[998,25859+19])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[997,25808+4]..[998,25859+19])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[997,25808+4]..[998,25859+19])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[998,25859+2]..[998,25859+19])
                Pexp_function
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[998,25859+11]..[998,25859+13])
                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[998,25859+11]..[998,25859+13])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[998,25859+17]..[998,25859+19])
                      Pexp_construct "Eq" (testsuite/tests/typing-gadts/test.ml[998,25859+17]..[998,25859+19])
                      None
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[997,25808+18]..[997,25808+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[997,25808+18]..[997,25808+35])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[997,25808+33]..[997,25808+35])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[997,25808+19]..[997,25808+24])
                      Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[997,25808+21]..[997,25808+24])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[997,25808+19]..[997,25808+20])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[997,25808+19]..[997,25808+20])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[997,25808+26]..[997,25808+31])
                      Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[997,25808+28]..[997,25808+31])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[997,25808+26]..[997,25808+27])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[997,25808+26]..[997,25808+27])
                          []
                      ]
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[997,25808+39]..[997,25808+48])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[997,25808+46]..[997,25808+48])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[997,25808+40]..[997,25808+41])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[997,25808+40]..[997,25808+41])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[997,25808+43]..[997,25808+44])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[997,25808+43]..[997,25808+44])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1000,25893+0]..[1008,26186+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1000,25893+9]..[1008,26186+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1000,25893+9]..[1008,26186+2])
          Pexp_constant PConst_string ("\nmodule M : sig type 'a t val eq : ('a t, 'b t) eq end\nLine 6, characters 17-19:\n6 |   function Eq -> Eq (* fail *)\n                     ^^\nError: This expression has type (a, a) eq\n       but an expression was expected of type (a, b) eq\n       Type a is not compatible with type b\n",(testsuite/tests/typing-gadts/test.ml[1000,25893+11]..[1008,26186+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1010,26193+0]..[1011,26252+19])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1010,26193+4]..[1010,26193+56]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1010,26193+4]..[1010,26193+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1010,26193+4]..[1010,26193+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+4]..[1011,26252+19]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+18]..[1010,26193+56])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+18]..[1010,26193+43])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1010,26193+41]..[1010,26193+43])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+19]..[1010,26193+28])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+19]..[1010,26193+24])
                        Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1010,26193+21]..[1010,26193+24])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+19]..[1010,26193+20])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+27]..[1010,26193+28])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+30]..[1010,26193+39])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+30]..[1010,26193+35])
                        Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1010,26193+32]..[1010,26193+35])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+30]..[1010,26193+31])
                            Ptyp_var b
                        ]
                      core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+38]..[1010,26193+39])
                        Ptyp_var b
                    ]
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+47]..[1010,26193+56])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1010,26193+54]..[1010,26193+56])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+48]..[1010,26193+49])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+51]..[1010,26193+52])
                    Ptyp_var b
                ]
        expression (testsuite/tests/typing-gadts/test.ml[1010,26193+4]..[1011,26252+19])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1010,26193+4]..[1011,26252+19])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1010,26193+4]..[1011,26252+19])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[1011,26252+2]..[1011,26252+19])
                Pexp_function
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[1011,26252+11]..[1011,26252+13])
                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1011,26252+11]..[1011,26252+13])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[1011,26252+17]..[1011,26252+19])
                      Pexp_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1011,26252+17]..[1011,26252+19])
                      None
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+18]..[1010,26193+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+18]..[1010,26193+43])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1010,26193+41]..[1010,26193+43])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+19]..[1010,26193+28])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+19]..[1010,26193+24])
                          Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1010,26193+21]..[1010,26193+24])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+19]..[1010,26193+20])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1010,26193+19]..[1010,26193+20])
                              []
                          ]
                        core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+27]..[1010,26193+28])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1010,26193+27]..[1010,26193+28])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+30]..[1010,26193+39])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+30]..[1010,26193+35])
                          Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1010,26193+32]..[1010,26193+35])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+30]..[1010,26193+31])
                              Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1010,26193+30]..[1010,26193+31])
                              []
                          ]
                        core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+38]..[1010,26193+39])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1010,26193+38]..[1010,26193+39])
                          []
                      ]
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+47]..[1010,26193+56])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1010,26193+54]..[1010,26193+56])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+48]..[1010,26193+49])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1010,26193+48]..[1010,26193+49])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1010,26193+51]..[1010,26193+52])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1010,26193+51]..[1010,26193+52])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1013,26284+0]..[1015,26357+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1013,26284+9]..[1015,26357+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1013,26284+9]..[1015,26357+2])
          Pexp_constant PConst_string ("\nval f : ('a M.t * 'a, 'b M.t * 'b) eq -> ('a, 'b) eq = <fun>\n",(testsuite/tests/typing-gadts/test.ml[1013,26284+11]..[1015,26357+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1017,26364+0]..[1018,26423+19])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1017,26364+4]..[1017,26364+56]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1017,26364+4]..[1017,26364+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1017,26364+4]..[1017,26364+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+4]..[1018,26423+19]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+18]..[1017,26364+56])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+18]..[1017,26364+43])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1017,26364+41]..[1017,26364+43])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+19]..[1017,26364+28])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+19]..[1017,26364+20])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+23]..[1017,26364+28])
                        Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1017,26364+25]..[1017,26364+28])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+23]..[1017,26364+24])
                            Ptyp_var a
                        ]
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+30]..[1017,26364+39])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+30]..[1017,26364+31])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+34]..[1017,26364+39])
                        Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1017,26364+36]..[1017,26364+39])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+34]..[1017,26364+35])
                            Ptyp_var b
                        ]
                    ]
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+47]..[1017,26364+56])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1017,26364+54]..[1017,26364+56])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+48]..[1017,26364+49])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+51]..[1017,26364+52])
                    Ptyp_var b
                ]
        expression (testsuite/tests/typing-gadts/test.ml[1017,26364+4]..[1018,26423+19])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1017,26364+4]..[1018,26423+19])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1017,26364+4]..[1018,26423+19])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[1018,26423+2]..[1018,26423+19])
                Pexp_function
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[1018,26423+11]..[1018,26423+13])
                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1018,26423+11]..[1018,26423+13])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[1018,26423+17]..[1018,26423+19])
                      Pexp_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1018,26423+17]..[1018,26423+19])
                      None
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+18]..[1017,26364+56])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+18]..[1017,26364+43])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1017,26364+41]..[1017,26364+43])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+19]..[1017,26364+28])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+19]..[1017,26364+20])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1017,26364+19]..[1017,26364+20])
                          []
                        core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+23]..[1017,26364+28])
                          Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1017,26364+25]..[1017,26364+28])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+23]..[1017,26364+24])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1017,26364+23]..[1017,26364+24])
                              []
                          ]
                      ]
                    core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+30]..[1017,26364+39])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+30]..[1017,26364+31])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1017,26364+30]..[1017,26364+31])
                          []
                        core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+34]..[1017,26364+39])
                          Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1017,26364+36]..[1017,26364+39])
                          [
                            core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+34]..[1017,26364+35])
                              Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1017,26364+34]..[1017,26364+35])
                              []
                          ]
                      ]
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+47]..[1017,26364+56])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1017,26364+54]..[1017,26364+56])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+48]..[1017,26364+49])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1017,26364+48]..[1017,26364+49])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1017,26364+51]..[1017,26364+52])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1017,26364+51]..[1017,26364+52])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1020,26455+0]..[1022,26528+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1020,26455+9]..[1022,26528+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1020,26455+9]..[1022,26528+2])
          Pexp_constant PConst_string ("\nval f : ('a * 'a M.t, 'b * 'b M.t) eq -> ('a, 'b) eq = <fun>\n",(testsuite/tests/typing-gadts/test.ml[1020,26455+11]..[1022,26528+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1026,26579+0]..[1028,26611+20])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1026,26579+7]..[1026,26579+8]) (testsuite/tests/typing-gadts/test.ml[1026,26579+0]..[1028,26611+20])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1026,26579+5]..[1026,26579+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1027,26590+2]..[1027,26590+20])
                "V1" (testsuite/tests/typing-gadts/test.ml[1027,26590+4]..[1027,26590+6])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1027,26590+9]..[1027,26590+20])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1027,26590+19]..[1027,26590+20])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1027,26590+9]..[1027,26590+18])
                        Ptyp_variant closed=Closed
                        [
                          Rtag "A" true
                            []
                          Rtag "B" true
                            []
                        ]
                        None
                    ]
              (testsuite/tests/typing-gadts/test.ml[1028,26611+2]..[1028,26611+20])
                "V2" (testsuite/tests/typing-gadts/test.ml[1028,26611+4]..[1028,26611+6])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1028,26611+9]..[1028,26611+20])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1028,26611+19]..[1028,26611+20])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1028,26611+9]..[1028,26611+18])
                        Ptyp_variant closed=Closed
                        [
                          Rtag "C" true
                            []
                          Rtag "D" true
                            []
                        ]
                        None
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1030,26633+0]..[1032,26682+12])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1030,26633+4]..[1030,26633+24]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1030,26633+4]..[1030,26633+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1030,26633+4]..[1030,26633+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+4]..[1032,26682+12]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+16]..[1030,26633+24])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+16]..[1030,26633+19])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1030,26633+18]..[1030,26633+19])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+16]..[1030,26633+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+23]..[1030,26633+24])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[1030,26633+4]..[1032,26682+12])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1030,26633+4]..[1032,26682+12])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[1030,26633+27]..[1032,26682+12])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[1031,26669+4]..[1031,26669+6])
                    Ppat_construct "V1" (testsuite/tests/typing-gadts/test.ml[1031,26669+4]..[1031,26669+6])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[1031,26669+10]..[1031,26669+12])
                    Pexp_variant "A"
                    None
                <case>
                  pattern (testsuite/tests/typing-gadts/test.ml[1032,26682+4]..[1032,26682+6])
                    Ppat_construct "V2" (testsuite/tests/typing-gadts/test.ml[1032,26682+4]..[1032,26682+6])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[1032,26682+10]..[1032,26682+12])
                    Pexp_variant "C"
                    None
              ]
            core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+16]..[1030,26633+24])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+16]..[1030,26633+19])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1030,26633+18]..[1030,26633+19])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+16]..[1030,26633+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1030,26633+16]..[1030,26633+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1030,26633+23]..[1030,26633+24])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1030,26633+23]..[1030,26633+24])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1035,26699+0]..[1035,26699+4])
    Pstr_eval
    expression (testsuite/tests/typing-gadts/test.ml[1035,26699+0]..[1035,26699+4])
      Pexp_apply
      expression (testsuite/tests/typing-gadts/test.ml[1035,26699+0]..[1035,26699+1])
        Pexp_ident "f" (testsuite/tests/typing-gadts/test.ml[1035,26699+0]..[1035,26699+1])
      [
        <arg>
        Nolabel
          expression (testsuite/tests/typing-gadts/test.ml[1035,26699+2]..[1035,26699+4])
            Pexp_construct "V1" (testsuite/tests/typing-gadts/test.ml[1035,26699+2]..[1035,26699+4])
            None
      ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1036,26706+0]..[1040,26817+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1036,26706+9]..[1040,26817+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1036,26706+9]..[1040,26817+2])
          Pexp_constant PConst_string ("\ntype _ t = V1 : [ `A | `B ] t | V2 : [ `C | `D ] t\nval f : 'a t -> 'a = <fun>\n- : [ `A | `B ] = `A\n",(testsuite/tests/typing-gadts/test.ml[1036,26706+11]..[1040,26817+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1044,26851+0]..[1045,26868+37])
    Pstr_type Rec
    [
      type_declaration "int_foo" (testsuite/tests/typing-gadts/test.ml[1044,26851+7]..[1044,26851+14]) (testsuite/tests/typing-gadts/test.ml[1044,26851+0]..[1045,26868+37])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1044,26851+5]..[1044,26851+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1045,26868+2]..[1045,26868+37])
                "IF_constr" (testsuite/tests/typing-gadts/test.ml[1045,26868+4]..[1045,26868+13])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1045,26868+16]..[1045,26868+37])
                    Ptyp_constr "int_foo" (testsuite/tests/typing-gadts/test.ml[1045,26868+30]..[1045,26868+37])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1045,26868+16]..[1045,26868+29])
                        Ptyp_object Open
                          method foo
                            core_type (testsuite/tests/typing-gadts/test.ml[1045,26868+21]..[1045,26868+24])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1045,26868+21]..[1045,26868+24])
                              []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1047,26907+0]..[1048,26924+37])
    Pstr_type Rec
    [
      type_declaration "int_bar" (testsuite/tests/typing-gadts/test.ml[1047,26907+7]..[1047,26907+14]) (testsuite/tests/typing-gadts/test.ml[1047,26907+0]..[1048,26924+37])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1047,26907+5]..[1047,26907+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1048,26924+2]..[1048,26924+37])
                "IB_constr" (testsuite/tests/typing-gadts/test.ml[1048,26924+4]..[1048,26924+13])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1048,26924+16]..[1048,26924+37])
                    Ptyp_constr "int_bar" (testsuite/tests/typing-gadts/test.ml[1048,26924+30]..[1048,26924+37])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1048,26924+16]..[1048,26924+29])
                        Ptyp_object Open
                          method bar
                            core_type (testsuite/tests/typing-gadts/test.ml[1048,26924+21]..[1048,26924+24])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1048,26924+21]..[1048,26924+24])
                              []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1051,26966+0]..[1053,27060+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1051,26966+4]..[1051,26966+5])
          Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1051,26966+4]..[1051,26966+5])
        expression (testsuite/tests/typing-gadts/test.ml[1051,26966+6]..[1053,27060+15])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/test.ml[1051,26966+15]..[1053,27060+15]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1051,26966+15]..[1051,26966+20])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1051,26966+16]..[1051,26966+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1051,26966+16]..[1051,26966+17])
              core_type (testsuite/tests/typing-gadts/test.ml[1051,26966+18]..[1051,26966+19])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1051,26966+18]..[1051,26966+19])
                []
            expression (testsuite/tests/typing-gadts/test.ml[1051,26966+21]..[1053,27060+15]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1051,26966+21]..[1051,26966+36])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[1051,26966+22]..[1051,26966+23])
                  Ppat_var "e" (testsuite/tests/typing-gadts/test.ml[1051,26966+22]..[1051,26966+23])
                core_type (testsuite/tests/typing-gadts/test.ml[1051,26966+26]..[1051,26966+35])
                  Ptyp_constr "int_foo" (testsuite/tests/typing-gadts/test.ml[1051,26966+28]..[1051,26966+35])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1051,26966+26]..[1051,26966+27])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1051,26966+26]..[1051,26966+27])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[1051,26966+37]..[1053,27060+15]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1051,26966+37]..[1051,26966+53])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[1051,26966+38]..[1051,26966+40])
                    Ppat_var "e'" (testsuite/tests/typing-gadts/test.ml[1051,26966+38]..[1051,26966+40])
                  core_type (testsuite/tests/typing-gadts/test.ml[1051,26966+43]..[1051,26966+52])
                    Ptyp_constr "int_bar" (testsuite/tests/typing-gadts/test.ml[1051,26966+45]..[1051,26966+52])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1051,26966+43]..[1051,26966+44])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1051,26966+43]..[1051,26966+44])
                        []
                    ]
                expression (testsuite/tests/typing-gadts/test.ml[1052,27022+2]..[1053,27060+15])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[1052,27022+6]..[1052,27022+26])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[1052,27022+6]..[1052,27022+15])
                            Ppat_construct "IF_constr" (testsuite/tests/typing-gadts/test.ml[1052,27022+6]..[1052,27022+15])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[1052,27022+17]..[1052,27022+26])
                            Ppat_construct "IB_constr" (testsuite/tests/typing-gadts/test.ml[1052,27022+17]..[1052,27022+26])
                            None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[1052,27022+29]..[1052,27022+34])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/test.ml[1052,27022+29]..[1052,27022+30])
                            Pexp_ident "e" (testsuite/tests/typing-gadts/test.ml[1052,27022+29]..[1052,27022+30])
                          expression (testsuite/tests/typing-gadts/test.ml[1052,27022+32]..[1052,27022+34])
                            Pexp_ident "e'" (testsuite/tests/typing-gadts/test.ml[1052,27022+32]..[1052,27022+34])
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[1053,27060+2]..[1053,27060+15])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[1053,27060+3]..[1053,27060+4])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1053,27060+3]..[1053,27060+4])
                    core_type (testsuite/tests/typing-gadts/test.ml[1053,27060+5]..[1053,27060+14])
                      Ptyp_object Closed
                        method foo
                          core_type (testsuite/tests/typing-gadts/test.ml[1053,27060+10]..[1053,27060+13])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1053,27060+10]..[1053,27060+13])
                            []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1055,27079+0]..[1065,27487+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1055,27079+9]..[1065,27487+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1055,27079+9]..[1065,27487+2])
          Pexp_constant PConst_string ("\ntype _ int_foo = IF_constr : < foo : int; .. > int_foo\ntype _ int_bar = IB_constr : < bar : int; .. > int_bar\nLine 10, characters 3-4:\n10 |   (x:<foo:int>)\n        ^\nError: This expression has type t = < foo : int; .. >\n       but an expression was expected of type < foo : int >\n       Type $0 = < bar : int; .. > is not compatible with type <  >\n       The second object type has no method bar\n",(testsuite/tests/typing-gadts/test.ml[1055,27079+11]..[1065,27487+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1067,27494+0]..[1069,27588+23])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1067,27494+4]..[1067,27494+5])
          Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1067,27494+4]..[1067,27494+5])
        expression (testsuite/tests/typing-gadts/test.ml[1067,27494+6]..[1069,27588+23])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/test.ml[1067,27494+15]..[1069,27588+23]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1067,27494+15]..[1067,27494+20])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1067,27494+16]..[1067,27494+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1067,27494+16]..[1067,27494+17])
              core_type (testsuite/tests/typing-gadts/test.ml[1067,27494+18]..[1067,27494+19])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1067,27494+18]..[1067,27494+19])
                []
            expression (testsuite/tests/typing-gadts/test.ml[1067,27494+21]..[1069,27588+23]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1067,27494+21]..[1067,27494+36])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[1067,27494+22]..[1067,27494+23])
                  Ppat_var "e" (testsuite/tests/typing-gadts/test.ml[1067,27494+22]..[1067,27494+23])
                core_type (testsuite/tests/typing-gadts/test.ml[1067,27494+26]..[1067,27494+35])
                  Ptyp_constr "int_foo" (testsuite/tests/typing-gadts/test.ml[1067,27494+28]..[1067,27494+35])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1067,27494+26]..[1067,27494+27])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1067,27494+26]..[1067,27494+27])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[1067,27494+37]..[1069,27588+23]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1067,27494+37]..[1067,27494+53])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[1067,27494+38]..[1067,27494+40])
                    Ppat_var "e'" (testsuite/tests/typing-gadts/test.ml[1067,27494+38]..[1067,27494+40])
                  core_type (testsuite/tests/typing-gadts/test.ml[1067,27494+43]..[1067,27494+52])
                    Ptyp_constr "int_bar" (testsuite/tests/typing-gadts/test.ml[1067,27494+45]..[1067,27494+52])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1067,27494+43]..[1067,27494+44])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1067,27494+43]..[1067,27494+44])
                        []
                    ]
                expression (testsuite/tests/typing-gadts/test.ml[1068,27550+2]..[1069,27588+23])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[1068,27550+6]..[1068,27550+26])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[1068,27550+6]..[1068,27550+15])
                            Ppat_construct "IF_constr" (testsuite/tests/typing-gadts/test.ml[1068,27550+6]..[1068,27550+15])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[1068,27550+17]..[1068,27550+26])
                            Ppat_construct "IB_constr" (testsuite/tests/typing-gadts/test.ml[1068,27550+17]..[1068,27550+26])
                            None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[1068,27550+29]..[1068,27550+34])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/test.ml[1068,27550+29]..[1068,27550+30])
                            Pexp_ident "e" (testsuite/tests/typing-gadts/test.ml[1068,27550+29]..[1068,27550+30])
                          expression (testsuite/tests/typing-gadts/test.ml[1068,27550+32]..[1068,27550+34])
                            Pexp_ident "e'" (testsuite/tests/typing-gadts/test.ml[1068,27550+32]..[1068,27550+34])
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[1069,27588+2]..[1069,27588+23])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[1069,27588+3]..[1069,27588+4])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1069,27588+3]..[1069,27588+4])
                    core_type (testsuite/tests/typing-gadts/test.ml[1069,27588+5]..[1069,27588+22])
                      Ptyp_object Closed
                        method foo
                          core_type (testsuite/tests/typing-gadts/test.ml[1069,27588+10]..[1069,27588+13])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1069,27588+10]..[1069,27588+13])
                            []
                        method bar
                          core_type (testsuite/tests/typing-gadts/test.ml[1069,27588+18]..[1069,27588+21])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1069,27588+18]..[1069,27588+21])
                            []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1071,27615+0]..[1079,27960+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1071,27615+9]..[1079,27960+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1071,27615+9]..[1079,27960+2])
          Pexp_constant PConst_string ("\nLine 3, characters 3-4:\n3 |   (x:<foo:int;bar:int>)\n       ^\nError: This expression has type t = < foo : int; .. >\n       but an expression was expected of type < bar : int; foo : int >\n       Type $0 = < bar : int; .. > is not compatible with type < bar : int >\n       The first object type has an abstract row, it cannot be closed\n",(testsuite/tests/typing-gadts/test.ml[1071,27615+11]..[1079,27960+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1081,27967+0]..[1083,28061+26])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1081,27967+4]..[1081,27967+5])
          Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1081,27967+4]..[1081,27967+5])
        expression (testsuite/tests/typing-gadts/test.ml[1081,27967+6]..[1083,28061+26])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/test.ml[1081,27967+15]..[1083,28061+26]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1081,27967+15]..[1081,27967+20])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1081,27967+16]..[1081,27967+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1081,27967+16]..[1081,27967+17])
              core_type (testsuite/tests/typing-gadts/test.ml[1081,27967+18]..[1081,27967+19])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1081,27967+18]..[1081,27967+19])
                []
            expression (testsuite/tests/typing-gadts/test.ml[1081,27967+21]..[1083,28061+26]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1081,27967+21]..[1081,27967+36])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[1081,27967+22]..[1081,27967+23])
                  Ppat_var "e" (testsuite/tests/typing-gadts/test.ml[1081,27967+22]..[1081,27967+23])
                core_type (testsuite/tests/typing-gadts/test.ml[1081,27967+26]..[1081,27967+35])
                  Ptyp_constr "int_foo" (testsuite/tests/typing-gadts/test.ml[1081,27967+28]..[1081,27967+35])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1081,27967+26]..[1081,27967+27])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1081,27967+26]..[1081,27967+27])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[1081,27967+37]..[1083,28061+26]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1081,27967+37]..[1081,27967+53])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[1081,27967+38]..[1081,27967+40])
                    Ppat_var "e'" (testsuite/tests/typing-gadts/test.ml[1081,27967+38]..[1081,27967+40])
                  core_type (testsuite/tests/typing-gadts/test.ml[1081,27967+43]..[1081,27967+52])
                    Ptyp_constr "int_bar" (testsuite/tests/typing-gadts/test.ml[1081,27967+45]..[1081,27967+52])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1081,27967+43]..[1081,27967+44])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1081,27967+43]..[1081,27967+44])
                        []
                    ]
                expression (testsuite/tests/typing-gadts/test.ml[1082,28023+2]..[1083,28061+26])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[1082,28023+6]..[1082,28023+26])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[1082,28023+6]..[1082,28023+15])
                            Ppat_construct "IF_constr" (testsuite/tests/typing-gadts/test.ml[1082,28023+6]..[1082,28023+15])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[1082,28023+17]..[1082,28023+26])
                            Ppat_construct "IB_constr" (testsuite/tests/typing-gadts/test.ml[1082,28023+17]..[1082,28023+26])
                            None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[1082,28023+29]..[1082,28023+34])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/test.ml[1082,28023+29]..[1082,28023+30])
                            Pexp_ident "e" (testsuite/tests/typing-gadts/test.ml[1082,28023+29]..[1082,28023+30])
                          expression (testsuite/tests/typing-gadts/test.ml[1082,28023+32]..[1082,28023+34])
                            Pexp_ident "e'" (testsuite/tests/typing-gadts/test.ml[1082,28023+32]..[1082,28023+34])
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[1083,28061+2]..[1083,28061+26])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/test.ml[1083,28061+3]..[1083,28061+4])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1083,28061+3]..[1083,28061+4])
                    core_type (testsuite/tests/typing-gadts/test.ml[1083,28061+5]..[1083,28061+25])
                      Ptyp_object Open
                        method foo
                          core_type (testsuite/tests/typing-gadts/test.ml[1083,28061+10]..[1083,28061+13])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1083,28061+10]..[1083,28061+13])
                            []
                        method bar
                          core_type (testsuite/tests/typing-gadts/test.ml[1083,28061+18]..[1083,28061+21])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1083,28061+18]..[1083,28061+21])
                            []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1085,28091+0]..[1100,28657+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1085,28091+9]..[1100,28657+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1085,28091+9]..[1100,28657+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/test.ml[1085,28091+9]..[1092,28354+2])
              Pexp_constant PConst_string ("\nLine 3, characters 2-26:\n3 |   (x:<foo:int;bar:int;..>)\n      ^^^^^^^^^^^^^^^^^^^^^^^^\nError: This expression has type < bar : int; foo : int; .. >\n       but an expression was expected of type 'a\n       The type constructor $1 would escape its scope\n",(testsuite/tests/typing-gadts/test.ml[1085,28091+11]..[1092,28354+0]),Some "")
            expression (testsuite/tests/typing-gadts/test.ml[1092,28354+4]..[1100,28657+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/test.ml[1092,28354+4]..[1092,28354+13])
              Some
                expression (testsuite/tests/typing-gadts/test.ml[1092,28354+13]..[1100,28657+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 2-26:\n3 |   (x:<foo:int;bar:int;..>)\n      ^^^^^^^^^^^^^^^^^^^^^^^^\nError: This expression has type < bar : int; foo : int; .. >\n       but an expression was expected of type 'a\n       This instance of $1 is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1092,28354+15]..[1100,28657+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1102,28664+0]..[1104,28762+26])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1102,28664+4]..[1102,28664+5])
          Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1102,28664+4]..[1102,28664+5])
        expression (testsuite/tests/typing-gadts/test.ml[1102,28664+6]..[1104,28762+26])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/test.ml[1102,28664+15]..[1104,28762+26]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1102,28664+15]..[1102,28664+20])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1102,28664+16]..[1102,28664+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1102,28664+16]..[1102,28664+17])
              core_type (testsuite/tests/typing-gadts/test.ml[1102,28664+18]..[1102,28664+19])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1102,28664+18]..[1102,28664+19])
                []
            expression (testsuite/tests/typing-gadts/test.ml[1102,28664+21]..[1104,28762+26]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1102,28664+21]..[1102,28664+36])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[1102,28664+22]..[1102,28664+23])
                  Ppat_var "e" (testsuite/tests/typing-gadts/test.ml[1102,28664+22]..[1102,28664+23])
                core_type (testsuite/tests/typing-gadts/test.ml[1102,28664+26]..[1102,28664+35])
                  Ptyp_constr "int_foo" (testsuite/tests/typing-gadts/test.ml[1102,28664+28]..[1102,28664+35])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1102,28664+26]..[1102,28664+27])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1102,28664+26]..[1102,28664+27])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[1102,28664+37]..[1104,28762+26]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1102,28664+37]..[1102,28664+53])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[1102,28664+38]..[1102,28664+40])
                    Ppat_var "e'" (testsuite/tests/typing-gadts/test.ml[1102,28664+38]..[1102,28664+40])
                  core_type (testsuite/tests/typing-gadts/test.ml[1102,28664+43]..[1102,28664+52])
                    Ptyp_constr "int_bar" (testsuite/tests/typing-gadts/test.ml[1102,28664+45]..[1102,28664+52])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1102,28664+43]..[1102,28664+44])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1102,28664+43]..[1102,28664+44])
                        []
                    ]
                expression (testsuite/tests/typing-gadts/test.ml[1102,28664+54]..[1104,28762+26])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/test.ml[1103,28724+2]..[1104,28762+26])
                    Pexp_let Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/test.ml[1103,28724+6]..[1103,28724+26])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/test.ml[1103,28724+6]..[1103,28724+15])
                              Ppat_construct "IF_constr" (testsuite/tests/typing-gadts/test.ml[1103,28724+6]..[1103,28724+15])
                              None
                            pattern (testsuite/tests/typing-gadts/test.ml[1103,28724+17]..[1103,28724+26])
                              Ppat_construct "IB_constr" (testsuite/tests/typing-gadts/test.ml[1103,28724+17]..[1103,28724+26])
                              None
                          ]
                        expression (testsuite/tests/typing-gadts/test.ml[1103,28724+29]..[1103,28724+34])
                          Pexp_tuple
                          [
                            expression (testsuite/tests/typing-gadts/test.ml[1103,28724+29]..[1103,28724+30])
                              Pexp_ident "e" (testsuite/tests/typing-gadts/test.ml[1103,28724+29]..[1103,28724+30])
                            expression (testsuite/tests/typing-gadts/test.ml[1103,28724+32]..[1103,28724+34])
                              Pexp_ident "e'" (testsuite/tests/typing-gadts/test.ml[1103,28724+32]..[1103,28724+34])
                          ]
                    ]
                    expression (testsuite/tests/typing-gadts/test.ml[1104,28762+2]..[1104,28762+26])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/test.ml[1104,28762+3]..[1104,28762+4])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1104,28762+3]..[1104,28762+4])
                      core_type (testsuite/tests/typing-gadts/test.ml[1104,28762+5]..[1104,28762+25])
                        Ptyp_object Open
                          method foo
                            core_type (testsuite/tests/typing-gadts/test.ml[1104,28762+10]..[1104,28762+13])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1104,28762+10]..[1104,28762+13])
                              []
                          method bar
                            core_type (testsuite/tests/typing-gadts/test.ml[1104,28762+18]..[1104,28762+21])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1104,28762+18]..[1104,28762+21])
                              []
                  core_type (testsuite/tests/typing-gadts/test.ml[1102,28664+56]..[1102,28664+57])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1102,28664+56]..[1102,28664+57])
                    []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1106,28792+0]..[1108,28857+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1106,28792+9]..[1108,28857+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1106,28792+9]..[1108,28857+2])
          Pexp_constant PConst_string ("\nval g : 't -> 't int_foo -> 't int_bar -> 't = <fun>\n",(testsuite/tests/typing-gadts/test.ml[1106,28792+11]..[1108,28857+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1110,28864+0]..[1112,28958+17])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1110,28864+4]..[1110,28864+5])
          Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1110,28864+4]..[1110,28864+5])
        expression (testsuite/tests/typing-gadts/test.ml[1110,28864+6]..[1112,28958+17])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/test.ml[1110,28864+15]..[1112,28958+17]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1110,28864+15]..[1110,28864+20])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1110,28864+16]..[1110,28864+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1110,28864+16]..[1110,28864+17])
              core_type (testsuite/tests/typing-gadts/test.ml[1110,28864+18]..[1110,28864+19])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1110,28864+18]..[1110,28864+19])
                []
            expression (testsuite/tests/typing-gadts/test.ml[1110,28864+21]..[1112,28958+17]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1110,28864+21]..[1110,28864+36])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[1110,28864+22]..[1110,28864+23])
                  Ppat_var "e" (testsuite/tests/typing-gadts/test.ml[1110,28864+22]..[1110,28864+23])
                core_type (testsuite/tests/typing-gadts/test.ml[1110,28864+26]..[1110,28864+35])
                  Ptyp_constr "int_foo" (testsuite/tests/typing-gadts/test.ml[1110,28864+28]..[1110,28864+35])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1110,28864+26]..[1110,28864+27])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1110,28864+26]..[1110,28864+27])
                      []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[1110,28864+37]..[1112,28958+17]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1110,28864+37]..[1110,28864+53])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[1110,28864+38]..[1110,28864+40])
                    Ppat_var "e'" (testsuite/tests/typing-gadts/test.ml[1110,28864+38]..[1110,28864+40])
                  core_type (testsuite/tests/typing-gadts/test.ml[1110,28864+43]..[1110,28864+52])
                    Ptyp_constr "int_bar" (testsuite/tests/typing-gadts/test.ml[1110,28864+45]..[1110,28864+52])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1110,28864+43]..[1110,28864+44])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1110,28864+43]..[1110,28864+44])
                        []
                    ]
                expression (testsuite/tests/typing-gadts/test.ml[1111,28920+2]..[1112,28958+17])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[1111,28920+6]..[1111,28920+26])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/test.ml[1111,28920+6]..[1111,28920+15])
                            Ppat_construct "IF_constr" (testsuite/tests/typing-gadts/test.ml[1111,28920+6]..[1111,28920+15])
                            None
                          pattern (testsuite/tests/typing-gadts/test.ml[1111,28920+17]..[1111,28920+26])
                            Ppat_construct "IB_constr" (testsuite/tests/typing-gadts/test.ml[1111,28920+17]..[1111,28920+26])
                            None
                        ]
                      expression (testsuite/tests/typing-gadts/test.ml[1111,28920+29]..[1111,28920+34])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/test.ml[1111,28920+29]..[1111,28920+30])
                            Pexp_ident "e" (testsuite/tests/typing-gadts/test.ml[1111,28920+29]..[1111,28920+30])
                          expression (testsuite/tests/typing-gadts/test.ml[1111,28920+32]..[1111,28920+34])
                            Pexp_ident "e'" (testsuite/tests/typing-gadts/test.ml[1111,28920+32]..[1111,28920+34])
                        ]
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[1112,28958+2]..[1112,28958+17])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/test.ml[1112,28958+2]..[1112,28958+3])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1112,28958+2]..[1112,28958+3])
                      expression (testsuite/tests/typing-gadts/test.ml[1112,28958+5]..[1112,28958+10])
                        Pexp_send "foo"
                        expression (testsuite/tests/typing-gadts/test.ml[1112,28958+5]..[1112,28958+6])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1112,28958+5]..[1112,28958+6])
                      expression (testsuite/tests/typing-gadts/test.ml[1112,28958+12]..[1112,28958+17])
                        Pexp_send "bar"
                        expression (testsuite/tests/typing-gadts/test.ml[1112,28958+12]..[1112,28958+13])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1112,28958+12]..[1112,28958+13])
                    ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1114,28979+0]..[1123,29303+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1114,28979+9]..[1123,29303+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1114,28979+9]..[1123,29303+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/test.ml[1114,28979+9]..[1116,29056+2])
              Pexp_constant PConst_string ("\nval g : 't -> 't int_foo -> 't int_bar -> 't * int * int = <fun>\n",(testsuite/tests/typing-gadts/test.ml[1114,28979+11]..[1116,29056+0]),Some "")
            expression (testsuite/tests/typing-gadts/test.ml[1116,29056+4]..[1123,29303+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/test.ml[1116,29056+4]..[1116,29056+13])
              Some
                expression (testsuite/tests/typing-gadts/test.ml[1116,29056+13]..[1123,29303+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 5-10:\n3 |   x, x#foo, x#bar\n         ^^^^^\nError: This expression has type int but an expression was expected of type 'a\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1116,29056+15]..[1123,29303+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1127,29325+0]..[1127,29325+32])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/test.ml[1127,29325+8]..[1127,29325+10]) (testsuite/tests/typing-gadts/test.ml[1127,29325+0]..[1127,29325+32])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1127,29325+5]..[1127,29325+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1127,29325+13]..[1127,29325+32])
                "Int" (testsuite/tests/typing-gadts/test.ml[1127,29325+13]..[1127,29325+16])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1127,29325+19]..[1127,29325+22])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1127,29325+19]..[1127,29325+22])
                    []
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1127,29325+26]..[1127,29325+32])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[1127,29325+30]..[1127,29325+32])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1127,29325+26]..[1127,29325+29])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1127,29325+26]..[1127,29325+29])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1129,29361+0]..[1130,29389+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1129,29361+4]..[1129,29361+25]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1129,29361+4]..[1129,29361+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1129,29361+4]..[1129,29361+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+4]..[1130,29389+34]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+16]..[1129,29361+25])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+16]..[1129,29361+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[1129,29361+18]..[1129,29361+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+16]..[1129,29361+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+24]..[1129,29361+25])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[1129,29361+4]..[1130,29389+34])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1129,29361+4]..[1130,29389+34])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[1130,29389+2]..[1130,29389+34])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1130,29389+6]..[1130,29389+7])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1130,29389+6]..[1130,29389+7])
              expression (testsuite/tests/typing-gadts/test.ml[1130,29389+11]..[1130,29389+34])
                Pexp_match
                expression (testsuite/tests/typing-gadts/test.ml[1130,29389+17]..[1130,29389+18])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1130,29389+17]..[1130,29389+18])
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/test.ml[1130,29389+24]..[1130,29389+29])
                      Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[1130,29389+24]..[1130,29389+27])
                      Some
                        []
                        pattern (testsuite/tests/typing-gadts/test.ml[1130,29389+28]..[1130,29389+29])
                          Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1130,29389+28]..[1130,29389+29])
                    expression (testsuite/tests/typing-gadts/test.ml[1130,29389+33]..[1130,29389+34])
                      Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1130,29389+33]..[1130,29389+34])
                ]
            core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+16]..[1129,29361+25])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+16]..[1129,29361+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[1129,29361+18]..[1129,29361+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+16]..[1129,29361+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1129,29361+16]..[1129,29361+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1129,29361+24]..[1129,29361+25])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1129,29361+24]..[1129,29361+25])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1132,29427+0]..[1134,29472+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1132,29427+4]..[1132,29427+25]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1132,29427+4]..[1132,29427+5])
            Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1132,29427+4]..[1132,29427+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+4]..[1134,29472+34]) ghost
            Ptyp_poly 'a
            core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+16]..[1132,29427+25])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+16]..[1132,29427+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[1132,29427+18]..[1132,29427+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+16]..[1132,29427+17])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+24]..[1132,29427+25])
                Ptyp_var a
        expression (testsuite/tests/typing-gadts/test.ml[1132,29427+4]..[1134,29472+34])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1132,29427+4]..[1134,29472+34])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/test.ml[1133,29455+2]..[1134,29472+34])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/test.ml[1133,29455+6]..[1133,29455+8])
                    Ppat_construct "()" (testsuite/tests/typing-gadts/test.ml[1133,29455+6]..[1133,29455+8])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[1133,29455+11]..[1133,29455+13])
                    Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[1133,29455+11]..[1133,29455+13])
                    None
              ]
              expression (testsuite/tests/typing-gadts/test.ml[1134,29472+2]..[1134,29472+34])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1134,29472+6]..[1134,29472+7])
                  Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1134,29472+6]..[1134,29472+7])
                expression (testsuite/tests/typing-gadts/test.ml[1134,29472+11]..[1134,29472+34])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/test.ml[1134,29472+17]..[1134,29472+18])
                    Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1134,29472+17]..[1134,29472+18])
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/test.ml[1134,29472+24]..[1134,29472+29])
                        Ppat_construct "Int" (testsuite/tests/typing-gadts/test.ml[1134,29472+24]..[1134,29472+27])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/test.ml[1134,29472+28]..[1134,29472+29])
                            Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1134,29472+28]..[1134,29472+29])
                      expression (testsuite/tests/typing-gadts/test.ml[1134,29472+33]..[1134,29472+34])
                        Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1134,29472+33]..[1134,29472+34])
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+16]..[1132,29427+25])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+16]..[1132,29427+20])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/test.ml[1132,29427+18]..[1132,29427+20])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+16]..[1132,29427+17])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1132,29427+16]..[1132,29427+17])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1132,29427+24]..[1132,29427+25])
                Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1132,29427+24]..[1132,29427+25])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1135,29509+0]..[1139,29610+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1135,29509+9]..[1139,29610+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1135,29509+9]..[1139,29610+2])
          Pexp_constant PConst_string ("\ntype 'a ty = Int : int -> int ty\nval f : 'a ty -> 'a = <fun>\nval g : 'a ty -> 'a = <fun>\n",(testsuite/tests/typing-gadts/test.ml[1135,29509+11]..[1139,29610+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1143,29656+0]..[1143,29656+36])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1143,29656+7]..[1143,29656+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1143,29656+11]..[1143,29656+36])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1143,29656+18]..[1143,29656+32])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1143,29656+25]..[1143,29656+26]) (testsuite/tests/typing-gadts/test.ml[1143,29656+18]..[1143,29656+32])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1143,29656+23]..[1143,29656+24])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  Some
                    core_type (testsuite/tests/typing-gadts/test.ml[1143,29656+29]..[1143,29656+32])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1143,29656+29]..[1143,29656+32])
                      []
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1144,29695+0]..[1144,29695+42])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1144,29695+7]..[1144,29695+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1144,29695+11]..[1144,29695+42])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1144,29695+18]..[1144,29695+38])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1144,29695+25]..[1144,29695+26]) (testsuite/tests/typing-gadts/test.ml[1144,29695+18]..[1144,29695+38])
                ptype_params =
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1144,29695+23]..[1144,29695+24])
                      Ptyp_any
                  ]
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[1144,29695+29]..[1144,29695+38])
                        "T" (testsuite/tests/typing-gadts/test.ml[1144,29695+29]..[1144,29695+30])
                        []
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[1144,29695+33]..[1144,29695+38])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1144,29695+37]..[1144,29695+38])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[1144,29695+33]..[1144,29695+36])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1144,29695+33]..[1144,29695+36])
                                []
                            ]
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1145,29740+0]..[1145,29740+12])
    Pstr_module
    "N" (testsuite/tests/typing-gadts/test.ml[1145,29740+7]..[1145,29740+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1145,29740+11]..[1145,29740+12])
        Pmod_ident "M" (testsuite/tests/typing-gadts/test.ml[1145,29740+11]..[1145,29740+12])
  structure_item (testsuite/tests/typing-gadts/test.ml[1146,29755+0]..[1150,29854+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1146,29755+9]..[1150,29854+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1146,29755+9]..[1150,29854+2])
          Pexp_constant PConst_string ("\nmodule M : sig type _ t = int end\nmodule M : sig type _ t = T : int t end\nmodule N = M\n",(testsuite/tests/typing-gadts/test.ml[1146,29755+11]..[1150,29854+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1155,29940+0]..[1160,30091+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1155,29940+4]..[1155,29940+55]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1155,29940+4]..[1155,29940+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1155,29940+4]..[1155,29940+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+4]..[1160,30091+13]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+18]..[1155,29940+55])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+18]..[1155,29940+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1155,29940+24]..[1155,29940+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+19]..[1155,29940+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+21]..[1155,29940+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+30]..[1155,29940+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+30]..[1155,29940+40])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1155,29940+38]..[1155,29940+40])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+31]..[1155,29940+32])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+33]..[1155,29940+36])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1155,29940+33]..[1155,29940+36])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+44]..[1155,29940+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+44]..[1155,29940+45])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+49]..[1155,29940+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+49]..[1155,29940+50])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+54]..[1155,29940+55])
                      Ptyp_any
        expression (testsuite/tests/typing-gadts/test.ml[1155,29940+4]..[1160,30091+13])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1155,29940+4]..[1160,30091+13])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1155,29940+4]..[1160,30091+13])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[1155,29940+58]..[1160,30091+13])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1155,29940+62]..[1155,29940+64])
                  Ppat_var "ab" (testsuite/tests/typing-gadts/test.ml[1155,29940+62]..[1155,29940+64])
                expression (testsuite/tests/typing-gadts/test.ml[1155,29940+65]..[1160,30091+13]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1155,29940+65]..[1155,29940+69])
                    Ppat_var "aint" (testsuite/tests/typing-gadts/test.ml[1155,29940+65]..[1155,29940+69])
                  expression (testsuite/tests/typing-gadts/test.ml[1155,29940+70]..[1160,30091+13]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[1155,29940+70]..[1155,29940+71])
                      Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[1155,29940+70]..[1155,29940+71])
                    expression (testsuite/tests/typing-gadts/test.ml[1155,29940+72]..[1160,30091+13]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[1155,29940+72]..[1155,29940+73])
                        Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[1155,29940+72]..[1155,29940+73])
                      expression (testsuite/tests/typing-gadts/test.ml[1156,30017+2]..[1160,30091+13])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (testsuite/tests/typing-gadts/test.ml[1156,30017+6]..[1156,30017+8])
                              Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1156,30017+6]..[1156,30017+8])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[1156,30017+11]..[1156,30017+13])
                              Pexp_ident "ab" (testsuite/tests/typing-gadts/test.ml[1156,30017+11]..[1156,30017+13])
                        ]
                        expression (testsuite/tests/typing-gadts/test.ml[1157,30034+2]..[1160,30091+13])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/test.ml[1157,30034+6]..[1157,30034+7])
                                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1157,30034+6]..[1157,30034+7])
                              expression (testsuite/tests/typing-gadts/test.ml[1158,30044+4]..[1159,30065+25])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (testsuite/tests/typing-gadts/test.ml[1158,30044+8]..[1158,30044+10])
                                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1158,30044+8]..[1158,30044+10])
                                      None
                                    expression (testsuite/tests/typing-gadts/test.ml[1158,30044+13]..[1158,30044+17])
                                      Pexp_ident "aint" (testsuite/tests/typing-gadts/test.ml[1158,30044+13]..[1158,30044+17])
                                ]
                                expression (testsuite/tests/typing-gadts/test.ml[1159,30065+4]..[1159,30065+25])
                                  Pexp_ifthenelse
                                  expression (testsuite/tests/typing-gadts/test.ml[1159,30065+7]..[1159,30065+11])
                                    Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1159,30065+7]..[1159,30065+11])
                                    None
                                  expression (testsuite/tests/typing-gadts/test.ml[1159,30065+17]..[1159,30065+18])
                                    Pexp_ident "a" (testsuite/tests/typing-gadts/test.ml[1159,30065+17]..[1159,30065+18])
                                  Some
                                    expression (testsuite/tests/typing-gadts/test.ml[1159,30065+24]..[1159,30065+25])
                                      Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[1159,30065+24]..[1159,30065+25])
                          ]
                          expression (testsuite/tests/typing-gadts/test.ml[1160,30091+5]..[1160,30091+13])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[1160,30091+5]..[1160,30091+11])
                              Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[1160,30091+5]..[1160,30091+11])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[1160,30091+12]..[1160,30091+13])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1160,30091+12]..[1160,30091+13])
                            ]
              core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+18]..[1155,29940+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+18]..[1155,29940+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1155,29940+24]..[1155,29940+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+19]..[1155,29940+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1155,29940+19]..[1155,29940+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+21]..[1155,29940+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1155,29940+21]..[1155,29940+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+30]..[1155,29940+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+30]..[1155,29940+40])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1155,29940+38]..[1155,29940+40])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+31]..[1155,29940+32])
                        Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1155,29940+31]..[1155,29940+32])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+33]..[1155,29940+36])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1155,29940+33]..[1155,29940+36])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+44]..[1155,29940+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+44]..[1155,29940+45])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1155,29940+44]..[1155,29940+45])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+49]..[1155,29940+55])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+49]..[1155,29940+50])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1155,29940+49]..[1155,29940+50])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1155,29940+54]..[1155,29940+55])
                        Ptyp_any
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1162,30117+0]..[1164,30193+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1162,30117+9]..[1164,30193+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1162,30117+9]..[1164,30193+2])
          Pexp_constant PConst_string ("\nval f : ('a, 'b) eq -> ('a, int) eq -> 'a -> 'b -> unit = <fun>\n",(testsuite/tests/typing-gadts/test.ml[1162,30117+11]..[1164,30193+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1166,30200+0]..[1171,30351+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1166,30200+4]..[1166,30200+55]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1166,30200+4]..[1166,30200+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1166,30200+4]..[1166,30200+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+4]..[1171,30351+13]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+18]..[1166,30200+55])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+18]..[1166,30200+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1166,30200+24]..[1166,30200+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+19]..[1166,30200+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+21]..[1166,30200+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+30]..[1166,30200+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+30]..[1166,30200+40])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1166,30200+38]..[1166,30200+40])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+31]..[1166,30200+32])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+33]..[1166,30200+36])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1166,30200+33]..[1166,30200+36])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+44]..[1166,30200+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+44]..[1166,30200+45])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+49]..[1166,30200+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+49]..[1166,30200+50])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+54]..[1166,30200+55])
                      Ptyp_any
        expression (testsuite/tests/typing-gadts/test.ml[1166,30200+4]..[1171,30351+13])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1166,30200+4]..[1171,30351+13])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1166,30200+4]..[1171,30351+13])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[1166,30200+58]..[1171,30351+13])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1166,30200+62]..[1166,30200+64])
                  Ppat_var "ab" (testsuite/tests/typing-gadts/test.ml[1166,30200+62]..[1166,30200+64])
                expression (testsuite/tests/typing-gadts/test.ml[1166,30200+65]..[1171,30351+13]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1166,30200+65]..[1166,30200+69])
                    Ppat_var "bint" (testsuite/tests/typing-gadts/test.ml[1166,30200+65]..[1166,30200+69])
                  expression (testsuite/tests/typing-gadts/test.ml[1166,30200+70]..[1171,30351+13]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[1166,30200+70]..[1166,30200+71])
                      Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[1166,30200+70]..[1166,30200+71])
                    expression (testsuite/tests/typing-gadts/test.ml[1166,30200+72]..[1171,30351+13]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[1166,30200+72]..[1166,30200+73])
                        Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[1166,30200+72]..[1166,30200+73])
                      expression (testsuite/tests/typing-gadts/test.ml[1167,30277+2]..[1171,30351+13])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (testsuite/tests/typing-gadts/test.ml[1167,30277+6]..[1167,30277+8])
                              Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1167,30277+6]..[1167,30277+8])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[1167,30277+11]..[1167,30277+13])
                              Pexp_ident "ab" (testsuite/tests/typing-gadts/test.ml[1167,30277+11]..[1167,30277+13])
                        ]
                        expression (testsuite/tests/typing-gadts/test.ml[1168,30294+2]..[1171,30351+13])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/test.ml[1168,30294+6]..[1168,30294+7])
                                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1168,30294+6]..[1168,30294+7])
                              expression (testsuite/tests/typing-gadts/test.ml[1169,30304+4]..[1170,30325+25])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (testsuite/tests/typing-gadts/test.ml[1169,30304+8]..[1169,30304+10])
                                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1169,30304+8]..[1169,30304+10])
                                      None
                                    expression (testsuite/tests/typing-gadts/test.ml[1169,30304+13]..[1169,30304+17])
                                      Pexp_ident "bint" (testsuite/tests/typing-gadts/test.ml[1169,30304+13]..[1169,30304+17])
                                ]
                                expression (testsuite/tests/typing-gadts/test.ml[1170,30325+4]..[1170,30325+25])
                                  Pexp_ifthenelse
                                  expression (testsuite/tests/typing-gadts/test.ml[1170,30325+7]..[1170,30325+11])
                                    Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1170,30325+7]..[1170,30325+11])
                                    None
                                  expression (testsuite/tests/typing-gadts/test.ml[1170,30325+17]..[1170,30325+18])
                                    Pexp_ident "a" (testsuite/tests/typing-gadts/test.ml[1170,30325+17]..[1170,30325+18])
                                  Some
                                    expression (testsuite/tests/typing-gadts/test.ml[1170,30325+24]..[1170,30325+25])
                                      Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[1170,30325+24]..[1170,30325+25])
                          ]
                          expression (testsuite/tests/typing-gadts/test.ml[1171,30351+5]..[1171,30351+13])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[1171,30351+5]..[1171,30351+11])
                              Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[1171,30351+5]..[1171,30351+11])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[1171,30351+12]..[1171,30351+13])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1171,30351+12]..[1171,30351+13])
                            ]
              core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+18]..[1166,30200+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+18]..[1166,30200+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1166,30200+24]..[1166,30200+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+19]..[1166,30200+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1166,30200+19]..[1166,30200+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+21]..[1166,30200+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1166,30200+21]..[1166,30200+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+30]..[1166,30200+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+30]..[1166,30200+40])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1166,30200+38]..[1166,30200+40])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+31]..[1166,30200+32])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1166,30200+31]..[1166,30200+32])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+33]..[1166,30200+36])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1166,30200+33]..[1166,30200+36])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+44]..[1166,30200+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+44]..[1166,30200+45])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1166,30200+44]..[1166,30200+45])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+49]..[1166,30200+55])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+49]..[1166,30200+50])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1166,30200+49]..[1166,30200+50])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1166,30200+54]..[1166,30200+55])
                        Ptyp_any
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1173,30377+0]..[1175,30453+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1173,30377+9]..[1175,30453+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1173,30377+9]..[1175,30453+2])
          Pexp_constant PConst_string ("\nval f : ('a, 'b) eq -> ('b, int) eq -> 'a -> 'b -> unit = <fun>\n",(testsuite/tests/typing-gadts/test.ml[1173,30377+11]..[1175,30453+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1177,30460+0]..[1182,30611+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1177,30460+4]..[1177,30460+55]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1177,30460+4]..[1177,30460+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1177,30460+4]..[1177,30460+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+4]..[1182,30611+13]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+18]..[1177,30460+55])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+18]..[1177,30460+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1177,30460+24]..[1177,30460+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+19]..[1177,30460+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+21]..[1177,30460+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+30]..[1177,30460+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+30]..[1177,30460+40])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1177,30460+38]..[1177,30460+40])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+31]..[1177,30460+32])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+33]..[1177,30460+36])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1177,30460+33]..[1177,30460+36])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+44]..[1177,30460+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+44]..[1177,30460+45])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+49]..[1177,30460+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+49]..[1177,30460+50])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+54]..[1177,30460+55])
                      Ptyp_any
        expression (testsuite/tests/typing-gadts/test.ml[1177,30460+4]..[1182,30611+13])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1177,30460+4]..[1182,30611+13])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1177,30460+4]..[1182,30611+13])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[1177,30460+58]..[1182,30611+13])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1177,30460+62]..[1177,30460+64])
                  Ppat_var "ab" (testsuite/tests/typing-gadts/test.ml[1177,30460+62]..[1177,30460+64])
                expression (testsuite/tests/typing-gadts/test.ml[1177,30460+65]..[1182,30611+13]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1177,30460+65]..[1177,30460+69])
                    Ppat_var "aint" (testsuite/tests/typing-gadts/test.ml[1177,30460+65]..[1177,30460+69])
                  expression (testsuite/tests/typing-gadts/test.ml[1177,30460+70]..[1182,30611+13]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[1177,30460+70]..[1177,30460+71])
                      Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[1177,30460+70]..[1177,30460+71])
                    expression (testsuite/tests/typing-gadts/test.ml[1177,30460+72]..[1182,30611+13]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[1177,30460+72]..[1177,30460+73])
                        Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[1177,30460+72]..[1177,30460+73])
                      expression (testsuite/tests/typing-gadts/test.ml[1178,30537+2]..[1182,30611+13])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (testsuite/tests/typing-gadts/test.ml[1178,30537+6]..[1178,30537+8])
                              Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1178,30537+6]..[1178,30537+8])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[1178,30537+11]..[1178,30537+15])
                              Pexp_ident "aint" (testsuite/tests/typing-gadts/test.ml[1178,30537+11]..[1178,30537+15])
                        ]
                        expression (testsuite/tests/typing-gadts/test.ml[1179,30556+2]..[1182,30611+13])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/test.ml[1179,30556+6]..[1179,30556+7])
                                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1179,30556+6]..[1179,30556+7])
                              expression (testsuite/tests/typing-gadts/test.ml[1180,30566+4]..[1181,30585+25])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (testsuite/tests/typing-gadts/test.ml[1180,30566+8]..[1180,30566+10])
                                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1180,30566+8]..[1180,30566+10])
                                      None
                                    expression (testsuite/tests/typing-gadts/test.ml[1180,30566+13]..[1180,30566+15])
                                      Pexp_ident "ab" (testsuite/tests/typing-gadts/test.ml[1180,30566+13]..[1180,30566+15])
                                ]
                                expression (testsuite/tests/typing-gadts/test.ml[1181,30585+4]..[1181,30585+25])
                                  Pexp_ifthenelse
                                  expression (testsuite/tests/typing-gadts/test.ml[1181,30585+7]..[1181,30585+11])
                                    Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1181,30585+7]..[1181,30585+11])
                                    None
                                  expression (testsuite/tests/typing-gadts/test.ml[1181,30585+17]..[1181,30585+18])
                                    Pexp_ident "a" (testsuite/tests/typing-gadts/test.ml[1181,30585+17]..[1181,30585+18])
                                  Some
                                    expression (testsuite/tests/typing-gadts/test.ml[1181,30585+24]..[1181,30585+25])
                                      Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[1181,30585+24]..[1181,30585+25])
                          ]
                          expression (testsuite/tests/typing-gadts/test.ml[1182,30611+5]..[1182,30611+13])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[1182,30611+5]..[1182,30611+11])
                              Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[1182,30611+5]..[1182,30611+11])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[1182,30611+12]..[1182,30611+13])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1182,30611+12]..[1182,30611+13])
                            ]
              core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+18]..[1177,30460+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+18]..[1177,30460+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1177,30460+24]..[1177,30460+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+19]..[1177,30460+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1177,30460+19]..[1177,30460+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+21]..[1177,30460+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1177,30460+21]..[1177,30460+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+30]..[1177,30460+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+30]..[1177,30460+40])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1177,30460+38]..[1177,30460+40])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+31]..[1177,30460+32])
                        Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1177,30460+31]..[1177,30460+32])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+33]..[1177,30460+36])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1177,30460+33]..[1177,30460+36])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+44]..[1177,30460+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+44]..[1177,30460+45])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1177,30460+44]..[1177,30460+45])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+49]..[1177,30460+55])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+49]..[1177,30460+50])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1177,30460+49]..[1177,30460+50])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1177,30460+54]..[1177,30460+55])
                        Ptyp_any
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1184,30637+0]..[1193,30972+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1184,30637+9]..[1193,30972+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1184,30637+9]..[1193,30972+2])
          Pexp_constant PConst_string ("\nLine 5, characters 24-25:\n5 |     if true then a else b\n                            ^\nError: This expression has type b = int\n       but an expression was expected of type a = int\n       Type b = int is not compatible with type int\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1184,30637+11]..[1193,30972+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1195,30979+0]..[1200,31130+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1195,30979+4]..[1195,30979+55]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/test.ml[1195,30979+4]..[1195,30979+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1195,30979+4]..[1195,30979+5])
          core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+4]..[1200,31130+13]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+18]..[1195,30979+55])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+18]..[1195,30979+26])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1195,30979+24]..[1195,30979+26])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+19]..[1195,30979+20])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+21]..[1195,30979+22])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+30]..[1195,30979+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+30]..[1195,30979+40])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1195,30979+38]..[1195,30979+40])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+31]..[1195,30979+32])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+33]..[1195,30979+36])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1195,30979+33]..[1195,30979+36])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+44]..[1195,30979+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+44]..[1195,30979+45])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+49]..[1195,30979+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+49]..[1195,30979+50])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+54]..[1195,30979+55])
                      Ptyp_any
        expression (testsuite/tests/typing-gadts/test.ml[1195,30979+4]..[1200,31130+13])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1195,30979+4]..[1200,31130+13])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1195,30979+4]..[1200,31130+13])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/test.ml[1195,30979+58]..[1200,31130+13])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1195,30979+62]..[1195,30979+64])
                  Ppat_var "ab" (testsuite/tests/typing-gadts/test.ml[1195,30979+62]..[1195,30979+64])
                expression (testsuite/tests/typing-gadts/test.ml[1195,30979+65]..[1200,31130+13]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1195,30979+65]..[1195,30979+69])
                    Ppat_var "bint" (testsuite/tests/typing-gadts/test.ml[1195,30979+65]..[1195,30979+69])
                  expression (testsuite/tests/typing-gadts/test.ml[1195,30979+70]..[1200,31130+13]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[1195,30979+70]..[1195,30979+71])
                      Ppat_var "a" (testsuite/tests/typing-gadts/test.ml[1195,30979+70]..[1195,30979+71])
                    expression (testsuite/tests/typing-gadts/test.ml[1195,30979+72]..[1200,31130+13]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[1195,30979+72]..[1195,30979+73])
                        Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[1195,30979+72]..[1195,30979+73])
                      expression (testsuite/tests/typing-gadts/test.ml[1196,31056+2]..[1200,31130+13])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (testsuite/tests/typing-gadts/test.ml[1196,31056+6]..[1196,31056+8])
                              Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1196,31056+6]..[1196,31056+8])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[1196,31056+11]..[1196,31056+15])
                              Pexp_ident "bint" (testsuite/tests/typing-gadts/test.ml[1196,31056+11]..[1196,31056+15])
                        ]
                        expression (testsuite/tests/typing-gadts/test.ml[1197,31075+2]..[1200,31130+13])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/test.ml[1197,31075+6]..[1197,31075+7])
                                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1197,31075+6]..[1197,31075+7])
                              expression (testsuite/tests/typing-gadts/test.ml[1198,31085+4]..[1199,31104+25])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (testsuite/tests/typing-gadts/test.ml[1198,31085+8]..[1198,31085+10])
                                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1198,31085+8]..[1198,31085+10])
                                      None
                                    expression (testsuite/tests/typing-gadts/test.ml[1198,31085+13]..[1198,31085+15])
                                      Pexp_ident "ab" (testsuite/tests/typing-gadts/test.ml[1198,31085+13]..[1198,31085+15])
                                ]
                                expression (testsuite/tests/typing-gadts/test.ml[1199,31104+4]..[1199,31104+25])
                                  Pexp_ifthenelse
                                  expression (testsuite/tests/typing-gadts/test.ml[1199,31104+7]..[1199,31104+11])
                                    Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1199,31104+7]..[1199,31104+11])
                                    None
                                  expression (testsuite/tests/typing-gadts/test.ml[1199,31104+17]..[1199,31104+18])
                                    Pexp_ident "a" (testsuite/tests/typing-gadts/test.ml[1199,31104+17]..[1199,31104+18])
                                  Some
                                    expression (testsuite/tests/typing-gadts/test.ml[1199,31104+24]..[1199,31104+25])
                                      Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[1199,31104+24]..[1199,31104+25])
                          ]
                          expression (testsuite/tests/typing-gadts/test.ml[1200,31130+5]..[1200,31130+13])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/test.ml[1200,31130+5]..[1200,31130+11])
                              Pexp_ident "ignore" (testsuite/tests/typing-gadts/test.ml[1200,31130+5]..[1200,31130+11])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/test.ml[1200,31130+12]..[1200,31130+13])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1200,31130+12]..[1200,31130+13])
                            ]
              core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+18]..[1195,30979+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+18]..[1195,30979+26])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1195,30979+24]..[1195,30979+26])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+19]..[1195,30979+20])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1195,30979+19]..[1195,30979+20])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+21]..[1195,30979+22])
                      Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1195,30979+21]..[1195,30979+22])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+30]..[1195,30979+55])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+30]..[1195,30979+40])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1195,30979+38]..[1195,30979+40])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+31]..[1195,30979+32])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1195,30979+31]..[1195,30979+32])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+33]..[1195,30979+36])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1195,30979+33]..[1195,30979+36])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+44]..[1195,30979+55])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+44]..[1195,30979+45])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1195,30979+44]..[1195,30979+45])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+49]..[1195,30979+55])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+49]..[1195,30979+50])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1195,30979+49]..[1195,30979+50])
                        []
                      core_type (testsuite/tests/typing-gadts/test.ml[1195,30979+54]..[1195,30979+55])
                        Ptyp_any
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1202,31156+0]..[1211,31491+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1202,31156+9]..[1211,31491+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1202,31156+9]..[1211,31491+2])
          Pexp_constant PConst_string ("\nLine 5, characters 24-25:\n5 |     if true then a else b\n                            ^\nError: This expression has type b = int\n       but an expression was expected of type a = int\n       Type int is not compatible with type a = int\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1202,31156+11]..[1211,31491+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1213,31498+0]..[1216,31614+20])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+4]..[1213,31498+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1213,31498+4]..[1213,31498+5])
        expression (testsuite/tests/typing-gadts/test.ml[1213,31498+6]..[1216,31614+20])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1213,31498+6]..[1216,31614+20])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1213,31498+6]..[1216,31614+20])
              Pexp_newtype "c"
              expression (testsuite/tests/typing-gadts/test.ml[1213,31498+19]..[1216,31614+20]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+19]..[1213,31498+29])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+20]..[1213,31498+21])
                    Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[1213,31498+20]..[1213,31498+21])
                  core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+24]..[1213,31498+28])
                    Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[1213,31498+24]..[1213,31498+28])
                    []
                expression (testsuite/tests/typing-gadts/test.ml[1213,31498+30]..[1216,31614+20]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+30]..[1213,31498+45])
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+31]..[1213,31498+33])
                      Ppat_var "w1" (testsuite/tests/typing-gadts/test.ml[1213,31498+31]..[1213,31498+33])
                    core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+36]..[1213,31498+44])
                      Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1213,31498+42]..[1213,31498+44])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+37]..[1213,31498+38])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1213,31498+37]..[1213,31498+38])
                          []
                        core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+39]..[1213,31498+40])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1213,31498+39]..[1213,31498+40])
                          []
                      ]
                  expression (testsuite/tests/typing-gadts/test.ml[1213,31498+46]..[1216,31614+20]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+46]..[1213,31498+63])
                      Ppat_constraint
                      pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+47]..[1213,31498+49])
                        Ppat_var "w2" (testsuite/tests/typing-gadts/test.ml[1213,31498+47]..[1213,31498+49])
                      core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+52]..[1213,31498+62])
                        Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1213,31498+60]..[1213,31498+62])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+53]..[1213,31498+54])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1213,31498+53]..[1213,31498+54])
                            []
                          core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+55]..[1213,31498+58])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1213,31498+55]..[1213,31498+58])
                            []
                        ]
                    expression (testsuite/tests/typing-gadts/test.ml[1213,31498+64]..[1216,31614+20]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+64]..[1213,31498+71])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+65]..[1213,31498+66])
                          Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1213,31498+65]..[1213,31498+66])
                        core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+69]..[1213,31498+70])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1213,31498+69]..[1213,31498+70])
                          []
                      expression (testsuite/tests/typing-gadts/test.ml[1213,31498+72]..[1216,31614+20]) ghost
                        Pexp_fun
                        Nolabel
                        None
                        pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+72]..[1213,31498+79])
                          Ppat_constraint
                          pattern (testsuite/tests/typing-gadts/test.ml[1213,31498+73]..[1213,31498+74])
                            Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1213,31498+73]..[1213,31498+74])
                          core_type (testsuite/tests/typing-gadts/test.ml[1213,31498+77]..[1213,31498+78])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1213,31498+77]..[1213,31498+78])
                            []
                        expression (testsuite/tests/typing-gadts/test.ml[1214,31580+2]..[1216,31614+20])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/test.ml[1214,31580+6]..[1214,31580+8])
                                Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1214,31580+6]..[1214,31580+8])
                                None
                              expression (testsuite/tests/typing-gadts/test.ml[1214,31580+11]..[1214,31580+13])
                                Pexp_ident "w1" (testsuite/tests/typing-gadts/test.ml[1214,31580+11]..[1214,31580+13])
                          ]
                          expression (testsuite/tests/typing-gadts/test.ml[1215,31597+2]..[1216,31614+20])
                            Pexp_let Nonrec
                            [
                              <def>
                                pattern (testsuite/tests/typing-gadts/test.ml[1215,31597+6]..[1215,31597+8])
                                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1215,31597+6]..[1215,31597+8])
                                  None
                                expression (testsuite/tests/typing-gadts/test.ml[1215,31597+11]..[1215,31597+13])
                                  Pexp_ident "w2" (testsuite/tests/typing-gadts/test.ml[1215,31597+11]..[1215,31597+13])
                            ]
                            expression (testsuite/tests/typing-gadts/test.ml[1216,31614+2]..[1216,31614+20])
                              Pexp_ifthenelse
                              expression (testsuite/tests/typing-gadts/test.ml[1216,31614+5]..[1216,31614+6])
                                Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[1216,31614+5]..[1216,31614+6])
                              expression (testsuite/tests/typing-gadts/test.ml[1216,31614+12]..[1216,31614+13])
                                Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1216,31614+12]..[1216,31614+13])
                              Some
                                expression (testsuite/tests/typing-gadts/test.ml[1216,31614+19]..[1216,31614+20])
                                  Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1216,31614+19]..[1216,31614+20])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1218,31638+0]..[1227,31967+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1218,31638+9]..[1227,31967+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1218,31638+9]..[1227,31967+2])
          Pexp_constant PConst_string ("\nLine 4, characters 19-20:\n4 |   if b then x else y\n                       ^\nError: This expression has type b = int\n       but an expression was expected of type a = int\n       Type a = int is not compatible with type a = int\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1218,31638+11]..[1227,31967+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1229,31974+0]..[1232,32090+20])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+4]..[1229,31974+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1229,31974+4]..[1229,31974+5])
        expression (testsuite/tests/typing-gadts/test.ml[1229,31974+6]..[1232,32090+20])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/test.ml[1229,31974+6]..[1232,32090+20])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/test.ml[1229,31974+6]..[1232,32090+20])
              Pexp_newtype "c"
              expression (testsuite/tests/typing-gadts/test.ml[1229,31974+19]..[1232,32090+20]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+19]..[1229,31974+29])
                  Ppat_constraint
                  pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+20]..[1229,31974+21])
                    Ppat_var "b" (testsuite/tests/typing-gadts/test.ml[1229,31974+20]..[1229,31974+21])
                  core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+24]..[1229,31974+28])
                    Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[1229,31974+24]..[1229,31974+28])
                    []
                expression (testsuite/tests/typing-gadts/test.ml[1229,31974+30]..[1232,32090+20]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+30]..[1229,31974+45])
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+31]..[1229,31974+33])
                      Ppat_var "w1" (testsuite/tests/typing-gadts/test.ml[1229,31974+31]..[1229,31974+33])
                    core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+36]..[1229,31974+44])
                      Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1229,31974+42]..[1229,31974+44])
                      [
                        core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+37]..[1229,31974+38])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1229,31974+37]..[1229,31974+38])
                          []
                        core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+39]..[1229,31974+40])
                          Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1229,31974+39]..[1229,31974+40])
                          []
                      ]
                  expression (testsuite/tests/typing-gadts/test.ml[1229,31974+46]..[1232,32090+20]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+46]..[1229,31974+63])
                      Ppat_constraint
                      pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+47]..[1229,31974+49])
                        Ppat_var "w2" (testsuite/tests/typing-gadts/test.ml[1229,31974+47]..[1229,31974+49])
                      core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+52]..[1229,31974+62])
                        Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1229,31974+60]..[1229,31974+62])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+53]..[1229,31974+54])
                            Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1229,31974+53]..[1229,31974+54])
                            []
                          core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+55]..[1229,31974+58])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1229,31974+55]..[1229,31974+58])
                            []
                        ]
                    expression (testsuite/tests/typing-gadts/test.ml[1229,31974+64]..[1232,32090+20]) ghost
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+64]..[1229,31974+71])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+65]..[1229,31974+66])
                          Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1229,31974+65]..[1229,31974+66])
                        core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+69]..[1229,31974+70])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/test.ml[1229,31974+69]..[1229,31974+70])
                          []
                      expression (testsuite/tests/typing-gadts/test.ml[1229,31974+72]..[1232,32090+20]) ghost
                        Pexp_fun
                        Nolabel
                        None
                        pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+72]..[1229,31974+79])
                          Ppat_constraint
                          pattern (testsuite/tests/typing-gadts/test.ml[1229,31974+73]..[1229,31974+74])
                            Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1229,31974+73]..[1229,31974+74])
                          core_type (testsuite/tests/typing-gadts/test.ml[1229,31974+77]..[1229,31974+78])
                            Ptyp_constr "b" (testsuite/tests/typing-gadts/test.ml[1229,31974+77]..[1229,31974+78])
                            []
                        expression (testsuite/tests/typing-gadts/test.ml[1230,32056+2]..[1232,32090+20])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/test.ml[1230,32056+6]..[1230,32056+8])
                                Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1230,32056+6]..[1230,32056+8])
                                None
                              expression (testsuite/tests/typing-gadts/test.ml[1230,32056+11]..[1230,32056+13])
                                Pexp_ident "w1" (testsuite/tests/typing-gadts/test.ml[1230,32056+11]..[1230,32056+13])
                          ]
                          expression (testsuite/tests/typing-gadts/test.ml[1231,32073+2]..[1232,32090+20])
                            Pexp_let Nonrec
                            [
                              <def>
                                pattern (testsuite/tests/typing-gadts/test.ml[1231,32073+6]..[1231,32073+8])
                                  Ppat_construct "Eq" (testsuite/tests/typing-gadts/test.ml[1231,32073+6]..[1231,32073+8])
                                  None
                                expression (testsuite/tests/typing-gadts/test.ml[1231,32073+11]..[1231,32073+13])
                                  Pexp_ident "w2" (testsuite/tests/typing-gadts/test.ml[1231,32073+11]..[1231,32073+13])
                            ]
                            expression (testsuite/tests/typing-gadts/test.ml[1232,32090+2]..[1232,32090+20])
                              Pexp_ifthenelse
                              expression (testsuite/tests/typing-gadts/test.ml[1232,32090+5]..[1232,32090+6])
                                Pexp_ident "b" (testsuite/tests/typing-gadts/test.ml[1232,32090+5]..[1232,32090+6])
                              expression (testsuite/tests/typing-gadts/test.ml[1232,32090+12]..[1232,32090+13])
                                Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1232,32090+12]..[1232,32090+13])
                              Some
                                expression (testsuite/tests/typing-gadts/test.ml[1232,32090+19]..[1232,32090+20])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1232,32090+19]..[1232,32090+20])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1233,32111+0]..[1241,32384+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1233,32111+9]..[1241,32384+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1233,32111+9]..[1241,32384+2])
          Pexp_constant PConst_string ("\nLine 4, characters 19-20:\n4 |   if b then y else x\n                       ^\nError: This expression has type a = int\n       but an expression was expected of type b = int\n       This instance of int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1233,32111+11]..[1241,32384+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1243,32391+0]..[1245,32418+3])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1243,32391+7]..[1243,32391+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1243,32391+11]..[1245,32418+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1244,32409+2]..[1244,32409+8])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1244,32409+7]..[1244,32409+8]) (testsuite/tests/typing-gadts/test.ml[1244,32409+2]..[1244,32409+8])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1246,32422+0]..[1246,32422+32])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[1246,32422+11]..[1246,32422+13]) (testsuite/tests/typing-gadts/test.ml[1246,32422+0]..[1246,32422+32])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1246,32422+6]..[1246,32422+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/test.ml[1246,32422+8]..[1246,32422+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1246,32422+16]..[1246,32422+32])
                "Refl" (testsuite/tests/typing-gadts/test.ml[1246,32422+16]..[1246,32422+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1246,32422+22]..[1246,32422+32])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1246,32422+30]..[1246,32422+32])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1246,32422+23]..[1246,32422+25])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[1246,32422+26]..[1246,32422+28])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1247,32455+0]..[1249,32515+36])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1247,32455+4]..[1247,32455+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1247,32455+4]..[1247,32455+5])
        expression (testsuite/tests/typing-gadts/test.ml[1247,32455+6]..[1249,32515+36]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/test.ml[1247,32455+6]..[1247,32455+13])
            Ppat_constraint
            pattern (testsuite/tests/typing-gadts/test.ml[1247,32455+7]..[1247,32455+8])
              Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1247,32455+7]..[1247,32455+8])
            core_type (testsuite/tests/typing-gadts/test.ml[1247,32455+9]..[1247,32455+12])
              Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1247,32455+9]..[1247,32455+12])
              []
          expression (testsuite/tests/typing-gadts/test.ml[1247,32455+14]..[1249,32515+36]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1247,32455+14]..[1247,32455+39])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1247,32455+15]..[1247,32455+16])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1247,32455+15]..[1247,32455+16])
              core_type (testsuite/tests/typing-gadts/test.ml[1247,32455+18]..[1247,32455+38])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1247,32455+36]..[1247,32455+38])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1247,32455+19]..[1247,32455+22])
                    Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1247,32455+19]..[1247,32455+22])
                    []
                  core_type (testsuite/tests/typing-gadts/test.ml[1247,32455+24]..[1247,32455+34])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1247,32455+24]..[1247,32455+27])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1247,32455+24]..[1247,32455+27])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1247,32455+31]..[1247,32455+34])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1247,32455+31]..[1247,32455+34])
                      []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[1248,32497+2]..[1249,32515+36])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/test.ml[1248,32497+6]..[1248,32497+10])
                    Ppat_construct "Refl" (testsuite/tests/typing-gadts/test.ml[1248,32497+6]..[1248,32497+10])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[1248,32497+13]..[1248,32497+14])
                    Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1248,32497+13]..[1248,32497+14])
              ]
              expression (testsuite/tests/typing-gadts/test.ml[1249,32515+2]..[1249,32515+36])
                Pexp_ifthenelse
                expression (testsuite/tests/typing-gadts/test.ml[1249,32515+5]..[1249,32515+9])
                  Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1249,32515+5]..[1249,32515+9])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[1249,32515+15]..[1249,32515+16])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1249,32515+15]..[1249,32515+16])
                Some
                  expression (testsuite/tests/typing-gadts/test.ml[1249,32515+22]..[1249,32515+36])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/test.ml[1249,32515+26]..[1249,32515+27])
                      Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1249,32515+26]..[1249,32515+27])
                    expression (testsuite/tests/typing-gadts/test.ml[1249,32515+31]..[1249,32515+36])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/test.ml[1249,32515+33]..[1249,32515+34])
                        Pexp_ident "+" (testsuite/tests/typing-gadts/test.ml[1249,32515+33]..[1249,32515+34])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[1249,32515+31]..[1249,32515+32])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1249,32515+31]..[1249,32515+32])
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/test.ml[1249,32515+35]..[1249,32515+36])
                            Pexp_constant PConst_int (1,None)
                      ]
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1250,32552+0]..[1260,32936+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1250,32552+9]..[1260,32936+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1250,32552+9]..[1260,32936+2])
          Pexp_constant PConst_string ("\nmodule M : sig type t end\ntype (_, _) eq = Refl : ('a, 'a) eq\nLine 7, characters 22-36:\n7 |   if true then x else fun x -> x + 1\n                          ^^^^^^^^^^^^^^\nError: This expression has type 'a -> 'b\n       but an expression was expected of type M.t = int -> int\n       This instance of int -> int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1250,32552+11]..[1260,32936+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1263,32989+0]..[1265,33016+3])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1263,32989+7]..[1263,32989+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1263,32989+11]..[1265,33016+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1264,33007+2]..[1264,33007+8])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1264,33007+7]..[1264,33007+8]) (testsuite/tests/typing-gadts/test.ml[1264,33007+2]..[1264,33007+8])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1266,33020+0]..[1266,33020+32])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[1266,33020+11]..[1266,33020+13]) (testsuite/tests/typing-gadts/test.ml[1266,33020+0]..[1266,33020+32])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1266,33020+6]..[1266,33020+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/test.ml[1266,33020+8]..[1266,33020+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1266,33020+16]..[1266,33020+32])
                "Refl" (testsuite/tests/typing-gadts/test.ml[1266,33020+16]..[1266,33020+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1266,33020+22]..[1266,33020+32])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1266,33020+30]..[1266,33020+32])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1266,33020+23]..[1266,33020+25])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[1266,33020+26]..[1266,33020+28])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1267,33053+0]..[1269,33113+36])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1267,33053+4]..[1267,33053+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1267,33053+4]..[1267,33053+5])
        expression (testsuite/tests/typing-gadts/test.ml[1267,33053+6]..[1269,33113+36]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/test.ml[1267,33053+6]..[1267,33053+13])
            Ppat_constraint
            pattern (testsuite/tests/typing-gadts/test.ml[1267,33053+7]..[1267,33053+8])
              Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1267,33053+7]..[1267,33053+8])
            core_type (testsuite/tests/typing-gadts/test.ml[1267,33053+9]..[1267,33053+12])
              Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1267,33053+9]..[1267,33053+12])
              []
          expression (testsuite/tests/typing-gadts/test.ml[1267,33053+14]..[1269,33113+36]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1267,33053+14]..[1267,33053+39])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1267,33053+15]..[1267,33053+16])
                Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1267,33053+15]..[1267,33053+16])
              core_type (testsuite/tests/typing-gadts/test.ml[1267,33053+18]..[1267,33053+38])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1267,33053+36]..[1267,33053+38])
                [
                  core_type (testsuite/tests/typing-gadts/test.ml[1267,33053+19]..[1267,33053+22])
                    Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1267,33053+19]..[1267,33053+22])
                    []
                  core_type (testsuite/tests/typing-gadts/test.ml[1267,33053+24]..[1267,33053+34])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/test.ml[1267,33053+24]..[1267,33053+27])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1267,33053+24]..[1267,33053+27])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1267,33053+31]..[1267,33053+34])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1267,33053+31]..[1267,33053+34])
                      []
                ]
            expression (testsuite/tests/typing-gadts/test.ml[1268,33095+2]..[1269,33113+36])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/test.ml[1268,33095+6]..[1268,33095+10])
                    Ppat_construct "Refl" (testsuite/tests/typing-gadts/test.ml[1268,33095+6]..[1268,33095+10])
                    None
                  expression (testsuite/tests/typing-gadts/test.ml[1268,33095+13]..[1268,33095+14])
                    Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1268,33095+13]..[1268,33095+14])
              ]
              expression (testsuite/tests/typing-gadts/test.ml[1269,33113+2]..[1269,33113+36])
                Pexp_ifthenelse
                expression (testsuite/tests/typing-gadts/test.ml[1269,33113+5]..[1269,33113+9])
                  Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1269,33113+5]..[1269,33113+9])
                  None
                expression (testsuite/tests/typing-gadts/test.ml[1269,33113+15]..[1269,33113+29])
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1269,33113+19]..[1269,33113+20])
                    Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1269,33113+19]..[1269,33113+20])
                  expression (testsuite/tests/typing-gadts/test.ml[1269,33113+24]..[1269,33113+29])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/test.ml[1269,33113+26]..[1269,33113+27])
                      Pexp_ident "+" (testsuite/tests/typing-gadts/test.ml[1269,33113+26]..[1269,33113+27])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[1269,33113+24]..[1269,33113+25])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1269,33113+24]..[1269,33113+25])
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/test.ml[1269,33113+28]..[1269,33113+29])
                          Pexp_constant PConst_int (1,None)
                    ]
                Some
                  expression (testsuite/tests/typing-gadts/test.ml[1269,33113+35]..[1269,33113+36])
                    Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1269,33113+35]..[1269,33113+36])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1270,33150+0]..[1280,33536+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1270,33150+9]..[1280,33536+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1270,33150+9]..[1280,33536+2])
          Pexp_constant PConst_string ("\nmodule M : sig type t end\ntype (_, _) eq = Refl : ('a, 'a) eq\nLine 7, characters 35-36:\n7 |   if true then fun x -> x + 1 else x\n                                       ^\nError: This expression has type M.t = int -> int\n       but an expression was expected of type int -> int\n       This instance of int -> int is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1270,33150+11]..[1280,33536+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1282,33541+0]..[1284,33568+3])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1282,33541+7]..[1282,33541+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1282,33541+11]..[1284,33568+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1283,33559+2]..[1283,33559+8])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1283,33559+7]..[1283,33559+8]) (testsuite/tests/typing-gadts/test.ml[1283,33559+2]..[1283,33559+8])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1285,33572+0]..[1285,33572+32])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[1285,33572+11]..[1285,33572+13]) (testsuite/tests/typing-gadts/test.ml[1285,33572+0]..[1285,33572+32])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1285,33572+6]..[1285,33572+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/test.ml[1285,33572+8]..[1285,33572+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1285,33572+16]..[1285,33572+32])
                "Refl" (testsuite/tests/typing-gadts/test.ml[1285,33572+16]..[1285,33572+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1285,33572+22]..[1285,33572+32])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1285,33572+30]..[1285,33572+32])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1285,33572+23]..[1285,33572+25])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[1285,33572+26]..[1285,33572+28])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1286,33605+0]..[1289,33699+5])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1286,33605+4]..[1286,33605+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1286,33605+4]..[1286,33605+5])
        expression (testsuite/tests/typing-gadts/test.ml[1286,33605+6]..[1289,33699+5]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/test.ml[1286,33605+6]..[1286,33605+7])
            Ppat_var "w" (testsuite/tests/typing-gadts/test.ml[1286,33605+6]..[1286,33605+7])
          expression (testsuite/tests/typing-gadts/test.ml[1286,33605+8]..[1289,33699+5]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1286,33605+8]..[1286,33605+15])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1286,33605+9]..[1286,33605+10])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1286,33605+9]..[1286,33605+10])
              core_type (testsuite/tests/typing-gadts/test.ml[1286,33605+11]..[1286,33605+14])
                Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1286,33605+11]..[1286,33605+14])
                []
            expression (testsuite/tests/typing-gadts/test.ml[1286,33605+16]..[1289,33699+5]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1286,33605+16]..[1286,33605+38])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[1286,33605+17]..[1286,33605+18])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1286,33605+17]..[1286,33605+18])
                core_type (testsuite/tests/typing-gadts/test.ml[1286,33605+20]..[1286,33605+37])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1286,33605+35]..[1286,33605+37])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1286,33605+21]..[1286,33605+24])
                      Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1286,33605+21]..[1286,33605+24])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1286,33605+26]..[1286,33605+33])
                      Ptyp_object Closed
                        method m
                          core_type (testsuite/tests/typing-gadts/test.ml[1286,33605+29]..[1286,33605+32])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1286,33605+29]..[1286,33605+32])
                            []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[1287,33646+2]..[1289,33699+5])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[1287,33646+6]..[1287,33646+10])
                      Ppat_construct "Refl" (testsuite/tests/typing-gadts/test.ml[1287,33646+6]..[1287,33646+10])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[1287,33646+13]..[1287,33646+14])
                      Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1287,33646+13]..[1287,33646+14])
                ]
                expression (testsuite/tests/typing-gadts/test.ml[1288,33664+2]..[1289,33699+5])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[1288,33664+6]..[1288,33664+7])
                        Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[1288,33664+6]..[1288,33664+7])
                      expression (testsuite/tests/typing-gadts/test.ml[1288,33664+10]..[1288,33664+31])
                        Pexp_ifthenelse
                        expression (testsuite/tests/typing-gadts/test.ml[1288,33664+13]..[1288,33664+17])
                          Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1288,33664+13]..[1288,33664+17])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[1288,33664+23]..[1288,33664+24])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1288,33664+23]..[1288,33664+24])
                        Some
                          expression (testsuite/tests/typing-gadts/test.ml[1288,33664+30]..[1288,33664+31])
                            Pexp_ident "w" (testsuite/tests/typing-gadts/test.ml[1288,33664+30]..[1288,33664+31])
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[1289,33699+2]..[1289,33699+5])
                    Pexp_send "m"
                    expression (testsuite/tests/typing-gadts/test.ml[1289,33699+2]..[1289,33699+3])
                      Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[1289,33699+2]..[1289,33699+3])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1290,33705+0]..[1300,34019+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1290,33705+9]..[1300,34019+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1290,33705+9]..[1300,34019+2])
          Pexp_constant PConst_string ("\nmodule M : sig type t end\ntype (_, _) eq = Refl : ('a, 'a) eq\nLine 8, characters 2-3:\n8 |   z#m\n      ^\nError: This expression has type M.t but an expression was expected of type\n         < m : 'a; .. >\n       This instance of < m : int > is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1290,33705+11]..[1300,34019+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1303,34072+0]..[1305,34099+3])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1303,34072+7]..[1303,34072+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1303,34072+11]..[1305,34099+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1304,34090+2]..[1304,34090+8])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1304,34090+7]..[1304,34090+8]) (testsuite/tests/typing-gadts/test.ml[1304,34090+2]..[1304,34090+8])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1306,34103+0]..[1306,34103+32])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[1306,34103+11]..[1306,34103+13]) (testsuite/tests/typing-gadts/test.ml[1306,34103+0]..[1306,34103+32])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1306,34103+6]..[1306,34103+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/test.ml[1306,34103+8]..[1306,34103+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1306,34103+16]..[1306,34103+32])
                "Refl" (testsuite/tests/typing-gadts/test.ml[1306,34103+16]..[1306,34103+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1306,34103+22]..[1306,34103+32])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1306,34103+30]..[1306,34103+32])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1306,34103+23]..[1306,34103+25])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[1306,34103+26]..[1306,34103+28])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1307,34136+0]..[1310,34230+5])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1307,34136+4]..[1307,34136+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1307,34136+4]..[1307,34136+5])
        expression (testsuite/tests/typing-gadts/test.ml[1307,34136+6]..[1310,34230+5]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/test.ml[1307,34136+6]..[1307,34136+7])
            Ppat_var "w" (testsuite/tests/typing-gadts/test.ml[1307,34136+6]..[1307,34136+7])
          expression (testsuite/tests/typing-gadts/test.ml[1307,34136+8]..[1310,34230+5]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/test.ml[1307,34136+8]..[1307,34136+15])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/test.ml[1307,34136+9]..[1307,34136+10])
                Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1307,34136+9]..[1307,34136+10])
              core_type (testsuite/tests/typing-gadts/test.ml[1307,34136+11]..[1307,34136+14])
                Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1307,34136+11]..[1307,34136+14])
                []
            expression (testsuite/tests/typing-gadts/test.ml[1307,34136+16]..[1310,34230+5]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/test.ml[1307,34136+16]..[1307,34136+38])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/test.ml[1307,34136+17]..[1307,34136+18])
                  Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1307,34136+17]..[1307,34136+18])
                core_type (testsuite/tests/typing-gadts/test.ml[1307,34136+20]..[1307,34136+37])
                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1307,34136+35]..[1307,34136+37])
                  [
                    core_type (testsuite/tests/typing-gadts/test.ml[1307,34136+21]..[1307,34136+24])
                      Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1307,34136+21]..[1307,34136+24])
                      []
                    core_type (testsuite/tests/typing-gadts/test.ml[1307,34136+26]..[1307,34136+33])
                      Ptyp_object Closed
                        method m
                          core_type (testsuite/tests/typing-gadts/test.ml[1307,34136+29]..[1307,34136+32])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1307,34136+29]..[1307,34136+32])
                            []
                  ]
              expression (testsuite/tests/typing-gadts/test.ml[1308,34177+2]..[1310,34230+5])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/test.ml[1308,34177+6]..[1308,34177+10])
                      Ppat_construct "Refl" (testsuite/tests/typing-gadts/test.ml[1308,34177+6]..[1308,34177+10])
                      None
                    expression (testsuite/tests/typing-gadts/test.ml[1308,34177+13]..[1308,34177+14])
                      Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1308,34177+13]..[1308,34177+14])
                ]
                expression (testsuite/tests/typing-gadts/test.ml[1309,34195+2]..[1310,34230+5])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/test.ml[1309,34195+6]..[1309,34195+7])
                        Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[1309,34195+6]..[1309,34195+7])
                      expression (testsuite/tests/typing-gadts/test.ml[1309,34195+10]..[1309,34195+31])
                        Pexp_ifthenelse
                        expression (testsuite/tests/typing-gadts/test.ml[1309,34195+13]..[1309,34195+17])
                          Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1309,34195+13]..[1309,34195+17])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[1309,34195+23]..[1309,34195+24])
                          Pexp_ident "w" (testsuite/tests/typing-gadts/test.ml[1309,34195+23]..[1309,34195+24])
                        Some
                          expression (testsuite/tests/typing-gadts/test.ml[1309,34195+30]..[1309,34195+31])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1309,34195+30]..[1309,34195+31])
                  ]
                  expression (testsuite/tests/typing-gadts/test.ml[1310,34230+2]..[1310,34230+5])
                    Pexp_send "m"
                    expression (testsuite/tests/typing-gadts/test.ml[1310,34230+2]..[1310,34230+3])
                      Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[1310,34230+2]..[1310,34230+3])
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1311,34236+0]..[1321,34550+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1311,34236+9]..[1321,34550+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1311,34236+9]..[1321,34550+2])
          Pexp_constant PConst_string ("\nmodule M : sig type t end\ntype (_, _) eq = Refl : ('a, 'a) eq\nLine 8, characters 2-3:\n8 |   z#m\n      ^\nError: This expression has type M.t but an expression was expected of type\n         < m : 'a; .. >\n       This instance of < m : int > is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1311,34236+11]..[1321,34550+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1323,34555+0]..[1323,34555+32])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[1323,34555+11]..[1323,34555+13]) (testsuite/tests/typing-gadts/test.ml[1323,34555+0]..[1323,34555+32])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1323,34555+6]..[1323,34555+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/test.ml[1323,34555+8]..[1323,34555+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1323,34555+16]..[1323,34555+32])
                "Refl" (testsuite/tests/typing-gadts/test.ml[1323,34555+16]..[1323,34555+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1323,34555+22]..[1323,34555+32])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1323,34555+30]..[1323,34555+32])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1323,34555+23]..[1323,34555+25])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[1323,34555+26]..[1323,34555+28])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1324,34588+0]..[1326,34673+3])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1324,34588+7]..[1324,34588+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1324,34588+11]..[1326,34673+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1325,34606+2]..[1325,34606+66])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1325,34606+7]..[1325,34606+8]) (testsuite/tests/typing-gadts/test.ml[1325,34606+2]..[1325,34606+66])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[1325,34606+11]..[1325,34606+66])
                        "C" (testsuite/tests/typing-gadts/test.ml[1325,34606+11]..[1325,34606+12])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+16]..[1325,34606+33])
                            Ptyp_alias "a"
                            core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+16]..[1325,34606+27])
                              Ptyp_object Open
                                method m
                                  core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+19]..[1325,34606+22])
                                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1325,34606+19]..[1325,34606+22])
                                    []
                          core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+37]..[1325,34606+61])
                            Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1325,34606+59]..[1325,34606+61])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+38]..[1325,34606+40])
                                Ptyp_var a
                              core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+42]..[1325,34606+57])
                                Ptyp_object Closed
                                  method m
                                    core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+45]..[1325,34606+48])
                                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1325,34606+45]..[1325,34606+48])
                                      []
                                  method b
                                    core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+52]..[1325,34606+56])
                                      Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[1325,34606+52]..[1325,34606+56])
                                      []
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[1325,34606+65]..[1325,34606+66])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1325,34606+65]..[1325,34606+66])
                            []
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1327,34677+0]..[1332,34778+7])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1327,34677+4]..[1327,34677+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1327,34677+4]..[1327,34677+5])
        expression (testsuite/tests/typing-gadts/test.ml[1327,34677+6]..[1332,34778+7]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/test.ml[1327,34677+6]..[1327,34677+21])
            Ppat_constraint
            pattern (testsuite/tests/typing-gadts/test.ml[1327,34677+7]..[1327,34677+14])
              Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[1327,34677+7]..[1327,34677+8])
              Some
                []
                pattern (testsuite/tests/typing-gadts/test.ml[1327,34677+9]..[1327,34677+14])
                  Ppat_tuple
                  [
                    pattern (testsuite/tests/typing-gadts/test.ml[1327,34677+10]..[1327,34677+11])
                      Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1327,34677+10]..[1327,34677+11])
                    pattern (testsuite/tests/typing-gadts/test.ml[1327,34677+12]..[1327,34677+13])
                      Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1327,34677+12]..[1327,34677+13])
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[1327,34677+17]..[1327,34677+20])
              Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1327,34677+17]..[1327,34677+20])
              []
          expression (testsuite/tests/typing-gadts/test.ml[1328,34701+2]..[1332,34778+7])
            Pexp_let Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[1328,34701+6]..[1328,34701+7])
                  Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1328,34701+6]..[1328,34701+7])
                expression (testsuite/tests/typing-gadts/test.ml[1328,34701+8]..[1331,34770+7]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1328,34701+8]..[1328,34701+9])
                    Ppat_var "w" (testsuite/tests/typing-gadts/test.ml[1328,34701+8]..[1328,34701+9])
                  expression (testsuite/tests/typing-gadts/test.ml[1329,34713+4]..[1331,34770+7])
                    Pexp_let Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/test.ml[1329,34713+8]..[1329,34713+12])
                          Ppat_construct "Refl" (testsuite/tests/typing-gadts/test.ml[1329,34713+8]..[1329,34713+12])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[1329,34713+15]..[1329,34713+16])
                          Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1329,34713+15]..[1329,34713+16])
                    ]
                    expression (testsuite/tests/typing-gadts/test.ml[1330,34733+4]..[1331,34770+7])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (testsuite/tests/typing-gadts/test.ml[1330,34733+8]..[1330,34733+9])
                            Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[1330,34733+8]..[1330,34733+9])
                          expression (testsuite/tests/typing-gadts/test.ml[1330,34733+12]..[1330,34733+33])
                            Pexp_ifthenelse
                            expression (testsuite/tests/typing-gadts/test.ml[1330,34733+15]..[1330,34733+19])
                              Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1330,34733+15]..[1330,34733+19])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[1330,34733+25]..[1330,34733+26])
                              Pexp_ident "w" (testsuite/tests/typing-gadts/test.ml[1330,34733+25]..[1330,34733+26])
                            Some
                              expression (testsuite/tests/typing-gadts/test.ml[1330,34733+32]..[1330,34733+33])
                                Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1330,34733+32]..[1330,34733+33])
                      ]
                      expression (testsuite/tests/typing-gadts/test.ml[1331,34770+4]..[1331,34770+7])
                        Pexp_send "b"
                        expression (testsuite/tests/typing-gadts/test.ml[1331,34770+4]..[1331,34770+5])
                          Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[1331,34770+4]..[1331,34770+5])
            ]
            expression (testsuite/tests/typing-gadts/test.ml[1332,34778+5]..[1332,34778+7])
              Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[1332,34778+5]..[1332,34778+7])
              None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1333,34786+0]..[1347,35204+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1333,34786+9]..[1347,35204+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1333,34786+9]..[1347,35204+2])
          Pexp_constant PConst_string ("\ntype (_, _) eq = Refl : ('a, 'a) eq\nmodule M :\n  sig\n    type t =\n        C : (< m : int; .. > as 'a) * ('a, < b : bool; m : int >) eq -> t\n  end\nLine 9, characters 4-5:\n9 |     z#b\n        ^\nError: This expression has type $C_'a = < b : bool >\n       but an expression was expected of type < b : 'a; .. >\n       This instance of < b : bool > is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1333,34786+11]..[1347,35204+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1350,35257+0]..[1350,35257+32])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/test.ml[1350,35257+11]..[1350,35257+13]) (testsuite/tests/typing-gadts/test.ml[1350,35257+0]..[1350,35257+32])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/test.ml[1350,35257+6]..[1350,35257+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/test.ml[1350,35257+8]..[1350,35257+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/test.ml[1350,35257+16]..[1350,35257+32])
                "Refl" (testsuite/tests/typing-gadts/test.ml[1350,35257+16]..[1350,35257+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/test.ml[1350,35257+22]..[1350,35257+32])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1350,35257+30]..[1350,35257+32])
                    [
                      core_type (testsuite/tests/typing-gadts/test.ml[1350,35257+23]..[1350,35257+25])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/test.ml[1350,35257+26]..[1350,35257+28])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1351,35290+0]..[1353,35375+3])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/test.ml[1351,35290+7]..[1351,35290+8])
      module_expr (testsuite/tests/typing-gadts/test.ml[1351,35290+11]..[1353,35375+3])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/test.ml[1352,35308+2]..[1352,35308+66])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/test.ml[1352,35308+7]..[1352,35308+8]) (testsuite/tests/typing-gadts/test.ml[1352,35308+2]..[1352,35308+66])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/test.ml[1352,35308+11]..[1352,35308+66])
                        "C" (testsuite/tests/typing-gadts/test.ml[1352,35308+11]..[1352,35308+12])
                        [
                          core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+16]..[1352,35308+33])
                            Ptyp_alias "a"
                            core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+16]..[1352,35308+27])
                              Ptyp_object Open
                                method m
                                  core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+19]..[1352,35308+22])
                                    Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1352,35308+19]..[1352,35308+22])
                                    []
                          core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+37]..[1352,35308+61])
                            Ptyp_constr "eq" (testsuite/tests/typing-gadts/test.ml[1352,35308+59]..[1352,35308+61])
                            [
                              core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+38]..[1352,35308+40])
                                Ptyp_var a
                              core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+42]..[1352,35308+57])
                                Ptyp_object Closed
                                  method m
                                    core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+45]..[1352,35308+48])
                                      Ptyp_constr "int" (testsuite/tests/typing-gadts/test.ml[1352,35308+45]..[1352,35308+48])
                                      []
                                  method b
                                    core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+52]..[1352,35308+56])
                                      Ptyp_constr "bool" (testsuite/tests/typing-gadts/test.ml[1352,35308+52]..[1352,35308+56])
                                      []
                            ]
                        ]
                        Some
                          core_type (testsuite/tests/typing-gadts/test.ml[1352,35308+65]..[1352,35308+66])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/test.ml[1352,35308+65]..[1352,35308+66])
                            []
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1354,35379+0]..[1359,35480+7])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/test.ml[1354,35379+4]..[1354,35379+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/test.ml[1354,35379+4]..[1354,35379+5])
        expression (testsuite/tests/typing-gadts/test.ml[1354,35379+6]..[1359,35480+7]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/test.ml[1354,35379+6]..[1354,35379+21])
            Ppat_constraint
            pattern (testsuite/tests/typing-gadts/test.ml[1354,35379+7]..[1354,35379+14])
              Ppat_construct "C" (testsuite/tests/typing-gadts/test.ml[1354,35379+7]..[1354,35379+8])
              Some
                []
                pattern (testsuite/tests/typing-gadts/test.ml[1354,35379+9]..[1354,35379+14])
                  Ppat_tuple
                  [
                    pattern (testsuite/tests/typing-gadts/test.ml[1354,35379+10]..[1354,35379+11])
                      Ppat_var "x" (testsuite/tests/typing-gadts/test.ml[1354,35379+10]..[1354,35379+11])
                    pattern (testsuite/tests/typing-gadts/test.ml[1354,35379+12]..[1354,35379+13])
                      Ppat_var "y" (testsuite/tests/typing-gadts/test.ml[1354,35379+12]..[1354,35379+13])
                  ]
            core_type (testsuite/tests/typing-gadts/test.ml[1354,35379+17]..[1354,35379+20])
              Ptyp_constr "M.t" (testsuite/tests/typing-gadts/test.ml[1354,35379+17]..[1354,35379+20])
              []
          expression (testsuite/tests/typing-gadts/test.ml[1355,35403+2]..[1359,35480+7])
            Pexp_let Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/test.ml[1355,35403+6]..[1355,35403+7])
                  Ppat_var "g" (testsuite/tests/typing-gadts/test.ml[1355,35403+6]..[1355,35403+7])
                expression (testsuite/tests/typing-gadts/test.ml[1355,35403+8]..[1358,35472+7]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/test.ml[1355,35403+8]..[1355,35403+9])
                    Ppat_var "w" (testsuite/tests/typing-gadts/test.ml[1355,35403+8]..[1355,35403+9])
                  expression (testsuite/tests/typing-gadts/test.ml[1356,35415+4]..[1358,35472+7])
                    Pexp_let Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/test.ml[1356,35415+8]..[1356,35415+12])
                          Ppat_construct "Refl" (testsuite/tests/typing-gadts/test.ml[1356,35415+8]..[1356,35415+12])
                          None
                        expression (testsuite/tests/typing-gadts/test.ml[1356,35415+15]..[1356,35415+16])
                          Pexp_ident "y" (testsuite/tests/typing-gadts/test.ml[1356,35415+15]..[1356,35415+16])
                    ]
                    expression (testsuite/tests/typing-gadts/test.ml[1357,35435+4]..[1358,35472+7])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (testsuite/tests/typing-gadts/test.ml[1357,35435+8]..[1357,35435+9])
                            Ppat_var "z" (testsuite/tests/typing-gadts/test.ml[1357,35435+8]..[1357,35435+9])
                          expression (testsuite/tests/typing-gadts/test.ml[1357,35435+12]..[1357,35435+33])
                            Pexp_ifthenelse
                            expression (testsuite/tests/typing-gadts/test.ml[1357,35435+15]..[1357,35435+19])
                              Pexp_construct "true" (testsuite/tests/typing-gadts/test.ml[1357,35435+15]..[1357,35435+19])
                              None
                            expression (testsuite/tests/typing-gadts/test.ml[1357,35435+25]..[1357,35435+26])
                              Pexp_ident "x" (testsuite/tests/typing-gadts/test.ml[1357,35435+25]..[1357,35435+26])
                            Some
                              expression (testsuite/tests/typing-gadts/test.ml[1357,35435+32]..[1357,35435+33])
                                Pexp_ident "w" (testsuite/tests/typing-gadts/test.ml[1357,35435+32]..[1357,35435+33])
                      ]
                      expression (testsuite/tests/typing-gadts/test.ml[1358,35472+4]..[1358,35472+7])
                        Pexp_send "b"
                        expression (testsuite/tests/typing-gadts/test.ml[1358,35472+4]..[1358,35472+5])
                          Pexp_ident "z" (testsuite/tests/typing-gadts/test.ml[1358,35472+4]..[1358,35472+5])
            ]
            expression (testsuite/tests/typing-gadts/test.ml[1359,35480+5]..[1359,35480+7])
              Pexp_construct "()" (testsuite/tests/typing-gadts/test.ml[1359,35480+5]..[1359,35480+7])
              None
    ]
  structure_item (testsuite/tests/typing-gadts/test.ml[1360,35488+0]..[1374,35906+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/test.ml[1360,35488+9]..[1374,35906+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/test.ml[1360,35488+9]..[1374,35906+2])
          Pexp_constant PConst_string ("\ntype (_, _) eq = Refl : ('a, 'a) eq\nmodule M :\n  sig\n    type t =\n        C : (< m : int; .. > as 'a) * ('a, < b : bool; m : int >) eq -> t\n  end\nLine 9, characters 4-5:\n9 |     z#b\n        ^\nError: This expression has type $C_'a = < b : bool >\n       but an expression was expected of type < b : 'a; .. >\n       This instance of < b : bool > is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/test.ml[1360,35488+11]..[1374,35906+0]),Some "")
    ]
]

