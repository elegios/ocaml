[
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[5,24+0]..[5,24+20])
    Pstr_type Rec
    [
      type_declaration "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[5,24+8]..[5,24+20]) (testsuite/tests/typing-gadts/pr6690.ml[5,24+0]..[5,24+20])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6690.ml[5,24+5]..[5,24+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[7,46+0]..[7,46+11])
    Pstr_type Rec
    [
      type_declaration "insert" (testsuite/tests/typing-gadts/pr6690.ml[7,46+5]..[7,46+11]) (testsuite/tests/typing-gadts/pr6690.ml[7,46+0]..[7,46+11])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[9,59+0]..[9,59+26])
    Pstr_type Rec
    [
      type_declaration "local_visit_action" (testsuite/tests/typing-gadts/pr6690.ml[9,59+8]..[9,59+26]) (testsuite/tests/typing-gadts/pr6690.ml[9,59+0]..[9,59+26])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6690.ml[9,59+5]..[9,59+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[11,87+0]..[13,205+46])
    Pstr_type Rec
    [
      type_declaration "context" (testsuite/tests/typing-gadts/pr6690.ml[11,87+34]..[11,87+41]) (testsuite/tests/typing-gadts/pr6690.ml[11,87+0]..[13,205+46])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6690.ml[11,87+6]..[11,87+8])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/pr6690.ml[11,87+10]..[11,87+17])
              Ptyp_var result
            core_type (testsuite/tests/typing-gadts/pr6690.ml[11,87+19]..[11,87+32])
              Ptyp_var visit_action
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr6690.ml[12,131+2]..[12,131+73])
                "Local" (testsuite/tests/typing-gadts/pr6690.ml[12,131+4]..[12,131+9])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+12]..[12,131+73])
                    Ptyp_constr "context" (testsuite/tests/typing-gadts/pr6690.ml[12,131+66]..[12,131+73])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+13]..[12,131+15])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+17]..[12,131+41])
                        Ptyp_alias "result"
                        core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+18]..[12,131+29])
                          Ptyp_tuple
                          [
                            core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+18]..[12,131+20])
                              Ptyp_var a
                            core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+23]..[12,131+29])
                              Ptyp_constr "insert" (testsuite/tests/typing-gadts/pr6690.ml[12,131+23]..[12,131+29])
                              []
                          ]
                      core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+43]..[12,131+64])
                        Ptyp_constr "local_visit_action" (testsuite/tests/typing-gadts/pr6690.ml[12,131+46]..[12,131+64])
                        [
                          core_type (testsuite/tests/typing-gadts/pr6690.ml[12,131+43]..[12,131+45])
                            Ptyp_var a
                        ]
                    ]
              (testsuite/tests/typing-gadts/pr6690.ml[13,205+2]..[13,205+46])
                "Global" (testsuite/tests/typing-gadts/pr6690.ml[13,205+4]..[13,205+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[13,205+13]..[13,205+46])
                    Ptyp_constr "context" (testsuite/tests/typing-gadts/pr6690.ml[13,205+39]..[13,205+46])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6690.ml[13,205+14]..[13,205+16])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/pr6690.ml[13,205+18]..[13,205+20])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/pr6690.ml[13,205+22]..[13,205+37])
                        Ptyp_constr "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[13,205+25]..[13,205+37])
                        [
                          core_type (testsuite/tests/typing-gadts/pr6690.ml[13,205+22]..[13,205+24])
                            Ptyp_var a
                        ]
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[16,256+0]..[20,388+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr6690.ml[16,256+4]..[16,256+9])
          Ppat_var "vexpr" (testsuite/tests/typing-gadts/pr6690.ml[16,256+4]..[16,256+9])
        expression (testsuite/tests/typing-gadts/pr6690.ml[16,256+10]..[20,388+33])
          Pexp_newtype "visit_action"
          expression (testsuite/tests/typing-gadts/pr6690.ml[17,286+4]..[20,388+33])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/pr6690.ml[18,344+2]..[20,388+33])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/pr6690.ml[19,355+4]..[19,355+9])
                    Ppat_construct "Local" (testsuite/tests/typing-gadts/pr6690.ml[19,355+4]..[19,355+9])
                    None
                  expression (testsuite/tests/typing-gadts/pr6690.ml[19,355+13]..[19,355+32])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/pr6690.ml[19,355+17]..[19,355+18])
                      Ppat_any
                    expression (testsuite/tests/typing-gadts/pr6690.ml[19,355+22]..[19,355+32])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/pr6690.ml[19,355+22]..[19,355+27])
                        Pexp_ident "raise" (testsuite/tests/typing-gadts/pr6690.ml[19,355+22]..[19,355+27])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/pr6690.ml[19,355+28]..[19,355+32])
                            Pexp_construct "Exit" (testsuite/tests/typing-gadts/pr6690.ml[19,355+28]..[19,355+32])
                            None
                      ]
                <case>
                  pattern (testsuite/tests/typing-gadts/pr6690.ml[20,388+4]..[20,388+10])
                    Ppat_construct "Global" (testsuite/tests/typing-gadts/pr6690.ml[20,388+4]..[20,388+10])
                    None
                  expression (testsuite/tests/typing-gadts/pr6690.ml[20,388+14]..[20,388+33])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/pr6690.ml[20,388+18]..[20,388+19])
                      Ppat_any
                    expression (testsuite/tests/typing-gadts/pr6690.ml[20,388+23]..[20,388+33])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/pr6690.ml[20,388+23]..[20,388+28])
                        Pexp_ident "raise" (testsuite/tests/typing-gadts/pr6690.ml[20,388+23]..[20,388+28])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/pr6690.ml[20,388+29]..[20,388+33])
                            Pexp_construct "Exit" (testsuite/tests/typing-gadts/pr6690.ml[20,388+29]..[20,388+33])
                            None
                      ]
              ]
            core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+6]..[17,286+55])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+6]..[17,286+34])
                Ptyp_constr "context" (testsuite/tests/typing-gadts/pr6690.ml[17,286+27]..[17,286+34])
                [
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+7]..[17,286+8])
                    Ptyp_any
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+10]..[17,286+11])
                    Ptyp_any
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+13]..[17,286+25])
                    Ptyp_constr "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[17,286+13]..[17,286+25])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+38]..[17,286+55])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+38]..[17,286+39])
                  Ptyp_any
                core_type (testsuite/tests/typing-gadts/pr6690.ml[17,286+43]..[17,286+55])
                  Ptyp_constr "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[17,286+43]..[17,286+55])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[22,425+0]..[37,994+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr6690.ml[22,425+9]..[37,994+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr6690.ml[22,425+9]..[37,994+2])
          Pexp_constant PConst_string ("\ntype 'a visit_action\ntype insert\ntype 'a local_visit_action\ntype ('a, 'result, 'visit_action) context =\n    Local : ('a, 'a * insert, 'a local_visit_action) context\n  | Global : ('a, 'a, 'a visit_action) context\nLine 15, characters 4-9:\n15 |   | Local -> fun _ -> raise Exit\n         ^^^^^\nError: This pattern matches values of type\n         ($0, $0 * insert, $0 local_visit_action) context\n       but a pattern was expected which matches values of type\n         ($0, $0 * insert, visit_action) context\n       The type constructor $0 would escape its scope\n",(testsuite/tests/typing-gadts/pr6690.ml[22,425+11]..[37,994+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[39,1001+0]..[43,1141+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr6690.ml[39,1001+4]..[39,1001+9])
          Ppat_var "vexpr" (testsuite/tests/typing-gadts/pr6690.ml[39,1001+4]..[39,1001+9])
        expression (testsuite/tests/typing-gadts/pr6690.ml[39,1001+10]..[43,1141+33])
          Pexp_newtype "visit_action"
          expression (testsuite/tests/typing-gadts/pr6690.ml[40,1031+4]..[43,1141+33])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/pr6690.ml[41,1097+2]..[43,1141+33])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/pr6690.ml[42,1108+4]..[42,1108+9])
                    Ppat_construct "Local" (testsuite/tests/typing-gadts/pr6690.ml[42,1108+4]..[42,1108+9])
                    None
                  expression (testsuite/tests/typing-gadts/pr6690.ml[42,1108+13]..[42,1108+32])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/pr6690.ml[42,1108+17]..[42,1108+18])
                      Ppat_any
                    expression (testsuite/tests/typing-gadts/pr6690.ml[42,1108+22]..[42,1108+32])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/pr6690.ml[42,1108+22]..[42,1108+27])
                        Pexp_ident "raise" (testsuite/tests/typing-gadts/pr6690.ml[42,1108+22]..[42,1108+27])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/pr6690.ml[42,1108+28]..[42,1108+32])
                            Pexp_construct "Exit" (testsuite/tests/typing-gadts/pr6690.ml[42,1108+28]..[42,1108+32])
                            None
                      ]
                <case>
                  pattern (testsuite/tests/typing-gadts/pr6690.ml[43,1141+4]..[43,1141+10])
                    Ppat_construct "Global" (testsuite/tests/typing-gadts/pr6690.ml[43,1141+4]..[43,1141+10])
                    None
                  expression (testsuite/tests/typing-gadts/pr6690.ml[43,1141+14]..[43,1141+33])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/pr6690.ml[43,1141+18]..[43,1141+19])
                      Ppat_any
                    expression (testsuite/tests/typing-gadts/pr6690.ml[43,1141+23]..[43,1141+33])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/pr6690.ml[43,1141+23]..[43,1141+28])
                        Pexp_ident "raise" (testsuite/tests/typing-gadts/pr6690.ml[43,1141+23]..[43,1141+28])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/pr6690.ml[43,1141+29]..[43,1141+33])
                            Pexp_construct "Exit" (testsuite/tests/typing-gadts/pr6690.ml[43,1141+29]..[43,1141+33])
                            None
                      ]
              ]
            core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+6]..[40,1031+63])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+6]..[40,1031+41])
                Ptyp_constr "context" (testsuite/tests/typing-gadts/pr6690.ml[40,1031+34]..[40,1031+41])
                [
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+7]..[40,1031+9])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+11]..[40,1031+18])
                    Ptyp_var result
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+20]..[40,1031+32])
                    Ptyp_constr "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[40,1031+20]..[40,1031+32])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+45]..[40,1031+63])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+45]..[40,1031+47])
                  Ptyp_var a
                core_type (testsuite/tests/typing-gadts/pr6690.ml[40,1031+51]..[40,1031+63])
                  Ptyp_constr "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[40,1031+51]..[40,1031+63])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[45,1178+0]..[54,1538+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr6690.ml[45,1178+9]..[54,1538+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr6690.ml[45,1178+9]..[54,1538+2])
          Pexp_constant PConst_string ("\nLine 4, characters 4-9:\n4 |   | Local -> fun _ -> raise Exit\n        ^^^^^\nError: This pattern matches values of type\n         ($'a, $'a * insert, $'a local_visit_action) context\n       but a pattern was expected which matches values of type\n         ($'a, $'a * insert, visit_action) context\n       The type constructor $'a would escape its scope\n",(testsuite/tests/typing-gadts/pr6690.ml[45,1178+11]..[54,1538+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[56,1545+0]..[60,1702+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr6690.ml[56,1545+4]..[56,1545+9])
          Ppat_var "vexpr" (testsuite/tests/typing-gadts/pr6690.ml[56,1545+4]..[56,1545+9])
        expression (testsuite/tests/typing-gadts/pr6690.ml[56,1545+10]..[60,1702+33])
          Pexp_newtype "result"
          expression (testsuite/tests/typing-gadts/pr6690.ml[56,1545+24]..[60,1702+33])
            Pexp_newtype "visit_action"
            expression (testsuite/tests/typing-gadts/pr6690.ml[57,1589+4]..[60,1702+33])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/pr6690.ml[58,1658+2]..[60,1702+33])
                Pexp_function
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/pr6690.ml[59,1669+4]..[59,1669+9])
                      Ppat_construct "Local" (testsuite/tests/typing-gadts/pr6690.ml[59,1669+4]..[59,1669+9])
                      None
                    expression (testsuite/tests/typing-gadts/pr6690.ml[59,1669+13]..[59,1669+32])
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/pr6690.ml[59,1669+17]..[59,1669+18])
                        Ppat_any
                      expression (testsuite/tests/typing-gadts/pr6690.ml[59,1669+22]..[59,1669+32])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/pr6690.ml[59,1669+22]..[59,1669+27])
                          Pexp_ident "raise" (testsuite/tests/typing-gadts/pr6690.ml[59,1669+22]..[59,1669+27])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/pr6690.ml[59,1669+28]..[59,1669+32])
                              Pexp_construct "Exit" (testsuite/tests/typing-gadts/pr6690.ml[59,1669+28]..[59,1669+32])
                              None
                        ]
                  <case>
                    pattern (testsuite/tests/typing-gadts/pr6690.ml[60,1702+4]..[60,1702+10])
                      Ppat_construct "Global" (testsuite/tests/typing-gadts/pr6690.ml[60,1702+4]..[60,1702+10])
                      None
                    expression (testsuite/tests/typing-gadts/pr6690.ml[60,1702+14]..[60,1702+33])
                      Pexp_fun
                      Nolabel
                      None
                      pattern (testsuite/tests/typing-gadts/pr6690.ml[60,1702+18]..[60,1702+19])
                        Ppat_any
                      expression (testsuite/tests/typing-gadts/pr6690.ml[60,1702+23]..[60,1702+33])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/pr6690.ml[60,1702+23]..[60,1702+28])
                          Pexp_ident "raise" (testsuite/tests/typing-gadts/pr6690.ml[60,1702+23]..[60,1702+28])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/pr6690.ml[60,1702+29]..[60,1702+33])
                              Pexp_construct "Exit" (testsuite/tests/typing-gadts/pr6690.ml[60,1702+29]..[60,1702+33])
                              None
                        ]
                ]
              core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+6]..[57,1589+66])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+6]..[57,1589+42])
                  Ptyp_constr "context" (testsuite/tests/typing-gadts/pr6690.ml[57,1589+35]..[57,1589+42])
                  [
                    core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+7]..[57,1589+11])
                      Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr6690.ml[57,1589+7]..[57,1589+11])
                      []
                    core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+13]..[57,1589+19])
                      Ptyp_constr "result" (testsuite/tests/typing-gadts/pr6690.ml[57,1589+13]..[57,1589+19])
                      []
                    core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+21]..[57,1589+33])
                      Ptyp_constr "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[57,1589+21]..[57,1589+33])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+46]..[57,1589+66])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+46]..[57,1589+50])
                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr6690.ml[57,1589+46]..[57,1589+50])
                    []
                  core_type (testsuite/tests/typing-gadts/pr6690.ml[57,1589+54]..[57,1589+66])
                    Ptyp_constr "visit_action" (testsuite/tests/typing-gadts/pr6690.ml[57,1589+54]..[57,1589+66])
                    []
    ]
  structure_item (testsuite/tests/typing-gadts/pr6690.ml[62,1739+0]..[65,1837+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr6690.ml[62,1739+9]..[65,1837+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr6690.ml[62,1739+9]..[65,1837+2])
          Pexp_constant PConst_string ("\nval vexpr : (unit, 'result, 'visit_action) context -> unit -> 'visit_action =\n  <fun>\n",(testsuite/tests/typing-gadts/pr6690.ml[62,1739+11]..[65,1837+0]),Some "")
    ]
]

