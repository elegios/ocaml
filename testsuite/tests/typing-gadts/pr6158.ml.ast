[
  structure_item (testsuite/tests/typing-gadts/pr6158.ml[5,24+0]..[5,24+19])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/pr6158.ml[5,24+8]..[5,24+9]) (testsuite/tests/typing-gadts/pr6158.ml[5,24+0]..[5,24+19])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6158.ml[5,24+5]..[5,24+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr6158.ml[5,24+12]..[5,24+19])
                "T" (testsuite/tests/typing-gadts/pr6158.ml[5,24+12]..[5,24+13])
                [
                  core_type (testsuite/tests/typing-gadts/pr6158.ml[5,24+17]..[5,24+19])
                    Ptyp_var a
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6158.ml[6,44+0]..[6,44+19])
    Pstr_type Rec
    [
      type_declaration "s" (testsuite/tests/typing-gadts/pr6158.ml[6,44+8]..[6,44+9]) (testsuite/tests/typing-gadts/pr6158.ml[6,44+0]..[6,44+19])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6158.ml[6,44+5]..[6,44+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr6158.ml[6,44+12]..[6,44+19])
                "S" (testsuite/tests/typing-gadts/pr6158.ml[6,44+12]..[6,44+13])
                [
                  core_type (testsuite/tests/typing-gadts/pr6158.ml[6,44+17]..[6,44+19])
                    Ptyp_var a
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6158.ml[8,65+0]..[8,65+35])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/pr6158.ml[8,65+12]..[8,65+14]) (testsuite/tests/typing-gadts/pr6158.ml[8,65+0]..[8,65+35])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr6158.ml[8,65+6]..[8,65+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/pr6158.ml[8,65+9]..[8,65+10])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr6158.ml[8,65+17]..[8,65+35])
                "Refl" (testsuite/tests/typing-gadts/pr6158.ml[8,65+17]..[8,65+21])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr6158.ml[8,65+24]..[8,65+35])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr6158.ml[8,65+33]..[8,65+35])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[8,65+25]..[8,65+27])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[8,65+29]..[8,65+31])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr6158.ml[10,104+0]..[10,104+55])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr6158.ml[10,104+4]..[10,104+33]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/pr6158.ml[10,104+4]..[10,104+5])
            Ppat_var "f" (testsuite/tests/typing-gadts/pr6158.ml[10,104+4]..[10,104+5])
          core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+8]..[10,104+33]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+8]..[10,104+33])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+8]..[10,104+25])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr6158.ml[10,104+23]..[10,104+25])
                [
                  core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+9]..[10,104+14])
                    Ptyp_constr "s" (testsuite/tests/typing-gadts/pr6158.ml[10,104+13]..[10,104+14])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+9]..[10,104+12])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/pr6158.ml[10,104+9]..[10,104+12])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+16]..[10,104+21])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/pr6158.ml[10,104+20]..[10,104+21])
                    [
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+16]..[10,104+19])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/pr6158.ml[10,104+16]..[10,104+19])
                        []
                    ]
                ]
              core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+29]..[10,104+33])
                Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr6158.ml[10,104+29]..[10,104+33])
                []
        expression (testsuite/tests/typing-gadts/pr6158.ml[10,104+4]..[10,104+55])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/pr6158.ml[10,104+36]..[10,104+55])
            Pexp_function
            [
              <case>
                pattern (testsuite/tests/typing-gadts/pr6158.ml[10,104+45]..[10,104+49])
                  Ppat_construct "Refl" (testsuite/tests/typing-gadts/pr6158.ml[10,104+45]..[10,104+49])
                  None
                expression (testsuite/tests/typing-gadts/pr6158.ml[10,104+53]..[10,104+55])
                  Pexp_construct "()" (testsuite/tests/typing-gadts/pr6158.ml[10,104+53]..[10,104+55])
                  None
            ]
          core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+8]..[10,104+33])
            Ptyp_arrow
            Nolabel
            core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+8]..[10,104+25])
              Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr6158.ml[10,104+23]..[10,104+25])
              [
                core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+9]..[10,104+14])
                  Ptyp_constr "s" (testsuite/tests/typing-gadts/pr6158.ml[10,104+13]..[10,104+14])
                  [
                    core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+9]..[10,104+12])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/pr6158.ml[10,104+9]..[10,104+12])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+16]..[10,104+21])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/pr6158.ml[10,104+20]..[10,104+21])
                  [
                    core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+16]..[10,104+19])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/pr6158.ml[10,104+16]..[10,104+19])
                      []
                  ]
              ]
            core_type (testsuite/tests/typing-gadts/pr6158.ml[10,104+29]..[10,104+33])
              Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr6158.ml[10,104+29]..[10,104+33])
              []
    ]
  structure_item (testsuite/tests/typing-gadts/pr6158.ml[12,163+0]..[13,228+68])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/pr6158.ml[12,163+7]..[12,163+8])
      module_expr (testsuite/tests/typing-gadts/pr6158.ml[12,163+9]..[13,228+68])
        Pmod_functor "S" (testsuite/tests/typing-gadts/pr6158.ml[12,163+10]..[12,163+11])
        module_type (testsuite/tests/typing-gadts/pr6158.ml[12,163+14]..[12,163+61])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/pr6158.ml[12,163+18]..[12,163+37])
              Psig_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/pr6158.ml[12,163+26]..[12,163+27]) (testsuite/tests/typing-gadts/pr6158.ml[12,163+18]..[12,163+37])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[12,163+23]..[12,163+25])
                        Ptyp_var a
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (testsuite/tests/typing-gadts/pr6158.ml[12,163+30]..[12,163+37])
                          "T" (testsuite/tests/typing-gadts/pr6158.ml[12,163+30]..[12,163+31])
                          [
                            core_type (testsuite/tests/typing-gadts/pr6158.ml[12,163+35]..[12,163+37])
                              Ptyp_var a
                          ]
                          None
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            signature_item (testsuite/tests/typing-gadts/pr6158.ml[12,163+38]..[12,163+57])
              Psig_type Rec
              [
                type_declaration "s" (testsuite/tests/typing-gadts/pr6158.ml[12,163+46]..[12,163+47]) (testsuite/tests/typing-gadts/pr6158.ml[12,163+38]..[12,163+57])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[12,163+43]..[12,163+45])
                        Ptyp_var a
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (testsuite/tests/typing-gadts/pr6158.ml[12,163+50]..[12,163+57])
                          "T" (testsuite/tests/typing-gadts/pr6158.ml[12,163+50]..[12,163+51])
                          [
                            core_type (testsuite/tests/typing-gadts/pr6158.ml[12,163+55]..[12,163+57])
                              Ptyp_var a
                          ]
                          None
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
          ]
        module_expr (testsuite/tests/typing-gadts/pr6158.ml[13,228+0]..[13,228+68])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/pr6158.ml[13,228+7]..[13,228+64])
              Pstr_value Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/pr6158.ml[13,228+11]..[13,228+42]) ghost
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/pr6158.ml[13,228+11]..[13,228+12])
                      Ppat_var "f" (testsuite/tests/typing-gadts/pr6158.ml[13,228+11]..[13,228+12])
                    core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+15]..[13,228+42]) ghost
                      Ptyp_poly
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+15]..[13,228+42])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+15]..[13,228+34])
                          Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr6158.ml[13,228+32]..[13,228+34])
                          [
                            core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+16]..[13,228+22])
                              Ptyp_constr "S.s" (testsuite/tests/typing-gadts/pr6158.ml[13,228+19]..[13,228+22])
                              [
                                core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+16]..[13,228+18])
                                  Ptyp_var a
                              ]
                            core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+24]..[13,228+30])
                              Ptyp_constr "S.t" (testsuite/tests/typing-gadts/pr6158.ml[13,228+27]..[13,228+30])
                              [
                                core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+24]..[13,228+26])
                                  Ptyp_var a
                              ]
                          ]
                        core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+38]..[13,228+42])
                          Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr6158.ml[13,228+38]..[13,228+42])
                          []
                  expression (testsuite/tests/typing-gadts/pr6158.ml[13,228+11]..[13,228+64])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/pr6158.ml[13,228+45]..[13,228+64])
                      Pexp_function
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/pr6158.ml[13,228+54]..[13,228+58])
                            Ppat_construct "Refl" (testsuite/tests/typing-gadts/pr6158.ml[13,228+54]..[13,228+58])
                            None
                          expression (testsuite/tests/typing-gadts/pr6158.ml[13,228+62]..[13,228+64])
                            Pexp_construct "()" (testsuite/tests/typing-gadts/pr6158.ml[13,228+62]..[13,228+64])
                            None
                      ]
                    core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+15]..[13,228+42])
                      Ptyp_arrow
                      Nolabel
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+15]..[13,228+34])
                        Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr6158.ml[13,228+32]..[13,228+34])
                        [
                          core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+16]..[13,228+22])
                            Ptyp_constr "S.s" (testsuite/tests/typing-gadts/pr6158.ml[13,228+19]..[13,228+22])
                            [
                              core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+16]..[13,228+18])
                                Ptyp_var a
                            ]
                          core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+24]..[13,228+30])
                            Ptyp_constr "S.t" (testsuite/tests/typing-gadts/pr6158.ml[13,228+27]..[13,228+30])
                            [
                              core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+24]..[13,228+26])
                                Ptyp_var a
                            ]
                        ]
                      core_type (testsuite/tests/typing-gadts/pr6158.ml[13,228+38]..[13,228+42])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/pr6158.ml[13,228+38]..[13,228+42])
                        []
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/pr6158.ml[14,299+0]..[25,732+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr6158.ml[14,299+9]..[25,732+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr6158.ml[14,299+9]..[25,732+2])
          Pexp_constant PConst_string ("\ntype 'a t = T of 'a\ntype 'a s = S of 'a\ntype (_, _) eq = Refl : ('a, 'a) eq\nLine 6, characters 45-49:\n6 | let f : (int s, int t) eq -> unit = function Refl -> ();;\n                                                 ^^^^\nError: This pattern matches values of type (int s, int s) eq\n       but a pattern was expected which matches values of type\n         (int s, int t) eq\n       Type int s is not compatible with type int t\n",(testsuite/tests/typing-gadts/pr6158.ml[14,299+11]..[25,732+0]),Some "")
    ]
]

