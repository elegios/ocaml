[
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[11,161+0]..[15,242+41])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[11,161+8]..[11,161+10]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[11,161+0]..[15,242+41])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[11,161+5]..[11,161+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[12,174+2]..[12,174+15])
                "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[12,174+4]..[12,174+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[12,174+9]..[12,174+15])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[12,174+13]..[12,174+15])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[12,174+9]..[12,174+12])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[12,174+9]..[12,174+12])
                        []
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[13,190+2]..[13,190+21])
                "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[13,190+4]..[13,190+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[13,190+12]..[13,190+21])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[13,190+19]..[13,190+21])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[13,190+12]..[13,190+18])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[13,190+12]..[13,190+18])
                        []
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+2]..[14,212+29])
                "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+4]..[14,212+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+10]..[14,212+15])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+13]..[14,212+15])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+10]..[14,212+12])
                        Ptyp_var a
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+19]..[14,212+29])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+27]..[14,212+29])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+19]..[14,212+26])
                        Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+22]..[14,212+26])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[14,212+19]..[14,212+21])
                            Ptyp_var a
                        ]
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+2]..[15,242+41])
                "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+4]..[15,242+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+11]..[15,242+24])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+11]..[15,242+16])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+14]..[15,242+16])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+11]..[15,242+13])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+19]..[15,242+24])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+22]..[15,242+24])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+19]..[15,242+21])
                            Ptyp_var b
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+29]..[15,242+41])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+39]..[15,242+41])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+30]..[15,242+37])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+30]..[15,242+32])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[15,242+35]..[15,242+37])
                            Ptyp_var b
                        ]
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[20,308+0]..[24,387+30])
    Pstr_type Rec
    [
      type_declaration "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[20,308+5]..[20,308+12]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[20,308+0]..[24,387+30])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[21,323+2]..[21,323+15])
                "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[21,323+4]..[21,323+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[21,323+12]..[21,323+15])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[21,323+12]..[21,323+15])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[22,339+2]..[22,339+21])
                "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[22,339+4]..[22,339+11])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[22,339+15]..[22,339+21])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[22,339+15]..[22,339+21])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[23,361+2]..[23,361+25])
                "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[23,361+4]..[23,361+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[23,361+13]..[23,361+25])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[23,361+21]..[23,361+25])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[23,361+13]..[23,361+20])
                        Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[23,361+13]..[23,361+20])
                        []
                    ]
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[24,387+2]..[24,387+30])
                "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[24,387+4]..[24,387+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[24,387+13]..[24,387+20])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[24,387+13]..[24,387+20])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[24,387+23]..[24,387+30])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[24,387+23]..[24,387+30])
                    []
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+0]..[37,758+62])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+8]..[27,422+48]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+8]..[27,422+18])
            Ppat_var "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+8]..[27,422+18])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+8]..[37,758+62]) ghost
            Ptyp_poly 't
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+28]..[27,422+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+28]..[27,422+32])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+30]..[27,422+32])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+28]..[27,422+29])
                    Ptyp_var t
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+36]..[27,422+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+36]..[27,422+37])
                  Ptyp_var t
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+41]..[27,422+48])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+41]..[27,422+48])
                  []
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+8]..[37,758+62])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+8]..[37,758+62])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[28,473+2]..[37,758+62])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[28,473+6]..[28,473+8])
                Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[28,473+6]..[28,473+8])
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[28,473+9]..[37,758+62]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[28,473+9]..[28,473+10])
                  Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[28,473+9]..[28,473+10])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[30,521+4]..[37,758+62])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[30,521+10]..[30,521+12])
                    Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[30,521+10]..[30,521+12])
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[31,539+6]..[31,539+9])
                        Ppat_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[31,539+6]..[31,539+9])
                        None
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[31,539+13]..[31,539+19])
                        Pexp_construct "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[31,539+13]..[31,539+17])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[31,539+18]..[31,539+19])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[31,539+18]..[31,539+19])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[32,590+6]..[32,590+12])
                        Ppat_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[32,590+6]..[32,590+12])
                        None
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[32,590+16]..[32,590+25])
                        Pexp_construct "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[32,590+16]..[32,590+23])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[32,590+24]..[32,590+25])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[32,590+24]..[32,590+25])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[33,633+6]..[33,633+14])
                        Ppat_construct "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[33,633+6]..[33,633+10])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[33,633+11]..[33,633+14])
                            Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[33,633+11]..[33,633+14])
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+8]..[34,651+43])
                        Pexp_construct "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+8]..[34,651+13])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+14]..[34,651+43])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+15]..[34,651+23])
                              Pexp_ident "List.map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+15]..[34,651+23])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+24]..[34,651+40])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+25]..[34,651+35])
                                    Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+25]..[34,651+35])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+36]..[34,651+39])
                                        Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+36]..[34,651+39])
                                  ]
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+41]..[34,651+42])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[34,651+41]..[34,651+42])
                            ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[36,733+6]..[36,733+21])
                        Ppat_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[36,733+6]..[36,733+10])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[36,733+11]..[36,733+21])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[36,733+12]..[36,733+15])
                                Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[36,733+12]..[36,733+15])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[36,733+17]..[36,733+20])
                                Ppat_var "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[36,733+17]..[36,733+20])
                            ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+8]..[37,758+62])
                        Pexp_construct "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+8]..[37,758+13])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+14]..[37,758+62])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+15]..[37,758+37])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+15]..[37,758+25])
                                  Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+15]..[37,758+25])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+26]..[37,758+29])
                                      Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+26]..[37,758+29])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+30]..[37,758+37])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+31]..[37,758+34])
                                        Pexp_ident "fst" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+31]..[37,758+34])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+35]..[37,758+36])
                                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+35]..[37,758+36])
                                      ]
                                ]
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+39]..[37,758+61])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+39]..[37,758+49])
                                  Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+39]..[37,758+49])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+50]..[37,758+53])
                                      Pexp_ident "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+50]..[37,758+53])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+54]..[37,758+61])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+55]..[37,758+58])
                                        Pexp_ident "snd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+55]..[37,758+58])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+59]..[37,758+60])
                                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[37,758+59]..[37,758+60])
                                      ]
                                ]
                            ]
                  ]
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+28]..[27,422+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+28]..[27,422+32])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+30]..[27,422+32])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+28]..[27,422+29])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+28]..[27,422+29])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+36]..[27,422+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+36]..[27,422+37])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+36]..[27,422+37])
                  []
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+41]..[27,422+48])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[27,422+41]..[27,422+48])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[40,870+0]..[52,1167+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[40,870+9]..[52,1167+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[40,870+9]..[52,1167+2])
          Pexp_constant PConst_string ("\ntype 'a ty =\n    Int : int ty\n  | String : string ty\n  | List : 'a ty -> 'a list ty\n  | Pair : ('a ty * 'b ty) -> ('a * 'b) ty\ntype variant =\n    VInt of int\n  | VString of string\n  | VList of variant list\n  | VPair of variant * variant\nval variantize : 't ty -> 't -> variant = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[40,870+11]..[52,1167+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[54,1174+0]..[54,1174+25])
    Pstr_exception
    type_exception
      ptyext_constructor =
        extension_constructor (testsuite/tests/typing-gadts/dynamic_frisch.ml[54,1174+0]..[54,1174+25])
          pext_name = "VariantMismatch"
          pext_kind =
            Pext_decl
              []
              None
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+0]..[66,1503+32])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+8]..[57,1204+50]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+8]..[57,1204+20])
            Ppat_var "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+8]..[57,1204+20])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+8]..[66,1503+32]) ghost
            Ptyp_poly 't
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+30]..[57,1204+50])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+30]..[57,1204+34])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+32]..[57,1204+34])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+30]..[57,1204+31])
                    Ptyp_var t
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+38]..[57,1204+50])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+38]..[57,1204+45])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+38]..[57,1204+45])
                  []
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+49]..[57,1204+50])
                  Ptyp_var t
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+8]..[66,1503+32])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+8]..[66,1503+32])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[58,1257+2]..[66,1503+32])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[58,1257+6]..[58,1257+8])
                Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[58,1257+6]..[58,1257+8])
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[58,1257+9]..[66,1503+32]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[58,1257+9]..[58,1257+10])
                  Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[58,1257+9]..[58,1257+10])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[59,1271+4]..[66,1503+32])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[59,1271+10]..[59,1271+15])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[59,1271+10]..[59,1271+12])
                        Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[59,1271+10]..[59,1271+12])
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[59,1271+14]..[59,1271+15])
                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[59,1271+14]..[59,1271+15])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+6]..[60,1292+17])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+6]..[60,1292+9])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+6]..[60,1292+9])
                            None
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+11]..[60,1292+17])
                            Ppat_construct "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+11]..[60,1292+15])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+16]..[60,1292+17])
                                Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+16]..[60,1292+17])
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+21]..[60,1292+22])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[60,1292+21]..[60,1292+22])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+6]..[61,1315+23])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+6]..[61,1315+12])
                            Ppat_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+6]..[61,1315+12])
                            None
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+14]..[61,1315+23])
                            Ppat_construct "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+14]..[61,1315+21])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+22]..[61,1315+23])
                                Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+22]..[61,1315+23])
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+27]..[61,1315+28])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[61,1315+27]..[61,1315+28])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+6]..[62,1344+24])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+6]..[62,1344+14])
                            Ppat_construct "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+6]..[62,1344+10])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+11]..[62,1344+14])
                                Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+11]..[62,1344+14])
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+16]..[62,1344+24])
                            Ppat_construct "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+16]..[62,1344+21])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+22]..[62,1344+24])
                                Ppat_var "vl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[62,1344+22]..[62,1344+24])
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+8]..[63,1372+38])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+8]..[63,1372+16])
                          Pexp_ident "List.map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+8]..[63,1372+16])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+17]..[63,1372+35])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+18]..[63,1372+30])
                                Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+18]..[63,1372+30])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+31]..[63,1372+34])
                                    Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+31]..[63,1372+34])
                              ]
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+36]..[63,1372+38])
                              Pexp_ident "vl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[63,1372+36]..[63,1372+38])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+6]..[64,1411+37])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+6]..[64,1411+21])
                            Ppat_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+6]..[64,1411+10])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+11]..[64,1411+21])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+12]..[64,1411+15])
                                    Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+12]..[64,1411+15])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+17]..[64,1411+20])
                                    Ppat_var "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+17]..[64,1411+20])
                                ]
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+23]..[64,1411+37])
                            Ppat_construct "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+23]..[64,1411+28])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+29]..[64,1411+37])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+30]..[64,1411+32])
                                    Ppat_var "x1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+30]..[64,1411+32])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+34]..[64,1411+36])
                                    Ppat_var "x2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[64,1411+34]..[64,1411+36])
                                ]
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+8]..[65,1452+50])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+9]..[65,1452+28])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+9]..[65,1452+21])
                              Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+9]..[65,1452+21])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+22]..[65,1452+25])
                                  Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+22]..[65,1452+25])
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+26]..[65,1452+28])
                                  Pexp_ident "x1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+26]..[65,1452+28])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+30]..[65,1452+49])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+30]..[65,1452+42])
                              Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+30]..[65,1452+42])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+43]..[65,1452+46])
                                  Pexp_ident "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+43]..[65,1452+46])
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+47]..[65,1452+49])
                                  Pexp_ident "x2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[65,1452+47]..[65,1452+49])
                            ]
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[66,1503+6]..[66,1503+7])
                        Ppat_any
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[66,1503+11]..[66,1503+32])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[66,1503+11]..[66,1503+16])
                          Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[66,1503+11]..[66,1503+16])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[66,1503+17]..[66,1503+32])
                              Pexp_construct "VariantMismatch" (testsuite/tests/typing-gadts/dynamic_frisch.ml[66,1503+17]..[66,1503+32])
                              None
                        ]
                  ]
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+30]..[57,1204+50])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+30]..[57,1204+34])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+32]..[57,1204+34])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+30]..[57,1204+31])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+30]..[57,1204+31])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+38]..[57,1204+50])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+38]..[57,1204+45])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+38]..[57,1204+45])
                  []
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+49]..[57,1204+50])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[57,1204+49]..[57,1204+50])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[68,1539+0]..[71,1627+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[68,1539+9]..[71,1627+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[68,1539+9]..[71,1627+2])
          Pexp_constant PConst_string ("\nexception VariantMismatch\nval devariantize : 't ty -> variant -> 't = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[68,1539+11]..[71,1627+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[75,1658+0]..[96,2039+5])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[75,1658+8]..[75,1658+10]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[75,1658+0]..[80,1781+30])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[75,1658+5]..[75,1658+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[76,1671+2]..[76,1671+15])
                "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[76,1671+4]..[76,1671+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[76,1671+9]..[76,1671+15])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[76,1671+13]..[76,1671+15])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[76,1671+9]..[76,1671+12])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[76,1671+9]..[76,1671+12])
                        []
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[77,1687+2]..[77,1687+21])
                "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[77,1687+4]..[77,1687+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[77,1687+12]..[77,1687+21])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[77,1687+19]..[77,1687+21])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[77,1687+12]..[77,1687+18])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[77,1687+12]..[77,1687+18])
                        []
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+2]..[78,1709+29])
                "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+4]..[78,1709+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+10]..[78,1709+15])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+13]..[78,1709+15])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+10]..[78,1709+12])
                        Ptyp_var a
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+19]..[78,1709+29])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+27]..[78,1709+29])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+19]..[78,1709+26])
                        Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+22]..[78,1709+26])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[78,1709+19]..[78,1709+21])
                            Ptyp_var a
                        ]
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+2]..[79,1739+41])
                "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+4]..[79,1739+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+11]..[79,1739+24])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+11]..[79,1739+16])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+14]..[79,1739+16])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+11]..[79,1739+13])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+19]..[79,1739+24])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+22]..[79,1739+24])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+19]..[79,1739+21])
                            Ptyp_var b
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+29]..[79,1739+41])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+39]..[79,1739+41])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+30]..[79,1739+37])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+30]..[79,1739+32])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[79,1739+35]..[79,1739+37])
                            Ptyp_var b
                        ]
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+2]..[80,1781+30])
                "Record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+4]..[80,1781+10])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+12]..[80,1781+21])
                    Ptyp_constr "record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+15]..[80,1781+21])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+12]..[80,1781+14])
                        Ptyp_var a
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+25]..[80,1781+30])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+28]..[80,1781+30])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[80,1781+25]..[80,1781+27])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[82,1813+7]..[82,1813+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[82,1813+0]..[86,1883+5])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[82,1813+4]..[82,1813+6])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[84,1835+5]..[84,1835+18])
                Immutable
                "path" (testsuite/tests/typing-gadts/dynamic_frisch.ml[84,1835+5]..[84,1835+9])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[84,1835+11]..[84,1835+17])
                  Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[84,1835+11]..[84,1835+17])
                  []
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[85,1854+5]..[85,1854+28])
                Immutable
                "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[85,1854+5]..[85,1854+11])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[85,1854+13]..[85,1854+27])
                  Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[85,1854+23]..[85,1854+27])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[85,1854+13]..[85,1854+22])
                      Ptyp_constr "field_" (testsuite/tests/typing-gadts/dynamic_frisch.ml[85,1854+16]..[85,1854+22])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[85,1854+13]..[85,1854+15])
                          Ptyp_var a
                      ]
                  ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "field_" (testsuite/tests/typing-gadts/dynamic_frisch.ml[88,1890+7]..[88,1890+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[88,1890+0]..[89,1906+38])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[88,1890+4]..[88,1890+6])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+2]..[89,1906+38])
                "Field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+4]..[89,1906+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+11]..[89,1906+25])
                    Ptyp_constr "field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+20]..[89,1906+25])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+12]..[89,1906+14])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+16]..[89,1906+18])
                        Ptyp_var b
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+29]..[89,1906+38])
                    Ptyp_constr "field_" (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+32]..[89,1906+38])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[89,1906+29]..[89,1906+31])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[91,1946+13]..[91,1946+18]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[91,1946+0]..[96,2039+5])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[91,1946+5]..[91,1946+7])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[91,1946+9]..[91,1946+11])
              Ptyp_var b
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[93,1973+5]..[93,1973+19])
                Immutable
                "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[93,1973+5]..[93,1973+10])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[93,1973+12]..[93,1973+18])
                  Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[93,1973+12]..[93,1973+18])
                  []
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[94,1993+5]..[94,1993+23])
                Immutable
                "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[94,1993+5]..[94,1993+15])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[94,1993+17]..[94,1993+22])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[94,1993+20]..[94,1993+22])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[94,1993+17]..[94,1993+19])
                      Ptyp_var b
                  ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[95,2017+5]..[95,2017+21])
                Immutable
                "get" (testsuite/tests/typing-gadts/dynamic_frisch.ml[95,2017+5]..[95,2017+8])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[95,2017+11]..[95,2017+19])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[95,2017+11]..[95,2017+13])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[95,2017+17]..[95,2017+19])
                    Ptyp_var b
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[101,2062+0]..[106,2172+38])
    Pstr_type Rec
    [
      type_declaration "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[101,2062+5]..[101,2062+12]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[101,2062+0]..[106,2172+38])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[102,2077+2]..[102,2077+15])
                "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[102,2077+4]..[102,2077+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[102,2077+12]..[102,2077+15])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[102,2077+12]..[102,2077+15])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[103,2093+2]..[103,2093+21])
                "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[103,2093+4]..[103,2093+11])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[103,2093+15]..[103,2093+21])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[103,2093+15]..[103,2093+21])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[104,2115+2]..[104,2115+25])
                "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[104,2115+4]..[104,2115+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[104,2115+13]..[104,2115+25])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[104,2115+21]..[104,2115+25])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[104,2115+13]..[104,2115+20])
                        Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[104,2115+13]..[104,2115+20])
                        []
                    ]
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[105,2141+2]..[105,2141+30])
                "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[105,2141+4]..[105,2141+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[105,2141+13]..[105,2141+20])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[105,2141+13]..[105,2141+20])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[105,2141+23]..[105,2141+30])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[105,2141+23]..[105,2141+30])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+2]..[106,2172+38])
                "VRecord" (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+4]..[106,2172+11])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+15]..[106,2172+38])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+34]..[106,2172+38])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+16]..[106,2172+32])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+16]..[106,2172+22])
                            Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+16]..[106,2172+22])
                            []
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+25]..[106,2172+32])
                            Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[106,2172+25]..[106,2172+32])
                            []
                        ]
                    ]
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+0]..[124,2761+70])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+8]..[109,2215+48]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+8]..[109,2215+18])
            Ppat_var "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+8]..[109,2215+18])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+8]..[124,2761+70]) ghost
            Ptyp_poly 't
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+28]..[109,2215+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+28]..[109,2215+32])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+30]..[109,2215+32])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+28]..[109,2215+29])
                    Ptyp_var t
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+36]..[109,2215+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+36]..[109,2215+37])
                  Ptyp_var t
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+41]..[109,2215+48])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+41]..[109,2215+48])
                  []
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+8]..[124,2761+70])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+8]..[124,2761+70])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[110,2266+2]..[124,2761+70])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[110,2266+6]..[110,2266+8])
                Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[110,2266+6]..[110,2266+8])
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[110,2266+9]..[124,2761+70]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[110,2266+9]..[110,2266+10])
                  Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[110,2266+9]..[110,2266+10])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[112,2314+4]..[124,2761+70])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[112,2314+10]..[112,2314+12])
                    Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[112,2314+10]..[112,2314+12])
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[113,2332+6]..[113,2332+9])
                        Ppat_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[113,2332+6]..[113,2332+9])
                        None
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[113,2332+13]..[113,2332+19])
                        Pexp_construct "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[113,2332+13]..[113,2332+17])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[113,2332+18]..[113,2332+19])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[113,2332+18]..[113,2332+19])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[114,2383+6]..[114,2383+12])
                        Ppat_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[114,2383+6]..[114,2383+12])
                        None
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[114,2383+16]..[114,2383+25])
                        Pexp_construct "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[114,2383+16]..[114,2383+23])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[114,2383+24]..[114,2383+25])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[114,2383+24]..[114,2383+25])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[115,2426+6]..[115,2426+14])
                        Ppat_construct "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[115,2426+6]..[115,2426+10])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[115,2426+11]..[115,2426+14])
                            Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[115,2426+11]..[115,2426+14])
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+8]..[116,2444+43])
                        Pexp_construct "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+8]..[116,2444+13])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+14]..[116,2444+43])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+15]..[116,2444+23])
                              Pexp_ident "List.map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+15]..[116,2444+23])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+24]..[116,2444+40])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+25]..[116,2444+35])
                                    Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+25]..[116,2444+35])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+36]..[116,2444+39])
                                        Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+36]..[116,2444+39])
                                  ]
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+41]..[116,2444+42])
                                  Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[116,2444+41]..[116,2444+42])
                            ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[118,2526+6]..[118,2526+21])
                        Ppat_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[118,2526+6]..[118,2526+10])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[118,2526+11]..[118,2526+21])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[118,2526+12]..[118,2526+15])
                                Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[118,2526+12]..[118,2526+15])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[118,2526+17]..[118,2526+20])
                                Ppat_var "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[118,2526+17]..[118,2526+20])
                            ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+8]..[119,2551+62])
                        Pexp_construct "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+8]..[119,2551+13])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+14]..[119,2551+62])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+15]..[119,2551+37])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+15]..[119,2551+25])
                                  Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+15]..[119,2551+25])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+26]..[119,2551+29])
                                      Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+26]..[119,2551+29])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+30]..[119,2551+37])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+31]..[119,2551+34])
                                        Pexp_ident "fst" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+31]..[119,2551+34])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+35]..[119,2551+36])
                                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+35]..[119,2551+36])
                                      ]
                                ]
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+39]..[119,2551+61])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+39]..[119,2551+49])
                                  Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+39]..[119,2551+49])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+50]..[119,2551+53])
                                      Pexp_ident "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+50]..[119,2551+53])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+54]..[119,2551+61])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+55]..[119,2551+58])
                                        Pexp_ident "snd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+55]..[119,2551+58])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+59]..[119,2551+60])
                                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[119,2551+59]..[119,2551+60])
                                      ]
                                ]
                            ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[121,2660+6]..[121,2660+21])
                        Ppat_construct "Record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[121,2660+6]..[121,2660+12])
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[121,2660+13]..[121,2660+21])
                            Ppat_record Closed
                            [
                              "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[121,2660+14]..[121,2660+20]) ghost
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[121,2660+14]..[121,2660+20])
                                  Ppat_var "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[121,2660+14]..[121,2660+20])
                            ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[122,2685+8]..[124,2761+70])
                        Pexp_construct "VRecord" (testsuite/tests/typing-gadts/dynamic_frisch.ml[122,2685+8]..[122,2685+15])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+10]..[124,2761+70])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+11]..[123,2701+19])
                              Pexp_ident "List.map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+11]..[123,2701+19])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+20]..[124,2761+62])
                                  Pexp_fun
                                  Nolabel
                                  None
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+25]..[123,2701+56])
                                    Ppat_construct "Field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+26]..[123,2701+31])
                                    Some
                                      []
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+31]..[123,2701+55])
                                        Ppat_record Closed
                                        [
                                          "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+32]..[123,2701+42]) ghost
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+32]..[123,2701+42])
                                              Ppat_var "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+32]..[123,2701+42])
                                          "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+44]..[123,2701+49]) ghost
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+44]..[123,2701+49])
                                              Ppat_var "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+44]..[123,2701+49])
                                          "get" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+51]..[123,2701+54]) ghost
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+51]..[123,2701+54])
                                              Ppat_var "get" (testsuite/tests/typing-gadts/dynamic_frisch.ml[123,2701+51]..[123,2701+54])
                                        ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+23]..[124,2761+61])
                                    Pexp_tuple
                                    [
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+24]..[124,2761+29])
                                        Pexp_ident "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+24]..[124,2761+29])
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+31]..[124,2761+60])
                                        Pexp_apply
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+31]..[124,2761+41])
                                          Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+31]..[124,2761+41])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+42]..[124,2761+52])
                                              Pexp_ident "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+42]..[124,2761+52])
                                          <arg>
                                          Nolabel
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+53]..[124,2761+60])
                                              Pexp_apply
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+54]..[124,2761+57])
                                                Pexp_ident "get" (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+54]..[124,2761+57])
                                              [
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+58]..[124,2761+59])
                                                    Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+58]..[124,2761+59])
                                              ]
                                        ]
                                    ]
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+63]..[124,2761+69])
                                  Pexp_ident "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[124,2761+63]..[124,2761+69])
                            ]
                  ]
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+28]..[109,2215+48])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+28]..[109,2215+32])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+30]..[109,2215+32])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+28]..[109,2215+29])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+28]..[109,2215+29])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+36]..[109,2215+48])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+36]..[109,2215+37])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+36]..[109,2215+37])
                  []
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+41]..[109,2215+48])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[109,2215+41]..[109,2215+48])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[126,2835+0]..[143,3392+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[126,2835+9]..[143,3392+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[126,2835+9]..[143,3392+2])
          Pexp_constant PConst_string ("\ntype 'a ty =\n    Int : int ty\n  | String : string ty\n  | List : 'a ty -> 'a list ty\n  | Pair : ('a ty * 'b ty) -> ('a * 'b) ty\n  | Record : 'a record -> 'a ty\nand 'a record = { path : string; fields : 'a field_ list; }\nand 'a field_ = Field : ('a, 'b) field -> 'a field_\nand ('a, 'b) field = { label : string; field_type : 'b ty; get : 'a -> 'b; }\ntype variant =\n    VInt of int\n  | VString of string\n  | VList of variant list\n  | VPair of variant * variant\n  | VRecord of (string * variant) list\nval variantize : 't ty -> 't -> variant = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[126,2835+11]..[143,3392+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[147,3417+0]..[171,3979+3])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[147,3417+8]..[147,3417+10]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[147,3417+0]..[152,3540+42])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[147,3417+5]..[147,3417+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[148,3430+2]..[148,3430+15])
                "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[148,3430+4]..[148,3430+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[148,3430+9]..[148,3430+15])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[148,3430+13]..[148,3430+15])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[148,3430+9]..[148,3430+12])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[148,3430+9]..[148,3430+12])
                        []
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[149,3446+2]..[149,3446+21])
                "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[149,3446+4]..[149,3446+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[149,3446+12]..[149,3446+21])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[149,3446+19]..[149,3446+21])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[149,3446+12]..[149,3446+18])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[149,3446+12]..[149,3446+18])
                        []
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+2]..[150,3468+29])
                "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+4]..[150,3468+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+10]..[150,3468+15])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+13]..[150,3468+15])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+10]..[150,3468+12])
                        Ptyp_var a
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+19]..[150,3468+29])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+27]..[150,3468+29])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+19]..[150,3468+26])
                        Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+22]..[150,3468+26])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[150,3468+19]..[150,3468+21])
                            Ptyp_var a
                        ]
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+2]..[151,3498+41])
                "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+4]..[151,3498+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+11]..[151,3498+24])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+11]..[151,3498+16])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+14]..[151,3498+16])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+11]..[151,3498+13])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+19]..[151,3498+24])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+22]..[151,3498+24])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+19]..[151,3498+21])
                            Ptyp_var b
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+29]..[151,3498+41])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+39]..[151,3498+41])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+30]..[151,3498+37])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+30]..[151,3498+32])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[151,3498+35]..[151,3498+37])
                            Ptyp_var b
                        ]
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+2]..[152,3540+42])
                "Record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+4]..[152,3540+10])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+12]..[152,3540+33])
                    Ptyp_constr "record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+27]..[152,3540+33])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+13]..[152,3540+15])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+17]..[152,3540+25])
                        Ptyp_var builder
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+37]..[152,3540+42])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+40]..[152,3540+42])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[152,3540+37]..[152,3540+39])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[154,3584+19]..[154,3584+25]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[154,3584+0]..[160,3753+5])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[154,3584+5]..[154,3584+7])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[154,3584+9]..[154,3584+17])
              Ptyp_var builder
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[156,3618+5]..[156,3618+18])
                Immutable
                "path" (testsuite/tests/typing-gadts/dynamic_frisch.ml[156,3618+5]..[156,3618+9])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[156,3618+11]..[156,3618+17])
                  Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[156,3618+11]..[156,3618+17])
                  []
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+5]..[157,3637+39])
                Immutable
                "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+5]..[157,3637+11])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+13]..[157,3637+38])
                  Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+34]..[157,3637+38])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+13]..[157,3637+33])
                      Ptyp_constr "field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+28]..[157,3637+33])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+14]..[157,3637+16])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[157,3637+18]..[157,3637+26])
                          Ptyp_var builder
                      ]
                  ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[158,3677+5]..[158,3677+40])
                Immutable
                "create_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[158,3677+5]..[158,3677+19])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[158,3677+22]..[158,3677+38])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[158,3677+22]..[158,3677+26])
                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[158,3677+22]..[158,3677+26])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[158,3677+30]..[158,3677+38])
                    Ptyp_var builder
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[159,3718+5]..[159,3718+34])
                Immutable
                "of_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[159,3718+5]..[159,3718+15])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[159,3718+18]..[159,3718+32])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[159,3718+18]..[159,3718+26])
                    Ptyp_var builder
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[159,3718+30]..[159,3718+32])
                    Ptyp_var a
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[162,3760+19]..[162,3760+24]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[162,3760+0]..[163,3787+60])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[162,3760+5]..[162,3760+7])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[162,3760+9]..[162,3760+17])
              Ptyp_var builder
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+2]..[163,3787+60])
                "Field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+4]..[163,3787+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+11]..[163,3787+36])
                    Ptyp_constr "field_" (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+30]..[163,3787+36])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+12]..[163,3787+14])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+16]..[163,3787+24])
                        Ptyp_var builder
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+26]..[163,3787+28])
                        Ptyp_var b
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+40]..[163,3787+60])
                    Ptyp_constr "field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+55]..[163,3787+60])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+41]..[163,3787+43])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[163,3787+45]..[163,3787+53])
                        Ptyp_var builder
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "field_" (testsuite/tests/typing-gadts/dynamic_frisch.ml[165,3849+23]..[165,3849+29]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[165,3849+0]..[171,3979+3])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[165,3849+5]..[165,3849+7])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[165,3849+9]..[165,3849+17])
              Ptyp_var builder
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[165,3849+19]..[165,3849+21])
              Ptyp_var b
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[167,3885+3]..[167,3885+17])
                Immutable
                "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[167,3885+3]..[167,3885+8])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[167,3885+10]..[167,3885+16])
                  Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[167,3885+10]..[167,3885+16])
                  []
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[168,3903+3]..[168,3903+21])
                Immutable
                "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[168,3903+3]..[168,3903+13])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[168,3903+15]..[168,3903+20])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[168,3903+18]..[168,3903+20])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[168,3903+15]..[168,3903+17])
                      Ptyp_var b
                  ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[169,3925+3]..[169,3925+19])
                Immutable
                "get" (testsuite/tests/typing-gadts/dynamic_frisch.ml[169,3925+3]..[169,3925+6])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[169,3925+9]..[169,3925+17])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[169,3925+9]..[169,3925+11])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[169,3925+15]..[169,3925+17])
                    Ptyp_var b
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+3]..[170,3945+33])
                Immutable
                "set" (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+3]..[170,3945+6])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+9]..[170,3945+31])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+9]..[170,3945+17])
                    Ptyp_var builder
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+21]..[170,3945+31])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+21]..[170,3945+23])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+27]..[170,3945+31])
                      Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[170,3945+27]..[170,3945+31])
                      []
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+0]..[193,4717+32])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+8]..[174,3987+50]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+8]..[174,3987+20])
            Ppat_var "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+8]..[174,3987+20])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+8]..[193,4717+32]) ghost
            Ptyp_poly 't
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+30]..[174,3987+50])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+30]..[174,3987+34])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+32]..[174,3987+34])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+30]..[174,3987+31])
                    Ptyp_var t
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+38]..[174,3987+50])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+38]..[174,3987+45])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+38]..[174,3987+45])
                  []
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+49]..[174,3987+50])
                  Ptyp_var t
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+8]..[193,4717+32])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+8]..[193,4717+32])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[175,4040+2]..[193,4717+32])
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[175,4040+6]..[175,4040+8])
                Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[175,4040+6]..[175,4040+8])
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[175,4040+9]..[193,4717+32]) ghost
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[175,4040+9]..[175,4040+10])
                  Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[175,4040+9]..[175,4040+10])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[176,4054+4]..[193,4717+32])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[176,4054+10]..[176,4054+15])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[176,4054+10]..[176,4054+12])
                        Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[176,4054+10]..[176,4054+12])
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[176,4054+14]..[176,4054+15])
                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[176,4054+14]..[176,4054+15])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+6]..[177,4075+17])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+6]..[177,4075+9])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+6]..[177,4075+9])
                            None
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+11]..[177,4075+17])
                            Ppat_construct "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+11]..[177,4075+15])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+16]..[177,4075+17])
                                Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+16]..[177,4075+17])
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+21]..[177,4075+22])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[177,4075+21]..[177,4075+22])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+6]..[178,4098+23])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+6]..[178,4098+12])
                            Ppat_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+6]..[178,4098+12])
                            None
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+14]..[178,4098+23])
                            Ppat_construct "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+14]..[178,4098+21])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+22]..[178,4098+23])
                                Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+22]..[178,4098+23])
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+27]..[178,4098+28])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[178,4098+27]..[178,4098+28])
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+6]..[179,4127+24])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+6]..[179,4127+14])
                            Ppat_construct "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+6]..[179,4127+10])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+11]..[179,4127+14])
                                Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+11]..[179,4127+14])
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+16]..[179,4127+24])
                            Ppat_construct "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+16]..[179,4127+21])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+22]..[179,4127+24])
                                Ppat_var "vl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[179,4127+22]..[179,4127+24])
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+8]..[180,4155+38])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+8]..[180,4155+16])
                          Pexp_ident "List.map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+8]..[180,4155+16])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+17]..[180,4155+35])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+18]..[180,4155+30])
                                Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+18]..[180,4155+30])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+31]..[180,4155+34])
                                    Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+31]..[180,4155+34])
                              ]
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+36]..[180,4155+38])
                              Pexp_ident "vl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[180,4155+36]..[180,4155+38])
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+6]..[181,4194+37])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+6]..[181,4194+21])
                            Ppat_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+6]..[181,4194+10])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+11]..[181,4194+21])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+12]..[181,4194+15])
                                    Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+12]..[181,4194+15])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+17]..[181,4194+20])
                                    Ppat_var "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+17]..[181,4194+20])
                                ]
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+23]..[181,4194+37])
                            Ppat_construct "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+23]..[181,4194+28])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+29]..[181,4194+37])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+30]..[181,4194+32])
                                    Ppat_var "x1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+30]..[181,4194+32])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+34]..[181,4194+36])
                                    Ppat_var "x2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[181,4194+34]..[181,4194+36])
                                ]
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+8]..[182,4235+50])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+9]..[182,4235+28])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+9]..[182,4235+21])
                              Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+9]..[182,4235+21])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+22]..[182,4235+25])
                                  Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+22]..[182,4235+25])
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+26]..[182,4235+28])
                                  Pexp_ident "x1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+26]..[182,4235+28])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+30]..[182,4235+49])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+30]..[182,4235+42])
                              Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+30]..[182,4235+42])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+43]..[182,4235+46])
                                  Pexp_ident "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+43]..[182,4235+46])
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+47]..[182,4235+49])
                                  Pexp_ident "x2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[182,4235+47]..[182,4235+49])
                            ]
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+6]..[183,4286+61])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+6]..[183,4286+49])
                            Ppat_construct "Record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+6]..[183,4286+12])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+13]..[183,4286+49])
                                Ppat_record Closed
                                [
                                  "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+14]..[183,4286+20]) ghost
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+14]..[183,4286+20])
                                      Ppat_var "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+14]..[183,4286+20])
                                  "create_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+22]..[183,4286+36]) ghost
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+22]..[183,4286+36])
                                      Ppat_var "create_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+22]..[183,4286+36])
                                  "of_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+38]..[183,4286+48]) ghost
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+38]..[183,4286+48])
                                      Ppat_var "of_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+38]..[183,4286+48])
                                ]
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+51]..[183,4286+61])
                            Ppat_construct "VRecord" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+51]..[183,4286+58])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+59]..[183,4286+61])
                                Ppat_var "fl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[183,4286+59]..[183,4286+61])
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+8]..[192,4690+26])
                        Pexp_sequence
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+8]..[184,4351+74])
                          Pexp_ifthenelse
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+11]..[184,4351+47])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+30]..[184,4351+32])
                              Pexp_ident "<>" (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+30]..[184,4351+32])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+11]..[184,4351+29])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+11]..[184,4351+22])
                                    Pexp_ident "List.length" (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+11]..[184,4351+22])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+23]..[184,4351+29])
                                        Pexp_ident "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+23]..[184,4351+29])
                                  ]
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+33]..[184,4351+47])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+33]..[184,4351+44])
                                    Pexp_ident "List.length" (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+33]..[184,4351+44])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+45]..[184,4351+47])
                                        Pexp_ident "fl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+45]..[184,4351+47])
                                  ]
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+53]..[184,4351+74])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+53]..[184,4351+58])
                              Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+53]..[184,4351+58])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+59]..[184,4351+74])
                                  Pexp_construct "VariantMismatch" (testsuite/tests/typing-gadts/dynamic_frisch.ml[184,4351+59]..[184,4351+74])
                                  None
                            ]
                          None
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+8]..[192,4690+26])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+12]..[185,4427+19])
                                Ppat_var "builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+12]..[185,4427+19])
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+22]..[185,4427+39])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+22]..[185,4427+36])
                                  Pexp_ident "create_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+22]..[185,4427+36])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+37]..[185,4427+39])
                                      Pexp_construct "()" (testsuite/tests/typing-gadts/dynamic_frisch.ml[185,4427+37]..[185,4427+39])
                                      None
                                ]
                          ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[186,4470+8]..[192,4690+26])
                            Pexp_sequence
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[186,4470+8]..[191,4669+19])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[186,4470+8]..[186,4470+18])
                                Pexp_ident "List.iter2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[186,4470+8]..[186,4470+18])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+10]..[190,4657+11])
                                    Pexp_fun
                                    Nolabel
                                    None
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+15]..[187,4489+47])
                                      Ppat_construct "Field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+16]..[187,4489+21])
                                      Some
                                        []
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+22]..[187,4489+46])
                                          Ppat_record Closed
                                          [
                                            "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+23]..[187,4489+28]) ghost
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+23]..[187,4489+28])
                                                Ppat_var "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+23]..[187,4489+28])
                                            "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+30]..[187,4489+40]) ghost
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+30]..[187,4489+40])
                                                Ppat_var "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+30]..[187,4489+40])
                                            "set" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+42]..[187,4489+45]) ghost
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+42]..[187,4489+45])
                                                Ppat_var "set" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+42]..[187,4489+45])
                                          ]
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+48]..[189,4605+51]) ghost
                                      Pexp_fun
                                      Nolabel
                                      None
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+48]..[187,4489+56])
                                        Ppat_tuple
                                        [
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+49]..[187,4489+52])
                                            Ppat_var "lab" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+49]..[187,4489+52])
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+54]..[187,4489+55])
                                            Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[187,4489+54]..[187,4489+55])
                                        ]
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+12]..[189,4605+51])
                                        Pexp_sequence
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+12]..[188,4549+54])
                                          Pexp_ifthenelse
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+15]..[188,4549+27])
                                            Pexp_apply
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+21]..[188,4549+23])
                                              Pexp_ident "<>" (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+21]..[188,4549+23])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+15]..[188,4549+20])
                                                  Pexp_ident "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+15]..[188,4549+20])
                                              <arg>
                                              Nolabel
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+24]..[188,4549+27])
                                                  Pexp_ident "lab" (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+24]..[188,4549+27])
                                            ]
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+33]..[188,4549+54])
                                            Pexp_apply
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+33]..[188,4549+38])
                                              Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+33]..[188,4549+38])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+39]..[188,4549+54])
                                                  Pexp_construct "VariantMismatch" (testsuite/tests/typing-gadts/dynamic_frisch.ml[188,4549+39]..[188,4549+54])
                                                  None
                                            ]
                                          None
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+12]..[189,4605+51])
                                          Pexp_apply
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+12]..[189,4605+15])
                                            Pexp_ident "set" (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+12]..[189,4605+15])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+16]..[189,4605+23])
                                                Pexp_ident "builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+16]..[189,4605+23])
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+24]..[189,4605+51])
                                                Pexp_apply
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+25]..[189,4605+37])
                                                  Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+25]..[189,4605+37])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+38]..[189,4605+48])
                                                      Pexp_ident "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+38]..[189,4605+48])
                                                  <arg>
                                                  Nolabel
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+49]..[189,4605+50])
                                                      Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[189,4605+49]..[189,4605+50])
                                                ]
                                          ]
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[191,4669+10]..[191,4669+16])
                                    Pexp_ident "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[191,4669+10]..[191,4669+16])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[191,4669+17]..[191,4669+19])
                                    Pexp_ident "fl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[191,4669+17]..[191,4669+19])
                              ]
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[192,4690+8]..[192,4690+26])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[192,4690+8]..[192,4690+18])
                                Pexp_ident "of_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[192,4690+8]..[192,4690+18])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[192,4690+19]..[192,4690+26])
                                    Pexp_ident "builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[192,4690+19]..[192,4690+26])
                              ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[193,4717+6]..[193,4717+7])
                        Ppat_any
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[193,4717+11]..[193,4717+32])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[193,4717+11]..[193,4717+16])
                          Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[193,4717+11]..[193,4717+16])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[193,4717+17]..[193,4717+32])
                              Pexp_construct "VariantMismatch" (testsuite/tests/typing-gadts/dynamic_frisch.ml[193,4717+17]..[193,4717+32])
                              None
                        ]
                  ]
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+30]..[174,3987+50])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+30]..[174,3987+34])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+32]..[174,3987+34])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+30]..[174,3987+31])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+30]..[174,3987+31])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+38]..[174,3987+50])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+38]..[174,3987+45])
                  Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+38]..[174,3987+45])
                  []
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+49]..[174,3987+50])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[174,3987+49]..[174,3987+50])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[195,4753+0]..[217,5356+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[195,4753+9]..[217,5356+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[195,4753+9]..[217,5356+2])
          Pexp_constant PConst_string ("\ntype 'a ty =\n    Int : int ty\n  | String : string ty\n  | List : 'a ty -> 'a list ty\n  | Pair : ('a ty * 'b ty) -> ('a * 'b) ty\n  | Record : ('a, 'builder) record -> 'a ty\nand ('a, 'builder) record = {\n  path : string;\n  fields : ('a, 'builder) field list;\n  create_builder : unit -> 'builder;\n  of_builder : 'builder -> 'a;\n}\nand ('a, 'builder) field =\n    Field : ('a, 'builder, 'b) field_ -> ('a, 'builder) field\nand ('a, 'builder, 'b) field_ = {\n  label : string;\n  field_type : 'b ty;\n  get : 'a -> 'b;\n  set : 'builder -> 'b -> unit;\n}\nval devariantize : 't ty -> variant -> 't = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[195,4753+11]..[217,5356+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[219,5363+0]..[223,5421+5])
    Pstr_type Rec
    [
      type_declaration "my_record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[219,5363+5]..[219,5363+14]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[219,5363+0]..[223,5421+5])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[221,5387+5]..[221,5387+12])
                Immutable
                "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[221,5387+5]..[221,5387+6])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[221,5387+8]..[221,5387+11])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[221,5387+8]..[221,5387+11])
                  []
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[222,5400+5]..[222,5400+20])
                Immutable
                "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[222,5400+5]..[222,5400+6])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[222,5400+8]..[222,5400+19])
                  Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[222,5400+15]..[222,5400+19])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[222,5400+8]..[222,5400+14])
                      Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[222,5400+8]..[222,5400+14])
                      []
                  ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[226,5431+0]..[243,5949+75])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[226,5431+4]..[226,5431+13])
          Ppat_var "my_record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[226,5431+4]..[226,5431+13])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[227,5447+2]..[243,5949+75])
          Pexp_let Nonrec
          [
            <def>
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[227,5447+6]..[227,5447+12])
                Ppat_var "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[227,5447+6]..[227,5447+12])
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[228,5462+4]..[235,5730+5])
                Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+5]..[235,5730+5]) ghost
                Some
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+5]..[235,5730+5]) ghost
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+5]..[231,5545+48])
                        Pexp_construct "Field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+5]..[229,5468+10])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+11]..[231,5545+48])
                            Pexp_record
                            [
                              "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+12]..[229,5468+17])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+20]..[229,5468+23])
                                  Pexp_constant PConst_string("a",(testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+21]..[229,5468+22]),None)
                              "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+25]..[229,5468+35])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+38]..[229,5468+41])
                                  Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[229,5468+38]..[229,5468+41])
                                  None
                              "get" (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+12]..[230,5511+15])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+18]..[230,5511+32])
                                  Pexp_fun
                                  Nolabel
                                  None
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+23]..[230,5511+26])
                                    Ppat_record Closed
                                    [
                                      "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+24]..[230,5511+25]) ghost
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+24]..[230,5511+25])
                                          Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+24]..[230,5511+25])
                                    ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+30]..[230,5511+31])
                                    Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[230,5511+30]..[230,5511+31])
                              "set" (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+12]..[231,5545+15])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+18]..[231,5545+47])
                                  Pexp_fun
                                  Nolabel
                                  None
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+23]..[231,5545+29])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+24]..[231,5545+25])
                                        Ppat_var "r" (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+24]..[231,5545+25])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+27]..[231,5545+28])
                                        Ppat_any
                                    ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+30]..[231,5545+46]) ghost
                                    Pexp_fun
                                    Nolabel
                                    None
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+30]..[231,5545+31])
                                      Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+30]..[231,5545+31])
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+35]..[231,5545+46])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+37]..[231,5545+39])
                                        Pexp_ident ":=" (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+37]..[231,5545+39])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+35]..[231,5545+36])
                                            Pexp_ident "r" (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+35]..[231,5545+36])
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+40]..[231,5545+46])
                                            Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+40]..[231,5545+44])
                                            Some
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+45]..[231,5545+46])
                                                Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[231,5545+45]..[231,5545+46])
                                      ]
                            ]
                            None
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+5]..[235,5730+5]) ghost
                        Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+5]..[235,5730+5]) ghost
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+5]..[235,5730+5]) ghost
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+5]..[234,5680+48])
                                Pexp_construct "Field" (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+5]..[232,5595+10])
                                Some
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+11]..[234,5680+48])
                                    Pexp_record
                                    [
                                      "label" (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+12]..[232,5595+17])
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+20]..[232,5595+23])
                                          Pexp_constant PConst_string("b",(testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+21]..[232,5595+22]),None)
                                      "field_type" (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+25]..[232,5595+35])
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+38]..[232,5595+49])
                                          Pexp_construct "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+38]..[232,5595+42])
                                          Some
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+43]..[232,5595+49])
                                              Pexp_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[232,5595+43]..[232,5595+49])
                                              None
                                      "get" (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+12]..[233,5646+15])
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+18]..[233,5646+32])
                                          Pexp_fun
                                          Nolabel
                                          None
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+23]..[233,5646+26])
                                            Ppat_record Closed
                                            [
                                              "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+24]..[233,5646+25]) ghost
                                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+24]..[233,5646+25])
                                                  Ppat_var "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+24]..[233,5646+25])
                                            ]
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+30]..[233,5646+31])
                                            Pexp_ident "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[233,5646+30]..[233,5646+31])
                                      "set" (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+12]..[234,5680+15])
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+18]..[234,5680+47])
                                          Pexp_fun
                                          Nolabel
                                          None
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+23]..[234,5680+29])
                                            Ppat_tuple
                                            [
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+24]..[234,5680+25])
                                                Ppat_any
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+27]..[234,5680+28])
                                                Ppat_var "r" (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+27]..[234,5680+28])
                                            ]
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+30]..[234,5680+46]) ghost
                                            Pexp_fun
                                            Nolabel
                                            None
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+30]..[234,5680+31])
                                              Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+30]..[234,5680+31])
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+35]..[234,5680+46])
                                              Pexp_apply
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+37]..[234,5680+39])
                                                Pexp_ident ":=" (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+37]..[234,5680+39])
                                              [
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+35]..[234,5680+36])
                                                    Pexp_ident "r" (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+35]..[234,5680+36])
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+40]..[234,5680+46])
                                                    Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+40]..[234,5680+44])
                                                    Some
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+45]..[234,5680+46])
                                                        Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[234,5680+45]..[234,5680+46])
                                              ]
                                    ]
                                    None
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[235,5730+4]..[235,5730+5]) ghost
                                Pexp_construct "[]" (testsuite/tests/typing-gadts/dynamic_frisch.ml[235,5730+4]..[235,5730+5]) ghost
                                None
                            ]
                    ]
          ]
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+2]..[243,5949+75])
            Pexp_let Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+6]..[237,5741+20])
                  Ppat_var "create_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+6]..[237,5741+20])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+21]..[237,5741+46]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+21]..[237,5741+23])
                    Ppat_construct "()" (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+21]..[237,5741+23])
                    None
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+26]..[237,5741+46])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+27]..[237,5741+35])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+27]..[237,5741+30])
                          Pexp_ident "ref" (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+27]..[237,5741+30])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+31]..[237,5741+35])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+31]..[237,5741+35])
                              None
                        ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+37]..[237,5741+45])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+37]..[237,5741+40])
                          Pexp_ident "ref" (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+37]..[237,5741+40])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+41]..[237,5741+45])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[237,5741+41]..[237,5741+45])
                              None
                        ]
                    ]
            ]
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+2]..[243,5949+75])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+6]..[238,5791+16])
                    Ppat_var "of_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+6]..[238,5791+16])
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+17]..[241,5870+73]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+17]..[238,5791+23])
                      Ppat_tuple
                      [
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+18]..[238,5791+19])
                          Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+18]..[238,5791+19])
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+21]..[238,5791+22])
                          Ppat_var "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[238,5791+21]..[238,5791+22])
                      ]
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+4]..[241,5870+73])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+10]..[239,5817+16])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+10]..[239,5817+12])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+10]..[239,5817+11])
                              Pexp_ident "!" (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+10]..[239,5817+11])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+11]..[239,5817+12])
                                  Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+11]..[239,5817+12])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+14]..[239,5817+16])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+14]..[239,5817+15])
                              Pexp_ident "!" (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+14]..[239,5817+15])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+15]..[239,5817+16])
                                  Pexp_ident "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[239,5817+15]..[239,5817+16])
                            ]
                        ]
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+6]..[240,5839+20])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+6]..[240,5839+12])
                                Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+6]..[240,5839+10])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+11]..[240,5839+12])
                                    Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+11]..[240,5839+12])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+14]..[240,5839+20])
                                Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+14]..[240,5839+18])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+19]..[240,5839+20])
                                    Ppat_var "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+19]..[240,5839+20])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+24]..[240,5839+30])
                            Pexp_record
                            [
                              "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+25]..[240,5839+26]) ghost
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+25]..[240,5839+26])
                                  Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+25]..[240,5839+26])
                              "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+28]..[240,5839+29]) ghost
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+28]..[240,5839+29])
                                  Pexp_ident "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[240,5839+28]..[240,5839+29])
                            ]
                            None
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[241,5870+6]..[241,5870+7])
                            Ppat_any
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[241,5870+11]..[241,5870+73])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[241,5870+11]..[241,5870+19])
                              Pexp_ident "failwith" (testsuite/tests/typing-gadts/dynamic_frisch.ml[241,5870+11]..[241,5870+19])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[241,5870+20]..[241,5870+73])
                                  Pexp_constant PConst_string("Some fields are missing in record of type my_record",(testsuite/tests/typing-gadts/dynamic_frisch.ml[241,5870+21]..[241,5870+72]),None)
                            ]
                      ]
              ]
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+2]..[243,5949+75])
                Pexp_construct "Record" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+2]..[243,5949+8])
                Some
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+9]..[243,5949+75])
                    Pexp_record
                    [
                      "path" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+10]..[243,5949+14])
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+17]..[243,5949+38])
                          Pexp_constant PConst_string("My_module.my_record",(testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+18]..[243,5949+37]),None)
                      "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+40]..[243,5949+46]) ghost
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+40]..[243,5949+46])
                          Pexp_ident "fields" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+40]..[243,5949+46])
                      "create_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+48]..[243,5949+62]) ghost
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+48]..[243,5949+62])
                          Pexp_ident "create_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+48]..[243,5949+62])
                      "of_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+64]..[243,5949+74]) ghost
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+64]..[243,5949+74])
                          Pexp_ident "of_builder" (testsuite/tests/typing-gadts/dynamic_frisch.ml[243,5949+64]..[243,5949+74])
                    ]
                    None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[245,6028+0]..[254,6373+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[245,6028+9]..[254,6373+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[245,6028+9]..[254,6373+2])
          Pexp_constant PConst_string ("\ntype my_record = { a : int; b : string list; }\nval my_record : my_record ty =\n  Record\n   {path = \"My_module.my_record\";\n    fields =\n     [Field {label = \"a\"; field_type = Int; get = <fun>; set = <fun>};\n      Field {label = \"b\"; field_type = List String; get = <fun>; set = <fun>}];\n    create_builder = <fun>; of_builder = <fun>}\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[245,6028+11]..[254,6373+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[259,6467+0]..[259,6467+18])
    Pstr_type Rec
    [
      type_declaration "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[259,6467+5]..[259,6467+10]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[259,6467+0]..[259,6467+18])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[259,6467+13]..[259,6467+18])
                "Noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[259,6467+13]..[259,6467+18])
                []
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[261,6487+0]..[290,7612+50])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[261,6487+11]..[261,6487+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[261,6487+0]..[274,7033+43])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[261,6487+6]..[261,6487+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[261,6487+8]..[261,6487+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[262,6503+2]..[262,6503+19])
                "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[262,6503+4]..[262,6503+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[262,6503+9]..[262,6503+19])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[262,6503+17]..[262,6503+19])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[262,6503+10]..[262,6503+13])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[262,6503+10]..[262,6503+13])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[262,6503+14]..[262,6503+15])
                        Ptyp_any
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[263,6523+2]..[263,6523+25])
                "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[263,6523+4]..[263,6523+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[263,6523+12]..[263,6523+25])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[263,6523+23]..[263,6523+25])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[263,6523+13]..[263,6523+19])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[263,6523+13]..[263,6523+19])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[263,6523+20]..[263,6523+21])
                        Ptyp_any
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+2]..[264,6549+40])
                "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+4]..[264,6549+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+10]..[264,6549+20])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+18]..[264,6549+20])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+11]..[264,6549+13])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+14]..[264,6549+16])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+24]..[264,6549+40])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+38]..[264,6549+40])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+25]..[264,6549+32])
                        Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+28]..[264,6549+32])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+25]..[264,6549+27])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[264,6549+34]..[264,6549+36])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+2]..[265,6590+44])
                "Option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+4]..[265,6590+10])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+12]..[265,6590+22])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+20]..[265,6590+22])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+13]..[265,6590+15])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+16]..[265,6590+18])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+26]..[265,6590+44])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+42]..[265,6590+44])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+27]..[265,6590+36])
                        Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+30]..[265,6590+36])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+27]..[265,6590+29])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[265,6590+38]..[265,6590+40])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+2]..[266,6635+54])
                "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+4]..[266,6635+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+11]..[266,6635+34])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+11]..[266,6635+21])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+19]..[266,6635+21])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+12]..[266,6635+14])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+15]..[266,6635+17])
                            Ptyp_var e
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+24]..[266,6635+34])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+32]..[266,6635+34])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+25]..[266,6635+27])
                            Ptyp_var b
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+28]..[266,6635+30])
                            Ptyp_var e
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+39]..[266,6635+54])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+52]..[266,6635+54])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+40]..[266,6635+47])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+40]..[266,6635+42])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+45]..[266,6635+47])
                            Ptyp_var b
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[266,6635+48]..[266,6635+50])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+2]..[268,6745+26])
                "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+4]..[268,6745+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+9]..[268,6745+26])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+24]..[268,6745+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+10]..[268,6745+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+14]..[268,6745+22])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+14]..[268,6745+16])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[268,6745+20]..[268,6745+22])
                          Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+2]..[269,6772+40])
                "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+4]..[269,6772+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+9]..[269,6772+26])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+24]..[269,6772+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+10]..[269,6772+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+14]..[269,6772+22])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+14]..[269,6772+16])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+20]..[269,6772+22])
                          Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+30]..[269,6772+40])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+38]..[269,6772+40])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+31]..[269,6772+33])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[269,6772+34]..[269,6772+36])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+2]..[270,6813+41])
                "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+4]..[270,6813+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+9]..[270,6813+20])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+18]..[270,6813+20])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+10]..[270,6813+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+14]..[270,6813+16])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+24]..[270,6813+41])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+39]..[270,6813+41])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+25]..[270,6813+27])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+29]..[270,6813+37])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+29]..[270,6813+31])
                          Ptyp_var b
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[270,6813+35]..[270,6813+37])
                          Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+2]..[272,6899+71])
                "Conv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+4]..[272,6899+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+10]..[272,6899+16])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+10]..[272,6899+16])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+20]..[272,6899+28])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+20]..[272,6899+22])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+26]..[272,6899+28])
                      Ptyp_var b
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+33]..[272,6899+41])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+33]..[272,6899+35])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+39]..[272,6899+41])
                      Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+45]..[272,6899+56])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+54]..[272,6899+56])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+46]..[272,6899+48])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+50]..[272,6899+52])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+60]..[272,6899+71])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+69]..[272,6899+71])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+61]..[272,6899+63])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[272,6899+65]..[272,6899+67])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+2]..[274,7033+43])
                "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+4]..[274,7033+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+9]..[274,7033+28])
                    Ptyp_constr "ty_sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+22]..[274,7033+28])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+10]..[274,7033+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+14]..[274,7033+16])
                        Ptyp_var e
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+18]..[274,7033+20])
                        Ptyp_var b
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+32]..[274,7033+43])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+41]..[274,7033+43])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+33]..[274,7033+35])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[274,7033+37]..[274,7033+39])
                        Ptyp_var e
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[276,7078+17]..[276,7078+23]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[276,7078+0]..[279,7203+47])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[276,7078+5]..[276,7078+7])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[276,7078+9]..[276,7078+11])
              Ptyp_var e
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[276,7078+13]..[276,7078+15])
              Ptyp_var b
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+6]..[277,7104+48])
                Immutable
                "sum_proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+6]..[277,7104+14])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+16]..[277,7104+47])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+16]..[277,7104+18])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+22]..[277,7104+47])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+22]..[277,7104+28])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+22]..[277,7104+28])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+31]..[277,7104+47])
                        Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+41]..[277,7104+47])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+31]..[277,7104+40])
                            Ptyp_constr "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+34]..[277,7104+40])
                            [
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[277,7104+31]..[277,7104+33])
                                Ptyp_var e
                            ]
                        ]
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+6]..[278,7153+49])
                Immutable
                "sum_cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+6]..[278,7153+15])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+17]..[278,7153+48])
                  Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+44]..[278,7153+48])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+18]..[278,7153+42])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+18]..[278,7153+24])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+18]..[278,7153+24])
                          []
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+27]..[278,7153+42])
                          Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+35]..[278,7153+42])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+28]..[278,7153+30])
                              Ptyp_var e
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[278,7153+31]..[278,7153+33])
                              Ptyp_var b
                          ]
                      ]
                  ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+6]..[279,7203+45])
                Immutable
                "sum_inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+6]..[279,7203+13])                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+15]..[279,7203+44])
                  Ptyp_poly 'c
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+19]..[279,7203+44])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+19]..[279,7203+38])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+19]..[279,7203+33])
                          Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+27]..[279,7203+33])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+20]..[279,7203+22])
                              Ptyp_var b
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+23]..[279,7203+25])
                              Ptyp_var c
                          ]
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+36]..[279,7203+38])
                          Ptyp_var c
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[279,7203+42]..[279,7203+44])
                      Ptyp_var a
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[281,7252+7]..[281,7252+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[281,7252+0]..[282,7300+39])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[281,7252+4]..[281,7252+6])
              Ptyp_var e
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+2]..[282,7300+39])
                "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+4]..[282,7300+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+11]..[282,7300+21])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+19]..[282,7300+21])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+12]..[282,7300+14])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+15]..[282,7300+17])
                        Ptyp_var e
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+24]..[282,7300+26])
                    Ptyp_var a
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+30]..[282,7300+39])
                    Ptyp_constr "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+33]..[282,7300+39])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[282,7300+30]..[282,7300+32])
                        Ptyp_var e
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[284,7341+10]..[284,7341+16]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[284,7341+0]..[286,7438+62])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[284,7341+5]..[284,7341+6])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[284,7341+7]..[284,7341+8])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+2]..[285,7406+31])
                "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+4]..[285,7406+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+10]..[285,7406+31])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+25]..[285,7406+31])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+11]..[285,7406+19])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+11]..[285,7406+13])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+17]..[285,7406+19])
                          Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[285,7406+21]..[285,7406+23])
                        Ptyp_var a
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+2]..[286,7438+62])
                "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+4]..[286,7438+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+10]..[286,7438+31])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+25]..[286,7438+31])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+11]..[286,7438+19])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+11]..[286,7438+13])
                          Ptyp_var b
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+17]..[286,7438+19])
                          Ptyp_var c
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+21]..[286,7438+23])
                        Ptyp_var d
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+35]..[286,7438+62])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+56]..[286,7438+62])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+36]..[286,7438+50])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+36]..[286,7438+38])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+42]..[286,7438+50])
                          Ptyp_arrow
                          Nolabel
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+42]..[286,7438+44])
                            Ptyp_var b
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+48]..[286,7438+50])
                            Ptyp_var c
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[286,7438+52]..[286,7438+54])
                        Ptyp_var d
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[288,7502+10]..[288,7502+17]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[288,7502+0]..[290,7612+50])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[288,7502+5]..[288,7502+6])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[288,7502+7]..[288,7502+8])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+2]..[289,7553+58])
                "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+4]..[289,7553+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+12]..[289,7553+26])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+20]..[289,7553+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+13]..[289,7553+15])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+16]..[289,7553+18])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+29]..[289,7553+39])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+37]..[289,7553+39])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+30]..[289,7553+32])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+33]..[289,7553+35])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+43]..[289,7553+58])
                    Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+51]..[289,7553+58])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+44]..[289,7553+46])
                        Ptyp_var e
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[289,7553+47]..[289,7553+49])
                        Ptyp_var b
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+2]..[290,7612+50])
                "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+4]..[290,7612+11])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+14]..[290,7612+31])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+25]..[290,7612+31])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+15]..[290,7612+17])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+18]..[290,7612+23])
                        Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+18]..[290,7612+23])
                        []
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+35]..[290,7612+50])
                    Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+43]..[290,7612+50])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+36]..[290,7612+38])
                        Ptyp_var e
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[290,7612+39]..[290,7612+41])
                        Ptyp_var b
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[293,7667+0]..[295,7752+55])
    Pstr_type Rec
    [
      type_declaration "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[293,7667+7]..[293,7667+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[293,7667+0]..[295,7752+55])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[293,7667+5]..[293,7667+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[294,7729+2]..[294,7729+22])
                "Enil" (testsuite/tests/typing-gadts/dynamic_frisch.ml[294,7729+4]..[294,7729+8])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[294,7729+11]..[294,7729+22])
                    Ptyp_constr "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[294,7729+16]..[294,7729+22])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[294,7729+11]..[294,7729+15])
                        Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[294,7729+11]..[294,7729+15])
                        []
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+2]..[295,7752+55])
                "Econs" (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+4]..[295,7752+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+12]..[295,7752+22])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+20]..[295,7752+22])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+13]..[295,7752+15])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+16]..[295,7752+18])
                        Ptyp_var e
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+25]..[295,7752+34])
                    Ptyp_constr "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+28]..[295,7752+34])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+25]..[295,7752+27])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+38]..[295,7752+55])
                    Ptyp_constr "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+49]..[295,7752+55])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+39]..[295,7752+47])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+39]..[295,7752+41])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[295,7752+45]..[295,7752+47])
                          Ptyp_var e
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+0]..[299,7838+30])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+11]..[299,7838+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+0]..[299,7838+30])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+6]..[299,7838+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+8]..[299,7838+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+16]..[299,7838+30])
                "Eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+16]..[299,7838+18])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+20]..[299,7838+30])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+28]..[299,7838+30])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+21]..[299,7838+23])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[299,7838+24]..[299,7838+26])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+0]..[308,8107+15])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[302,7873+76]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[302,7873+14])
            Ppat_var "eq_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[302,7873+14])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[308,8107+15]) ghost
            Ptyp_poly 'a 'b 'c
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+29]..[302,7873+76])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+29]..[302,7873+41])
                Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+35]..[302,7873+41])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+30]..[302,7873+31])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+32]..[302,7873+33])
                    Ptyp_var b
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+45]..[302,7873+76])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+45]..[302,7873+57])
                  Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+51]..[302,7873+57])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+46]..[302,7873+47])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+48]..[302,7873+49])
                      Ptyp_var c
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+61]..[302,7873+76])
                  Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+70]..[302,7873+76])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+61]..[302,7873+69])
                      Ptyp_constr "eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+67]..[302,7873+69])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+62]..[302,7873+63])
                          Ptyp_var b
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+64]..[302,7873+65])
                          Ptyp_var c
                      ]
                  ]
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[308,8107+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[308,8107+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[308,8107+15])
              Pexp_newtype "c"
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+8]..[308,8107+15])
                Pexp_constraint
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[303,7952+2]..[308,8107+15])
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[303,7952+6]..[303,7952+8])
                    Ppat_var "s1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[303,7952+6]..[303,7952+8])
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[303,7952+9]..[308,8107+15]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[303,7952+9]..[303,7952+11])
                      Ppat_var "s2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[303,7952+9]..[303,7952+11])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[304,7967+4]..[308,8107+15])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[304,7967+10]..[304,7967+16])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[304,7967+10]..[304,7967+12])
                            Pexp_ident "s1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[304,7967+10]..[304,7967+12])
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[304,7967+14]..[304,7967+16])
                            Pexp_ident "s2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[304,7967+14]..[304,7967+16])
                        ]
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+6]..[305,7989+14])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+6]..[305,7989+9])
                                Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+6]..[305,7989+9])
                                None
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+11]..[305,7989+14])
                                Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+11]..[305,7989+14])
                                None
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+18]..[305,7989+25])
                            Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+18]..[305,7989+22])
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+23]..[305,7989+25])
                                Pexp_construct "Eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[305,7989+23]..[305,7989+25])
                                None
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+6]..[306,8015+20])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+6]..[306,8015+12])
                                Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+6]..[306,8015+9])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+10]..[306,8015+12])
                                    Ppat_var "s1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+10]..[306,8015+12])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+14]..[306,8015+20])
                                Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+14]..[306,8015+17])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+18]..[306,8015+20])
                                    Ppat_var "s2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[306,8015+18]..[306,8015+20])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+8]..[307,8039+67])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+15]..[307,8039+27])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+15]..[307,8039+21])
                                Pexp_ident "eq_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+15]..[307,8039+21])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+22]..[307,8039+24])
                                    Pexp_ident "s1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+22]..[307,8039+24])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+25]..[307,8039+27])
                                    Pexp_ident "s2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+25]..[307,8039+27])
                              ]
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+33]..[307,8039+37])
                                  Ppat_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+33]..[307,8039+37])
                                  None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+41]..[307,8039+45])
                                  Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+41]..[307,8039+45])
                                  None
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+48]..[307,8039+55])
                                  Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+48]..[307,8039+52])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+53]..[307,8039+55])
                                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+53]..[307,8039+55])
                                      None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+59]..[307,8039+66])
                                  Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+59]..[307,8039+63])
                                  Some
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+64]..[307,8039+66])
                                      Pexp_construct "Eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[307,8039+64]..[307,8039+66])
                                      None
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[308,8107+6]..[308,8107+7])
                            Ppat_any
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[308,8107+11]..[308,8107+15])
                            Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[308,8107+11]..[308,8107+15])
                            None
                      ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+29]..[302,7873+76])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+29]..[302,7873+41])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+35]..[302,7873+41])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+30]..[302,7873+31])
                        Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+30]..[302,7873+31])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+32]..[302,7873+33])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+32]..[302,7873+33])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+45]..[302,7873+76])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+45]..[302,7873+57])
                      Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+51]..[302,7873+57])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+46]..[302,7873+47])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+46]..[302,7873+47])
                          []
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+48]..[302,7873+49])
                          Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+48]..[302,7873+49])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+61]..[302,7873+76])
                      Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+70]..[302,7873+76])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+61]..[302,7873+69])
                          Ptyp_constr "eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+67]..[302,7873+69])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+62]..[302,7873+63])
                              Ptyp_constr "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+62]..[302,7873+63])
                              []
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+64]..[302,7873+65])
                              Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[302,7873+64]..[302,7873+65])
                              []
                          ]
                      ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[310,8126+0]..[340,9287+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[310,8126+9]..[340,9287+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[310,8126+9]..[340,9287+2])
          Pexp_constant PConst_string ("\ntype noarg = Noarg\ntype (_, _) ty =\n    Int : (int, 'c) ty\n  | String : (string, 'd) ty\n  | List : ('a, 'e) ty -> ('a list, 'e) ty\n  | Option : ('a, 'e) ty -> ('a option, 'e) ty\n  | Pair : (('a, 'e) ty * ('b, 'e) ty) -> ('a * 'b, 'e) ty\n  | Var : ('a, 'a -> 'e) ty\n  | Rec : ('a, 'a -> 'e) ty -> ('a, 'e) ty\n  | Pop : ('a, 'e) ty -> ('a, 'b -> 'e) ty\n  | Conv : string * ('a -> 'b) * ('b -> 'a) * ('b, 'e) ty -> ('a, 'e) ty\n  | Sum : ('a, 'e, 'b) ty_sum -> ('a, 'e) ty\nand ('a, 'e, 'b) ty_sum = {\n  sum_proj : 'a -> string * 'e ty_dyn option;\n  sum_cases : (string * ('e, 'b) ty_case) list;\n  sum_inj : 'c. ('b, 'c) ty_sel * 'c -> 'a;\n}\nand 'e ty_dyn = Tdyn : ('a, 'e) ty * 'a -> 'e ty_dyn\nand (_, _) ty_sel =\n    Thd : ('a -> 'b, 'a) ty_sel\n  | Ttl : ('b -> 'c, 'd) ty_sel -> ('a -> 'b -> 'c, 'd) ty_sel\nand (_, _) ty_case =\n    TCarg : ('b, 'a) ty_sel * ('a, 'e) ty -> ('e, 'b) ty_case\n  | TCnoarg : ('b, noarg) ty_sel -> ('e, 'b) ty_case\ntype _ ty_env =\n    Enil : unit ty_env\n  | Econs : ('a, 'e) ty * 'e ty_env -> ('a -> 'e) ty_env\ntype (_, _) eq = Eq : ('a, 'a) eq\nval eq_sel : ('a, 'b) ty_sel -> ('a, 'c) ty_sel -> ('b, 'c) eq option = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[310,8126+11]..[340,9287+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+0]..[357,9813+25])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[344,9394+77]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[343,9363+16])
            Ppat_var "get_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[343,9363+16])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[357,9813+25]) ghost
            Ptyp_poly 'a 'b 'e
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+2]..[344,9394+77])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+2]..[344,9394+15])
                Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+9]..[344,9394+15])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+3]..[344,9394+4])
                    Ptyp_var b
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+6]..[344,9394+7])
                    Ptyp_var a
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+19]..[344,9394+77])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+19]..[344,9394+48])
                  Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+44]..[344,9394+48])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+20]..[344,9394+42])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+20]..[344,9394+26])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+20]..[344,9394+26])
                          []
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+29]..[344,9394+42])
                          Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+35]..[344,9394+42])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+30]..[344,9394+31])
                              Ptyp_var e
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+32]..[344,9394+33])
                              Ptyp_var b
                          ]
                      ]
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+52]..[344,9394+77])
                  Ptyp_tuple
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+52]..[344,9394+58])
                      Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+52]..[344,9394+58])
                      []
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+61]..[344,9394+77])
                      Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+71]..[344,9394+77])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+61]..[344,9394+70])
                          Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+68]..[344,9394+70])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+62]..[344,9394+63])
                              Ptyp_var a
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+65]..[344,9394+66])
                              Ptyp_var e
                          ]
                      ]
                  ]
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[357,9813+25])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[357,9813+25])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[357,9813+25])
              Pexp_newtype "e"
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[343,9363+8]..[357,9813+25])
                Pexp_constraint
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[345,9474+2]..[357,9813+25])
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[345,9474+6]..[345,9474+9])
                    Ppat_var "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[345,9474+6]..[345,9474+9])
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[345,9474+10]..[357,9813+25]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[345,9474+10]..[345,9474+15])
                      Ppat_var "cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[345,9474+10]..[345,9474+15])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[346,9493+2]..[357,9813+25])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[346,9493+8]..[346,9493+13])
                        Pexp_ident "cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[346,9493+8]..[346,9493+13])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+4]..[347,9512+31])
                            Ppat_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+25]..[347,9512+27])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+4]..[347,9512+31]) ghost
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+4]..[347,9512+24])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+5]..[347,9512+9])
                                        Ppat_var "name" (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+5]..[347,9512+9])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+11]..[347,9512+23])
                                        Ppat_construct "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+11]..[347,9512+18])
                                        Some
                                          []
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+19]..[347,9512+23])
                                            Ppat_var "sel'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+19]..[347,9512+23])
                                    ]
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+28]..[347,9512+31])
                                    Ppat_var "rem" (testsuite/tests/typing-gadts/dynamic_frisch.ml[347,9512+28]..[347,9512+31])
                                ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+6]..[351,9649+9])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+18]..[348,9547+33])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+18]..[348,9547+24])
                                Pexp_ident "eq_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+18]..[348,9547+24])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+25]..[348,9547+28])
                                    Pexp_ident "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+25]..[348,9547+28])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+29]..[348,9547+33])
                                    Pexp_ident "sel'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[348,9547+29]..[348,9547+33])
                              ]
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+8]..[349,9586+12])
                                  Ppat_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+8]..[349,9586+12])
                                  None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+16]..[349,9586+32])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+16]..[349,9586+24])
                                    Pexp_ident "get_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+16]..[349,9586+24])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+25]..[349,9586+28])
                                        Pexp_ident "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+25]..[349,9586+28])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+29]..[349,9586+32])
                                        Pexp_ident "rem" (testsuite/tests/typing-gadts/dynamic_frisch.ml[349,9586+29]..[349,9586+32])
                                  ]
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+8]..[350,9619+15])
                                  Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+8]..[350,9619+12])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+13]..[350,9619+15])
                                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+13]..[350,9619+15])
                                      None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+19]..[350,9619+29])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+19]..[350,9619+23])
                                      Pexp_ident "name" (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+19]..[350,9619+23])
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+25]..[350,9619+29])
                                      Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[350,9619+25]..[350,9619+29])
                                      None
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+4]..[352,9659+35])
                            Ppat_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+29]..[352,9659+31])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+4]..[352,9659+35]) ghost
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+4]..[352,9659+28])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+5]..[352,9659+9])
                                        Ppat_var "name" (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+5]..[352,9659+9])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+11]..[352,9659+27])
                                        Ppat_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+11]..[352,9659+16])
                                        Some
                                          []
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+17]..[352,9659+27])
                                            Ppat_tuple
                                            [
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+18]..[352,9659+22])
                                                Ppat_var "sel'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+18]..[352,9659+22])
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+24]..[352,9659+26])
                                                Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+24]..[352,9659+26])
                                            ]
                                    ]
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+32]..[352,9659+35])
                                    Ppat_var "rem" (testsuite/tests/typing-gadts/dynamic_frisch.ml[352,9659+32]..[352,9659+35])
                                ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+6]..[356,9803+9])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+18]..[353,9698+33])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+18]..[353,9698+24])
                                Pexp_ident "eq_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+18]..[353,9698+24])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+25]..[353,9698+28])
                                    Pexp_ident "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+25]..[353,9698+28])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+29]..[353,9698+33])
                                    Pexp_ident "sel'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[353,9698+29]..[353,9698+33])
                              ]
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+8]..[354,9737+12])
                                  Ppat_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+8]..[354,9737+12])
                                  None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+16]..[354,9737+32])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+16]..[354,9737+24])
                                    Pexp_ident "get_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+16]..[354,9737+24])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+25]..[354,9737+28])
                                        Pexp_ident "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+25]..[354,9737+28])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+29]..[354,9737+32])
                                        Pexp_ident "rem" (testsuite/tests/typing-gadts/dynamic_frisch.ml[354,9737+29]..[354,9737+32])
                                  ]
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+8]..[355,9770+15])
                                  Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+8]..[355,9770+12])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+13]..[355,9770+15])
                                      Ppat_construct "Eq" (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+13]..[355,9770+15])
                                      None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+19]..[355,9770+32])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+19]..[355,9770+23])
                                      Pexp_ident "name" (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+19]..[355,9770+23])
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+25]..[355,9770+32])
                                      Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+25]..[355,9770+29])
                                      Some
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+30]..[355,9770+32])
                                          Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[355,9770+30]..[355,9770+32])
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[357,9813+4]..[357,9813+6])
                            Ppat_construct "[]" (testsuite/tests/typing-gadts/dynamic_frisch.ml[357,9813+4]..[357,9813+6])
                            None
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[357,9813+10]..[357,9813+25])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[357,9813+10]..[357,9813+15])
                              Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[357,9813+10]..[357,9813+15])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[357,9813+16]..[357,9813+25])
                                  Pexp_construct "Not_found" (testsuite/tests/typing-gadts/dynamic_frisch.ml[357,9813+16]..[357,9813+25])
                                  None
                            ]
                      ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+2]..[344,9394+77])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+2]..[344,9394+15])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+9]..[344,9394+15])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+3]..[344,9394+4])
                        Ptyp_constr "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+3]..[344,9394+4])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+6]..[344,9394+7])
                        Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+6]..[344,9394+7])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+19]..[344,9394+77])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+19]..[344,9394+48])
                      Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+44]..[344,9394+48])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+20]..[344,9394+42])
                          Ptyp_tuple
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+20]..[344,9394+26])
                              Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+20]..[344,9394+26])
                              []
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+29]..[344,9394+42])
                              Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+35]..[344,9394+42])
                              [
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+30]..[344,9394+31])
                                  Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+30]..[344,9394+31])
                                  []
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+32]..[344,9394+33])
                                  Ptyp_constr "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+32]..[344,9394+33])
                                  []
                              ]
                          ]
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+52]..[344,9394+77])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+52]..[344,9394+58])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+52]..[344,9394+58])
                          []
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+61]..[344,9394+77])
                          Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+71]..[344,9394+77])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+61]..[344,9394+70])
                              Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+68]..[344,9394+70])
                              [
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+62]..[344,9394+63])
                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+62]..[344,9394+63])
                                  []
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+65]..[344,9394+66])
                                  Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[344,9394+65]..[344,9394+66])
                                  []
                              ]
                          ]
                      ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[359,9842+0]..[363,9964+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[359,9842+9]..[363,9964+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[359,9842+9]..[363,9964+2])
          Pexp_constant PConst_string ("\nval get_case :\n  ('b, 'a) ty_sel ->\n  (string * ('e, 'b) ty_case) list -> string * ('a, 'e) ty option = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[359,9842+11]..[363,9964+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[366,10010+0]..[373,10180+35])
    Pstr_type Rec
    [
      type_declaration "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[366,10010+5]..[366,10010+12]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[366,10010+0]..[373,10180+35])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[367,10025+2]..[367,10025+15])
                "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[367,10025+4]..[367,10025+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[367,10025+12]..[367,10025+15])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[367,10025+12]..[367,10025+15])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[368,10041+2]..[368,10041+21])
                "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[368,10041+4]..[368,10041+11])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[368,10041+15]..[368,10041+21])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[368,10041+15]..[368,10041+21])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[369,10063+2]..[369,10063+25])
                "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[369,10063+4]..[369,10063+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[369,10063+13]..[369,10063+25])
                    Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[369,10063+21]..[369,10063+25])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[369,10063+13]..[369,10063+20])
                        Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[369,10063+13]..[369,10063+20])
                        []
                    ]
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[370,10089+2]..[370,10089+29])
                "VOption" (testsuite/tests/typing-gadts/dynamic_frisch.ml[370,10089+4]..[370,10089+11])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[370,10089+15]..[370,10089+29])
                    Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[370,10089+23]..[370,10089+29])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[370,10089+15]..[370,10089+22])
                        Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[370,10089+15]..[370,10089+22])
                        []
                    ]
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[371,10119+2]..[371,10119+30])
                "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[371,10119+4]..[371,10119+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[371,10119+13]..[371,10119+20])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[371,10119+13]..[371,10119+20])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[371,10119+23]..[371,10119+30])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[371,10119+23]..[371,10119+30])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[372,10150+2]..[372,10150+29])
                "VConv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[372,10150+4]..[372,10150+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[372,10150+13]..[372,10150+19])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[372,10150+13]..[372,10150+19])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[372,10150+22]..[372,10150+29])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[372,10150+22]..[372,10150+29])
                    []
                ]
                None
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+2]..[373,10180+35])
                "VSum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+4]..[373,10180+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+12]..[373,10180+18])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+12]..[373,10180+18])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+21]..[373,10180+35])
                    Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+29]..[373,10180+35])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+21]..[373,10180+28])
                        Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[373,10180+21]..[373,10180+28])
                        []
                    ]
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+0]..[376,10220+60])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+4]..[376,10220+11])
          Ppat_var "may_map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+4]..[376,10220+11])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+12]..[376,10220+60]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+12]..[376,10220+13])
            Ppat_var "f" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+12]..[376,10220+13])
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+16]..[376,10220+60])
            Pexp_function
            [
              <case>
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+25]..[376,10220+31])
                  Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+25]..[376,10220+29])
                  Some
                    []
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+30]..[376,10220+31])
                      Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+30]..[376,10220+31])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+35]..[376,10220+45])
                  Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+35]..[376,10220+39])
                  Some
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+40]..[376,10220+45])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+41]..[376,10220+42])
                        Pexp_ident "f" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+41]..[376,10220+42])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+43]..[376,10220+44])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+43]..[376,10220+44])
                      ]
              <case>
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+48]..[376,10220+52])
                  Ppat_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+48]..[376,10220+52])
                  None
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+56]..[376,10220+60])
                  Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[376,10220+56]..[376,10220+60])
                  None
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+0]..[392,10897+77])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+8]..[378,10285+67]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+8]..[378,10285+18])
            Ppat_var "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+8]..[378,10285+18])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+8]..[392,10897+77]) ghost
            Ptyp_poly 'a 'e
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+31]..[378,10285+67])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+31]..[378,10285+39])
                Ptyp_constr "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+33]..[378,10285+39])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+31]..[378,10285+32])
                    Ptyp_var e
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+43]..[378,10285+67])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+43]..[378,10285+51])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+49]..[378,10285+51])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+44]..[378,10285+45])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+46]..[378,10285+47])
                      Ptyp_var e
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+55]..[378,10285+67])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+55]..[378,10285+56])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+60]..[378,10285+67])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+60]..[378,10285+67])
                    []
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+8]..[392,10897+77])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+8]..[392,10897+77])
            Pexp_newtype "e"
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+8]..[392,10897+77])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+2]..[392,10897+77])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+6]..[379,10355+7])
                  Ppat_var "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+6]..[379,10355+7])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+8]..[392,10897+77]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+8]..[379,10355+10])
                    Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+8]..[379,10355+10])
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+11]..[392,10897+77]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+11]..[379,10355+12])
                      Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[379,10355+11]..[379,10355+12])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[380,10371+2]..[392,10897+77])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[380,10371+8]..[380,10371+10])
                        Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[380,10371+8]..[380,10371+10])
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[381,10387+4]..[381,10387+7])
                            Ppat_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[381,10387+4]..[381,10387+7])
                            None
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[381,10387+11]..[381,10387+17])
                            Pexp_construct "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[381,10387+11]..[381,10387+15])
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[381,10387+16]..[381,10387+17])
                                Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[381,10387+16]..[381,10387+17])
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[382,10405+4]..[382,10405+10])
                            Ppat_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[382,10405+4]..[382,10405+10])
                            None
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[382,10405+14]..[382,10405+23])
                            Pexp_construct "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[382,10405+14]..[382,10405+21])
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[382,10405+22]..[382,10405+23])
                                Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[382,10405+22]..[382,10405+23])
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+4]..[383,10429+10])
                            Ppat_construct "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+4]..[383,10429+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+9]..[383,10429+10])
                                Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+9]..[383,10429+10])
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+14]..[383,10429+49])
                            Pexp_construct "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+14]..[383,10429+19])
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+20]..[383,10429+49])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+21]..[383,10429+29])
                                  Pexp_ident "List.map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+21]..[383,10429+29])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+30]..[383,10429+46])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+31]..[383,10429+41])
                                        Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+31]..[383,10429+41])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+42]..[383,10429+43])
                                            Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+42]..[383,10429+43])
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+44]..[383,10429+45])
                                            Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+44]..[383,10429+45])
                                      ]
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+47]..[383,10429+48])
                                      Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[383,10429+47]..[383,10429+48])
                                ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+4]..[384,10479+12])
                            Ppat_construct "Option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+4]..[384,10479+10])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+11]..[384,10479+12])
                                Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+11]..[384,10479+12])
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+16]..[384,10479+52])
                            Pexp_construct "VOption" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+16]..[384,10479+23])
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+24]..[384,10479+52])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+25]..[384,10479+32])
                                  Pexp_ident "may_map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+25]..[384,10479+32])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+33]..[384,10479+49])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+34]..[384,10479+44])
                                        Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+34]..[384,10479+44])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+45]..[384,10479+46])
                                            Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+45]..[384,10479+46])
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+47]..[384,10479+48])
                                            Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+47]..[384,10479+48])
                                      ]
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+50]..[384,10479+51])
                                      Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[384,10479+50]..[384,10479+51])
                                ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+4]..[385,10532+17])
                            Ppat_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+4]..[385,10532+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+9]..[385,10532+17])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+10]..[385,10532+12])
                                    Ppat_var "t1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+10]..[385,10532+12])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+14]..[385,10532+16])
                                    Ppat_var "t2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+14]..[385,10532+16])
                                ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+21]..[385,10532+77])
                            Pexp_construct "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+21]..[385,10532+26])
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+27]..[385,10532+77])
                                Pexp_tuple
                                [
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+28]..[385,10532+51])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+28]..[385,10532+38])
                                      Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+28]..[385,10532+38])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+39]..[385,10532+40])
                                          Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+39]..[385,10532+40])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+41]..[385,10532+43])
                                          Pexp_ident "t1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+41]..[385,10532+43])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+44]..[385,10532+51])
                                          Pexp_apply
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+45]..[385,10532+48])
                                            Pexp_ident "fst" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+45]..[385,10532+48])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+49]..[385,10532+50])
                                                Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+49]..[385,10532+50])
                                          ]
                                    ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+53]..[385,10532+76])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+53]..[385,10532+63])
                                      Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+53]..[385,10532+63])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+64]..[385,10532+65])
                                          Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+64]..[385,10532+65])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+66]..[385,10532+68])
                                          Pexp_ident "t2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+66]..[385,10532+68])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+69]..[385,10532+76])
                                          Pexp_apply
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+70]..[385,10532+73])
                                            Pexp_ident "snd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+70]..[385,10532+73])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+74]..[385,10532+75])
                                                Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[385,10532+74]..[385,10532+75])
                                          ]
                                    ]
                                ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+4]..[386,10610+9])
                            Ppat_construct "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+4]..[386,10610+7])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+8]..[386,10610+9])
                                Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+8]..[386,10610+9])
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+13]..[386,10610+43])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+13]..[386,10610+23])
                              Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+13]..[386,10610+23])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+24]..[386,10610+39])
                                  Pexp_construct "Econs" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+25]..[386,10610+30])
                                  Some
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+31]..[386,10610+38])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+32]..[386,10610+34])
                                          Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+32]..[386,10610+34])
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+36]..[386,10610+37])
                                          Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+36]..[386,10610+37])
                                      ]
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+40]..[386,10610+41])
                                  Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+40]..[386,10610+41])
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+42]..[386,10610+43])
                                  Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[386,10610+42]..[386,10610+43])
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+4]..[387,10654+9])
                            Ppat_construct "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+4]..[387,10654+7])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+8]..[387,10654+9])
                                Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+8]..[387,10654+9])
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+13]..[387,10654+62])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+20]..[387,10654+21])
                              Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+20]..[387,10654+21])
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+27]..[387,10654+40])
                                  Ppat_construct "Econs" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+27]..[387,10654+32])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+33]..[387,10654+40])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+34]..[387,10654+35])
                                          Ppat_any
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+37]..[387,10654+39])
                                          Ppat_var "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+37]..[387,10654+39])
                                      ]
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+44]..[387,10654+61])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+44]..[387,10654+54])
                                    Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+44]..[387,10654+54])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+55]..[387,10654+57])
                                        Pexp_ident "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+55]..[387,10654+57])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+58]..[387,10654+59])
                                        Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+58]..[387,10654+59])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+60]..[387,10654+61])
                                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[387,10654+60]..[387,10654+61])
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+4]..[388,10717+7])
                            Ppat_construct "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+4]..[388,10717+7])
                            None
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+11]..[388,10717+60])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+18]..[388,10717+19])
                              Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+18]..[388,10717+19])
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+25]..[388,10717+38])
                                  Ppat_construct "Econs" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+25]..[388,10717+30])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+31]..[388,10717+38])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+32]..[388,10717+33])
                                          Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+32]..[388,10717+33])
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+35]..[388,10717+37])
                                          Ppat_var "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+35]..[388,10717+37])
                                      ]
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+42]..[388,10717+59])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+42]..[388,10717+52])
                                    Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+42]..[388,10717+52])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+53]..[388,10717+55])
                                        Pexp_ident "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+53]..[388,10717+55])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+56]..[388,10717+57])
                                        Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+56]..[388,10717+57])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+58]..[388,10717+59])
                                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[388,10717+58]..[388,10717+59])
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+4]..[389,10778+26])
                            Ppat_construct "Conv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+4]..[389,10778+8])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+9]..[389,10778+26])
                                Ppat_tuple
                                [
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+10]..[389,10778+11])
                                    Ppat_var "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+10]..[389,10778+11])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+13]..[389,10778+17])
                                    Ppat_var "proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+13]..[389,10778+17])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+19]..[389,10778+22])
                                    Ppat_var "inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+19]..[389,10778+22])
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+24]..[389,10778+25])
                                    Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+24]..[389,10778+25])
                                ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+30]..[389,10778+64])
                            Pexp_construct "VConv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+30]..[389,10778+35])
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+36]..[389,10778+64])
                                Pexp_tuple
                                [
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+37]..[389,10778+38])
                                    Pexp_ident "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+37]..[389,10778+38])
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+40]..[389,10778+63])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+40]..[389,10778+50])
                                      Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+40]..[389,10778+50])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+51]..[389,10778+52])
                                          Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+51]..[389,10778+52])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+53]..[389,10778+54])
                                          Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+53]..[389,10778+54])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+55]..[389,10778+63])
                                          Pexp_apply
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+56]..[389,10778+60])
                                            Pexp_ident "proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+56]..[389,10778+60])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+61]..[389,10778+62])
                                                Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[389,10778+61]..[389,10778+62])
                                          ]
                                    ]
                                ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[390,10843+4]..[390,10843+11])
                            Ppat_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[390,10843+4]..[390,10843+7])
                            Some
                              []
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[390,10843+8]..[390,10843+11])
                                Ppat_var "ops" (testsuite/tests/typing-gadts/dynamic_frisch.ml[390,10843+8]..[390,10843+11])
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+6]..[392,10897+77])
                            Pexp_let Nonrec
                            [
                              <def>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+10]..[391,10858+18])
                                  Ppat_tuple
                                  [
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+10]..[391,10858+13])
                                      Ppat_var "tag" (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+10]..[391,10858+13])
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+15]..[391,10858+18])
                                      Ppat_var "arg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+15]..[391,10858+18])
                                  ]
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+21]..[391,10858+35])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+21]..[391,10858+33])
                                    Pexp_field
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+21]..[391,10858+24])
                                      Pexp_ident "ops" (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+21]..[391,10858+24])
                                    "sum_proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+25]..[391,10858+33])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+34]..[391,10858+35])
                                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[391,10858+34]..[391,10858+35])
                                  ]
                            ]
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+6]..[392,10897+77])
                              Pexp_construct "VSum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+6]..[392,10897+10])
                              Some
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+11]..[392,10897+77])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+12]..[392,10897+15])
                                      Pexp_ident "tag" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+12]..[392,10897+15])
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+17]..[392,10897+76])
                                      Pexp_apply
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+17]..[392,10897+24])
                                        Pexp_ident "may_map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+17]..[392,10897+24])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+25]..[392,10897+72])
                                            Pexp_function
                                            [
                                              <case>
                                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+35]..[392,10897+48])
                                                  Ppat_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+35]..[392,10897+39])
                                                  Some
                                                    []
                                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+40]..[392,10897+48])
                                                      Ppat_tuple
                                                      [
                                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+41]..[392,10897+43])
                                                          Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+41]..[392,10897+43])
                                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+44]..[392,10897+47])
                                                          Ppat_var "arg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+44]..[392,10897+47])
                                                      ]
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+52]..[392,10897+71])
                                                  Pexp_apply
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+52]..[392,10897+62])
                                                    Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+52]..[392,10897+62])
                                                  [
                                                    <arg>
                                                    Nolabel
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+63]..[392,10897+64])
                                                        Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+63]..[392,10897+64])
                                                    <arg>
                                                    Nolabel
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+65]..[392,10897+67])
                                                        Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+65]..[392,10897+67])
                                                    <arg>
                                                    Nolabel
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+68]..[392,10897+71])
                                                        Pexp_ident "arg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+68]..[392,10897+71])
                                                  ]
                                            ]
                                        <arg>
                                        Nolabel
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+73]..[392,10897+76])
                                            Pexp_ident "arg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[392,10897+73]..[392,10897+76])
                                      ]
                                  ]
                      ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+31]..[378,10285+67])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+31]..[378,10285+39])
                  Ptyp_constr "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+33]..[378,10285+39])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+31]..[378,10285+32])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+31]..[378,10285+32])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+43]..[378,10285+67])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+43]..[378,10285+51])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+49]..[378,10285+51])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+44]..[378,10285+45])
                        Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+44]..[378,10285+45])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+46]..[378,10285+47])
                        Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+46]..[378,10285+47])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+55]..[378,10285+67])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+55]..[378,10285+56])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+55]..[378,10285+56])
                      []
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+60]..[378,10285+67])
                      Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[378,10285+60]..[378,10285+67])
                      []
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[394,10978+0]..[405,11322+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[394,10978+9]..[405,11322+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[394,10978+9]..[405,11322+2])
          Pexp_constant PConst_string ("\ntype variant =\n    VInt of int\n  | VString of string\n  | VList of variant list\n  | VOption of variant option\n  | VPair of variant * variant\n  | VConv of string * variant\n  | VSum of string * variant option\nval may_map : ('a -> 'b) -> 'a option -> 'b option = <fun>\nval variantize : 'e ty_env -> ('a, 'e) ty -> 'a -> variant = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[394,10978+11]..[405,11322+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+0]..[428,12219+30])
    Pstr_value Rec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+8]..[407,11329+70]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+8]..[407,11329+20])
            Ppat_var "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+8]..[407,11329+20])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+8]..[428,12219+30]) ghost
            Ptyp_poly 't 'e
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+33]..[407,11329+70])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+33]..[407,11329+41])
                Ptyp_constr "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+35]..[407,11329+41])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+33]..[407,11329+34])
                    Ptyp_var e
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+45]..[407,11329+70])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+45]..[407,11329+54])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+52]..[407,11329+54])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+46]..[407,11329+47])
                      Ptyp_var t
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+49]..[407,11329+50])
                      Ptyp_var e
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+58]..[407,11329+70])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+58]..[407,11329+65])
                    Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+58]..[407,11329+65])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+69]..[407,11329+70])
                    Ptyp_var t
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+8]..[428,12219+30])
          Pexp_newtype "t"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+8]..[428,12219+30])
            Pexp_newtype "e"
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+8]..[428,12219+30])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+2]..[428,12219+30])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+6]..[408,11402+7])
                  Ppat_var "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+6]..[408,11402+7])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+8]..[428,12219+30]) ghost
                  Pexp_fun
                  Nolabel
                  None
                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+8]..[408,11402+10])
                    Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+8]..[408,11402+10])
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+11]..[428,12219+30]) ghost
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+11]..[408,11402+12])
                      Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[408,11402+11]..[408,11402+12])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[409,11418+2]..[428,12219+30])
                      Pexp_match
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[409,11418+8]..[409,11418+13])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[409,11418+8]..[409,11418+10])
                            Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[409,11418+8]..[409,11418+10])
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[409,11418+12]..[409,11418+13])
                            Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[409,11418+12]..[409,11418+13])
                        ]
                      [
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+4]..[410,11437+15])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+4]..[410,11437+7])
                                Ppat_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+4]..[410,11437+7])
                                None
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+9]..[410,11437+15])
                                Ppat_construct "VInt" (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+9]..[410,11437+13])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+14]..[410,11437+15])
                                    Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+14]..[410,11437+15])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+19]..[410,11437+20])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[410,11437+19]..[410,11437+20])
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+4]..[411,11458+21])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+4]..[411,11458+10])
                                Ppat_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+4]..[411,11458+10])
                                None
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+12]..[411,11458+21])
                                Ppat_construct "VString" (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+12]..[411,11458+19])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+20]..[411,11458+21])
                                    Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+20]..[411,11458+21])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+25]..[411,11458+26])
                            Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[411,11458+25]..[411,11458+26])
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+4]..[412,11485+22])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+4]..[412,11485+12])
                                Ppat_construct "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+4]..[412,11485+8])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+9]..[412,11485+12])
                                    Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+9]..[412,11485+12])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+14]..[412,11485+22])
                                Ppat_construct "VList" (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+14]..[412,11485+19])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+20]..[412,11485+22])
                                    Ppat_var "vl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[412,11485+20]..[412,11485+22])
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+6]..[413,11511+38])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+6]..[413,11511+14])
                              Pexp_ident "List.map" (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+6]..[413,11511+14])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+15]..[413,11511+35])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+16]..[413,11511+28])
                                    Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+16]..[413,11511+28])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+29]..[413,11511+30])
                                        Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+29]..[413,11511+30])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+31]..[413,11511+34])
                                        Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+31]..[413,11511+34])
                                  ]
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+36]..[413,11511+38])
                                  Pexp_ident "vl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[413,11511+36]..[413,11511+38])
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+4]..[414,11550+35])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+4]..[414,11550+19])
                                Ppat_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+4]..[414,11550+8])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+9]..[414,11550+19])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+10]..[414,11550+13])
                                        Ppat_var "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+10]..[414,11550+13])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+15]..[414,11550+18])
                                        Ppat_var "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+15]..[414,11550+18])
                                    ]
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+21]..[414,11550+35])
                                Ppat_construct "VPair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+21]..[414,11550+26])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+27]..[414,11550+35])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+28]..[414,11550+30])
                                        Ppat_var "x1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+28]..[414,11550+30])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+32]..[414,11550+34])
                                        Ppat_var "x2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[414,11550+32]..[414,11550+34])
                                    ]
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+6]..[415,11589+52])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+7]..[415,11589+28])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+7]..[415,11589+19])
                                  Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+7]..[415,11589+19])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+20]..[415,11589+21])
                                      Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+20]..[415,11589+21])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+22]..[415,11589+25])
                                      Pexp_ident "ty1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+22]..[415,11589+25])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+26]..[415,11589+28])
                                      Pexp_ident "x1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+26]..[415,11589+28])
                                ]
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+30]..[415,11589+51])
                                Pexp_apply
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+30]..[415,11589+42])
                                  Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+30]..[415,11589+42])
                                [
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+43]..[415,11589+44])
                                      Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+43]..[415,11589+44])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+45]..[415,11589+48])
                                      Pexp_ident "ty2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+45]..[415,11589+48])
                                  <arg>
                                  Nolabel
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+49]..[415,11589+51])
                                      Pexp_ident "x2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[415,11589+49]..[415,11589+51])
                                ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+4]..[416,11642+12])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+4]..[416,11642+9])
                                Ppat_construct "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+4]..[416,11642+7])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+8]..[416,11642+9])
                                    Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+8]..[416,11642+9])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+11]..[416,11642+12])
                                Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+16]..[416,11642+48])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+16]..[416,11642+28])
                              Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+16]..[416,11642+28])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+29]..[416,11642+44])
                                  Pexp_construct "Econs" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+30]..[416,11642+35])
                                  Some
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+36]..[416,11642+43])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+37]..[416,11642+39])
                                          Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+37]..[416,11642+39])
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+41]..[416,11642+42])
                                          Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+41]..[416,11642+42])
                                      ]
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+45]..[416,11642+46])
                                  Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+45]..[416,11642+46])
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+47]..[416,11642+48])
                                  Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[416,11642+47]..[416,11642+48])
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+4]..[417,11691+12])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+4]..[417,11691+9])
                                Ppat_construct "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+4]..[417,11691+7])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+8]..[417,11691+9])
                                    Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+8]..[417,11691+9])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+11]..[417,11691+12])
                                Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+16]..[417,11691+67])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+23]..[417,11691+24])
                              Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+23]..[417,11691+24])
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+30]..[417,11691+43])
                                  Ppat_construct "Econs" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+30]..[417,11691+35])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+36]..[417,11691+43])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+37]..[417,11691+38])
                                          Ppat_any
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+40]..[417,11691+42])
                                          Ppat_var "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+40]..[417,11691+42])
                                      ]
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+47]..[417,11691+66])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+47]..[417,11691+59])
                                    Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+47]..[417,11691+59])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+60]..[417,11691+62])
                                        Pexp_ident "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+60]..[417,11691+62])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+63]..[417,11691+64])
                                        Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+63]..[417,11691+64])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+65]..[417,11691+66])
                                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[417,11691+65]..[417,11691+66])
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+4]..[418,11759+10])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+4]..[418,11759+7])
                                Ppat_construct "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+4]..[418,11759+7])
                                None
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+9]..[418,11759+10])
                                Ppat_any
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+14]..[418,11759+65])
                            Pexp_match
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+21]..[418,11759+22])
                              Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+21]..[418,11759+22])
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+28]..[418,11759+41])
                                  Ppat_construct "Econs" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+28]..[418,11759+33])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+34]..[418,11759+41])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+35]..[418,11759+36])
                                          Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+35]..[418,11759+36])
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+38]..[418,11759+40])
                                          Ppat_var "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+38]..[418,11759+40])
                                      ]
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+45]..[418,11759+64])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+45]..[418,11759+57])
                                    Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+45]..[418,11759+57])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+58]..[418,11759+60])
                                        Pexp_ident "e'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+58]..[418,11759+60])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+61]..[418,11759+62])
                                        Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+61]..[418,11759+62])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+63]..[418,11759+64])
                                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[418,11759+63]..[418,11759+64])
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+4]..[419,11825+41])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+4]..[419,11825+26])
                                Ppat_construct "Conv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+4]..[419,11825+8])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+9]..[419,11825+26])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+10]..[419,11825+11])
                                        Ppat_var "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+10]..[419,11825+11])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+13]..[419,11825+17])
                                        Ppat_var "proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+13]..[419,11825+17])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+19]..[419,11825+22])
                                        Ppat_var "inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+19]..[419,11825+22])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+24]..[419,11825+25])
                                        Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+24]..[419,11825+25])
                                    ]
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+28]..[419,11825+41])
                                Ppat_construct "VConv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+28]..[419,11825+33])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+34]..[419,11825+41])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+35]..[419,11825+37])
                                        Ppat_var "s'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+35]..[419,11825+37])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+39]..[419,11825+40])
                                        Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+39]..[419,11825+40])
                                    ]
                            ]
                          <when>
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+47]..[419,11825+53])
                              Pexp_apply
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+49]..[419,11825+50])
                                Pexp_ident "=" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+49]..[419,11825+50])
                              [
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+47]..[419,11825+48])
                                    Pexp_ident "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+47]..[419,11825+48])
                                <arg>
                                Nolabel
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+51]..[419,11825+53])
                                    Pexp_ident "s'" (testsuite/tests/typing-gadts/dynamic_frisch.ml[419,11825+51]..[419,11825+53])
                              ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+6]..[420,11882+30])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+6]..[420,11882+9])
                              Pexp_ident "inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+6]..[420,11882+9])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+10]..[420,11882+30])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+11]..[420,11882+23])
                                    Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+11]..[420,11882+23])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+24]..[420,11882+25])
                                        Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+24]..[420,11882+25])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+26]..[420,11882+27])
                                        Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+26]..[420,11882+27])
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+28]..[420,11882+29])
                                        Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[420,11882+28]..[420,11882+29])
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+4]..[421,11913+26])
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+4]..[421,11913+11])
                                Ppat_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+4]..[421,11913+7])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+8]..[421,11913+11])
                                    Ppat_var "ops" (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+8]..[421,11913+11])
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+13]..[421,11913+26])
                                Ppat_construct "VSum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+13]..[421,11913+17])
                                Some
                                  []
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+18]..[421,11913+26])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+19]..[421,11913+22])
                                        Ppat_var "tag" (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+19]..[421,11913+22])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+24]..[421,11913+25])
                                        Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[421,11913+24]..[421,11913+25])
                                    ]
                            ]
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+6]..[427,12209+9])
                            Pexp_try
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+16]..[425,12128+34])
                              Pexp_match
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+22]..[422,11943+53])
                                Pexp_tuple
                                [
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+22]..[422,11943+50])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+22]..[422,11943+32])
                                      Pexp_ident "List.assoc" (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+22]..[422,11943+32])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+33]..[422,11943+36])
                                          Pexp_ident "tag" (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+33]..[422,11943+36])
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+37]..[422,11943+50])
                                          Pexp_field
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+37]..[422,11943+40])
                                            Pexp_ident "ops" (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+37]..[422,11943+40])
                                          "sum_cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+41]..[422,11943+50])
                                    ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+52]..[422,11943+53])
                                    Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[422,11943+52]..[422,11943+53])
                                ]
                              [
                                <case>
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+8]..[423,12002+30])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+8]..[423,12002+22])
                                        Ppat_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+8]..[423,12002+13])
                                        Some
                                          []
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+14]..[423,12002+22])
                                            Ppat_tuple
                                            [
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+15]..[423,12002+18])
                                                Ppat_var "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+15]..[423,12002+18])
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+20]..[423,12002+21])
                                                Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+20]..[423,12002+21])
                                            ]
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+24]..[423,12002+30])
                                        Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+24]..[423,12002+28])
                                        Some
                                          []
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+29]..[423,12002+30])
                                            Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+29]..[423,12002+30])
                                    ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+34]..[423,12002+71])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+34]..[423,12002+45])
                                      Pexp_field
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+34]..[423,12002+37])
                                        Pexp_ident "ops" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+34]..[423,12002+37])
                                      "sum_inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+38]..[423,12002+45])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+46]..[423,12002+71])
                                          Pexp_tuple
                                          [
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+47]..[423,12002+50])
                                              Pexp_ident "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+47]..[423,12002+50])
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+52]..[423,12002+70])
                                              Pexp_apply
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+52]..[423,12002+64])
                                                Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+52]..[423,12002+64])
                                              [
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+65]..[423,12002+66])
                                                    Pexp_ident "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+65]..[423,12002+66])
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+67]..[423,12002+68])
                                                    Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+67]..[423,12002+68])
                                                <arg>
                                                Nolabel
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+69]..[423,12002+70])
                                                    Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[423,12002+69]..[423,12002+70])
                                              ]
                                          ]
                                    ]
                                <case>
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+8]..[424,12074+25])
                                    Ppat_tuple
                                    [
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+8]..[424,12074+19])
                                        Ppat_construct "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+8]..[424,12074+15])
                                        Some
                                          []
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+16]..[424,12074+19])
                                            Ppat_var "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+16]..[424,12074+19])
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+21]..[424,12074+25])
                                        Ppat_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+21]..[424,12074+25])
                                        None
                                    ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+29]..[424,12074+53])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+29]..[424,12074+40])
                                      Pexp_field
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+29]..[424,12074+32])
                                        Pexp_ident "ops" (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+29]..[424,12074+32])
                                      "sum_inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+33]..[424,12074+40])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+41]..[424,12074+53])
                                          Pexp_tuple
                                          [
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+42]..[424,12074+45])
                                              Pexp_ident "sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+42]..[424,12074+45])
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+47]..[424,12074+52])
                                              Pexp_construct "Noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[424,12074+47]..[424,12074+52])
                                              None
                                          ]
                                    ]
                                <case>
                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[425,12128+8]..[425,12128+9])
                                    Ppat_any
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[425,12128+13]..[425,12128+34])
                                    Pexp_apply
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[425,12128+13]..[425,12128+18])
                                      Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[425,12128+13]..[425,12128+18])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[425,12128+19]..[425,12128+34])
                                          Pexp_construct "VariantMismatch" (testsuite/tests/typing-gadts/dynamic_frisch.ml[425,12128+19]..[425,12128+34])
                                          None
                                    ]
                              ]
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[426,12163+11]..[426,12163+20])
                                  Ppat_construct "Not_found" (testsuite/tests/typing-gadts/dynamic_frisch.ml[426,12163+11]..[426,12163+20])
                                  None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[426,12163+24]..[426,12163+45])
                                  Pexp_apply
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[426,12163+24]..[426,12163+29])
                                    Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[426,12163+24]..[426,12163+29])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[426,12163+30]..[426,12163+45])
                                        Pexp_construct "VariantMismatch" (testsuite/tests/typing-gadts/dynamic_frisch.ml[426,12163+30]..[426,12163+45])
                                        None
                                  ]
                            ]
                        <case>
                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[428,12219+4]..[428,12219+5])
                            Ppat_any
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[428,12219+9]..[428,12219+30])
                            Pexp_apply
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[428,12219+9]..[428,12219+14])
                              Pexp_ident "raise" (testsuite/tests/typing-gadts/dynamic_frisch.ml[428,12219+9]..[428,12219+14])
                            [
                              <arg>
                              Nolabel
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[428,12219+15]..[428,12219+30])
                                  Pexp_construct "VariantMismatch" (testsuite/tests/typing-gadts/dynamic_frisch.ml[428,12219+15]..[428,12219+30])
                                  None
                            ]
                      ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+33]..[407,11329+70])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+33]..[407,11329+41])
                  Ptyp_constr "ty_env" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+35]..[407,11329+41])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+33]..[407,11329+34])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+33]..[407,11329+34])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+45]..[407,11329+70])
                  Ptyp_arrow
                  Nolabel
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+45]..[407,11329+54])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+52]..[407,11329+54])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+46]..[407,11329+47])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+46]..[407,11329+47])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+49]..[407,11329+50])
                        Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+49]..[407,11329+50])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+58]..[407,11329+70])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+58]..[407,11329+65])
                      Ptyp_constr "variant" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+58]..[407,11329+65])
                      []
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+69]..[407,11329+70])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[407,11329+69]..[407,11329+70])
                      []
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[430,12253+0]..[432,12334+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[430,12253+9]..[432,12334+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[430,12253+9]..[432,12334+2])
          Pexp_constant PConst_string ("\nval devariantize : 'e ty_env -> ('t, 'e) ty -> variant -> 't = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[430,12253+11]..[432,12334+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+0]..[435,12406+65])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+4]..[435,12406+10])
          Ppat_var "wrap_A" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+4]..[435,12406+10])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+11]..[435,12406+65]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+11]..[435,12406+12])
            Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+11]..[435,12406+12])
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+15]..[435,12406+65])
            Pexp_construct "Conv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+15]..[435,12406+19])
            Some
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+20]..[435,12406+65])
                Pexp_tuple
                [
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+21]..[435,12406+25])
                    Pexp_constant PConst_string("`A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+22]..[435,12406+24]),None)
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+27]..[435,12406+44])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+32]..[435,12406+38])
                      Ppat_variant "A"
                      Some
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+36]..[435,12406+37])
                          Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+36]..[435,12406+37])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+42]..[435,12406+43])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+42]..[435,12406+43])
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+46]..[435,12406+61])
                    Pexp_fun
                    Nolabel
                    None
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+51]..[435,12406+52])
                      Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+51]..[435,12406+52])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+56]..[435,12406+60])
                      Pexp_variant "A"
                      Some
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+59]..[435,12406+60])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+59]..[435,12406+60])
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+63]..[435,12406+64])
                    Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[435,12406+63]..[435,12406+64])
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[436,12474+0]..[438,12544+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[436,12474+9]..[438,12544+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[436,12474+9]..[438,12544+2])
          Pexp_constant PConst_string ("\nval wrap_A : ('a, 'b) ty -> ([ `A of 'a ], 'b) ty = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[436,12474+11]..[438,12544+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+0]..[440,12551+48])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+4]..[440,12551+6])
          Ppat_var "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+4]..[440,12551+6])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+7]..[440,12551+48]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+7]..[440,12551+8])
            Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+7]..[440,12551+8])
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+11]..[440,12551+48])
            Pexp_construct "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+11]..[440,12551+14])
            Some
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+15]..[440,12551+48])
                Pexp_apply
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+16]..[440,12551+22])
                  Pexp_ident "wrap_A" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+16]..[440,12551+22])
                [
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+23]..[440,12551+47])
                      Pexp_construct "Option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+24]..[440,12551+30])
                      Some
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+31]..[440,12551+46])
                          Pexp_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+32]..[440,12551+36])
                          Some
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+37]..[440,12551+45])
                              Pexp_tuple
                              [
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+38]..[440,12551+39])
                                  Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+38]..[440,12551+39])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+41]..[440,12551+44])
                                  Pexp_construct "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[440,12551+41]..[440,12551+44])
                                  None
                              ]
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[441,12603+0]..[444,12699+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[441,12603+9]..[444,12699+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[441,12603+9]..[444,12699+2])
          Pexp_constant PConst_string ("\nval ty : ('a, ([ `A of ('a * 'b) option ] as 'b) -> 'c) ty -> ('b, 'c) ty =\n  <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[441,12603+11]..[444,12699+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+0]..[445,12705+32])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+4]..[445,12705+5])
          Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+4]..[445,12705+5])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+8]..[445,12705+32])
          Pexp_apply
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+8]..[445,12705+18])
            Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+8]..[445,12705+18])
          [
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+19]..[445,12705+23])
                Pexp_construct "Enil" (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+19]..[445,12705+23])
                None
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+24]..[445,12705+32])
                Pexp_apply
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+25]..[445,12705+27])
                  Pexp_ident "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+25]..[445,12705+27])
                [
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+28]..[445,12705+31])
                      Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[445,12705+28]..[445,12705+31])
                      None
                ]
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[446,12740+0]..[448,12815+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[446,12740+9]..[448,12815+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[446,12740+9]..[448,12815+2])
          Pexp_constant PConst_string ("\nval v : ([ `A of (int * 'a) option ] as 'a) -> variant = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[446,12740+11]..[448,12815+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+0]..[449,12821+49])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+4]..[449,12821+5])
          Ppat_var "x" (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+4]..[449,12821+5])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+8]..[449,12821+49])
          Pexp_apply
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+8]..[449,12821+9])
            Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+8]..[449,12821+9])
          [
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+10]..[449,12821+49])
                Pexp_variant "A"
                Some
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+14]..[449,12821+48])
                    Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+15]..[449,12821+19])
                    Some
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+20]..[449,12821+47])
                        Pexp_tuple
                        [
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+21]..[449,12821+22])
                            Pexp_constant PConst_int (1,None)
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+24]..[449,12821+46])
                            Pexp_variant "A"
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+27]..[449,12821+46])
                                Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+28]..[449,12821+32])
                                Some
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+33]..[449,12821+45])
                                    Pexp_tuple
                                    [
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+34]..[449,12821+35])
                                        Pexp_constant PConst_int (2,None)
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+37]..[449,12821+44])
                                        Pexp_variant "A"
                                        Some
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+40]..[449,12821+44])
                                            Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[449,12821+40]..[449,12821+44])
                                            None
                                    ]
                        ]
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[450,12874+0]..[458,13057+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[450,12874+9]..[458,13057+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[450,12874+9]..[458,13057+2])
          Pexp_constant PConst_string ("\nval x : variant =\n  VConv (\"`A\",\n   VOption\n    (Some\n      (VPair (VInt 1,\n        VConv (\"`A\",\n         VOption (Some (VPair (VInt 2, VConv (\"`A\", VOption None)))))))))\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[450,12874+11]..[458,13057+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+0]..[464,13176+61])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+4]..[462,13108+10])
          Ppat_var "triple" (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+4]..[462,13108+10])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+11]..[464,13176+61]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+11]..[462,13108+13])
            Ppat_var "t1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+11]..[462,13108+13])
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+14]..[464,13176+61]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+14]..[462,13108+16])
              Ppat_var "t2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+14]..[462,13108+16])
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+17]..[464,13176+61]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+17]..[462,13108+19])
                Ppat_var "t3" (testsuite/tests/typing-gadts/dynamic_frisch.ml[462,13108+17]..[462,13108+19])
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+2]..[464,13176+61])
                Pexp_construct "Conv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+2]..[463,13130+6])
                Some
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+7]..[464,13176+61])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+8]..[463,13130+16])
                        Pexp_constant PConst_string("Triple",(testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+9]..[463,13130+15]),None)
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+18]..[463,13130+44])
                        Pexp_fun
                        Nolabel
                        None
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+23]..[463,13130+30])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+24]..[463,13130+25])
                              Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+24]..[463,13130+25])
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+26]..[463,13130+27])
                              Ppat_var "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+26]..[463,13130+27])
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+28]..[463,13130+29])
                              Ppat_var "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+28]..[463,13130+29])
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+34]..[463,13130+43])
                          Pexp_tuple
                          [
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+35]..[463,13130+36])
                              Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+35]..[463,13130+36])
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+37]..[463,13130+42])
                              Pexp_tuple
                              [
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+38]..[463,13130+39])
                                  Pexp_ident "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+38]..[463,13130+39])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+40]..[463,13130+41])
                                  Pexp_ident "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[463,13130+40]..[463,13130+41])
                              ]
                          ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+8]..[464,13176+34])
                        Pexp_fun
                        Nolabel
                        None
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+13]..[464,13176+22])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+14]..[464,13176+15])
                              Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+14]..[464,13176+15])
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+16]..[464,13176+21])
                              Ppat_tuple
                              [
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+17]..[464,13176+18])
                                  Ppat_var "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+17]..[464,13176+18])
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+19]..[464,13176+20])
                                  Ppat_var "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+19]..[464,13176+20])
                              ]
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+26]..[464,13176+33])
                          Pexp_tuple
                          [
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+27]..[464,13176+28])
                              Pexp_ident "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+27]..[464,13176+28])
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+29]..[464,13176+30])
                              Pexp_ident "b" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+29]..[464,13176+30])
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+31]..[464,13176+32])
                              Pexp_ident "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+31]..[464,13176+32])
                          ]
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+36]..[464,13176+60])
                        Pexp_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+36]..[464,13176+40])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+41]..[464,13176+60])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+42]..[464,13176+44])
                                Pexp_ident "t1" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+42]..[464,13176+44])
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+46]..[464,13176+59])
                                Pexp_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+46]..[464,13176+50])
                                Some
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+51]..[464,13176+59])
                                    Pexp_tuple
                                    [
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+52]..[464,13176+54])
                                        Pexp_ident "t2" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+52]..[464,13176+54])
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+56]..[464,13176+58])
                                        Pexp_ident "t3" (testsuite/tests/typing-gadts/dynamic_frisch.ml[464,13176+56]..[464,13176+58])
                                    ]
                            ]
                    ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[465,13240+0]..[468,13342+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[465,13240+9]..[468,13342+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[465,13240+9]..[468,13342+2])
          Pexp_constant PConst_string ("\nval triple :\n  ('a, 'b) ty -> ('c, 'b) ty -> ('d, 'b) ty -> ('a * 'c * 'd, 'b) ty = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[465,13240+11]..[468,13342+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+0]..[470,13349+59])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+4]..[470,13349+5])
          Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+4]..[470,13349+5])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+8]..[470,13349+59])
          Pexp_apply
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+8]..[470,13349+18])
            Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+8]..[470,13349+18])
          [
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+19]..[470,13349+23])
                Pexp_construct "Enil" (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+19]..[470,13349+23])
                None
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+24]..[470,13349+47])
                Pexp_apply
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+25]..[470,13349+31])
                  Pexp_ident "triple" (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+25]..[470,13349+31])
                [
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+32]..[470,13349+38])
                      Pexp_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+32]..[470,13349+38])
                      None
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+39]..[470,13349+42])
                      Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+39]..[470,13349+42])
                      None
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+43]..[470,13349+46])
                      Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+43]..[470,13349+46])
                      None
                ]
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+48]..[470,13349+59])
                Pexp_tuple
                [
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+49]..[470,13349+52])
                    Pexp_constant PConst_string("A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+50]..[470,13349+51]),None)
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+54]..[470,13349+55])
                    Pexp_constant PConst_int (2,None)
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[470,13349+57]..[470,13349+58])
                    Pexp_constant PConst_int (3,None)
                ]
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[471,13412+0]..[474,13506+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[471,13412+9]..[474,13506+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[471,13412+9]..[474,13506+2])
          Pexp_constant PConst_string ("\nval v : variant =\n  VConv (\"Triple\", VPair (VString \"A\", VPair (VInt 2, VInt 3)))\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[471,13412+11]..[474,13506+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[477,13566+0]..[493,14252+42])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[477,13566+4]..[477,13566+10])
          Ppat_var "ty_abc" (testsuite/tests/typing-gadts/dynamic_frisch.ml[477,13566+4]..[477,13566+10])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[479,13656+2]..[493,14252+42])
          Pexp_let Nonrec
          [
            <def>
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[479,13656+6]..[479,13656+10])
                Ppat_var "proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[479,13656+6]..[479,13656+10])
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[479,13656+13]..[482,13761+23])
                Pexp_function
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+6]..[480,13678+10])
                      Ppat_variant "A"
                      Some
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+9]..[480,13678+10])
                          Ppat_var "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+9]..[480,13678+10])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+14]..[480,13678+39])
                      Pexp_tuple
                      [
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+14]..[480,13678+17])
                          Pexp_constant PConst_string("A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+15]..[480,13678+16]),None)
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+19]..[480,13678+39])
                          Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+19]..[480,13678+23])
                          Some
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+24]..[480,13678+39])
                              Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+25]..[480,13678+29])
                              Some
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+30]..[480,13678+38])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+31]..[480,13678+34])
                                      Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+31]..[480,13678+34])
                                      None
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+36]..[480,13678+37])
                                      Pexp_ident "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[480,13678+36]..[480,13678+37])
                                  ]
                      ]
                  <case>
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+6]..[481,13718+10])
                      Ppat_variant "B"
                      Some
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+9]..[481,13718+10])
                          Ppat_var "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+9]..[481,13718+10])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+14]..[481,13718+42])
                      Pexp_tuple
                      [
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+14]..[481,13718+17])
                          Pexp_constant PConst_string("B",(testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+15]..[481,13718+16]),None)
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+19]..[481,13718+42])
                          Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+19]..[481,13718+23])
                          Some
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+24]..[481,13718+42])
                              Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+25]..[481,13718+29])
                              Some
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+30]..[481,13718+41])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+31]..[481,13718+37])
                                      Pexp_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+31]..[481,13718+37])
                                      None
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+39]..[481,13718+40])
                                      Pexp_ident "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[481,13718+39]..[481,13718+40])
                                  ]
                      ]
                  <case>
                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[482,13761+6]..[482,13761+8])
                      Ppat_variant "C"
                      None
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[482,13761+14]..[482,13761+23])
                      Pexp_tuple
                      [
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[482,13761+14]..[482,13761+17])
                          Pexp_constant PConst_string("C",(testsuite/tests/typing-gadts/dynamic_frisch.ml[482,13761+15]..[482,13761+16]),None)
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[482,13761+19]..[482,13761+23])
                          Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[482,13761+19]..[482,13761+23])
                          None
                      ]
                ]
            <def>
              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+6]..[485,13932+35]) ghost
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+6]..[484,13862+9])
                  Ppat_var "inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+6]..[484,13862+9])
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+6]..[488,14029+34]) ghost
                  Ptyp_poly 'c
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+20]..[485,13932+35])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+20]..[484,13862+66])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+20]..[484,13862+62])
                          Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+56]..[484,13862+62])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+21]..[484,13862+51])
                              Ptyp_arrow
                              Nolabel
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+21]..[484,13862+24])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+21]..[484,13862+24])
                                []
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+28]..[484,13862+51])
                                Ptyp_arrow
                                Nolabel
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+28]..[484,13862+34])
                                  Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+28]..[484,13862+34])
                                  []
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+38]..[484,13862+51])
                                  Ptyp_arrow
                                  Nolabel
                                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+38]..[484,13862+43])
                                    Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+38]..[484,13862+43])
                                    []
                                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+47]..[484,13862+51])
                                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+47]..[484,13862+51])
                                    []
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+53]..[484,13862+54])
                              Ptyp_var c
                          ]
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+65]..[484,13862+66])
                          Ptyp_var c
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+4]..[485,13932+35])
                      Ptyp_variant closed=Closed
                      [
                        Rtag "A" false
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+11]..[485,13932+14])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+11]..[485,13932+14])
                              []
                          ]
                        Rtag "B" false
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+23]..[485,13932+29])
                              Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+23]..[485,13932+29])
                              []
                          ]
                        Rtag "C" true
                          []
                      ]
                      None
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+6]..[488,14029+34])
                Pexp_newtype "c"
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+6]..[488,14029+34])
                  Pexp_constraint
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+38]..[488,14029+34])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+8]..[486,13979+14])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+8]..[486,13979+11])
                              Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+8]..[486,13979+11])
                              None
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+13]..[486,13979+14])
                              Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+13]..[486,13979+14])
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+18]..[486,13979+22])
                          Pexp_variant "A"
                          Some
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+21]..[486,13979+22])
                              Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[486,13979+21]..[486,13979+22])
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+8]..[487,14002+18])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+8]..[487,14002+15])
                              Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+8]..[487,14002+11])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+12]..[487,14002+15])
                                  Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+12]..[487,14002+15])
                                  None
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+17]..[487,14002+18])
                              Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+17]..[487,14002+18])
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+22]..[487,14002+26])
                          Pexp_variant "B"
                          Some
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+25]..[487,14002+26])
                              Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[487,14002+25]..[487,14002+26])
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+8]..[488,14029+28])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+8]..[488,14029+21])
                              Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+8]..[488,14029+11])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+12]..[488,14029+21])
                                  Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+13]..[488,14029+16])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+17]..[488,14029+20])
                                      Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+17]..[488,14029+20])
                                      None
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+23]..[488,14029+28])
                              Ppat_construct "Noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+23]..[488,14029+28])
                              None
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[488,14029+32]..[488,14029+34])
                          Pexp_variant "C"
                          None
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+20]..[485,13932+35])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+20]..[484,13862+66])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+20]..[484,13862+62])
                          Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+56]..[484,13862+62])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+21]..[484,13862+51])
                              Ptyp_arrow
                              Nolabel
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+21]..[484,13862+24])
                                Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+21]..[484,13862+24])
                                []
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+28]..[484,13862+51])
                                Ptyp_arrow
                                Nolabel
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+28]..[484,13862+34])
                                  Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+28]..[484,13862+34])
                                  []
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+38]..[484,13862+51])
                                  Ptyp_arrow
                                  Nolabel
                                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+38]..[484,13862+43])
                                    Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+38]..[484,13862+43])
                                    []
                                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+47]..[484,13862+51])
                                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+47]..[484,13862+51])
                                    []
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+53]..[484,13862+54])
                              Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+53]..[484,13862+54])
                              []
                          ]
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+65]..[484,13862+66])
                          Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[484,13862+65]..[484,13862+66])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+4]..[485,13932+35])
                      Ptyp_variant closed=Closed
                      [
                        Rtag "A" false
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+11]..[485,13932+14])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+11]..[485,13932+14])
                              []
                          ]
                        Rtag "B" false
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+23]..[485,13932+29])
                              Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[485,13932+23]..[485,13932+29])
                              []
                          ]
                        Rtag "C" true
                          []
                      ]
                      None
          ]
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+2]..[493,14252+42])
            Pexp_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+2]..[491,14137+5])
            Some
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+6]..[493,14252+42])
                Pexp_record
                [
                  "sum_proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+8]..[491,14137+16])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+19]..[491,14137+23])
                      Pexp_ident "proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+19]..[491,14137+23])
                  "sum_inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+25]..[491,14137+32])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+35]..[491,14137+38])
                      Pexp_ident "inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+35]..[491,14137+38])
                  "sum_cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[491,14137+40]..[491,14137+49])
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+8]..[493,14252+40])
                      Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+10]..[493,14252+40]) ghost
                      Some
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+10]..[493,14252+40]) ghost
                          Pexp_tuple
                          [
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+10]..[492,14189+31])
                              Pexp_tuple
                              [
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+10]..[492,14189+13])
                                  Pexp_constant PConst_string("A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+11]..[492,14189+12]),None)
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+15]..[492,14189+31])
                                  Pexp_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+15]..[492,14189+20])
                                  Some
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+21]..[492,14189+31])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+22]..[492,14189+25])
                                          Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+22]..[492,14189+25])
                                          None
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+27]..[492,14189+30])
                                          Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+27]..[492,14189+30])
                                          None
                                      ]
                              ]
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+33]..[493,14252+40]) ghost
                              Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+33]..[493,14252+40]) ghost
                              Some
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+33]..[493,14252+40]) ghost
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+33]..[492,14189+61])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+33]..[492,14189+36])
                                          Pexp_constant PConst_string("B",(testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+34]..[492,14189+35]),None)
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+38]..[492,14189+61])
                                          Pexp_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+38]..[492,14189+43])
                                          Some
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+44]..[492,14189+61])
                                              Pexp_tuple
                                              [
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+45]..[492,14189+52])
                                                  Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+45]..[492,14189+48])
                                                  Some
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+49]..[492,14189+52])
                                                      Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+49]..[492,14189+52])
                                                      None
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+54]..[492,14189+60])
                                                  Pexp_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[492,14189+54]..[492,14189+60])
                                                  None
                                              ]
                                      ]
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+10]..[493,14252+40]) ghost
                                      Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+10]..[493,14252+40]) ghost
                                      Some
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+10]..[493,14252+40]) ghost
                                          Pexp_tuple
                                          [
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+10]..[493,14252+38])
                                              Pexp_tuple
                                              [
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+10]..[493,14252+13])
                                                  Pexp_constant PConst_string("C",(testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+11]..[493,14252+12]),None)
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+15]..[493,14252+38])
                                                  Pexp_construct "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+15]..[493,14252+22])
                                                  Some
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+23]..[493,14252+38])
                                                      Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+24]..[493,14252+27])
                                                      Some
                                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+28]..[493,14252+37])
                                                          Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+29]..[493,14252+32])
                                                          Some
                                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+33]..[493,14252+36])
                                                              Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+33]..[493,14252+36])
                                                              None
                                              ]
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+39]..[493,14252+40]) ghost
                                              Pexp_construct "[]" (testsuite/tests/typing-gadts/dynamic_frisch.ml[493,14252+39]..[493,14252+40]) ghost
                                              None
                                          ]
                                  ]
                          ]
                ]
                None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[495,14298+0]..[503,14535+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[495,14298+9]..[503,14535+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[495,14298+9]..[503,14535+2])
          Pexp_constant PConst_string ("\nval ty_abc : ([ `A of int | `B of string | `C ], 'a) ty =\n  Sum\n   {sum_proj = <fun>;\n    sum_cases =\n     [(\"A\", TCarg (Thd, Int)); (\"B\", TCarg (Ttl Thd, String));\n      (\"C\", TCnoarg (Ttl (Ttl Thd)))];\n    sum_inj = <fun>}\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[495,14298+11]..[503,14535+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+0]..[505,14542+37])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+4]..[505,14542+5])
          Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+4]..[505,14542+5])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+8]..[505,14542+37])
          Pexp_apply
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+8]..[505,14542+18])
            Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+8]..[505,14542+18])
          [
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+19]..[505,14542+23])
                Pexp_construct "Enil" (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+19]..[505,14542+23])
                None
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+24]..[505,14542+30])
                Pexp_ident "ty_abc" (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+24]..[505,14542+30])
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+31]..[505,14542+37])
                Pexp_variant "A"
                Some
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[505,14542+35]..[505,14542+36])
                    Pexp_constant PConst_int (3,None)
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[506,14582+0]..[508,14638+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[506,14582+9]..[508,14638+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[506,14582+9]..[508,14638+2])
          Pexp_constant PConst_string ("\nval v : variant = VSum (\"A\", Some (VInt 3))\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[506,14582+11]..[508,14638+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+0]..[509,14644+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+4]..[509,14644+5])
          Ppat_var "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+4]..[509,14644+5])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+8]..[509,14644+34])
          Pexp_apply
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+8]..[509,14644+20])
            Pexp_ident "devariantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+8]..[509,14644+20])
          [
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+21]..[509,14644+25])
                Pexp_construct "Enil" (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+21]..[509,14644+25])
                None
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+26]..[509,14644+32])
                Pexp_ident "ty_abc" (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+26]..[509,14644+32])
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+33]..[509,14644+34])
                Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[509,14644+33]..[509,14644+34])
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[510,14681+0]..[512,14742+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[510,14681+9]..[512,14742+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[510,14681+9]..[512,14742+2])
          Pexp_constant PConst_string ("\nval a : [ `A of int | `B of string | `C ] = `A 3\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[510,14681+11]..[512,14742+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+0]..[515,14788+47])
    Pstr_type Rec
    [
      type_declaration "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+8]..[515,14788+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+0]..[515,14788+47])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+5]..[515,14788+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+16]..[515,14788+47])
              Ptyp_variant closed=Closed
              [
                Rtag "Nil" true
                  []
                Rtag "Cons" false
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+33]..[515,14788+46])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+33]..[515,14788+35])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+38]..[515,14788+46])
                          Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+41]..[515,14788+46])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[515,14788+38]..[515,14788+40])
                              Ptyp_var a
                          ]
                      ]
                  ]
              ]
              None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+0]..[531,15385+7])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+4]..[518,14840+52]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+4]..[518,14840+11])
            Ppat_var "ty_list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+4]..[518,14840+11])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+4]..[531,15385+7]) ghost
            Ptyp_poly 'a 'e
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+24]..[518,14840+52])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+24]..[518,14840+33])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+31]..[518,14840+33])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+25]..[518,14840+26])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+28]..[518,14840+29])
                    Ptyp_var e
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+37]..[518,14840+52])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+50]..[518,14840+52])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+38]..[518,14840+45])
                    Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+40]..[518,14840+45])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+38]..[518,14840+39])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+47]..[518,14840+48])
                    Ptyp_var e
                ]
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+4]..[531,15385+7])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+4]..[531,15385+7])
            Pexp_newtype "e"
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+4]..[531,15385+7])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+55]..[531,15385+7])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+59]..[518,14840+60])
                  Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+59]..[518,14840+60])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+2]..[531,15385+7])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+6]..[519,14904+11])
                        Ppat_var "tcons" (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+6]..[519,14904+11])
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+14]..[519,14904+31])
                        Pexp_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+14]..[519,14904+18])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+19]..[519,14904+31])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+20]..[519,14904+25])
                                Pexp_construct "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+20]..[519,14904+23])
                                Some
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+24]..[519,14904+25])
                                    Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+24]..[519,14904+25])
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+27]..[519,14904+30])
                                Pexp_construct "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[519,14904+27]..[519,14904+30])
                                None
                            ]
                  ]
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[520,14939+2]..[531,15385+7])
                    Pexp_construct "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[520,14939+2]..[520,14939+5])
                    Some
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[520,14939+6]..[531,15385+7])
                        Pexp_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[520,14939+7]..[520,14939+10])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[520,14939+11]..[531,15385+6])
                            Pexp_record
                            [
                              "sum_proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[521,14952+7]..[521,14952+15])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[521,14952+18]..[523,15011+53])
                                  Pexp_function
                                  [
                                    <case>
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[522,14980+11]..[522,14980+15])
                                        Ppat_variant "Nil"
                                        None
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[522,14980+19]..[522,14980+30])
                                        Pexp_tuple
                                        [
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[522,14980+19]..[522,14980+24])
                                            Pexp_constant PConst_string("Nil",(testsuite/tests/typing-gadts/dynamic_frisch.ml[522,14980+20]..[522,14980+23]),None)
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[522,14980+26]..[522,14980+30])
                                            Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[522,14980+26]..[522,14980+30])
                                            None
                                        ]
                                    <case>
                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+11]..[523,15011+18])
                                        Ppat_variant "Cons"
                                        Some
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+17]..[523,15011+18])
                                            Ppat_var "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+17]..[523,15011+18])
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+22]..[523,15011+52])
                                        Pexp_tuple
                                        [
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+22]..[523,15011+28])
                                            Pexp_constant PConst_string("Cons",(testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+23]..[523,15011+27]),None)
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+30]..[523,15011+52])
                                            Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+30]..[523,15011+34])
                                            Some
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+35]..[523,15011+52])
                                                Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+36]..[523,15011+40])
                                                Some
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+41]..[523,15011+51])
                                                    Pexp_tuple
                                                    [
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+42]..[523,15011+47])
                                                        Pexp_ident "tcons" (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+42]..[523,15011+47])
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+49]..[523,15011+50])
                                                        Pexp_ident "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[523,15011+49]..[523,15011+50])
                                                    ]
                                        ]
                                  ]
                              "sum_cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+7]..[524,15066+16])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+19]..[524,15066+71])
                                  Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+20]..[524,15066+71]) ghost
                                  Some
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+20]..[524,15066+71]) ghost
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+20]..[524,15066+38])
                                          Pexp_tuple
                                          [
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+20]..[524,15066+25])
                                              Pexp_constant PConst_string("Nil",(testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+21]..[524,15066+24]),None)
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+27]..[524,15066+38])
                                              Pexp_construct "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+27]..[524,15066+34])
                                              Some
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+35]..[524,15066+38])
                                                  Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+35]..[524,15066+38])
                                                  None
                                          ]
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+40]..[524,15066+71]) ghost
                                          Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+40]..[524,15066+71]) ghost
                                          Some
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+40]..[524,15066+71]) ghost
                                              Pexp_tuple
                                              [
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+40]..[524,15066+70])
                                                  Pexp_tuple
                                                  [
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+40]..[524,15066+46])
                                                      Pexp_constant PConst_string("Cons",(testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+41]..[524,15066+45]),None)
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+48]..[524,15066+70])
                                                      Pexp_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+48]..[524,15066+53])
                                                      Some
                                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+54]..[524,15066+70])
                                                          Pexp_tuple
                                                          [
                                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+55]..[524,15066+62])
                                                              Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+55]..[524,15066+58])
                                                              Some
                                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+59]..[524,15066+62])
                                                                  Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+59]..[524,15066+62])
                                                                  None
                                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+64]..[524,15066+69])
                                                              Pexp_ident "tcons" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+64]..[524,15066+69])
                                                          ]
                                                  ]
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+70]..[524,15066+71]) ghost
                                                  Pexp_construct "[]" (testsuite/tests/typing-gadts/dynamic_frisch.ml[524,15066+70]..[524,15066+71]) ghost
                                                  None
                                              ]
                                      ]
                              "sum_inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[525,15139+7]..[525,15139+14])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[525,15139+17]..[529,15254+67])
                                  Pexp_newtype "c"
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[526,15172+9]..[529,15254+67])
                                    Pexp_constraint
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[526,15172+10]..[528,15221+32])
                                      Pexp_function
                                      [
                                        <case>
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[527,15191+11]..[527,15191+21])
                                            Ppat_tuple
                                            [
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[527,15191+11]..[527,15191+14])
                                                Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[527,15191+11]..[527,15191+14])
                                                None
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[527,15191+16]..[527,15191+21])
                                                Ppat_construct "Noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[527,15191+16]..[527,15191+21])
                                                None
                                            ]
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[527,15191+25]..[527,15191+29])
                                            Pexp_variant "Nil"
                                            None
                                        <case>
                                          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+11]..[528,15221+21])
                                            Ppat_tuple
                                            [
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+11]..[528,15221+18])
                                                Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+11]..[528,15221+14])
                                                Some
                                                  []
                                                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+15]..[528,15221+18])
                                                    Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+15]..[528,15221+18])
                                                    None
                                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+20]..[528,15221+21])
                                                Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+20]..[528,15221+21])
                                            ]
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+25]..[528,15221+32])
                                            Pexp_variant "Cons"
                                            Some
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+31]..[528,15221+32])
                                                Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[528,15221+31]..[528,15221+32])
                                      ]
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+11]..[529,15254+66])
                                      Ptyp_arrow
                                      Nolabel
                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+11]..[529,15254+55])
                                        Ptyp_tuple
                                        [
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+11]..[529,15254+51])
                                            Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+45]..[529,15254+51])
                                            [
                                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+12]..[529,15254+40])
                                                Ptyp_arrow
                                                Nolabel
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+12]..[529,15254+17])
                                                  Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+12]..[529,15254+17])
                                                  []
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+21]..[529,15254+40])
                                                  Ptyp_arrow
                                                  Nolabel
                                                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+21]..[529,15254+32])
                                                    Ptyp_tuple
                                                    [
                                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+21]..[529,15254+22])
                                                        Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+21]..[529,15254+22])
                                                        []
                                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+25]..[529,15254+32])
                                                        Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+27]..[529,15254+32])
                                                        [
                                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+25]..[529,15254+26])
                                                            Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+25]..[529,15254+26])
                                                            []
                                                        ]
                                                    ]
                                                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+36]..[529,15254+40])
                                                    Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+36]..[529,15254+40])
                                                    []
                                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+42]..[529,15254+43])
                                                Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+42]..[529,15254+43])
                                                []
                                            ]
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+54]..[529,15254+55])
                                            Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+54]..[529,15254+55])
                                            []
                                        ]
                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+59]..[529,15254+66])
                                        Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+61]..[529,15254+66])
                                        [
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+59]..[529,15254+60])
                                            Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[529,15254+59]..[529,15254+60])
                                            []
                                        ]
                            ]
                            None
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+24]..[518,14840+52])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+24]..[518,14840+33])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+31]..[518,14840+33])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+25]..[518,14840+26])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+25]..[518,14840+26])
                      []
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+28]..[518,14840+29])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+28]..[518,14840+29])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+37]..[518,14840+52])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+50]..[518,14840+52])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+38]..[518,14840+45])
                      Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+40]..[518,14840+45])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+38]..[518,14840+39])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+38]..[518,14840+39])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+47]..[518,14840+48])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[518,14840+47]..[518,14840+48])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[533,15396+0]..[536,15513+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[533,15396+9]..[536,15513+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[533,15396+9]..[536,15513+2])
          Pexp_constant PConst_string ("\ntype 'a vlist = [ `Cons of 'a * 'a vlist | `Nil ]\nval ty_list : ('a, 'e) ty -> ('a vlist, 'e) ty = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[533,15396+11]..[536,15513+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+0]..[538,15520+66])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+4]..[538,15520+5])
          Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+4]..[538,15520+5])
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+8]..[538,15520+66])
          Pexp_apply
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+8]..[538,15520+18])
            Pexp_ident "variantize" (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+8]..[538,15520+18])
          [
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+19]..[538,15520+23])
                Pexp_construct "Enil" (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+19]..[538,15520+23])
                None
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+24]..[538,15520+37])
                Pexp_apply
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+25]..[538,15520+32])
                  Pexp_ident "ty_list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+25]..[538,15520+32])
                [
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+33]..[538,15520+36])
                      Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+33]..[538,15520+36])
                      None
                ]
            <arg>
            Nolabel
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+38]..[538,15520+66])
                Pexp_variant "Cons"
                Some
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+45]..[538,15520+65])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+46]..[538,15520+47])
                        Pexp_constant PConst_int (1,None)
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+49]..[538,15520+64])
                        Pexp_variant "Cons"
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+55]..[538,15520+64])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+56]..[538,15520+57])
                                Pexp_constant PConst_int (2,None)
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[538,15520+59]..[538,15520+63])
                                Pexp_variant "Nil"
                                None
                            ]
                    ]
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[539,15590+0]..[544,15724+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[539,15590+9]..[544,15724+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[539,15590+9]..[544,15724+2])
          Pexp_constant PConst_string ("\nval v : variant =\n  VSum (\"Cons\",\n   Some\n    (VPair (VInt 1, VSum (\"Cons\", Some (VPair (VInt 2, VSum (\"Nil\", None)))))))\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[539,15590+11]..[544,15724+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[548,15766+0]..[561,16274+39])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[548,15766+11]..[548,15766+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[548,15766+0]..[559,16230+27])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[548,15766+6]..[548,15766+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[548,15766+8]..[548,15766+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[549,15782+2]..[549,15782+19])
                "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[549,15782+4]..[549,15782+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[549,15782+9]..[549,15782+19])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[549,15782+17]..[549,15782+19])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[549,15782+10]..[549,15782+13])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[549,15782+10]..[549,15782+13])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[549,15782+14]..[549,15782+15])
                        Ptyp_any
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[550,15802+2]..[550,15802+25])
                "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[550,15802+4]..[550,15802+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[550,15802+12]..[550,15802+25])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[550,15802+23]..[550,15802+25])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[550,15802+13]..[550,15802+19])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[550,15802+13]..[550,15802+19])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[550,15802+20]..[550,15802+21])
                        Ptyp_any
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+2]..[551,15828+40])
                "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+4]..[551,15828+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+10]..[551,15828+20])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+18]..[551,15828+20])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+11]..[551,15828+13])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+14]..[551,15828+16])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+24]..[551,15828+40])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+38]..[551,15828+40])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+25]..[551,15828+32])
                        Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+28]..[551,15828+32])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+25]..[551,15828+27])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[551,15828+34]..[551,15828+36])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+2]..[552,15869+44])
                "Option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+4]..[552,15869+10])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+12]..[552,15869+22])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+20]..[552,15869+22])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+13]..[552,15869+15])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+16]..[552,15869+18])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+26]..[552,15869+44])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+42]..[552,15869+44])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+27]..[552,15869+36])
                        Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+30]..[552,15869+36])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+27]..[552,15869+29])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[552,15869+38]..[552,15869+40])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+2]..[553,15914+54])
                "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+4]..[553,15914+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+11]..[553,15914+34])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+11]..[553,15914+21])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+19]..[553,15914+21])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+12]..[553,15914+14])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+15]..[553,15914+17])
                            Ptyp_var e
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+24]..[553,15914+34])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+32]..[553,15914+34])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+25]..[553,15914+27])
                            Ptyp_var b
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+28]..[553,15914+30])
                            Ptyp_var e
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+39]..[553,15914+54])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+52]..[553,15914+54])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+40]..[553,15914+47])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+40]..[553,15914+42])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+45]..[553,15914+47])
                            Ptyp_var b
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[553,15914+48]..[553,15914+50])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+2]..[554,15969+26])
                "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+4]..[554,15969+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+9]..[554,15969+26])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+24]..[554,15969+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+10]..[554,15969+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+14]..[554,15969+22])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+14]..[554,15969+16])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[554,15969+20]..[554,15969+22])
                          Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+2]..[555,15996+40])
                "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+4]..[555,15996+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+9]..[555,15996+26])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+24]..[555,15996+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+10]..[555,15996+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+14]..[555,15996+22])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+14]..[555,15996+16])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+20]..[555,15996+22])
                          Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+30]..[555,15996+40])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+38]..[555,15996+40])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+31]..[555,15996+33])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[555,15996+34]..[555,15996+36])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+2]..[556,16037+41])
                "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+4]..[556,16037+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+9]..[556,16037+20])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+18]..[556,16037+20])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+10]..[556,16037+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+14]..[556,16037+16])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+24]..[556,16037+41])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+39]..[556,16037+41])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+25]..[556,16037+27])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+29]..[556,16037+37])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+29]..[556,16037+31])
                          Ptyp_var b
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[556,16037+35]..[556,16037+37])
                          Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+2]..[557,16079+71])
                "Conv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+4]..[557,16079+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+10]..[557,16079+16])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+10]..[557,16079+16])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+20]..[557,16079+28])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+20]..[557,16079+22])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+26]..[557,16079+28])
                      Ptyp_var b
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+33]..[557,16079+41])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+33]..[557,16079+35])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+39]..[557,16079+41])
                      Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+45]..[557,16079+56])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+54]..[557,16079+56])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+46]..[557,16079+48])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+50]..[557,16079+52])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+60]..[557,16079+71])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+69]..[557,16079+71])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+61]..[557,16079+63])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[557,16079+65]..[557,16079+67])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+2]..[559,16230+27])
                "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+4]..[558,16151+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+10]..[558,16151+41])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+10]..[558,16151+12])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+16]..[558,16151+41])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+16]..[558,16151+22])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+16]..[558,16151+22])
                          []
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+25]..[558,16151+41])
                          Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+35]..[558,16151+41])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+25]..[558,16151+34])
                              Ptyp_constr "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+28]..[558,16151+34])
                              [
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+25]..[558,16151+27])
                                  Ptyp_var e
                              ]
                          ]
                      ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+46]..[558,16151+77])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+46]..[558,16151+71])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+46]..[558,16151+52])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+46]..[558,16151+52])
                          []
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+55]..[558,16151+71])
                          Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+65]..[558,16151+71])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+55]..[558,16151+64])
                              Ptyp_constr "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+58]..[558,16151+64])
                              [
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+55]..[558,16151+57])
                                  Ptyp_var e
                              ]
                          ]
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[558,16151+75]..[558,16151+77])
                      Ptyp_var a
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[559,16230+16]..[559,16230+27])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[559,16230+25]..[559,16230+27])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[559,16230+17]..[559,16230+19])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[559,16230+21]..[559,16230+23])
                        Ptyp_var e
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[560,16258+7]..[560,16258+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[560,16258+0]..[561,16274+39])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[560,16258+4]..[560,16258+6])
              Ptyp_var e
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+2]..[561,16274+39])
                "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+4]..[561,16274+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+11]..[561,16274+21])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+19]..[561,16274+21])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+12]..[561,16274+14])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+15]..[561,16274+17])
                        Ptyp_var e
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+24]..[561,16274+26])
                    Ptyp_var a
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+30]..[561,16274+39])
                    Ptyp_constr "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+33]..[561,16274+39])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[561,16274+30]..[561,16274+32])
                        Ptyp_var e
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+0]..[575,16696+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+4]..[564,16318+52]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+4]..[564,16318+10])
            Ppat_var "ty_abc" (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+4]..[564,16318+10])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+13]..[564,16318+52]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+13]..[564,16318+52])
              Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+50]..[564,16318+52])
              [
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+14]..[564,16318+45])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+21]..[564,16318+24])
                          Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+21]..[564,16318+24])
                          []
                      ]
                    Rtag "B" false
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+33]..[564,16318+39])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+33]..[564,16318+39])
                          []
                      ]
                    Rtag "C" true
                      []
                  ]
                  None
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+46]..[564,16318+48])
                  Ptyp_var e
              ]
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+4]..[575,16696+33])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[566,16450+2]..[575,16696+33])
            Pexp_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[566,16450+2]..[566,16450+5])
            Some
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[566,16450+6]..[575,16696+33])
                Pexp_tuple
                [
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[567,16458+2]..[570,16553+24])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+6]..[568,16470+10])
                          Ppat_variant "A"
                          Some
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+9]..[568,16470+10])
                              Ppat_var "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+9]..[568,16470+10])
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+14]..[568,16470+39])
                          Pexp_tuple
                          [
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+14]..[568,16470+17])
                              Pexp_constant PConst_string("A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+15]..[568,16470+16]),None)
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+19]..[568,16470+39])
                              Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+19]..[568,16470+23])
                              Some
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+24]..[568,16470+39])
                                  Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+25]..[568,16470+29])
                                  Some
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+30]..[568,16470+38])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+31]..[568,16470+34])
                                          Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+31]..[568,16470+34])
                                          None
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+36]..[568,16470+37])
                                          Pexp_ident "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[568,16470+36]..[568,16470+37])
                                      ]
                          ]
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+6]..[569,16510+10])
                          Ppat_variant "B"
                          Some
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+9]..[569,16510+10])
                              Ppat_var "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+9]..[569,16510+10])
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+14]..[569,16510+42])
                          Pexp_tuple
                          [
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+14]..[569,16510+17])
                              Pexp_constant PConst_string("B",(testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+15]..[569,16510+16]),None)
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+19]..[569,16510+42])
                              Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+19]..[569,16510+23])
                              Some
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+24]..[569,16510+42])
                                  Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+25]..[569,16510+29])
                                  Some
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+30]..[569,16510+41])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+31]..[569,16510+37])
                                          Pexp_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+31]..[569,16510+37])
                                          None
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+39]..[569,16510+40])
                                          Pexp_ident "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[569,16510+39]..[569,16510+40])
                                      ]
                          ]
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[570,16553+6]..[570,16553+8])
                          Ppat_variant "C"
                          None
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[570,16553+14]..[570,16553+23])
                          Pexp_tuple
                          [
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[570,16553+14]..[570,16553+17])
                              Pexp_constant PConst_string("C",(testsuite/tests/typing-gadts/dynamic_frisch.ml[570,16553+15]..[570,16553+16]),None)
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[570,16553+19]..[570,16553+23])
                              Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[570,16553+19]..[570,16553+23])
                              None
                          ]
                    ]
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[571,16579+2]..[575,16696+32])
                    Pexp_function
                    [
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+6]..[572,16591+31])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+6]..[572,16591+9])
                              Ppat_constant PConst_string("A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+7]..[572,16591+8]),None)
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+11]..[572,16591+31])
                              Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+11]..[572,16591+15])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+16]..[572,16591+31])
                                  Ppat_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+17]..[572,16591+21])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+22]..[572,16591+30])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+23]..[572,16591+26])
                                          Ppat_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+23]..[572,16591+26])
                                          None
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+28]..[572,16591+29])
                                          Ppat_var "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+28]..[572,16591+29])
                                      ]
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+35]..[572,16591+39])
                          Pexp_variant "A"
                          Some
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+38]..[572,16591+39])
                              Pexp_ident "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[572,16591+38]..[572,16591+39])
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+6]..[573,16631+34])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+6]..[573,16631+9])
                              Ppat_constant PConst_string("B",(testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+7]..[573,16631+8]),None)
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+11]..[573,16631+34])
                              Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+11]..[573,16631+15])
                              Some
                                []
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+16]..[573,16631+34])
                                  Ppat_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+17]..[573,16631+21])
                                  Some
                                    []
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+22]..[573,16631+33])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+23]..[573,16631+29])
                                          Ppat_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+23]..[573,16631+29])
                                          None
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+31]..[573,16631+32])
                                          Ppat_var "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+31]..[573,16631+32])
                                      ]
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+38]..[573,16631+42])
                          Pexp_variant "B"
                          Some
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+41]..[573,16631+42])
                              Pexp_ident "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[573,16631+41]..[573,16631+42])
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[574,16674+6]..[574,16674+15])
                          Ppat_tuple
                          [
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[574,16674+6]..[574,16674+9])
                              Ppat_constant PConst_string("C",(testsuite/tests/typing-gadts/dynamic_frisch.ml[574,16674+7]..[574,16674+8]),None)
                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[574,16674+11]..[574,16674+15])
                              Ppat_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[574,16674+11]..[574,16674+15])
                              None
                          ]
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[574,16674+19]..[574,16674+21])
                          Pexp_variant "C"
                          None
                      <case>
                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[575,16696+6]..[575,16696+7])
                          Ppat_any
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[575,16696+11]..[575,16696+31])
                          Pexp_apply
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[575,16696+11]..[575,16696+22])
                            Pexp_ident "invalid_arg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[575,16696+11]..[575,16696+22])
                          [
                            <arg>
                            Nolabel
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[575,16696+23]..[575,16696+31])
                                Pexp_constant PConst_string("ty_abc",(testsuite/tests/typing-gadts/dynamic_frisch.ml[575,16696+24]..[575,16696+30]),None)
                          ]
                    ]
                ]
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+13]..[564,16318+52])
            Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+50]..[564,16318+52])
            [
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+14]..[564,16318+45])
                Ptyp_variant closed=Closed
                [
                  Rtag "A" false
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+21]..[564,16318+24])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+21]..[564,16318+24])
                        []
                    ]
                  Rtag "B" false
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+33]..[564,16318+39])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+33]..[564,16318+39])
                        []
                    ]
                  Rtag "C" true
                    []
                ]
                None
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[564,16318+46]..[564,16318+48])
                Ptyp_var e
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[577,16733+0]..[592,17381+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[577,16733+9]..[592,17381+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[577,16733+9]..[592,17381+2])
          Pexp_constant PConst_string ("\ntype (_, _) ty =\n    Int : (int, 'c) ty\n  | String : (string, 'd) ty\n  | List : ('a, 'e) ty -> ('a list, 'e) ty\n  | Option : ('a, 'e) ty -> ('a option, 'e) ty\n  | Pair : (('a, 'e) ty * ('b, 'e) ty) -> ('a * 'b, 'e) ty\n  | Var : ('a, 'a -> 'e) ty\n  | Rec : ('a, 'a -> 'e) ty -> ('a, 'e) ty\n  | Pop : ('a, 'e) ty -> ('a, 'b -> 'e) ty\n  | Conv : string * ('a -> 'b) * ('b -> 'a) * ('b, 'e) ty -> ('a, 'e) ty\n  | Sum : ('a -> string * 'e ty_dyn option) *\n      (string * 'e ty_dyn option -> 'a) -> ('a, 'e) ty\nand 'e ty_dyn = Tdyn : ('a, 'e) ty * 'a -> 'e ty_dyn\nval ty_abc : ([ `A of int | `B of string | `C ], 'e) ty = Sum (<fun>, <fun>)\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[577,16733+11]..[592,17381+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+0]..[601,17673+74])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+4]..[595,17451+50]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+4]..[595,17451+11])
            Ppat_var "ty_list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+4]..[595,17451+11])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+4]..[601,17673+74]) ghost
            Ptyp_poly 'a 'e
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+24]..[595,17451+50])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+24]..[595,17451+32])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+30]..[595,17451+32])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+25]..[595,17451+26])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+27]..[595,17451+28])
                    Ptyp_var e
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+36]..[595,17451+50])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+48]..[595,17451+50])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+37]..[595,17451+44])
                    Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+39]..[595,17451+44])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+37]..[595,17451+38])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+45]..[595,17451+46])
                    Ptyp_var e
                ]
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+4]..[601,17673+74])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+4]..[601,17673+74])
            Pexp_newtype "e"
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+4]..[601,17673+74])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+53]..[601,17673+74])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+57]..[595,17451+58])
                  Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+57]..[595,17451+58])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+2]..[601,17673+74])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+6]..[596,17513+10])
                        Ppat_var "targ" (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+6]..[596,17513+10])
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+13]..[596,17513+30])
                        Pexp_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+13]..[596,17513+17])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+18]..[596,17513+30])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+19]..[596,17513+24])
                                Pexp_construct "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+19]..[596,17513+22])
                                Some
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+23]..[596,17513+24])
                                    Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+23]..[596,17513+24])
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+26]..[596,17513+29])
                                Pexp_construct "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[596,17513+26]..[596,17513+29])
                                None
                            ]
                  ]
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[597,17547+2]..[601,17673+74])
                    Pexp_construct "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[597,17547+2]..[597,17547+5])
                    Some
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[597,17547+6]..[601,17673+74])
                        Pexp_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[597,17547+7]..[597,17547+10])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[597,17547+11]..[601,17673+73])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[598,17560+2]..[599,17592+47])
                                Pexp_function
                                [
                                  <case>
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[598,17560+12]..[598,17560+16])
                                      Ppat_variant "Nil"
                                      None
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[598,17560+20]..[598,17560+31])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[598,17560+20]..[598,17560+25])
                                          Pexp_constant PConst_string("Nil",(testsuite/tests/typing-gadts/dynamic_frisch.ml[598,17560+21]..[598,17560+24]),None)
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[598,17560+27]..[598,17560+31])
                                          Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[598,17560+27]..[598,17560+31])
                                          None
                                      ]
                                  <case>
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+6]..[599,17592+13])
                                      Ppat_variant "Cons"
                                      Some
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+12]..[599,17592+13])
                                          Ppat_var "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+12]..[599,17592+13])
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+17]..[599,17592+46])
                                      Pexp_tuple
                                      [
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+17]..[599,17592+23])
                                          Pexp_constant PConst_string("Cons",(testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+18]..[599,17592+22]),None)
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+25]..[599,17592+46])
                                          Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+25]..[599,17592+29])
                                          Some
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+30]..[599,17592+46])
                                              Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+31]..[599,17592+35])
                                              Some
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+36]..[599,17592+45])
                                                  Pexp_tuple
                                                  [
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+37]..[599,17592+41])
                                                      Pexp_ident "targ" (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+37]..[599,17592+41])
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+43]..[599,17592+44])
                                                      Pexp_ident "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[599,17592+43]..[599,17592+44])
                                                  ]
                                      ]
                                ]
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[600,17641+2]..[601,17673+72])
                                Pexp_function
                                [
                                  <case>
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[600,17641+12]..[600,17641+23])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[600,17641+12]..[600,17641+17])
                                          Ppat_constant PConst_string("Nil",(testsuite/tests/typing-gadts/dynamic_frisch.ml[600,17641+13]..[600,17641+16]),None)
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[600,17641+19]..[600,17641+23])
                                          Ppat_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[600,17641+19]..[600,17641+23])
                                          None
                                      ]
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[600,17641+27]..[600,17641+31])
                                      Pexp_variant "Nil"
                                      None
                                  <case>
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+6]..[601,17673+60])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+6]..[601,17673+12])
                                          Ppat_constant PConst_string("Cons",(testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+7]..[601,17673+11]),None)
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+14]..[601,17673+60])
                                          Ppat_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+14]..[601,17673+18])
                                          Some
                                            []
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+19]..[601,17673+60])
                                              Ppat_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+20]..[601,17673+24])
                                              Some
                                                []
                                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+25]..[601,17673+59])
                                                  Ppat_tuple
                                                  [
                                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+26]..[601,17673+39])
                                                      Ppat_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+26]..[601,17673+30])
                                                      Some
                                                        []
                                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+31]..[601,17673+39])
                                                          Ppat_tuple
                                                          [
                                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+32]..[601,17673+33])
                                                              Ppat_any
                                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+35]..[601,17673+38])
                                                              Ppat_construct "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+35]..[601,17673+38])
                                                              None
                                                          ]
                                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+41]..[601,17673+58])
                                                      Ppat_constraint
                                                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+42]..[601,17673+43])
                                                        Ppat_var "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+42]..[601,17673+43])
                                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+46]..[601,17673+57])
                                                        Ptyp_tuple
                                                        [
                                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+46]..[601,17673+47])
                                                            Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+46]..[601,17673+47])
                                                            []
                                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+50]..[601,17673+57])
                                                            Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+52]..[601,17673+57])
                                                            [
                                                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+50]..[601,17673+51])
                                                                Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+50]..[601,17673+51])
                                                                []
                                                            ]
                                                        ]
                                                  ]
                                      ]
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+64]..[601,17673+71])
                                      Pexp_variant "Cons"
                                      Some
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+70]..[601,17673+71])
                                          Pexp_ident "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[601,17673+70]..[601,17673+71])
                                ]
                            ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+24]..[595,17451+50])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+24]..[595,17451+32])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+30]..[595,17451+32])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+25]..[595,17451+26])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+25]..[595,17451+26])
                      []
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+27]..[595,17451+28])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+27]..[595,17451+28])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+36]..[595,17451+50])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+48]..[595,17451+50])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+37]..[595,17451+44])
                      Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+39]..[595,17451+44])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+37]..[595,17451+38])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+37]..[595,17451+38])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+45]..[595,17451+46])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[595,17451+45]..[595,17451+46])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[603,17751+0]..[611,18122+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[603,17751+9]..[611,18122+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[603,17751+9]..[611,18122+2])
          Pexp_constant PConst_string ("\nLine 7, characters 41-58:\n7 |     | \"Cons\", Some (Tdyn (Pair (_, Var), (p : a * a vlist))) -> `Cons p)))\n                                             ^^^^^^^^^^^^^^^^^\nError: This pattern matches values of type a * a vlist\n       but a pattern was expected which matches values of type\n         $Tdyn_'a = $0 * $1\n       Type a is not compatible with type $0\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[603,17751+11]..[611,18122+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[615,18207+0]..[639,19018+50])
    Pstr_type Rec
    [
      type_declaration "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[615,18207+11]..[615,18207+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[615,18207+0]..[628,18741+24])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[615,18207+6]..[615,18207+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[615,18207+8]..[615,18207+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[616,18223+2]..[616,18223+19])
                "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[616,18223+4]..[616,18223+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[616,18223+9]..[616,18223+19])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[616,18223+17]..[616,18223+19])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[616,18223+10]..[616,18223+13])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[616,18223+10]..[616,18223+13])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[616,18223+14]..[616,18223+15])
                        Ptyp_any
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[617,18243+2]..[617,18243+25])
                "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[617,18243+4]..[617,18243+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[617,18243+12]..[617,18243+25])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[617,18243+23]..[617,18243+25])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[617,18243+13]..[617,18243+19])
                        Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[617,18243+13]..[617,18243+19])
                        []
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[617,18243+20]..[617,18243+21])
                        Ptyp_any
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+2]..[618,18269+40])
                "List" (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+4]..[618,18269+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+10]..[618,18269+20])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+18]..[618,18269+20])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+11]..[618,18269+13])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+14]..[618,18269+16])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+24]..[618,18269+40])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+38]..[618,18269+40])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+25]..[618,18269+32])
                        Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+28]..[618,18269+32])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+25]..[618,18269+27])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[618,18269+34]..[618,18269+36])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+2]..[619,18310+44])
                "Option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+4]..[619,18310+10])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+12]..[619,18310+22])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+20]..[619,18310+22])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+13]..[619,18310+15])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+16]..[619,18310+18])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+26]..[619,18310+44])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+42]..[619,18310+44])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+27]..[619,18310+36])
                        Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+30]..[619,18310+36])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+27]..[619,18310+29])
                            Ptyp_var a
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[619,18310+38]..[619,18310+40])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+2]..[620,18355+54])
                "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+4]..[620,18355+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+11]..[620,18355+34])
                    Ptyp_tuple
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+11]..[620,18355+21])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+19]..[620,18355+21])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+12]..[620,18355+14])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+15]..[620,18355+17])
                            Ptyp_var e
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+24]..[620,18355+34])
                        Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+32]..[620,18355+34])
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+25]..[620,18355+27])
                            Ptyp_var b
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+28]..[620,18355+30])
                            Ptyp_var e
                        ]
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+39]..[620,18355+54])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+52]..[620,18355+54])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+40]..[620,18355+47])
                        Ptyp_tuple
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+40]..[620,18355+42])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+45]..[620,18355+47])
                            Ptyp_var b
                        ]
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[620,18355+48]..[620,18355+50])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+2]..[621,18410+26])
                "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+4]..[621,18410+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+9]..[621,18410+26])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+24]..[621,18410+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+10]..[621,18410+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+14]..[621,18410+22])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+14]..[621,18410+16])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[621,18410+20]..[621,18410+22])
                          Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+2]..[622,18437+40])
                "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+4]..[622,18437+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+9]..[622,18437+26])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+24]..[622,18437+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+10]..[622,18437+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+14]..[622,18437+22])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+14]..[622,18437+16])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+20]..[622,18437+22])
                          Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+30]..[622,18437+40])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+38]..[622,18437+40])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+31]..[622,18437+33])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[622,18437+34]..[622,18437+36])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+2]..[623,18478+41])
                "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+4]..[623,18478+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+9]..[623,18478+20])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+18]..[623,18478+20])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+10]..[623,18478+12])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+14]..[623,18478+16])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+24]..[623,18478+41])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+39]..[623,18478+41])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+25]..[623,18478+27])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+29]..[623,18478+37])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+29]..[623,18478+31])
                          Ptyp_var b
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[623,18478+35]..[623,18478+37])
                          Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+2]..[624,18520+71])
                "Conv" (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+4]..[624,18520+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+10]..[624,18520+16])
                    Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+10]..[624,18520+16])
                    []
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+20]..[624,18520+28])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+20]..[624,18520+22])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+26]..[624,18520+28])
                      Ptyp_var b
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+33]..[624,18520+41])
                    Ptyp_arrow
                    Nolabel
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+33]..[624,18520+35])
                      Ptyp_var b
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+39]..[624,18520+41])
                      Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+45]..[624,18520+56])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+54]..[624,18520+56])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+46]..[624,18520+48])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+50]..[624,18520+52])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+60]..[624,18520+71])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+69]..[624,18520+71])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+61]..[624,18520+63])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[624,18520+65]..[624,18520+67])
                        Ptyp_var e
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+2]..[628,18741+24])
                "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+4]..[625,18592+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+9]..[627,18693+47])
                    Ptyp_object Closed
                      method proj
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+17]..[625,18592+48])
                          Ptyp_arrow
                          Nolabel
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+17]..[625,18592+19])
                            Ptyp_var a
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+23]..[625,18592+48])
                            Ptyp_tuple
                            [
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+23]..[625,18592+29])
                                Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+23]..[625,18592+29])
                                []
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+32]..[625,18592+48])
                                Ptyp_constr "option" (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+42]..[625,18592+48])
                                [
                                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+32]..[625,18592+41])
                                    Ptyp_constr "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+35]..[625,18592+41])
                                    [
                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[625,18592+32]..[625,18592+34])
                                        Ptyp_var e
                                    ]
                                ]
                            ]
                      method cases
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+18]..[626,18642+49])
                          Ptyp_constr "list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+45]..[626,18642+49])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+19]..[626,18642+43])
                              Ptyp_tuple
                              [
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+19]..[626,18642+25])
                                  Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+19]..[626,18642+25])
                                  []
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+28]..[626,18642+43])
                                  Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+36]..[626,18642+43])
                                  [
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+29]..[626,18642+31])
                                      Ptyp_var e
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[626,18642+32]..[626,18642+34])
                                      Ptyp_var b
                                  ]
                              ]
                          ]
                      method inj
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+16]..[627,18693+45])
                          Ptyp_poly 'c
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+20]..[627,18693+45])
                            Ptyp_arrow
                            Nolabel
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+20]..[627,18693+39])
                              Ptyp_tuple
                              [
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+20]..[627,18693+34])
                                  Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+28]..[627,18693+34])
                                  [
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+21]..[627,18693+23])
                                      Ptyp_var b
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+24]..[627,18693+26])
                                      Ptyp_var c
                                  ]
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+37]..[627,18693+39])
                                  Ptyp_var c
                              ]
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[627,18693+43]..[627,18693+45])
                              Ptyp_var a
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[628,18741+13]..[628,18741+24])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[628,18741+22]..[628,18741+24])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[628,18741+14]..[628,18741+16])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[628,18741+18]..[628,18741+20])
                        Ptyp_var e
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[630,18767+7]..[630,18767+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[630,18767+0]..[631,18783+39])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[630,18767+4]..[630,18767+6])
              Ptyp_var e
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+2]..[631,18783+39])
                "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+4]..[631,18783+8])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+11]..[631,18783+21])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+19]..[631,18783+21])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+12]..[631,18783+14])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+15]..[631,18783+17])
                        Ptyp_var e
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+24]..[631,18783+26])
                    Ptyp_var a
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+30]..[631,18783+39])
                    Ptyp_constr "ty_dyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+33]..[631,18783+39])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[631,18783+30]..[631,18783+32])
                        Ptyp_var e
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[633,18824+10]..[633,18824+16]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[633,18824+0]..[635,18875+62])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[633,18824+5]..[633,18824+6])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[633,18824+7]..[633,18824+8])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+2]..[634,18843+31])
                "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+4]..[634,18843+7])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+10]..[634,18843+31])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+25]..[634,18843+31])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+11]..[634,18843+19])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+11]..[634,18843+13])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+17]..[634,18843+19])
                          Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[634,18843+21]..[634,18843+23])
                        Ptyp_var a
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+2]..[635,18875+62])
                "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+4]..[635,18875+7])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+10]..[635,18875+31])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+25]..[635,18875+31])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+11]..[635,18875+19])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+11]..[635,18875+13])
                          Ptyp_var b
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+17]..[635,18875+19])
                          Ptyp_var c
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+21]..[635,18875+23])
                        Ptyp_var d
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+35]..[635,18875+62])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+56]..[635,18875+62])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+36]..[635,18875+50])
                        Ptyp_arrow
                        Nolabel
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+36]..[635,18875+38])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+42]..[635,18875+50])
                          Ptyp_arrow
                          Nolabel
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+42]..[635,18875+44])
                            Ptyp_var b
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+48]..[635,18875+50])
                            Ptyp_var c
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[635,18875+52]..[635,18875+54])
                        Ptyp_var d
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[637,18939+10]..[637,18939+17]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[637,18939+0]..[639,19018+50])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[637,18939+5]..[637,18939+6])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[637,18939+7]..[637,18939+8])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+2]..[638,18959+58])
                "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+4]..[638,18959+9])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+12]..[638,18959+26])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+20]..[638,18959+26])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+13]..[638,18959+15])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+16]..[638,18959+18])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+29]..[638,18959+39])
                    Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+37]..[638,18959+39])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+30]..[638,18959+32])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+33]..[638,18959+35])
                        Ptyp_var e
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+43]..[638,18959+58])
                    Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+51]..[638,18959+58])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+44]..[638,18959+46])
                        Ptyp_var e
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[638,18959+47]..[638,18959+49])
                        Ptyp_var b
                    ]
              (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+2]..[639,19018+50])
                "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+4]..[639,19018+11])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+14]..[639,19018+31])
                    Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+25]..[639,19018+31])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+15]..[639,19018+17])
                        Ptyp_var b
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+18]..[639,19018+23])
                        Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+18]..[639,19018+23])
                        []
                    ]
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+35]..[639,19018+50])
                    Ptyp_constr "ty_case" (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+43]..[639,19018+50])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+36]..[639,19018+38])
                        Ptyp_var e
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[639,19018+39]..[639,19018+41])
                        Ptyp_var b
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+0]..[658,19634+6])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+4]..[642,19073+59]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+4]..[642,19073+10])
            Ppat_var "ty_abc" (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+4]..[642,19073+10])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+13]..[642,19073+59]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+13]..[642,19073+59])
              Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+57]..[642,19073+59])
              [
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+14]..[642,19073+51])
                  Ptyp_alias "a"
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+14]..[642,19073+45])
                    Ptyp_variant closed=Closed
                    [
                      Rtag "A" false
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+21]..[642,19073+24])
                            Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+21]..[642,19073+24])
                            []
                        ]
                      Rtag "B" false
                        [
                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+33]..[642,19073+39])
                            Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+33]..[642,19073+39])
                            []
                        ]
                      Rtag "C" true
                        []
                    ]
                    None
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+53]..[642,19073+55])
                  Ptyp_var e
              ]
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+4]..[658,19634+6])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[643,19135+2]..[658,19634+6])
            Pexp_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[643,19135+2]..[643,19135+5])
            Some
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[643,19135+6]..[658,19634+6])
                Pexp_object
                class_structure
                  pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[643,19135+13]..[643,19135+13]) ghost
                    Ppat_any
                  [
                    class_field (testsuite/tests/typing-gadts/dynamic_frisch.ml[644,19149+4]..[647,19263+23])
                      Pcf_method Public
                        "proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[644,19149+11]..[644,19149+15])
                        Concrete Fresh
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[644,19149+18]..[647,19263+23]) ghost
                          Pexp_poly
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[644,19149+18]..[647,19263+23])
                            Pexp_function
                            [
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+8]..[645,19176+12])
                                  Ppat_variant "A"
                                  Some
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+11]..[645,19176+12])
                                      Ppat_var "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+11]..[645,19176+12])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+16]..[645,19176+41])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+16]..[645,19176+19])
                                      Pexp_constant PConst_string("A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+17]..[645,19176+18]),None)
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+21]..[645,19176+41])
                                      Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+21]..[645,19176+25])
                                      Some
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+26]..[645,19176+41])
                                          Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+27]..[645,19176+31])
                                          Some
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+32]..[645,19176+40])
                                              Pexp_tuple
                                              [
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+33]..[645,19176+36])
                                                  Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+33]..[645,19176+36])
                                                  None
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+38]..[645,19176+39])
                                                  Pexp_ident "n" (testsuite/tests/typing-gadts/dynamic_frisch.ml[645,19176+38]..[645,19176+39])
                                              ]
                                  ]
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+8]..[646,19218+12])
                                  Ppat_variant "B"
                                  Some
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+11]..[646,19218+12])
                                      Ppat_var "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+11]..[646,19218+12])
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+16]..[646,19218+44])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+16]..[646,19218+19])
                                      Pexp_constant PConst_string("B",(testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+17]..[646,19218+18]),None)
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+21]..[646,19218+44])
                                      Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+21]..[646,19218+25])
                                      Some
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+26]..[646,19218+44])
                                          Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+27]..[646,19218+31])
                                          Some
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+32]..[646,19218+43])
                                              Pexp_tuple
                                              [
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+33]..[646,19218+39])
                                                  Pexp_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+33]..[646,19218+39])
                                                  None
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+41]..[646,19218+42])
                                                  Pexp_ident "s" (testsuite/tests/typing-gadts/dynamic_frisch.ml[646,19218+41]..[646,19218+42])
                                              ]
                                  ]
                              <case>
                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[647,19263+8]..[647,19263+10])
                                  Ppat_variant "C"
                                  None
                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[647,19263+14]..[647,19263+23])
                                  Pexp_tuple
                                  [
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[647,19263+14]..[647,19263+17])
                                      Pexp_constant PConst_string("C",(testsuite/tests/typing-gadts/dynamic_frisch.ml[647,19263+15]..[647,19263+16]),None)
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[647,19263+19]..[647,19263+23])
                                      Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[647,19263+19]..[647,19263+23])
                                      None
                                  ]
                            ]
                          None
                    class_field (testsuite/tests/typing-gadts/dynamic_frisch.ml[648,19287+4]..[650,19367+39])
                      Pcf_method Public
                        "cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[648,19287+11]..[648,19287+16])
                        Concrete Fresh
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+6]..[650,19367+38]) ghost
                          Pexp_poly
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+6]..[650,19367+38])
                            Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+8]..[650,19367+38]) ghost
                            Some
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+8]..[650,19367+38]) ghost
                                Pexp_tuple
                                [
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+8]..[649,19306+29])
                                    Pexp_tuple
                                    [
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+8]..[649,19306+11])
                                        Pexp_constant PConst_string("A",(testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+9]..[649,19306+10]),None)
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+13]..[649,19306+29])
                                        Pexp_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+13]..[649,19306+18])
                                        Some
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+19]..[649,19306+29])
                                            Pexp_tuple
                                            [
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+20]..[649,19306+23])
                                                Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+20]..[649,19306+23])
                                                None
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+25]..[649,19306+28])
                                                Pexp_construct "Int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+25]..[649,19306+28])
                                                None
                                            ]
                                    ]
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+31]..[650,19367+38]) ghost
                                    Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+31]..[650,19367+38]) ghost
                                    Some
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+31]..[650,19367+38]) ghost
                                        Pexp_tuple
                                        [
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+31]..[649,19306+59])
                                            Pexp_tuple
                                            [
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+31]..[649,19306+34])
                                                Pexp_constant PConst_string("B",(testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+32]..[649,19306+33]),None)
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+36]..[649,19306+59])
                                                Pexp_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+36]..[649,19306+41])
                                                Some
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+42]..[649,19306+59])
                                                    Pexp_tuple
                                                    [
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+43]..[649,19306+50])
                                                        Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+43]..[649,19306+46])
                                                        Some
                                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+47]..[649,19306+50])
                                                            Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+47]..[649,19306+50])
                                                            None
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+52]..[649,19306+58])
                                                        Pexp_construct "String" (testsuite/tests/typing-gadts/dynamic_frisch.ml[649,19306+52]..[649,19306+58])
                                                        None
                                                    ]
                                            ]
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+8]..[650,19367+38]) ghost
                                            Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+8]..[650,19367+38]) ghost
                                            Some
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+8]..[650,19367+38]) ghost
                                                Pexp_tuple
                                                [
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+8]..[650,19367+36])
                                                    Pexp_tuple
                                                    [
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+8]..[650,19367+11])
                                                        Pexp_constant PConst_string("C",(testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+9]..[650,19367+10]),None)
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+13]..[650,19367+36])
                                                        Pexp_construct "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+13]..[650,19367+20])
                                                        Some
                                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+21]..[650,19367+36])
                                                            Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+22]..[650,19367+25])
                                                            Some
                                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+26]..[650,19367+35])
                                                                Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+27]..[650,19367+30])
                                                                Some
                                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+31]..[650,19367+34])
                                                                    Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+31]..[650,19367+34])
                                                                    None
                                                    ]
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+37]..[650,19367+38]) ghost
                                                    Pexp_construct "[]" (testsuite/tests/typing-gadts/dynamic_frisch.ml[650,19367+37]..[650,19367+38]) ghost
                                                    None
                                                ]
                                        ]
                                ]
                          None
                    class_field (testsuite/tests/typing-gadts/dynamic_frisch.ml[651,19407+4]..[657,19599+34])
                      Pcf_method Public
                        "inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[651,19407+11]..[651,19407+14])
                        Concrete Fresh
                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[651,19407+22]..[657,19599+34]) ghost
                          Pexp_poly
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[651,19407+11]..[657,19599+34])
                            Pexp_newtype "c"
                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[651,19407+11]..[657,19599+34])
                              Pexp_constraint
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[654,19534+6]..[657,19599+34])
                                Pexp_function
                                [
                                  <case>
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+8]..[655,19549+14])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+8]..[655,19549+11])
                                          Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+8]..[655,19549+11])
                                          None
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+13]..[655,19549+14])
                                          Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+13]..[655,19549+14])
                                      ]
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+18]..[655,19549+22])
                                      Pexp_variant "A"
                                      Some
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+21]..[655,19549+22])
                                          Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[655,19549+21]..[655,19549+22])
                                  <case>
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+8]..[656,19572+18])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+8]..[656,19572+15])
                                          Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+8]..[656,19572+11])
                                          Some
                                            []
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+12]..[656,19572+15])
                                              Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+12]..[656,19572+15])
                                              None
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+17]..[656,19572+18])
                                          Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+17]..[656,19572+18])
                                      ]
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+22]..[656,19572+26])
                                      Pexp_variant "B"
                                      Some
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+25]..[656,19572+26])
                                          Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[656,19572+25]..[656,19572+26])
                                  <case>
                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+8]..[657,19599+28])
                                      Ppat_tuple
                                      [
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+8]..[657,19599+21])
                                          Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+8]..[657,19599+11])
                                          Some
                                            []
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+12]..[657,19599+21])
                                              Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+13]..[657,19599+16])
                                              Some
                                                []
                                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+17]..[657,19599+20])
                                                  Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+17]..[657,19599+20])
                                                  None
                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+23]..[657,19599+28])
                                          Ppat_construct "Noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+23]..[657,19599+28])
                                          None
                                      ]
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[657,19599+32]..[657,19599+34])
                                      Pexp_variant "C"
                                      None
                                ]
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+8]..[653,19490+41])
                                Ptyp_arrow
                                Nolabel
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+8]..[652,19432+54])
                                  Ptyp_tuple
                                  [
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+8]..[652,19432+50])
                                      Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+44]..[652,19432+50])
                                      [
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+9]..[652,19432+39])
                                          Ptyp_arrow
                                          Nolabel
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+9]..[652,19432+12])
                                            Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+9]..[652,19432+12])
                                            []
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+16]..[652,19432+39])
                                            Ptyp_arrow
                                            Nolabel
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+16]..[652,19432+22])
                                              Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+16]..[652,19432+22])
                                              []
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+26]..[652,19432+39])
                                              Ptyp_arrow
                                              Nolabel
                                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+26]..[652,19432+31])
                                                Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+26]..[652,19432+31])
                                                []
                                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+35]..[652,19432+39])
                                                Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+35]..[652,19432+39])
                                                []
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+41]..[652,19432+42])
                                          Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+41]..[652,19432+42])
                                          []
                                      ]
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+53]..[652,19432+54])
                                      Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+53]..[652,19432+54])
                                      []
                                  ]
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+10]..[653,19490+41])
                                  Ptyp_variant closed=Closed
                                  [
                                    Rtag "A" false
                                      [
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+17]..[653,19490+20])
                                          Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+17]..[653,19490+20])
                                          []
                                      ]
                                    Rtag "B" false
                                      [
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+29]..[653,19490+35])
                                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+29]..[653,19490+35])
                                          []
                                      ]
                                    Rtag "C" true
                                      []
                                  ]
                                  None
                          Some
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[651,19407+11]..[657,19599+34]) ghost
                              Ptyp_poly 'c
                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+8]..[653,19490+41])
                                Ptyp_arrow
                                Nolabel
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+8]..[652,19432+54])
                                  Ptyp_tuple
                                  [
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+8]..[652,19432+50])
                                      Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+44]..[652,19432+50])
                                      [
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+9]..[652,19432+39])
                                          Ptyp_arrow
                                          Nolabel
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+9]..[652,19432+12])
                                            Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+9]..[652,19432+12])
                                            []
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+16]..[652,19432+39])
                                            Ptyp_arrow
                                            Nolabel
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+16]..[652,19432+22])
                                              Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+16]..[652,19432+22])
                                              []
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+26]..[652,19432+39])
                                              Ptyp_arrow
                                              Nolabel
                                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+26]..[652,19432+31])
                                                Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+26]..[652,19432+31])
                                                []
                                              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+35]..[652,19432+39])
                                                Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+35]..[652,19432+39])
                                                []
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+41]..[652,19432+42])
                                          Ptyp_var c
                                      ]
                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[652,19432+53]..[652,19432+54])
                                      Ptyp_var c
                                  ]
                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+10]..[653,19490+41])
                                  Ptyp_variant closed=Closed
                                  [
                                    Rtag "A" false
                                      [
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+17]..[653,19490+20])
                                          Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+17]..[653,19490+20])
                                          []
                                      ]
                                    Rtag "B" false
                                      [
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+29]..[653,19490+35])
                                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[653,19490+29]..[653,19490+35])
                                          []
                                      ]
                                    Rtag "C" true
                                      []
                                  ]
                                  None
                  ]
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+13]..[642,19073+59])
            Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+57]..[642,19073+59])
            [
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+14]..[642,19073+51])
                Ptyp_alias "a"
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+14]..[642,19073+45])
                  Ptyp_variant closed=Closed
                  [
                    Rtag "A" false
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+21]..[642,19073+24])
                          Ptyp_constr "int" (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+21]..[642,19073+24])
                          []
                      ]
                    Rtag "B" false
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+33]..[642,19073+39])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+33]..[642,19073+39])
                          []
                      ]
                    Rtag "C" true
                      []
                  ]
                  None
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[642,19073+53]..[642,19073+55])
                Ptyp_var e
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[660,19644+0]..[683,20603+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[660,19644+9]..[683,20603+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[660,19644+9]..[683,20603+2])
          Pexp_constant PConst_string ("\ntype (_, _) ty =\n    Int : (int, 'd) ty\n  | String : (string, 'f) ty\n  | List : ('a, 'e) ty -> ('a list, 'e) ty\n  | Option : ('a, 'e) ty -> ('a option, 'e) ty\n  | Pair : (('a, 'e) ty * ('b, 'e) ty) -> ('a * 'b, 'e) ty\n  | Var : ('a, 'a -> 'e) ty\n  | Rec : ('a, 'a -> 'e) ty -> ('a, 'e) ty\n  | Pop : ('a, 'e) ty -> ('a, 'b -> 'e) ty\n  | Conv : string * ('a -> 'b) * ('b -> 'a) * ('b, 'e) ty -> ('a, 'e) ty\n  | Sum :\n      < cases : (string * ('e, 'b) ty_case) list;\n        inj : 'c. ('b, 'c) ty_sel * 'c -> 'a;\n        proj : 'a -> string * 'e ty_dyn option > -> ('a, 'e) ty\nand 'e ty_dyn = Tdyn : ('a, 'e) ty * 'a -> 'e ty_dyn\nand (_, _) ty_sel =\n    Thd : ('a -> 'b, 'a) ty_sel\n  | Ttl : ('b -> 'c, 'd) ty_sel -> ('a -> 'b -> 'c, 'd) ty_sel\nand (_, _) ty_case =\n    TCarg : ('b, 'a) ty_sel * ('a, 'e) ty -> ('e, 'b) ty_case\n  | TCnoarg : ('b, noarg) ty_sel -> ('e, 'b) ty_case\nval ty_abc : ([ `A of int | `B of string | `C ], 'e) ty = Sum <obj>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[660,19644+11]..[683,20603+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+0]..[685,20610+47])
    Pstr_type Rec
    [
      type_declaration "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+8]..[685,20610+13]) (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+0]..[685,20610+47])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+5]..[685,20610+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+16]..[685,20610+47])
              Ptyp_variant closed=Closed
              [
                Rtag "Nil" true
                  []
                Rtag "Cons" false
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+33]..[685,20610+46])
                      Ptyp_tuple
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+33]..[685,20610+35])
                          Ptyp_var a
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+38]..[685,20610+46])
                          Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+41]..[685,20610+46])
                          [
                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[685,20610+38]..[685,20610+40])
                              Ptyp_var a
                          ]
                      ]
                  ]
              ]
              None
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+0]..[699,21109+7])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+4]..[688,20662+52]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+4]..[688,20662+11])
            Ppat_var "ty_list" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+4]..[688,20662+11])
          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+4]..[699,21109+7]) ghost
            Ptyp_poly 'a 'e
            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+24]..[688,20662+52])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+24]..[688,20662+33])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+31]..[688,20662+33])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+25]..[688,20662+26])
                    Ptyp_var a
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+28]..[688,20662+29])
                    Ptyp_var e
                ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+37]..[688,20662+52])
                Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+50]..[688,20662+52])
                [
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+38]..[688,20662+45])
                    Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+40]..[688,20662+45])
                    [
                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+38]..[688,20662+39])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+47]..[688,20662+48])
                    Ptyp_var e
                ]
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+4]..[699,21109+7])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+4]..[699,21109+7])
            Pexp_newtype "e"
            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+4]..[699,21109+7])
              Pexp_constraint
              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+55]..[699,21109+7])
                Pexp_fun
                Nolabel
                None
                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+59]..[688,20662+60])
                  Ppat_var "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+59]..[688,20662+60])
                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+2]..[699,21109+7])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+6]..[689,20726+11])
                        Ppat_var "tcons" (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+6]..[689,20726+11])
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+14]..[689,20726+31])
                        Pexp_construct "Pair" (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+14]..[689,20726+18])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+19]..[689,20726+31])
                            Pexp_tuple
                            [
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+20]..[689,20726+25])
                                Pexp_construct "Pop" (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+20]..[689,20726+23])
                                Some
                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+24]..[689,20726+25])
                                    Pexp_ident "t" (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+24]..[689,20726+25])
                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+27]..[689,20726+30])
                                Pexp_construct "Var" (testsuite/tests/typing-gadts/dynamic_frisch.ml[689,20726+27]..[689,20726+30])
                                None
                            ]
                  ]
                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[690,20761+2]..[699,21109+7])
                    Pexp_construct "Rec" (testsuite/tests/typing-gadts/dynamic_frisch.ml[690,20761+2]..[690,20761+5])
                    Some
                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[690,20761+6]..[699,21109+7])
                        Pexp_construct "Sum" (testsuite/tests/typing-gadts/dynamic_frisch.ml[690,20761+7]..[690,20761+10])
                        Some
                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[690,20761+11]..[699,21109+6])
                            Pexp_object
                            class_structure
                              pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[690,20761+18]..[690,20761+18]) ghost
                                Ppat_any
                              [
                                class_field (testsuite/tests/typing-gadts/dynamic_frisch.ml[691,20780+4]..[693,20835+49])
                                  Pcf_method Public
                                    "proj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[691,20780+11]..[691,20780+15])
                                    Concrete Fresh
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[691,20780+18]..[693,20835+49]) ghost
                                      Pexp_poly
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[691,20780+18]..[693,20835+49])
                                        Pexp_function
                                        [
                                          <case>
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[692,20807+8]..[692,20807+12])
                                              Ppat_variant "Nil"
                                              None
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[692,20807+16]..[692,20807+27])
                                              Pexp_tuple
                                              [
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[692,20807+16]..[692,20807+21])
                                                  Pexp_constant PConst_string("Nil",(testsuite/tests/typing-gadts/dynamic_frisch.ml[692,20807+17]..[692,20807+20]),None)
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[692,20807+23]..[692,20807+27])
                                                  Pexp_construct "None" (testsuite/tests/typing-gadts/dynamic_frisch.ml[692,20807+23]..[692,20807+27])
                                                  None
                                              ]
                                          <case>
                                            pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+8]..[693,20835+15])
                                              Ppat_variant "Cons"
                                              Some
                                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+14]..[693,20835+15])
                                                  Ppat_var "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+14]..[693,20835+15])
                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+19]..[693,20835+49])
                                              Pexp_tuple
                                              [
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+19]..[693,20835+25])
                                                  Pexp_constant PConst_string("Cons",(testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+20]..[693,20835+24]),None)
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+27]..[693,20835+49])
                                                  Pexp_construct "Some" (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+27]..[693,20835+31])
                                                  Some
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+32]..[693,20835+49])
                                                      Pexp_construct "Tdyn" (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+33]..[693,20835+37])
                                                      Some
                                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+38]..[693,20835+48])
                                                          Pexp_tuple
                                                          [
                                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+39]..[693,20835+44])
                                                              Pexp_ident "tcons" (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+39]..[693,20835+44])
                                                            expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+46]..[693,20835+47])
                                                              Pexp_ident "p" (testsuite/tests/typing-gadts/dynamic_frisch.ml[693,20835+46]..[693,20835+47])
                                                          ]
                                              ]
                                        ]
                                      None
                                class_field (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+4]..[694,20885+71])
                                  Pcf_method Public
                                    "cases" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+11]..[694,20885+16])
                                    Concrete Fresh
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+19]..[694,20885+71]) ghost
                                      Pexp_poly
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+19]..[694,20885+71])
                                        Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+20]..[694,20885+71]) ghost
                                        Some
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+20]..[694,20885+71]) ghost
                                            Pexp_tuple
                                            [
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+20]..[694,20885+38])
                                                Pexp_tuple
                                                [
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+20]..[694,20885+25])
                                                    Pexp_constant PConst_string("Nil",(testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+21]..[694,20885+24]),None)
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+27]..[694,20885+38])
                                                    Pexp_construct "TCnoarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+27]..[694,20885+34])
                                                    Some
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+35]..[694,20885+38])
                                                        Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+35]..[694,20885+38])
                                                        None
                                                ]
                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+40]..[694,20885+71]) ghost
                                                Pexp_construct "::" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+40]..[694,20885+71]) ghost
                                                Some
                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+40]..[694,20885+71]) ghost
                                                    Pexp_tuple
                                                    [
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+40]..[694,20885+70])
                                                        Pexp_tuple
                                                        [
                                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+40]..[694,20885+46])
                                                            Pexp_constant PConst_string("Cons",(testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+41]..[694,20885+45]),None)
                                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+48]..[694,20885+70])
                                                            Pexp_construct "TCarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+48]..[694,20885+53])
                                                            Some
                                                              expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+54]..[694,20885+70])
                                                                Pexp_tuple
                                                                [
                                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+55]..[694,20885+62])
                                                                    Pexp_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+55]..[694,20885+58])
                                                                    Some
                                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+59]..[694,20885+62])
Pexp_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+59]..[694,20885+62])
None
                                                                  expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+64]..[694,20885+69])
                                                                    Pexp_ident "tcons" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+64]..[694,20885+69])
                                                                ]
                                                        ]
                                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+70]..[694,20885+71]) ghost
                                                        Pexp_construct "[]" (testsuite/tests/typing-gadts/dynamic_frisch.ml[694,20885+70]..[694,20885+71]) ghost
                                                        None
                                                    ]
                                            ]
                                      None
                                class_field (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+4]..[698,21079+29])
                                  Pcf_method Public
                                    "inj" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+11]..[695,20957+14])
                                    Concrete Fresh
                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+22]..[698,21079+29]) ghost
                                      Pexp_poly
                                      expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+11]..[698,21079+29])
                                        Pexp_newtype "c"
                                        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+11]..[698,21079+29])
                                          Pexp_constraint
                                          expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[696,21037+6]..[698,21079+29])
                                            Pexp_function
                                            [
                                              <case>
                                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[697,21052+8]..[697,21052+18])
                                                  Ppat_tuple
                                                  [
                                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[697,21052+8]..[697,21052+11])
                                                      Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[697,21052+8]..[697,21052+11])
                                                      None
                                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[697,21052+13]..[697,21052+18])
                                                      Ppat_construct "Noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[697,21052+13]..[697,21052+18])
                                                      None
                                                  ]
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[697,21052+22]..[697,21052+26])
                                                  Pexp_variant "Nil"
                                                  None
                                              <case>
                                                pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+8]..[698,21079+18])
                                                  Ppat_tuple
                                                  [
                                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+8]..[698,21079+15])
                                                      Ppat_construct "Ttl" (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+8]..[698,21079+11])
                                                      Some
                                                        []
                                                        pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+12]..[698,21079+15])
                                                          Ppat_construct "Thd" (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+12]..[698,21079+15])
                                                          None
                                                    pattern (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+17]..[698,21079+18])
                                                      Ppat_var "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+17]..[698,21079+18])
                                                  ]
                                                expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+22]..[698,21079+29])
                                                  Pexp_variant "Cons"
                                                  Some
                                                    expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+28]..[698,21079+29])
                                                      Pexp_ident "v" (testsuite/tests/typing-gadts/dynamic_frisch.ml[698,21079+28]..[698,21079+29])
                                            ]
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+24]..[695,20957+79])
                                            Ptyp_arrow
                                            Nolabel
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+24]..[695,20957+68])
                                              Ptyp_tuple
                                              [
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+24]..[695,20957+64])
                                                  Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+58]..[695,20957+64])
                                                  [
                                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+25]..[695,20957+53])
                                                      Ptyp_arrow
                                                      Nolabel
                                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+25]..[695,20957+30])
                                                        Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+25]..[695,20957+30])
                                                        []
                                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+53])
                                                        Ptyp_arrow
                                                        Nolabel
                                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+45])
                                                          Ptyp_tuple
                                                          [
                                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+35])
                                                              Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+35])
                                                              []
                                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+38]..[695,20957+45])
                                                              Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+40]..[695,20957+45])
                                                              [
                                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+38]..[695,20957+39])
                                                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+38]..[695,20957+39])
                                                                  []
                                                              ]
                                                          ]
                                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+49]..[695,20957+53])
                                                          Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+49]..[695,20957+53])
                                                          []
                                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+55]..[695,20957+56])
                                                      Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+55]..[695,20957+56])
                                                      []
                                                  ]
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+67]..[695,20957+68])
                                                  Ptyp_constr "c" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+67]..[695,20957+68])
                                                  []
                                              ]
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+72]..[695,20957+79])
                                              Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+74]..[695,20957+79])
                                              [
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+72]..[695,20957+73])
                                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+72]..[695,20957+73])
                                                  []
                                              ]
                                      Some
                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+11]..[698,21079+29]) ghost
                                          Ptyp_poly 'c
                                          core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+24]..[695,20957+79])
                                            Ptyp_arrow
                                            Nolabel
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+24]..[695,20957+68])
                                              Ptyp_tuple
                                              [
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+24]..[695,20957+64])
                                                  Ptyp_constr "ty_sel" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+58]..[695,20957+64])
                                                  [
                                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+25]..[695,20957+53])
                                                      Ptyp_arrow
                                                      Nolabel
                                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+25]..[695,20957+30])
                                                        Ptyp_constr "noarg" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+25]..[695,20957+30])
                                                        []
                                                      core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+53])
                                                        Ptyp_arrow
                                                        Nolabel
                                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+45])
                                                          Ptyp_tuple
                                                          [
                                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+35])
                                                              Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+34]..[695,20957+35])
                                                              []
                                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+38]..[695,20957+45])
                                                              Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+40]..[695,20957+45])
                                                              [
                                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+38]..[695,20957+39])
                                                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+38]..[695,20957+39])
                                                                  []
                                                              ]
                                                          ]
                                                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+49]..[695,20957+53])
                                                          Ptyp_constr "unit" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+49]..[695,20957+53])
                                                          []
                                                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+55]..[695,20957+56])
                                                      Ptyp_var c
                                                  ]
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+67]..[695,20957+68])
                                                  Ptyp_var c
                                              ]
                                            core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+72]..[695,20957+79])
                                              Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+74]..[695,20957+79])
                                              [
                                                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+72]..[695,20957+73])
                                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[695,20957+72]..[695,20957+73])
                                                  []
                                              ]
                              ]
              core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+24]..[688,20662+52])
                Ptyp_arrow
                Nolabel
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+24]..[688,20662+33])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+31]..[688,20662+33])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+25]..[688,20662+26])
                      Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+25]..[688,20662+26])
                      []
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+28]..[688,20662+29])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+28]..[688,20662+29])
                      []
                  ]
                core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+37]..[688,20662+52])
                  Ptyp_constr "ty" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+50]..[688,20662+52])
                  [
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+38]..[688,20662+45])
                      Ptyp_constr "vlist" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+40]..[688,20662+45])
                      [
                        core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+38]..[688,20662+39])
                          Ptyp_constr "a" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+38]..[688,20662+39])
                          []
                      ]
                    core_type (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+47]..[688,20662+48])
                      Ptyp_constr "e" (testsuite/tests/typing-gadts/dynamic_frisch.ml[688,20662+47]..[688,20662+48])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[701,21120+0]..[704,21237+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/dynamic_frisch.ml[701,21120+9]..[704,21237+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/dynamic_frisch.ml[701,21120+9]..[704,21237+2])
          Pexp_constant PConst_string ("\ntype 'a vlist = [ `Cons of 'a * 'a vlist | `Nil ]\nval ty_list : ('a, 'e) ty -> ('a vlist, 'e) ty = <fun>\n",(testsuite/tests/typing-gadts/dynamic_frisch.ml[701,21120+11]..[704,21237+0]),Some "")
    ]
]

