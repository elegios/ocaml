[
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[7,99+0]..[7,99+22])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/nested_equations.ml[7,99+7]..[7,99+8]) (testsuite/tests/typing-gadts/nested_equations.ml[7,99+0]..[7,99+22])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[7,99+5]..[7,99+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/nested_equations.ml[7,99+11]..[7,99+22])
                "Int" (testsuite/tests/typing-gadts/nested_equations.ml[7,99+11]..[7,99+14])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/nested_equations.ml[7,99+17]..[7,99+22])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[7,99+21]..[7,99+22])
                    [
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[7,99+17]..[7,99+20])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[7,99+17]..[7,99+20])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[9,125+0]..[9,125+62])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[9,125+4]..[9,125+10])
          Ppat_var "to_int" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+4]..[9,125+10])
        expression (testsuite/tests/typing-gadts/nested_equations.ml[9,125+11]..[9,125+62])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/nested_equations.ml[9,125+20]..[9,125+62]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/nested_equations.ml[9,125+20]..[9,125+29])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/nested_equations.ml[9,125+21]..[9,125+22])
                Ppat_var "w" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+21]..[9,125+22])
              core_type (testsuite/tests/typing-gadts/nested_equations.ml[9,125+25]..[9,125+28])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+27]..[9,125+28])
                [
                  core_type (testsuite/tests/typing-gadts/nested_equations.ml[9,125+25]..[9,125+26])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+25]..[9,125+26])
                    []
                ]
            expression (testsuite/tests/typing-gadts/nested_equations.ml[9,125+30]..[9,125+62]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/nested_equations.ml[9,125+30]..[9,125+37])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/nested_equations.ml[9,125+31]..[9,125+32])
                  Ppat_var "x" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+31]..[9,125+32])
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[9,125+35]..[9,125+36])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+35]..[9,125+36])
                  []
              expression (testsuite/tests/typing-gadts/nested_equations.ml[9,125+38]..[9,125+62])
                Pexp_constraint
                expression (testsuite/tests/typing-gadts/nested_equations.ml[9,125+46]..[9,125+62])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/nested_equations.ml[9,125+50]..[9,125+53])
                        Ppat_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+50]..[9,125+53])
                        None
                      expression (testsuite/tests/typing-gadts/nested_equations.ml[9,125+56]..[9,125+57])
                        Pexp_ident "w" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+56]..[9,125+57])
                  ]
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[9,125+61]..[9,125+62])
                    Pexp_ident "x" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+61]..[9,125+62])
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[9,125+40]..[9,125+43])
                  Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[9,125+40]..[9,125+43])
                  []
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[10,190+0]..[13,264+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[10,190+9]..[13,264+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[10,190+9]..[13,264+2])
          Pexp_constant PConst_string ("\ntype _ t = Int : int t\nval to_int : 'a t -> 'a -> int = <fun>\n",(testsuite/tests/typing-gadts/nested_equations.ml[10,190+11]..[13,264+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[15,271+0]..[15,271+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[15,271+4]..[15,271+19]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[15,271+4]..[15,271+10])
            Ppat_var "w_bool" (testsuite/tests/typing-gadts/nested_equations.ml[15,271+4]..[15,271+10])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[15,271+13]..[15,271+19]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[15,271+13]..[15,271+19])
              Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[15,271+18]..[15,271+19])
              [
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[15,271+13]..[15,271+17])
                  Ptyp_constr "bool" (testsuite/tests/typing-gadts/nested_equations.ml[15,271+13]..[15,271+17])
                  []
              ]
        expression (testsuite/tests/typing-gadts/nested_equations.ml[15,271+4]..[15,271+33])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/nested_equations.ml[15,271+22]..[15,271+33])
            Pexp_apply
            expression (testsuite/tests/typing-gadts/nested_equations.ml[15,271+22]..[15,271+31])
              Pexp_ident "Obj.magic" (testsuite/tests/typing-gadts/nested_equations.ml[15,271+22]..[15,271+31])
            [
              <arg>
              Nolabel
                expression (testsuite/tests/typing-gadts/nested_equations.ml[15,271+32]..[15,271+33])
                  Pexp_constant PConst_int (0,None)
            ]
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[15,271+13]..[15,271+19])
            Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[15,271+18]..[15,271+19])
            [
              core_type (testsuite/tests/typing-gadts/nested_equations.ml[15,271+13]..[15,271+17])
                Ptyp_constr "bool" (testsuite/tests/typing-gadts/nested_equations.ml[15,271+13]..[15,271+17])
                []
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[16,307+0]..[16,307+51])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[16,307+4]..[16,307+10])
          Ppat_var "f_bool" (testsuite/tests/typing-gadts/nested_equations.ml[16,307+4]..[16,307+10])
        expression (testsuite/tests/typing-gadts/nested_equations.ml[16,307+11]..[16,307+51]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[16,307+11]..[16,307+21])
            Ppat_constraint
            pattern (testsuite/tests/typing-gadts/nested_equations.ml[16,307+12]..[16,307+13])
              Ppat_var "x" (testsuite/tests/typing-gadts/nested_equations.ml[16,307+12]..[16,307+13])
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[16,307+16]..[16,307+20])
              Ptyp_constr "bool" (testsuite/tests/typing-gadts/nested_equations.ml[16,307+16]..[16,307+20])
              []
          expression (testsuite/tests/typing-gadts/nested_equations.ml[16,307+22]..[16,307+51])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/nested_equations.ml[16,307+30]..[16,307+51])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[16,307+34]..[16,307+37])
                    Ppat_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[16,307+34]..[16,307+37])
                    None
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[16,307+40]..[16,307+46])
                    Pexp_ident "w_bool" (testsuite/tests/typing-gadts/nested_equations.ml[16,307+40]..[16,307+46])
              ]
              expression (testsuite/tests/typing-gadts/nested_equations.ml[16,307+50]..[16,307+51])
                Pexp_ident "x" (testsuite/tests/typing-gadts/nested_equations.ml[16,307+50]..[16,307+51])
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[16,307+24]..[16,307+27])
              Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[16,307+24]..[16,307+27])
              []
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[17,372+0]..[25,715+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[17,372+9]..[25,715+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[17,372+9]..[25,715+2])
          Pexp_constant PConst_string ("\nval w_bool : bool t = Int\nLine 2, characters 34-37:\n2 | let f_bool (x : bool) : int = let Int = w_bool in x;; (* fail *)\n                                      ^^^\nError: This pattern matches values of type int t\n       but a pattern was expected which matches values of type bool t\n       Type int is not compatible with type bool\n",(testsuite/tests/typing-gadts/nested_equations.ml[17,372+11]..[25,715+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[27,722+0]..[27,722+39])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[27,722+4]..[27,722+25]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[27,722+4]..[27,722+12])
            Ppat_var "w_buffer" (testsuite/tests/typing-gadts/nested_equations.ml[27,722+4]..[27,722+12])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[27,722+15]..[27,722+25]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[27,722+15]..[27,722+25])
              Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[27,722+24]..[27,722+25])
              [
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[27,722+15]..[27,722+23])
                  Ptyp_constr "Buffer.t" (testsuite/tests/typing-gadts/nested_equations.ml[27,722+15]..[27,722+23])
                  []
              ]
        expression (testsuite/tests/typing-gadts/nested_equations.ml[27,722+4]..[27,722+39])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/nested_equations.ml[27,722+28]..[27,722+39])
            Pexp_apply
            expression (testsuite/tests/typing-gadts/nested_equations.ml[27,722+28]..[27,722+37])
              Pexp_ident "Obj.magic" (testsuite/tests/typing-gadts/nested_equations.ml[27,722+28]..[27,722+37])
            [
              <arg>
              Nolabel
                expression (testsuite/tests/typing-gadts/nested_equations.ml[27,722+38]..[27,722+39])
                  Pexp_constant PConst_int (0,None)
            ]
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[27,722+15]..[27,722+25])
            Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[27,722+24]..[27,722+25])
            [
              core_type (testsuite/tests/typing-gadts/nested_equations.ml[27,722+15]..[27,722+23])
                Ptyp_constr "Buffer.t" (testsuite/tests/typing-gadts/nested_equations.ml[27,722+15]..[27,722+23])
                []
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[28,764+0]..[28,764+59])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[28,764+4]..[28,764+12])
          Ppat_var "f_buffer" (testsuite/tests/typing-gadts/nested_equations.ml[28,764+4]..[28,764+12])
        expression (testsuite/tests/typing-gadts/nested_equations.ml[28,764+13]..[28,764+59]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[28,764+13]..[28,764+27])
            Ppat_constraint
            pattern (testsuite/tests/typing-gadts/nested_equations.ml[28,764+14]..[28,764+15])
              Ppat_var "x" (testsuite/tests/typing-gadts/nested_equations.ml[28,764+14]..[28,764+15])
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[28,764+18]..[28,764+26])
              Ptyp_constr "Buffer.t" (testsuite/tests/typing-gadts/nested_equations.ml[28,764+18]..[28,764+26])
              []
          expression (testsuite/tests/typing-gadts/nested_equations.ml[28,764+28]..[28,764+59])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/nested_equations.ml[28,764+36]..[28,764+59])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[28,764+40]..[28,764+43])
                    Ppat_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[28,764+40]..[28,764+43])
                    None
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[28,764+46]..[28,764+54])
                    Pexp_ident "w_buffer" (testsuite/tests/typing-gadts/nested_equations.ml[28,764+46]..[28,764+54])
              ]
              expression (testsuite/tests/typing-gadts/nested_equations.ml[28,764+58]..[28,764+59])
                Pexp_ident "x" (testsuite/tests/typing-gadts/nested_equations.ml[28,764+58]..[28,764+59])
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[28,764+30]..[28,764+33])
              Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[28,764+30]..[28,764+33])
              []
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[29,835+0]..[32,918+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[29,835+9]..[32,918+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[29,835+9]..[32,918+2])
          Pexp_constant PConst_string ("\nval w_buffer : Buffer.t t = Int\nval f_buffer : Buffer.t -> int = <fun>\n",(testsuite/tests/typing-gadts/nested_equations.ml[29,835+11]..[32,918+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[34,925+0]..[34,925+37])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[34,925+4]..[34,925+23]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[34,925+4]..[34,925+10])
            Ppat_var "w_spec" (testsuite/tests/typing-gadts/nested_equations.ml[34,925+4]..[34,925+10])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[34,925+13]..[34,925+23]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[34,925+13]..[34,925+23])
              Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[34,925+22]..[34,925+23])
              [
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[34,925+13]..[34,925+21])
                  Ptyp_constr "Arg.spec" (testsuite/tests/typing-gadts/nested_equations.ml[34,925+13]..[34,925+21])
                  []
              ]
        expression (testsuite/tests/typing-gadts/nested_equations.ml[34,925+4]..[34,925+37])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/nested_equations.ml[34,925+26]..[34,925+37])
            Pexp_apply
            expression (testsuite/tests/typing-gadts/nested_equations.ml[34,925+26]..[34,925+35])
              Pexp_ident "Obj.magic" (testsuite/tests/typing-gadts/nested_equations.ml[34,925+26]..[34,925+35])
            [
              <arg>
              Nolabel
                expression (testsuite/tests/typing-gadts/nested_equations.ml[34,925+36]..[34,925+37])
                  Pexp_constant PConst_int (0,None)
            ]
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[34,925+13]..[34,925+23])
            Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[34,925+22]..[34,925+23])
            [
              core_type (testsuite/tests/typing-gadts/nested_equations.ml[34,925+13]..[34,925+21])
                Ptyp_constr "Arg.spec" (testsuite/tests/typing-gadts/nested_equations.ml[34,925+13]..[34,925+21])
                []
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[35,965+0]..[35,965+55])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[35,965+4]..[35,965+10])
          Ppat_var "f_spec" (testsuite/tests/typing-gadts/nested_equations.ml[35,965+4]..[35,965+10])
        expression (testsuite/tests/typing-gadts/nested_equations.ml[35,965+11]..[35,965+55]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[35,965+11]..[35,965+25])
            Ppat_constraint
            pattern (testsuite/tests/typing-gadts/nested_equations.ml[35,965+12]..[35,965+13])
              Ppat_var "x" (testsuite/tests/typing-gadts/nested_equations.ml[35,965+12]..[35,965+13])
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[35,965+16]..[35,965+24])
              Ptyp_constr "Arg.spec" (testsuite/tests/typing-gadts/nested_equations.ml[35,965+16]..[35,965+24])
              []
          expression (testsuite/tests/typing-gadts/nested_equations.ml[35,965+26]..[35,965+55])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/nested_equations.ml[35,965+34]..[35,965+55])
              Pexp_let Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[35,965+38]..[35,965+41])
                    Ppat_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[35,965+38]..[35,965+41])
                    None
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[35,965+44]..[35,965+50])
                    Pexp_ident "w_spec" (testsuite/tests/typing-gadts/nested_equations.ml[35,965+44]..[35,965+50])
              ]
              expression (testsuite/tests/typing-gadts/nested_equations.ml[35,965+54]..[35,965+55])
                Pexp_ident "x" (testsuite/tests/typing-gadts/nested_equations.ml[35,965+54]..[35,965+55])
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[35,965+28]..[35,965+31])
              Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[35,965+28]..[35,965+31])
              []
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[36,1034+0]..[44,1397+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[36,1034+9]..[44,1397+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[36,1034+9]..[44,1397+2])
          Pexp_constant PConst_string ("\nval w_spec : Arg.spec t = Int\nLine 2, characters 38-41:\n2 | let f_spec (x : Arg.spec) : int = let Int = w_spec in x;; (* fail *)\n                                          ^^^\nError: This pattern matches values of type int t\n       but a pattern was expected which matches values of type Arg.spec t\n       Type int is not compatible with type Arg.spec\n",(testsuite/tests/typing-gadts/nested_equations.ml[36,1034+11]..[44,1397+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+0]..[47,1454+48])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+7]..[46,1404+8])
      module_expr (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+9]..[47,1454+48])
        Pmod_constraint
        module_expr (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+2]..[47,1454+48])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+9]..[47,1454+21])
              Pstr_type Rec
              [
                type_declaration "u" (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+14]..[47,1454+15]) (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+9]..[47,1454+21])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+18]..[47,1454+21])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+18]..[47,1454+21])
                        []
              ]
            structure_item (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+22]..[47,1454+33])
              Pstr_value Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+26]..[47,1454+27])
                    Ppat_var "w" (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+26]..[47,1454+27])
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+30]..[47,1454+33])
                    Pexp_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+30]..[47,1454+33])
                    None
              ]
            structure_item (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+34]..[47,1454+44])
              Pstr_value Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+38]..[47,1454+39])
                    Ppat_var "x" (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+38]..[47,1454+39])
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[47,1454+42]..[47,1454+44])
                    Pexp_constant PConst_int (33,None)
              ]
          ]
        module_type (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+11]..[46,1404+47])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+15]..[46,1404+21])
              Psig_type Rec
              [
                type_declaration "u" (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+20]..[46,1404+21]) (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+15]..[46,1404+21])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            signature_item (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+22]..[46,1404+33])
              Psig_value
              value_description "w" (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+26]..[46,1404+27]) (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+22]..[46,1404+33])
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+30]..[46,1404+33])
                  Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+32]..[46,1404+33])
                  [
                    core_type (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+30]..[46,1404+31])
                      Ptyp_constr "u" (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+30]..[46,1404+31])
                      []
                  ]
                []
            signature_item (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+34]..[46,1404+43])
              Psig_value
              value_description "x" (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+38]..[46,1404+39]) (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+34]..[46,1404+43])
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+42]..[46,1404+43])
                  Ptyp_constr "u" (testsuite/tests/typing-gadts/nested_equations.ml[46,1404+42]..[46,1404+43])
                  []
                []
          ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+0]..[48,1505+36])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+4]..[48,1505+13]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+4]..[48,1505+7])
            Ppat_var "m_x" (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+4]..[48,1505+7])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+10]..[48,1505+13]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+10]..[48,1505+13])
              Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+10]..[48,1505+13])
              []
        expression (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+4]..[48,1505+36])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+16]..[48,1505+36])
            Pexp_let Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+20]..[48,1505+23])
                  Ppat_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+20]..[48,1505+23])
                  None
                expression (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+26]..[48,1505+29])
                  Pexp_ident "M.w" (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+26]..[48,1505+29])
            ]
            expression (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+33]..[48,1505+36])
              Pexp_ident "M.x" (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+33]..[48,1505+36])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+10]..[48,1505+13])
            Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[48,1505+10]..[48,1505+13])
            []
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[49,1544+0]..[52,1623+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[49,1544+9]..[52,1623+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[49,1544+9]..[52,1623+2])
          Pexp_constant PConst_string ("\nmodule M : sig type u val w : u t val x : u end\nval m_x : int = 33\n",(testsuite/tests/typing-gadts/nested_equations.ml[49,1544+11]..[52,1623+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+0]..[54,1630+76])
    Pstr_module
    "F" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+7]..[54,1630+8])
      module_expr (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+9]..[54,1630+76])
        Pmod_functor "X" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+10]..[54,1630+11])
        module_type (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+14]..[54,1630+44])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+18]..[54,1630+30])
              Psig_type Rec
              [
                type_declaration "u" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+23]..[54,1630+24]) (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+18]..[54,1630+30])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+27]..[54,1630+30])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+27]..[54,1630+30])
                        []
              ]
            signature_item (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+31]..[54,1630+40])
              Psig_value
              value_description "x" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+35]..[54,1630+36]) (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+31]..[54,1630+40])
                core_type (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+39]..[54,1630+40])
                  Ptyp_constr "u" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+39]..[54,1630+40])
                  []
                []
          ]
        module_expr (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+48]..[54,1630+76])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+55]..[54,1630+72])
              Pstr_value Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+59]..[54,1630+66]) ghost
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+59]..[54,1630+60])
                      Ppat_var "x" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+59]..[54,1630+60])
                    core_type (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+63]..[54,1630+66]) ghost
                      Ptyp_poly
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+63]..[54,1630+66])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+63]..[54,1630+66])
                        []
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+59]..[54,1630+72])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+69]..[54,1630+72])
                      Pexp_ident "X.x" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+69]..[54,1630+72])
                    core_type (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+63]..[54,1630+66])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[54,1630+63]..[54,1630+66])
                      []
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+0]..[55,1709+62])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+4]..[55,1709+14]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+4]..[55,1709+8])
            Ppat_var "fm_x" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+4]..[55,1709+8])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+11]..[55,1709+14]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+11]..[55,1709+14])
              Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+11]..[55,1709+14])
              []
        expression (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+4]..[55,1709+62])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+17]..[55,1709+62])
            Pexp_let Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+21]..[55,1709+24])
                  Ppat_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+21]..[55,1709+24])
                  None
                expression (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+27]..[55,1709+30])
                  Pexp_ident "M.w" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+27]..[55,1709+30])
            ]
            expression (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+34]..[55,1709+62])
              Pexp_letmodule "FM" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+45]..[55,1709+47])
              module_expr (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+50]..[55,1709+54])
                Pmod_apply
                module_expr (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+50]..[55,1709+51])
                  Pmod_ident "F" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+50]..[55,1709+51])
                module_expr (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+52]..[55,1709+53])
                  Pmod_ident "M" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+52]..[55,1709+53])
              expression (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+58]..[55,1709+62])
                Pexp_ident "FM.x" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+58]..[55,1709+62])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+11]..[55,1709+14])
            Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[55,1709+11]..[55,1709+14])
            []
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[56,1783+0]..[60,1896+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[56,1783+9]..[60,1896+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[56,1783+9]..[60,1896+2])
          Pexp_constant PConst_string ("\nmodule F :\n  functor (X : sig type u = int val x : u end) -> sig val x : int end\nval fm_x : int = 33\n",(testsuite/tests/typing-gadts/nested_equations.ml[56,1783+11]..[60,1896+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+0]..[62,1903+74])
    Pstr_module
    "M'" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+7]..[62,1903+9])
      module_expr (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+12]..[62,1903+74])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+19]..[62,1903+70])
            Pstr_module
            "M" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+26]..[62,1903+27])
              module_expr (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+28]..[62,1903+70])
                Pmod_constraint
                module_expr (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+69]..[62,1903+70])
                  Pmod_ident "M" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+69]..[62,1903+70])
                module_type (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+30]..[62,1903+66])
                  Pmty_signature
                  [
                    signature_item (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+34]..[62,1903+40])
                      Psig_type Rec
                      [
                        type_declaration "u" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+39]..[62,1903+40]) (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+34]..[62,1903+40])
                          ptype_params =
                            []
                          ptype_cstrs =
                            []
                          ptype_kind =
                            Ptype_abstract
                          ptype_private = Public
                          ptype_manifest =
                            None
                      ]
                    signature_item (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+41]..[62,1903+52])
                      Psig_value
                      value_description "w" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+45]..[62,1903+46]) (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+41]..[62,1903+52])
                        core_type (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+49]..[62,1903+52])
                          Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+51]..[62,1903+52])
                          [
                            core_type (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+49]..[62,1903+50])
                              Ptyp_constr "u" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+49]..[62,1903+50])
                              []
                          ]
                        []
                    signature_item (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+53]..[62,1903+62])
                      Psig_value
                      value_description "x" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+57]..[62,1903+58]) (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+53]..[62,1903+62])
                        core_type (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+61]..[62,1903+62])
                          Ptyp_constr "u" (testsuite/tests/typing-gadts/nested_equations.ml[62,1903+61]..[62,1903+62])
                          []
                        []
                  ]
        ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+0]..[64,2048+32])
    Pstr_module
    "F'" (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+7]..[63,1980+9])
      module_expr (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+10]..[64,2048+32])
        Pmod_functor "X" (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+11]..[63,1980+12])
        module_type (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+15]..[63,1980+64])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+19]..[63,1980+60])
              Psig_module "M" (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+26]..[63,1980+27])
              module_type (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+30]..[63,1980+60])
                Pmty_signature
                [
                  signature_item (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+34]..[63,1980+46])
                    Psig_type Rec
                    [
                      type_declaration "u" (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+39]..[63,1980+40]) (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+34]..[63,1980+46])
                        ptype_params =
                          []
                        ptype_cstrs =
                          []
                        ptype_kind =
                          Ptype_abstract
                        ptype_private = Public
                        ptype_manifest =
                          Some
                            core_type (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+43]..[63,1980+46])
                              Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+43]..[63,1980+46])
                              []
                    ]
                  signature_item (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+47]..[63,1980+56])
                    Psig_value
                    value_description "x" (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+51]..[63,1980+52]) (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+47]..[63,1980+56])
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+55]..[63,1980+56])
                        Ptyp_constr "u" (testsuite/tests/typing-gadts/nested_equations.ml[63,1980+55]..[63,1980+56])
                        []
                      []
                ]
          ]
        module_expr (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+2]..[64,2048+32])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+9]..[64,2048+28])
              Pstr_value Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+13]..[64,2048+20]) ghost
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+13]..[64,2048+14])
                      Ppat_var "x" (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+13]..[64,2048+14])
                    core_type (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+17]..[64,2048+20]) ghost
                      Ptyp_poly
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+17]..[64,2048+20])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+17]..[64,2048+20])
                        []
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+13]..[64,2048+28])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+23]..[64,2048+28])
                      Pexp_ident "X.M.x" (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+23]..[64,2048+28])
                    core_type (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+17]..[64,2048+20])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[64,2048+17]..[64,2048+20])
                      []
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+0]..[66,2101+54])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+4]..[65,2083+15]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+4]..[65,2083+9])
            Ppat_var "fm'_x" (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+4]..[65,2083+9])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+12]..[65,2083+15]) ghost
            Ptyp_poly
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+12]..[65,2083+15])
              Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+12]..[65,2083+15])
              []
        expression (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+4]..[66,2101+54])
          Pexp_constraint
          expression (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+2]..[66,2101+54])
            Pexp_let Nonrec
            [
              <def>
                pattern (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+6]..[66,2101+9])
                  Ppat_construct "Int" (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+6]..[66,2101+9])
                  None
                expression (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+12]..[66,2101+18])
                  Pexp_ident "M'.M.w" (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+12]..[66,2101+18])
            ]
            expression (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+22]..[66,2101+54])
              Pexp_letmodule "FM'" (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+33]..[66,2101+36])
              module_expr (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+39]..[66,2101+45])
                Pmod_apply
                module_expr (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+39]..[66,2101+41])
                  Pmod_ident "F'" (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+39]..[66,2101+41])
                module_expr (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+42]..[66,2101+44])
                  Pmod_ident "M'" (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+42]..[66,2101+44])
              expression (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+49]..[66,2101+54])
                Pexp_ident "FM'.x" (testsuite/tests/typing-gadts/nested_equations.ml[66,2101+49]..[66,2101+54])
          core_type (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+12]..[65,2083+15])
            Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[65,2083+12]..[65,2083+15])
            []
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[67,2167+0]..[73,2373+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[67,2167+9]..[73,2373+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[67,2167+9]..[73,2373+2])
          Pexp_constant PConst_string ("\nmodule M' : sig module M : sig type u val w : u t val x : u end end\nmodule F' :\n  functor (X : sig module M : sig type u = int val x : u end end) ->\n    sig val x : int end\nval fm'_x : int = 33\n",(testsuite/tests/typing-gadts/nested_equations.ml[67,2167+11]..[73,2373+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+0]..[77,2395+35])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+12]..[77,2395+14]) (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+0]..[77,2395+35])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+6]..[77,2395+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+9]..[77,2395+10])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+17]..[77,2395+35])
                "Refl" (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+17]..[77,2395+21])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+24]..[77,2395+35])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+33]..[77,2395+35])
                    [
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+25]..[77,2395+27])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[77,2395+29]..[77,2395+31])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[79,2432+0]..[82,2485+3])
    Pstr_modtype "S" (testsuite/tests/typing-gadts/nested_equations.ml[79,2432+12]..[79,2432+13])
      module_type (testsuite/tests/typing-gadts/nested_equations.ml[79,2432+16]..[82,2485+3])
        Pmty_signature
        [
          signature_item (testsuite/tests/typing-gadts/nested_equations.ml[80,2452+2]..[80,2452+8])
            Psig_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/nested_equations.ml[80,2452+7]..[80,2452+8]) (testsuite/tests/typing-gadts/nested_equations.ml[80,2452+2]..[80,2452+8])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          signature_item (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+2]..[81,2461+23])
            Psig_value
            value_description "eql" (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+6]..[81,2461+9]) (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+2]..[81,2461+23])
              core_type (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+12]..[81,2461+23])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+21]..[81,2461+23])
                [
                  core_type (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+13]..[81,2461+14])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+13]..[81,2461+14])
                    []
                  core_type (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+16]..[81,2461+19])
                    Ptyp_constr "int" (testsuite/tests/typing-gadts/nested_equations.ml[81,2461+16]..[81,2461+19])
                    []
                ]
              []
        ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[84,2490+0]..[87,2561+3])
    Pstr_module
    "F" (testsuite/tests/typing-gadts/nested_equations.ml[84,2490+7]..[84,2490+8])
      module_expr (testsuite/tests/typing-gadts/nested_equations.ml[84,2490+9]..[87,2561+3])
        Pmod_functor "M" (testsuite/tests/typing-gadts/nested_equations.ml[84,2490+10]..[84,2490+11])
        module_type (testsuite/tests/typing-gadts/nested_equations.ml[84,2490+14]..[84,2490+15])
          Pmty_ident "S" (testsuite/tests/typing-gadts/nested_equations.ml[84,2490+14]..[84,2490+15])
        module_expr (testsuite/tests/typing-gadts/nested_equations.ml[84,2490+19]..[87,2561+3])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+2]..[86,2535+25])
              Pstr_value Nonrec
              [
                <def>
                  pattern (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+6]..[85,2516+16]) ghost
                    Ppat_constraint
                    pattern (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+6]..[85,2516+10])
                      Ppat_var "zero" (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+6]..[85,2516+10])
                    core_type (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+13]..[85,2516+16]) ghost
                      Ptyp_poly
                      core_type (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+13]..[85,2516+16])
                        Ptyp_constr "M.t" (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+13]..[85,2516+16])
                        []
                  expression (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+6]..[86,2535+25])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/nested_equations.ml[86,2535+4]..[86,2535+25])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (testsuite/tests/typing-gadts/nested_equations.ml[86,2535+8]..[86,2535+12])
                            Ppat_construct "Refl" (testsuite/tests/typing-gadts/nested_equations.ml[86,2535+8]..[86,2535+12])
                            None
                          expression (testsuite/tests/typing-gadts/nested_equations.ml[86,2535+15]..[86,2535+20])
                            Pexp_ident "M.eql" (testsuite/tests/typing-gadts/nested_equations.ml[86,2535+15]..[86,2535+20])
                      ]
                      expression (testsuite/tests/typing-gadts/nested_equations.ml[86,2535+24]..[86,2535+25])
                        Pexp_constant PConst_int (0,None)
                    core_type (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+13]..[85,2516+16])
                      Ptyp_constr "M.t" (testsuite/tests/typing-gadts/nested_equations.ml[85,2516+13]..[85,2516+16])
                      []
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/nested_equations.ml[88,2567+0]..[92,2721+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/nested_equations.ml[88,2567+9]..[92,2721+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/nested_equations.ml[88,2567+9]..[92,2721+2])
          Pexp_constant PConst_string ("\ntype (_, _) eq = Refl : ('a, 'a) eq\nmodule type S = sig type t val eql : (t, int) eq end\nmodule F : functor (M : S) -> sig val zero : M.t end\n",(testsuite/tests/typing-gadts/nested_equations.ml[88,2567+11]..[92,2721+0]),Some "")
    ]
]

