File "testsuite/tests/typing-gadts/principality-and-gadts.ml", line 1:
Warning 24 [bad-module-name]: bad source file name: "Principality-and-gadts" is not a valid module name.
[
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+0]..[4,24+36])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+7]..[4,24+8])
      module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+11]..[4,24+36])
        Pmod_structure
        [
          structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+18]..[4,24+32])
            Pstr_type Rec
            [
              type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+23]..[4,24+24]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+18]..[4,24+32])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+27]..[4,24+28])
                        "A" (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+27]..[4,24+28])
                        []
                        None
                      (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+29]..[4,24+32])
                        "B" (testsuite/tests/typing-gadts/principality-and-gadts.ml[4,24+31]..[4,24+32])
                        []
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
        ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[5,63+0]..[7,109+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[5,63+9]..[7,109+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[5,63+9]..[7,109+2])
          Pexp_constant PConst_string ("\nmodule M : sig type t = A | B end\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[5,63+11]..[7,109+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+0]..[9,116+33])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+8]..[9,116+9]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+0]..[9,116+33])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+5]..[9,116+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+12]..[9,116+21])
                "I" (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+12]..[9,116+13])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+16]..[9,116+21])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+20]..[9,116+21])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+16]..[9,116+19])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+16]..[9,116+19])
                        []
                    ]
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+22]..[9,116+33])
                "M" (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+24]..[9,116+25])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+28]..[9,116+33])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+32]..[9,116+33])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+28]..[9,116+31])
                        Ptyp_constr "M.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[9,116+28]..[9,116+31])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[10,152+0]..[12,198+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[10,152+9]..[12,198+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[10,152+9]..[12,198+2])
          Pexp_constant PConst_string ("\ntype 'a t = I : int t | M : M.t t\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[10,152+11]..[12,198+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+0]..[14,205+35])
    Pstr_type Rec
    [
      type_declaration "dyn" (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+5]..[14,205+8]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+0]..[14,205+35])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+11]..[14,205+35])
                "Sigma" (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+11]..[14,205+16])
                [
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+19]..[14,205+23])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+22]..[14,205+23])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+19]..[14,205+21])
                        Ptyp_var a
                    ]
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+26]..[14,205+28])
                    Ptyp_var a
                ]
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+32]..[14,205+35])
                    Ptyp_constr "dyn" (testsuite/tests/typing-gadts/principality-and-gadts.ml[14,205+32]..[14,205+35])
                    []
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[15,243+0]..[17,291+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[15,243+9]..[17,291+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[15,243+9]..[17,291+2])
          Pexp_constant PConst_string ("\ntype dyn = Sigma : 'a t * 'a -> dyn\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[15,243+11]..[17,291+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+0]..[19,298+35])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+4]..[19,298+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+4]..[19,298+5])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+8]..[19,298+35])
          Pexp_function
          [
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+17]..[19,298+29])
                Ppat_construct "Sigma" (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+17]..[19,298+22])
                Some
                  []
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+23]..[19,298+29])
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+24]..[19,298+25])
                        Ppat_construct "M" (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+24]..[19,298+25])
                        None
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+27]..[19,298+28])
                        Ppat_construct "A" (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+27]..[19,298+28])
                        None
                    ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+33]..[19,298+35])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[19,298+33]..[19,298+35])
                None
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[20,336+0]..[28,614+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[20,336+9]..[28,614+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[20,336+9]..[28,614+2])
          Pexp_constant PConst_string ("\nLine 1, characters 8-35:\n1 | let f = function Sigma (M, A) -> ();;\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\nSigma (M, B)\nval f : dyn -> unit = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[20,336+11]..[28,614+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+0]..[30,621+44])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+7]..[30,621+8]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+0]..[30,621+44])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+5]..[30,621+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+11]..[30,621+25])
                "IntLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+11]..[30,621+17])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+20]..[30,621+25])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+24]..[30,621+25])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+20]..[30,621+23])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+20]..[30,621+23])
                        []
                    ]
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+26]..[30,621+44])
                "BoolLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+28]..[30,621+35])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+38]..[30,621+44])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+43]..[30,621+44])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+38]..[30,621+42])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/principality-and-gadts.ml[30,621+38]..[30,621+42])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[31,668+0]..[33,725+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[31,668+9]..[33,725+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[31,668+9]..[33,725+2])
          Pexp_constant PConst_string ("\ntype _ t = IntLit : int t | BoolLit : bool t\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[31,668+11]..[33,725+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+0]..[41,850+19])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+4]..[37,763+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+4]..[37,763+5])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+6]..[41,850+19])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+15]..[41,850+19]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+15]..[37,763+16])
              Ppat_var "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+15]..[37,763+16])
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+17]..[41,850+19]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+17]..[37,763+24])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+18]..[37,763+19])
                  Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+18]..[37,763+19])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+22]..[37,763+23])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[37,763+22]..[37,763+23])
                  []
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+2]..[41,850+19])
                Pexp_sequence
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+2]..[38,790+19])
                  Pexp_apply
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+2]..[38,790+8])
                    Pexp_ident "ignore" (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+2]..[38,790+8])
                  [
                    <arg>
                    Nolabel
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+10]..[38,790+19])
                        Pexp_constraint
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+11]..[38,790+12])
                          Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+11]..[38,790+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+15]..[38,790+18])
                          Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+17]..[38,790+18])
                          [
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+15]..[38,790+16])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[38,790+15]..[38,790+16])
                              []
                          ]
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[39,811+2]..[41,850+19])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[39,811+8]..[39,811+12])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[39,811+8]..[39,811+9])
                        Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[39,811+8]..[39,811+9])
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[39,811+11]..[39,811+12])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[39,811+11]..[39,811+12])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+4]..[40,829+13])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+4]..[40,829+10])
                            Ppat_construct "IntLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+4]..[40,829+10])
                            None
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+12]..[40,829+13])
                            Ppat_var "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+12]..[40,829+13])
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+17]..[40,829+20])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+18]..[40,829+19])
                          Pexp_ident "+" (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+18]..[40,829+19])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+17]..[40,829+18])
                              Pexp_ident "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+17]..[40,829+18])
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[40,829+19]..[40,829+20])
                              Pexp_constant PConst_int (1,None)
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[41,850+4]..[41,850+14])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[41,850+4]..[41,850+11])
                            Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[41,850+4]..[41,850+11])
                            None
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[41,850+13]..[41,850+14])
                            Ppat_var "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[41,850+13]..[41,850+14])
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[41,850+18]..[41,850+19])
                        Pexp_constant PConst_int (1,None)
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[43,873+0]..[57,1380+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[43,873+9]..[57,1380+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[43,873+9]..[57,1380+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[43,873+9]..[45,919+2])
              Pexp_constant PConst_string ("\nval f : 'a t -> 'a -> int = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[43,873+11]..[45,919+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[45,919+4]..[57,1380+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[45,919+4]..[45,919+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[45,919+13]..[57,1380+2])
                  Pexp_constant PConst_string ("\nLine 4, characters 4-10:\n4 |   | IntLit, n -> n+1\n        ^^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering int and a as equal.\nBut the knowledge of these types is not principal.\nLine 5, characters 4-11:\n5 |   | BoolLit, b -> 1\n        ^^^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering bool and a as equal.\nBut the knowledge of these types is not principal.\nval f : 'a t -> 'a -> int = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[45,919+15]..[57,1380+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+0]..[63,1472+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+4]..[59,1385+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+4]..[59,1385+5])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+6]..[63,1472+13])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+15]..[63,1472+13]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+15]..[59,1385+16])
              Ppat_var "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+15]..[59,1385+16])
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+17]..[63,1472+13]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+17]..[59,1385+24])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+18]..[59,1385+19])
                  Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+18]..[59,1385+19])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+22]..[59,1385+23])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[59,1385+22]..[59,1385+23])
                  []
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+2]..[63,1472+13])
                Pexp_sequence
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+2]..[60,1412+19])
                  Pexp_apply
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+2]..[60,1412+8])
                    Pexp_ident "ignore" (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+2]..[60,1412+8])
                  [
                    <arg>
                    Nolabel
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+10]..[60,1412+19])
                        Pexp_constraint
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+11]..[60,1412+12])
                          Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+11]..[60,1412+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+15]..[60,1412+18])
                          Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+17]..[60,1412+18])
                          [
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+15]..[60,1412+16])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[60,1412+15]..[60,1412+16])
                              []
                          ]
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[61,1433+2]..[63,1472+13])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[61,1433+8]..[61,1433+12])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[61,1433+8]..[61,1433+9])
                        Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[61,1433+8]..[61,1433+9])
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[61,1433+11]..[61,1433+12])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[61,1433+11]..[61,1433+12])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+4]..[62,1451+13])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+4]..[62,1451+10])
                            Ppat_construct "IntLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+4]..[62,1451+10])
                            None
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+12]..[62,1451+13])
                            Ppat_var "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+12]..[62,1451+13])
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+17]..[62,1451+20])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+18]..[62,1451+19])
                          Pexp_ident "+" (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+18]..[62,1451+19])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+17]..[62,1451+18])
                              Pexp_ident "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+17]..[62,1451+18])
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[62,1451+19]..[62,1451+20])
                              Pexp_constant PConst_int (1,None)
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[63,1472+4]..[63,1472+8])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[63,1472+4]..[63,1472+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[63,1472+7]..[63,1472+8])
                            Ppat_any
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[63,1472+12]..[63,1472+13])
                        Pexp_constant PConst_int (1,None)
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[65,1489+0]..[74,1790+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[65,1489+9]..[74,1790+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[65,1489+9]..[74,1790+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[65,1489+9]..[67,1535+2])
              Pexp_constant PConst_string ("\nval f : 'a t -> 'a -> int = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[65,1489+11]..[67,1535+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[67,1535+4]..[74,1790+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[67,1535+4]..[67,1535+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[67,1535+13]..[74,1790+2])
                  Pexp_constant PConst_string ("\nLine 4, characters 4-10:\n4 |   | IntLit, n -> n+1\n        ^^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering int and a as equal.\nBut the knowledge of these types is not principal.\nval f : 'a t -> 'a -> int = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[67,1535+15]..[74,1790+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+0]..[82,1895+19])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+4]..[77,1796+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+4]..[77,1796+5])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+6]..[82,1895+19])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+15]..[82,1895+19]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+15]..[77,1796+16])
              Ppat_var "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+15]..[77,1796+16])
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+17]..[82,1895+19]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+17]..[77,1796+24])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+18]..[77,1796+19])
                  Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+18]..[77,1796+19])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+22]..[77,1796+23])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[77,1796+22]..[77,1796+23])
                  []
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[78,1823+2]..[82,1895+19])
                Pexp_sequence
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[78,1823+2]..[81,1888+5])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[78,1823+14]..[78,1823+18])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[78,1823+14]..[78,1823+15])
                        Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[78,1823+14]..[78,1823+15])
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[78,1823+17]..[78,1823+18])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[78,1823+17]..[78,1823+18])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+4]..[79,1847+13])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+4]..[79,1847+10])
                            Ppat_construct "IntLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+4]..[79,1847+10])
                            None
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+12]..[79,1847+13])
                            Ppat_var "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+12]..[79,1847+13])
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+17]..[79,1847+20])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+18]..[79,1847+19])
                          Pexp_ident "+" (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+18]..[79,1847+19])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+17]..[79,1847+18])
                              Pexp_ident "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+17]..[79,1847+18])
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[79,1847+19]..[79,1847+20])
                              Pexp_constant PConst_int (1,None)
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[80,1868+4]..[80,1868+14])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[80,1868+4]..[80,1868+11])
                            Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[80,1868+4]..[80,1868+11])
                            None
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[80,1868+13]..[80,1868+14])
                            Ppat_var "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[80,1868+13]..[80,1868+14])
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[80,1868+18]..[80,1868+19])
                        Pexp_constant PConst_int (1,None)
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+2]..[82,1895+19])
                  Pexp_apply
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+2]..[82,1895+8])
                    Pexp_ident "ignore" (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+2]..[82,1895+8])
                  [
                    <arg>
                    Nolabel
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+10]..[82,1895+19])
                        Pexp_constraint
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+11]..[82,1895+12])
                          Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+11]..[82,1895+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+15]..[82,1895+18])
                          Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+17]..[82,1895+18])
                          [
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+15]..[82,1895+16])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[82,1895+15]..[82,1895+16])
                              []
                          ]
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[84,1918+0]..[91,2163+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[84,1918+9]..[91,2163+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[84,1918+9]..[91,2163+2])
          Pexp_constant PConst_string ("\nLine 4, characters 4-11:\n4 |   | BoolLit, b -> 1\n        ^^^^^^^\nError: This pattern matches values of type bool t\n       but a pattern was expected which matches values of type int t\n       Type bool is not compatible with type int\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[84,1918+11]..[91,2163+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+0]..[98,2261+19])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+4]..[93,2168+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+4]..[93,2168+5])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+6]..[98,2261+19])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+15]..[98,2261+19]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+15]..[93,2168+16])
              Ppat_var "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+15]..[93,2168+16])
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+17]..[98,2261+19]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+17]..[93,2168+24])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+18]..[93,2168+19])
                  Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+18]..[93,2168+19])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+22]..[93,2168+23])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[93,2168+22]..[93,2168+23])
                  []
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[94,2195+2]..[98,2261+19])
                Pexp_sequence
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[94,2195+2]..[97,2254+5])
                  Pexp_match
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[94,2195+14]..[94,2195+18])
                    Pexp_tuple
                    [
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[94,2195+14]..[94,2195+15])
                        Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[94,2195+14]..[94,2195+15])
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[94,2195+17]..[94,2195+18])
                        Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[94,2195+17]..[94,2195+18])
                    ]
                  [
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+4]..[95,2219+13])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+4]..[95,2219+10])
                            Ppat_construct "IntLit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+4]..[95,2219+10])
                            None
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+12]..[95,2219+13])
                            Ppat_var "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+12]..[95,2219+13])
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+17]..[95,2219+20])
                        Pexp_apply
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+18]..[95,2219+19])
                          Pexp_ident "+" (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+18]..[95,2219+19])
                        [
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+17]..[95,2219+18])
                              Pexp_ident "n" (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+17]..[95,2219+18])
                          <arg>
                          Nolabel
                            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[95,2219+19]..[95,2219+20])
                              Pexp_constant PConst_int (1,None)
                        ]
                    <case>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[96,2240+4]..[96,2240+8])
                        Ppat_tuple
                        [
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[96,2240+4]..[96,2240+5])
                            Ppat_any
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[96,2240+7]..[96,2240+8])
                            Ppat_any
                        ]
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[96,2240+12]..[96,2240+13])
                        Pexp_constant PConst_int (1,None)
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+2]..[98,2261+19])
                  Pexp_apply
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+2]..[98,2261+8])
                    Pexp_ident "ignore" (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+2]..[98,2261+8])
                  [
                    <arg>
                    Nolabel
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+10]..[98,2261+19])
                        Pexp_constraint
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+11]..[98,2261+12])
                          Pexp_ident "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+11]..[98,2261+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+15]..[98,2261+18])
                          Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+17]..[98,2261+18])
                          [
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+15]..[98,2261+16])
                              Ptyp_constr "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[98,2261+15]..[98,2261+16])
                              []
                          ]
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[100,2284+0]..[105,2447+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[100,2284+9]..[105,2447+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[100,2284+9]..[105,2447+2])
          Pexp_constant PConst_string ("\nLine 3, characters 17-18:\n3 |   | IntLit, n -> n+1\n                     ^\nError: This expression has type a but an expression was expected of type int\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[100,2284+11]..[105,2447+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+0]..[111,2528+17])
    Pstr_type Rec
    [
      type_declaration "ab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+7]..[111,2528+9]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+0]..[111,2528+17])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+5]..[111,2528+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+12]..[111,2528+13])
                "A" (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+12]..[111,2528+13])
                []
                None
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+14]..[111,2528+17])
                "B" (testsuite/tests/typing-gadts/principality-and-gadts.ml[111,2528+16]..[111,2528+17])
                []
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[113,2547+0]..[119,2712+3])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/principality-and-gadts.ml[113,2547+7]..[113,2547+8])
      module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[113,2547+9]..[119,2712+3])
        Pmod_constraint
        module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[116,2622+6]..[119,2712+3])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+2]..[117,2635+29])
              Pstr_type Rec
              [
                type_declaration "mab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+10]..[117,2635+13]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+2]..[117,2635+29])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+7]..[117,2635+9])
                        Ptyp_var a
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+24]..[117,2635+25])
                          "A" (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+24]..[117,2635+25])
                          []
                          None
                        (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+26]..[117,2635+29])
                          "B" (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+28]..[117,2635+29])
                          []
                          None
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+16]..[117,2635+21])
                        Ptyp_constr "ab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+19]..[117,2635+21])
                        [
                          core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[117,2635+16]..[117,2635+18])
                            Ptyp_var a
                        ]
              ]
            structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+2]..[118,2665+46])
              Pstr_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+9]..[118,2665+10]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+2]..[118,2665+46])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+7]..[118,2665+8])
                        Ptyp_any
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+13]..[118,2665+27])
                          "AB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+13]..[118,2665+15])
                          []
                          Some
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+18]..[118,2665+27])
                              Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+26]..[118,2665+27])
                              [
                                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+18]..[118,2665+25])
                                  Ptyp_constr "ab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+23]..[118,2665+25])
                                  [
                                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+18]..[118,2665+22])
                                      Ptyp_constr "unit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+18]..[118,2665+22])
                                      []
                                  ]
                              ]
                        (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+28]..[118,2665+46])
                          "MAB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+30]..[118,2665+33])
                          []
                          Some
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+36]..[118,2665+46])
                              Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+45]..[118,2665+46])
                              [
                                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+36]..[118,2665+44])
                                  Ptyp_constr "mab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+41]..[118,2665+44])
                                  [
                                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+36]..[118,2665+40])
                                      Ptyp_constr "unit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[118,2665+36]..[118,2665+40])
                                      []
                                  ]
                              ]
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
          ]
        module_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[113,2547+11]..[116,2622+3])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[114,2562+2]..[114,2562+12])
              Psig_type Rec
              [
                type_declaration "mab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[114,2562+9]..[114,2562+12]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[114,2562+2]..[114,2562+12])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[114,2562+7]..[114,2562+8])
                        Ptyp_any
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            signature_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+2]..[115,2575+46])
              Psig_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+9]..[115,2575+10]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+2]..[115,2575+46])
                  ptype_params =
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+7]..[115,2575+8])
                        Ptyp_any
                    ]
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+13]..[115,2575+27])
                          "AB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+13]..[115,2575+15])
                          []
                          Some
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+18]..[115,2575+27])
                              Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+26]..[115,2575+27])
                              [
                                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+18]..[115,2575+25])
                                  Ptyp_constr "ab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+23]..[115,2575+25])
                                  [
                                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+18]..[115,2575+22])
                                      Ptyp_constr "unit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+18]..[115,2575+22])
                                      []
                                  ]
                              ]
                        (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+28]..[115,2575+46])
                          "MAB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+30]..[115,2575+33])
                          []
                          Some
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+36]..[115,2575+46])
                              Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+45]..[115,2575+46])
                              [
                                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+36]..[115,2575+44])
                                  Ptyp_constr "mab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+41]..[115,2575+44])
                                  [
                                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+36]..[115,2575+40])
                                      Ptyp_constr "unit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[115,2575+36]..[115,2575+40])
                                      []
                                  ]
                              ]
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[120,2718+0]..[123,2823+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[120,2718+9]..[123,2823+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[120,2718+9]..[123,2823+2])
          Pexp_constant PConst_string ("\ntype _ ab = A | B\nmodule M : sig type _ mab type _ t = AB : unit ab t | MAB : unit mab t end\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[120,2718+11]..[123,2823+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[125,2828+0]..[125,2828+6])
    Pstr_open Fresh
    module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[125,2828+5]..[125,2828+6])
      Pmod_ident "M" (testsuite/tests/typing-gadts/principality-and-gadts.ml[125,2828+5]..[125,2828+6])
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[126,2837+0]..[127,2849+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[126,2837+9]..[127,2849+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[126,2837+9]..[127,2849+2])
          Pexp_constant PConst_string ("\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[126,2837+11]..[127,2849+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[129,2854+0]..[132,2897+16])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[129,2854+4]..[129,2854+6])
          Ppat_var "f1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[129,2854+4]..[129,2854+6])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[129,2854+7]..[132,2897+16]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[129,2854+7]..[129,2854+9])
            Ppat_var "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[129,2854+7]..[129,2854+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[130,2866+2]..[132,2897+16])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[130,2866+8]..[130,2866+10])
              Pexp_ident "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[130,2866+8]..[130,2866+10])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[131,2882+4]..[131,2882+6])
                  Ppat_construct "AB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[131,2882+4]..[131,2882+6])
                  None
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[131,2882+10]..[131,2882+14])
                  Pexp_construct "true" (testsuite/tests/typing-gadts/principality-and-gadts.ml[131,2882+10]..[131,2882+14])
                  None
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[132,2897+4]..[132,2897+7])
                  Ppat_construct "MAB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[132,2897+4]..[132,2897+7])
                  None
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[132,2897+11]..[132,2897+16])
                  Pexp_construct "false" (testsuite/tests/typing-gadts/principality-and-gadts.ml[132,2897+11]..[132,2897+16])
                  None
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[133,2916+0]..[142,3230+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[133,2916+9]..[142,3230+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[133,2916+9]..[142,3230+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[133,2916+9]..[135,2965+2])
              Pexp_constant PConst_string ("\nval f1 : unit ab M.t -> bool = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[133,2916+11]..[135,2965+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[135,2965+4]..[142,3230+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[135,2965+4]..[135,2965+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[135,2965+13]..[142,3230+2])
                  Pexp_constant PConst_string ("\nLine 4, characters 4-7:\n4 |   | MAB -> false;;\n        ^^^\nWarning 18 [not-principal]: typing this pattern requires considering unit M.mab and unit ab as equal.\nBut the knowledge of these types is not principal.\nval f1 : unit ab M.t -> bool = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[135,2965+15]..[142,3230+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[144,3235+0]..[148,3308+16])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[144,3235+4]..[144,3235+6])
          Ppat_var "f2" (testsuite/tests/typing-gadts/principality-and-gadts.ml[144,3235+4]..[144,3235+6])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[144,3235+7]..[148,3308+16])
          Pexp_newtype "x"
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[144,3235+16]..[148,3308+16]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[144,3235+16]..[144,3235+18])
              Ppat_var "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[144,3235+16]..[144,3235+18])
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+2]..[148,3308+16])
              Pexp_sequence
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+2]..[145,3256+19])
                Pexp_apply
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+2]..[145,3256+8])
                  Pexp_ident "ignore" (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+2]..[145,3256+8])
                [
                  <arg>
                  Nolabel
                    expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+9]..[145,3256+19])
                      Pexp_constraint
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+10]..[145,3256+12])
                        Pexp_ident "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+10]..[145,3256+12])
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+15]..[145,3256+18])
                        Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+17]..[145,3256+18])
                        [
                          core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+15]..[145,3256+16])
                            Ptyp_constr "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[145,3256+15]..[145,3256+16])
                            []
                        ]
                ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[146,3277+2]..[148,3308+16])
                Pexp_match
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[146,3277+8]..[146,3277+10])
                  Pexp_ident "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[146,3277+8]..[146,3277+10])
                [
                  <case>
                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[147,3293+4]..[147,3293+6])
                      Ppat_construct "AB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[147,3293+4]..[147,3293+6])
                      None
                    expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[147,3293+10]..[147,3293+14])
                      Pexp_construct "true" (testsuite/tests/typing-gadts/principality-and-gadts.ml[147,3293+10]..[147,3293+14])
                      None
                  <case>
                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[148,3308+4]..[148,3308+7])
                      Ppat_construct "MAB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[148,3308+4]..[148,3308+7])
                      None
                    expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[148,3308+11]..[148,3308+16])
                      Pexp_construct "false" (testsuite/tests/typing-gadts/principality-and-gadts.ml[148,3308+11]..[148,3308+16])
                      None
                ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[149,3327+0]..[163,3823+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[149,3327+9]..[163,3823+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[149,3327+9]..[163,3823+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[149,3327+9]..[151,3371+2])
              Pexp_constant PConst_string ("\nval f2 : 'x M.t -> bool = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[149,3327+11]..[151,3371+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[151,3371+4]..[163,3823+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[151,3371+4]..[151,3371+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[151,3371+13]..[163,3823+2])
                  Pexp_constant PConst_string ("\nLine 4, characters 4-6:\n4 |   | AB -> true\n        ^^\nWarning 18 [not-principal]: typing this pattern requires considering unit ab and x as equal.\nBut the knowledge of these types is not principal.\nLine 5, characters 4-7:\n5 |   | MAB -> false;;\n        ^^^\nWarning 18 [not-principal]: typing this pattern requires considering unit M.mab and x as equal.\nBut the knowledge of these types is not principal.\nval f2 : 'x M.t -> bool = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[151,3371+15]..[163,3823+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[166,3851+0]..[170,3921+16])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[166,3851+4]..[166,3851+6])
          Ppat_var "f3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[166,3851+4]..[166,3851+6])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[166,3851+7]..[170,3921+16]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[166,3851+7]..[166,3851+9])
            Ppat_var "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[166,3851+7]..[166,3851+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+2]..[170,3921+16])
            Pexp_sequence
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+2]..[167,3863+25])
              Pexp_apply
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+2]..[167,3863+8])
                Pexp_ident "ignore" (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+2]..[167,3863+8])
              [
                <arg>
                Nolabel
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+9]..[167,3863+25])
                    Pexp_constraint
                    expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+10]..[167,3863+12])
                      Pexp_ident "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+10]..[167,3863+12])
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+15]..[167,3863+24])
                      Ptyp_constr "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+23]..[167,3863+24])
                      [
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+15]..[167,3863+22])
                          Ptyp_constr "ab" (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+20]..[167,3863+22])
                          [
                            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+15]..[167,3863+19])
                              Ptyp_constr "unit" (testsuite/tests/typing-gadts/principality-and-gadts.ml[167,3863+15]..[167,3863+19])
                              []
                          ]
                      ]
              ]
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[168,3890+2]..[170,3921+16])
              Pexp_match
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[168,3890+8]..[168,3890+10])
                Pexp_ident "t1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[168,3890+8]..[168,3890+10])
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[169,3906+4]..[169,3906+6])
                    Ppat_construct "AB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[169,3906+4]..[169,3906+6])
                    None
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[169,3906+10]..[169,3906+14])
                    Pexp_construct "true" (testsuite/tests/typing-gadts/principality-and-gadts.ml[169,3906+10]..[169,3906+14])
                    None
                <case>
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[170,3921+4]..[170,3921+7])
                    Ppat_construct "MAB" (testsuite/tests/typing-gadts/principality-and-gadts.ml[170,3921+4]..[170,3921+7])
                    None
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[170,3921+11]..[170,3921+16])
                    Pexp_construct "false" (testsuite/tests/typing-gadts/principality-and-gadts.ml[170,3921+11]..[170,3921+16])
                    None
              ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[171,3940+0]..[180,4254+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[171,3940+9]..[180,4254+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[171,3940+9]..[180,4254+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[171,3940+9]..[173,3989+2])
              Pexp_constant PConst_string ("\nval f3 : unit ab M.t -> bool = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[171,3940+11]..[173,3989+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[173,3989+4]..[180,4254+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[173,3989+4]..[173,3989+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[173,3989+13]..[180,4254+2])
                  Pexp_constant PConst_string ("\nLine 5, characters 4-7:\n5 |   | MAB -> false;;\n        ^^^\nWarning 18 [not-principal]: typing this pattern requires considering unit M.mab and unit ab as equal.\nBut the knowledge of these types is not principal.\nval f3 : unit ab M.t -> bool = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[173,3989+15]..[180,4254+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+0]..[183,4339+33])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+11]..[183,4339+13]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+0]..[183,4339+33])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+6]..[183,4339+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+8]..[183,4339+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+16]..[183,4339+33])
                "Refl" (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+16]..[183,4339+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+23]..[183,4339+33])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+31]..[183,4339+33])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+24]..[183,4339+26])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[183,4339+27]..[183,4339+29])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[184,4375+0]..[186,4423+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[184,4375+9]..[186,4423+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[184,4375+9]..[186,4423+2])
          Pexp_constant PConst_string ("\ntype (_, _) eq = Refl : ('a, 'a) eq\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[184,4375+11]..[186,4423+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+0]..[189,4492+20])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+4]..[188,4428+6])
          Ppat_var "g1" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+4]..[188,4428+6])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+7]..[189,4492+20])
          Pexp_newtype "x"
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+16]..[189,4492+20]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+16]..[188,4428+40])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+17]..[188,4428+18])
                Ppat_var "e" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+17]..[188,4428+18])
              core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+21]..[188,4428+39])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+37]..[188,4428+39])
                [
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+22]..[188,4428+23])
                    Ptyp_constr "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+22]..[188,4428+23])
                    []
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+25]..[188,4428+35])
                    Ptyp_constr "option" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+29]..[188,4428+35])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+25]..[188,4428+28])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+25]..[188,4428+28])
                        []
                    ]
                ]
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+41]..[189,4492+20]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+41]..[188,4428+48])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+42]..[188,4428+43])
                  Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+42]..[188,4428+43])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+46]..[188,4428+47])
                  Ptyp_constr "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+46]..[188,4428+47])
                  []
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+49]..[189,4492+20])
                Pexp_constraint
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[189,4492+3]..[189,4492+20])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[189,4492+7]..[189,4492+11])
                        Ppat_construct "Refl" (testsuite/tests/typing-gadts/principality-and-gadts.ml[189,4492+7]..[189,4492+11])
                        None
                      expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[189,4492+14]..[189,4492+15])
                        Pexp_ident "e" (testsuite/tests/typing-gadts/principality-and-gadts.ml[189,4492+14]..[189,4492+15])
                  ]
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[189,4492+19]..[189,4492+20])
                    Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[189,4492+19]..[189,4492+20])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+51]..[188,4428+61])
                  Ptyp_constr "option" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+55]..[188,4428+61])
                  [
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+51]..[188,4428+54])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[188,4428+51]..[188,4428+54])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[190,4515+0]..[192,4584+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[190,4515+9]..[192,4584+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[190,4515+9]..[192,4584+2])
          Pexp_constant PConst_string ("\nval g1 : ('x, int option) eq -> 'x -> int option = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[190,4515+11]..[192,4584+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+0]..[197,4710+20])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+4]..[195,4612+6])
          Ppat_var "g2" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+4]..[195,4612+6])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+7]..[197,4710+20])
          Pexp_newtype "x"
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+16]..[197,4710+20]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+16]..[195,4612+38])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+17]..[195,4612+18])
                Ppat_var "e" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+17]..[195,4612+18])
              core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+21]..[195,4612+37])
                Ptyp_constr "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+35]..[195,4612+37])
                [
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+22]..[195,4612+23])
                    Ptyp_constr "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+22]..[195,4612+23])
                    []
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+25]..[195,4612+33])
                    Ptyp_constr "option" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+27]..[195,4612+33])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+25]..[195,4612+26])
                        Ptyp_any
                    ]
                ]
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+39]..[197,4710+20]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+39]..[195,4612+46])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+40]..[195,4612+41])
                  Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+40]..[195,4612+41])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+44]..[195,4612+45])
                  Ptyp_constr "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+44]..[195,4612+45])
                  []
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+47]..[197,4710+20])
                Pexp_constraint
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+3]..[197,4710+20])
                  Pexp_sequence
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+3]..[196,4674+34])
                    Pexp_apply
                    expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+3]..[196,4674+9])
                      Pexp_ident "ignore" (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+3]..[196,4674+9])
                    [
                      <arg>
                      Nolabel
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+10]..[196,4674+34])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+11]..[196,4674+12])
                            Pexp_ident "e" (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+11]..[196,4674+12])
                          core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+15]..[196,4674+33])
                            Ptyp_constr "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+31]..[196,4674+33])
                            [
                              core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+16]..[196,4674+17])
                                Ptyp_constr "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+16]..[196,4674+17])
                                []
                              core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+19]..[196,4674+29])
                                Ptyp_constr "option" (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+23]..[196,4674+29])
                                [
                                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+19]..[196,4674+22])
                                    Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[196,4674+19]..[196,4674+22])
                                    []
                                ]
                            ]
                    ]
                  expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[197,4710+3]..[197,4710+20])
                    Pexp_let Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[197,4710+7]..[197,4710+11])
                          Ppat_construct "Refl" (testsuite/tests/typing-gadts/principality-and-gadts.ml[197,4710+7]..[197,4710+11])
                          None
                        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[197,4710+14]..[197,4710+15])
                          Pexp_ident "e" (testsuite/tests/typing-gadts/principality-and-gadts.ml[197,4710+14]..[197,4710+15])
                    ]
                    expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[197,4710+19]..[197,4710+20])
                      Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[197,4710+19]..[197,4710+20])
                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+49]..[195,4612+59])
                  Ptyp_constr "option" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+53]..[195,4612+59])
                  [
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+49]..[195,4612+52])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[195,4612+49]..[195,4612+52])
                      []
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[198,4733+0]..[207,5090+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[198,4733+9]..[207,5090+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[198,4733+9]..[207,5090+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[198,4733+9]..[200,4802+2])
              Pexp_constant PConst_string ("\nval g2 : ('x, int option) eq -> 'x -> int option = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[198,4733+11]..[200,4802+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[200,4802+4]..[207,5090+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[200,4802+4]..[200,4802+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[200,4802+13]..[207,5090+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 7-11:\n3 |    let Refl = e in x;;\n           ^^^^\nWarning 18 [not-principal]: typing this pattern requires considering x and int option as equal.\nBut the knowledge of these types is not principal.\nval g2 : ('x, int option) eq -> 'x -> int option = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[200,4802+15]..[207,5090+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[211,5132+0]..[215,5186+3])
    Pstr_module
    "Foo" (testsuite/tests/typing-gadts/principality-and-gadts.ml[211,5132+7]..[211,5132+10])
      module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[211,5132+11]..[215,5186+3])
        Pmod_constraint
        module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[213,5158+6]..[215,5186+3])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[214,5171+2]..[214,5171+14])
              Pstr_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[214,5171+7]..[214,5171+8]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[214,5171+2]..[214,5171+14])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[214,5171+11]..[214,5171+14])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[214,5171+11]..[214,5171+14])
                        []
              ]
          ]
        module_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[211,5132+13]..[213,5158+3])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[212,5149+2]..[212,5149+8])
              Psig_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[212,5149+7]..[212,5149+8]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[212,5149+2]..[212,5149+8])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+0]..[217,5191+28])
    Pstr_type Rec
    [
      type_declaration "gadt" (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+7]..[217,5191+11]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+0]..[217,5191+28])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+5]..[217,5191+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+14]..[217,5191+28])
                "F" (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+14]..[217,5191+15])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+18]..[217,5191+28])
                    Ptyp_constr "gadt" (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+24]..[217,5191+28])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+18]..[217,5191+23])
                        Ptyp_constr "Foo.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[217,5191+18]..[217,5191+23])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+0]..[219,5221+34])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+9]..[219,5221+10]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+0]..[219,5221+34])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+6]..[219,5221+8])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+15]..[219,5221+21])
                Immutable
                "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+15]..[219,5221+16])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+18]..[219,5221+20])
                  Ptyp_var a
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+22]..[219,5221+32])
                Immutable
                "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+22]..[219,5221+23])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+25]..[219,5221+32])
                  Ptyp_constr "gadt" (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+28]..[219,5221+32])
                  [
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[219,5221+25]..[219,5221+27])
                      Ptyp_var a
                  ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[220,5259+0]..[224,5365+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[220,5259+9]..[224,5365+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[220,5259+9]..[224,5365+2])
          Pexp_constant PConst_string ("\nmodule Foo : sig type t end\ntype _ gadt = F : Foo.t gadt\ntype 'a t = { a : 'a; b : 'a gadt; }\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[220,5259+11]..[224,5365+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[226,5370+0]..[229,5436+11])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[226,5370+4]..[226,5370+6])
          Ppat_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[226,5370+4]..[226,5370+6])
          None
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[227,5379+2]..[229,5436+11])
          Pexp_match
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[227,5379+8]..[227,5379+10])
            Pexp_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[227,5379+8]..[227,5379+10])
            None
          [
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+4]..[228,5395+34])
                Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+6]..[228,5395+34]) ghost
                Some
                  []
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+6]..[228,5395+34]) ghost
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+6]..[228,5395+18])
                        Ppat_record Open
                        [
                          "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+8]..[228,5395+9])
                            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+12]..[228,5395+13])
                              Ppat_constant PConst_int (3,None)
                        ]
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+21]..[228,5395+34]) ghost
                        Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+21]..[228,5395+34]) ghost
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+21]..[228,5395+34]) ghost
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+21]..[228,5395+33])
                                Ppat_record Open
                                [
                                  "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+23]..[228,5395+24])
                                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+27]..[228,5395+28])
                                      Ppat_construct "F" (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+27]..[228,5395+28])
                                      None
                                ]
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+33]..[228,5395+34]) ghost
                                Ppat_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+33]..[228,5395+34]) ghost
                                None
                            ]
                    ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+38]..[228,5395+40])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[228,5395+38]..[228,5395+40])
                None
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[229,5436+4]..[229,5436+5])
                Ppat_any
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[229,5436+9]..[229,5436+11])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[229,5436+9]..[229,5436+11])
                None
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[230,5450+0]..[237,5726+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[230,5450+9]..[237,5726+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[230,5450+9]..[237,5726+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[230,5450+9]..[231,5462+2])
              Pexp_constant PConst_string ("\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[230,5450+11]..[231,5462+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[231,5462+4]..[237,5726+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[231,5462+4]..[231,5462+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[231,5462+13]..[237,5726+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 27-28:\n3 |   | [ { a = 3; _ } ; { b = F; _ }] -> ()\n                               ^\nWarning 18 [not-principal]: typing this pattern requires considering Foo.t and int as equal.\nBut the knowledge of these types is not principal.\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[231,5462+15]..[237,5726+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[239,5731+0]..[242,5797+11])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[239,5731+4]..[239,5731+6])
          Ppat_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[239,5731+4]..[239,5731+6])
          None
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[240,5740+2]..[242,5797+11])
          Pexp_match
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[240,5740+8]..[240,5740+10])
            Pexp_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[240,5740+8]..[240,5740+10])
            None
          [
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+4]..[241,5756+34])
                Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+6]..[241,5756+34]) ghost
                Some
                  []
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+6]..[241,5756+34]) ghost
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+6]..[241,5756+18])
                        Ppat_record Open
                        [
                          "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+8]..[241,5756+9])
                            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+12]..[241,5756+13])
                              Ppat_construct "F" (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+12]..[241,5756+13])
                              None
                        ]
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+21]..[241,5756+34]) ghost
                        Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+21]..[241,5756+34]) ghost
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+21]..[241,5756+34]) ghost
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+21]..[241,5756+33])
                                Ppat_record Open
                                [
                                  "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+23]..[241,5756+24])
                                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+27]..[241,5756+28])
                                      Ppat_constant PConst_int (3,None)
                                ]
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+33]..[241,5756+34]) ghost
                                Ppat_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+33]..[241,5756+34]) ghost
                                None
                            ]
                    ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+38]..[241,5756+40])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[241,5756+38]..[241,5756+40])
                None
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[242,5797+4]..[242,5797+5])
                Ppat_any
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[242,5797+9]..[242,5797+11])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[242,5797+9]..[242,5797+11])
                None
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[243,5811+0]..[249,6043+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[243,5811+9]..[249,6043+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[243,5811+9]..[249,6043+2])
          Pexp_constant PConst_string ("\nLine 3, characters 27-28:\n3 |   | [ { b = F; _ } ; { a = 3; _ }] -> ()\n                               ^\nError: This pattern matches values of type int\n       but a pattern was expected which matches values of type Foo.t\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[243,5811+11]..[249,6043+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+0]..[251,6048+45])
    Pstr_type Rec
    [
      type_declaration "eq3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+15]..[251,6048+18]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+0]..[251,6048+45])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+6]..[251,6048+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+9]..[251,6048+10])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+12]..[251,6048+13])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+21]..[251,6048+45])
                "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+21]..[251,6048+26])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+29]..[251,6048+45])
                    Ptyp_constr "eq3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+42]..[251,6048+45])
                    [
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+30]..[251,6048+32])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+34]..[251,6048+36])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[251,6048+38]..[251,6048+40])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+0]..[253,6095+47])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+9]..[253,6095+10]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+0]..[253,6095+47])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+6]..[253,6095+8])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+15]..[253,6095+21])
                Immutable
                "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+15]..[253,6095+16])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+18]..[253,6095+20])
                  Ptyp_var a
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+22]..[253,6095+45])
                Immutable
                "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+22]..[253,6095+23])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+25]..[253,6095+45])
                  Ptyp_constr "eq3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+42]..[253,6095+45])
                  [
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+26]..[253,6095+29])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+26]..[253,6095+29])
                      []
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+31]..[253,6095+36])
                      Ptyp_constr "Foo.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+31]..[253,6095+36])
                      []
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[253,6095+38]..[253,6095+40])
                      Ptyp_var a
                  ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[255,6146+0]..[258,6254+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[255,6146+9]..[258,6254+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[255,6146+9]..[258,6254+2])
          Pexp_constant PConst_string ("\ntype (_, _, _) eq3 = Refl3 : ('a, 'a, 'a) eq3\ntype 'a t = { a : 'a; b : (int, Foo.t, 'a) eq3; }\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[255,6146+11]..[258,6254+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[260,6259+0]..[263,6329+11])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[260,6259+4]..[260,6259+6])
          Ppat_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[260,6259+4]..[260,6259+6])
          None
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[261,6268+2]..[263,6329+11])
          Pexp_match
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[261,6268+8]..[261,6268+10])
            Pexp_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[261,6268+8]..[261,6268+10])
            None
          [
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+4]..[262,6284+38])
                Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+6]..[262,6284+38]) ghost
                Some
                  []
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+6]..[262,6284+38]) ghost
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+6]..[262,6284+18])
                        Ppat_record Open
                        [
                          "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+8]..[262,6284+9])
                            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+12]..[262,6284+13])
                              Ppat_constant PConst_int (3,None)
                        ]
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+20]..[262,6284+38]) ghost
                        Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+20]..[262,6284+38]) ghost
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+20]..[262,6284+38]) ghost
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+20]..[262,6284+37])
                                Ppat_record Open
                                [
                                  "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+22]..[262,6284+23])
                                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+26]..[262,6284+31])
                                      Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+26]..[262,6284+31])
                                      None
                                ]
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+37]..[262,6284+38]) ghost
                                Ppat_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+37]..[262,6284+38]) ghost
                                None
                            ]
                    ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+42]..[262,6284+44])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[262,6284+42]..[262,6284+44])
                None
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[263,6329+4]..[263,6329+5])
                Ppat_any
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[263,6329+9]..[263,6329+11])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[263,6329+9]..[263,6329+11])
                None
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[265,6344+0]..[272,6627+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[265,6344+9]..[272,6627+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[265,6344+9]..[272,6627+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[265,6344+9]..[266,6356+2])
              Pexp_constant PConst_string ("\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[265,6344+11]..[266,6356+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[266,6356+4]..[272,6627+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[266,6356+4]..[266,6356+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[266,6356+13]..[272,6627+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 26-31:\n3 |   | [ { a = 3; _ }; { b = Refl3 ; _ }] -> ()\n                              ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering int and Foo.t as equal.\nBut the knowledge of these types is not principal.\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[266,6356+15]..[272,6627+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[274,6632+0]..[277,6703+11])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[274,6632+4]..[274,6632+6])
          Ppat_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[274,6632+4]..[274,6632+6])
          None
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[275,6641+2]..[277,6703+11])
          Pexp_match
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[275,6641+8]..[275,6641+10])
            Pexp_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[275,6641+8]..[275,6641+10])
            None
          [
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+4]..[276,6657+39])
                Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+6]..[276,6657+39]) ghost
                Some
                  []
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+6]..[276,6657+39]) ghost
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+6]..[276,6657+23])
                        Ppat_record Open
                        [
                          "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+8]..[276,6657+9])
                            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+12]..[276,6657+17])
                              Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+12]..[276,6657+17])
                              None
                        ]
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+25]..[276,6657+39]) ghost
                        Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+25]..[276,6657+39]) ghost
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+25]..[276,6657+39]) ghost
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+25]..[276,6657+37])
                                Ppat_record Open
                                [
                                  "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+27]..[276,6657+28])
                                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+31]..[276,6657+32])
                                      Ppat_constant PConst_int (3,None)
                                ]
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+38]..[276,6657+39]) ghost
                                Ppat_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+38]..[276,6657+39]) ghost
                                None
                            ]
                    ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+43]..[276,6657+45])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[276,6657+43]..[276,6657+45])
                None
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[277,6703+4]..[277,6703+5])
                Ppat_any
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[277,6703+9]..[277,6703+11])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[277,6703+9]..[277,6703+11])
                None
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[279,6718+0]..[286,6988+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[279,6718+9]..[286,6988+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[279,6718+9]..[286,6988+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[279,6718+9]..[280,6730+2])
              Pexp_constant PConst_string ("\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[279,6718+11]..[280,6730+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[280,6730+4]..[286,6988+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[280,6730+4]..[280,6730+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[280,6730+13]..[286,6988+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 12-17:\n3 |   | [ { b = Refl3 ; _ }; { a = 3; _ } ] -> ()\n                ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering int and Foo.t as equal.\nBut the knowledge of these types is not principal.\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[280,6730+15]..[286,6988+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+0]..[290,7020+47])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+9]..[290,7020+10]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+0]..[290,7020+47])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+6]..[290,7020+8])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+15]..[290,7020+21])
                Immutable
                "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+15]..[290,7020+16])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+18]..[290,7020+20])
                  Ptyp_var a
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+22]..[290,7020+45])
                Immutable
                "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+22]..[290,7020+23])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+25]..[290,7020+45])
                  Ptyp_constr "eq3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+42]..[290,7020+45])
                  [
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+26]..[290,7020+28])
                      Ptyp_var a
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+30]..[290,7020+33])
                      Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+30]..[290,7020+33])
                      []
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+35]..[290,7020+40])
                      Ptyp_constr "Foo.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[290,7020+35]..[290,7020+40])
                      []
                  ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[292,7071+0]..[294,7133+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[292,7071+9]..[294,7133+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[292,7071+9]..[294,7133+2])
          Pexp_constant PConst_string ("\ntype 'a t = { a : 'a; b : ('a, int, Foo.t) eq3; }\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[292,7071+11]..[294,7133+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[296,7138+0]..[299,7208+11])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[296,7138+4]..[296,7138+6])
          Ppat_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[296,7138+4]..[296,7138+6])
          None
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[297,7147+2]..[299,7208+11])
          Pexp_match
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[297,7147+8]..[297,7147+10])
            Pexp_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[297,7147+8]..[297,7147+10])
            None
          [
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+4]..[298,7163+38])
                Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+6]..[298,7163+38]) ghost
                Some
                  []
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+6]..[298,7163+38]) ghost
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+6]..[298,7163+18])
                        Ppat_record Open
                        [
                          "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+8]..[298,7163+9])
                            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+12]..[298,7163+13])
                              Ppat_constant PConst_int (3,None)
                        ]
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+20]..[298,7163+38]) ghost
                        Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+20]..[298,7163+38]) ghost
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+20]..[298,7163+38]) ghost
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+20]..[298,7163+37])
                                Ppat_record Open
                                [
                                  "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+22]..[298,7163+23])
                                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+26]..[298,7163+31])
                                      Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+26]..[298,7163+31])
                                      None
                                ]
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+37]..[298,7163+38]) ghost
                                Ppat_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+37]..[298,7163+38]) ghost
                                None
                            ]
                    ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+42]..[298,7163+44])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[298,7163+42]..[298,7163+44])
                None
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[299,7208+4]..[299,7208+5])
                Ppat_any
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[299,7208+9]..[299,7208+11])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[299,7208+9]..[299,7208+11])
                None
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[300,7220+0]..[307,7503+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[300,7220+9]..[307,7503+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[300,7220+9]..[307,7503+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[300,7220+9]..[301,7232+2])
              Pexp_constant PConst_string ("\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[300,7220+11]..[301,7232+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[301,7232+4]..[307,7503+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[301,7232+4]..[301,7232+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[301,7232+13]..[307,7503+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 26-31:\n3 |   | [ { a = 3; _ }; { b = Refl3 ; _ }] -> ()\n                              ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering int and Foo.t as equal.\nBut the knowledge of these types is not principal.\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[301,7232+15]..[307,7503+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[309,7508+0]..[312,7579+11])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[309,7508+4]..[309,7508+6])
          Ppat_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[309,7508+4]..[309,7508+6])
          None
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[310,7517+2]..[312,7579+11])
          Pexp_match
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[310,7517+8]..[310,7517+10])
            Pexp_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[310,7517+8]..[310,7517+10])
            None
          [
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+4]..[311,7533+39])
                Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+6]..[311,7533+39]) ghost
                Some
                  []
                  pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+6]..[311,7533+39]) ghost
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+6]..[311,7533+23])
                        Ppat_record Open
                        [
                          "b" (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+8]..[311,7533+9])
                            pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+12]..[311,7533+17])
                              Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+12]..[311,7533+17])
                              None
                        ]
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+25]..[311,7533+39]) ghost
                        Ppat_construct "::" (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+25]..[311,7533+39]) ghost
                        Some
                          []
                          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+25]..[311,7533+39]) ghost
                            Ppat_tuple
                            [
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+25]..[311,7533+37])
                                Ppat_record Open
                                [
                                  "a" (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+27]..[311,7533+28])
                                    pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+31]..[311,7533+32])
                                      Ppat_constant PConst_int (3,None)
                                ]
                              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+38]..[311,7533+39]) ghost
                                Ppat_construct "[]" (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+38]..[311,7533+39]) ghost
                                None
                            ]
                    ]
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+43]..[311,7533+45])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[311,7533+43]..[311,7533+45])
                None
            <case>
              pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[312,7579+4]..[312,7579+5])
                Ppat_any
              expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[312,7579+9]..[312,7579+11])
                Pexp_construct "()" (testsuite/tests/typing-gadts/principality-and-gadts.ml[312,7579+9]..[312,7579+11])
                None
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[313,7591+0]..[320,7861+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[313,7591+9]..[320,7861+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[313,7591+9]..[320,7861+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[313,7591+9]..[314,7603+2])
              Pexp_constant PConst_string ("\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[313,7591+11]..[314,7603+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[314,7603+4]..[320,7861+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[314,7603+4]..[314,7603+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[314,7603+13]..[320,7861+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 12-17:\n3 |   | [ { b = Refl3 ; _ }; { a = 3; _ } ] -> ()\n                ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering int and Foo.t as equal.\nBut the knowledge of these types is not principal.\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[314,7603+15]..[320,7861+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+0]..[327,7916+51])
    Pstr_module
    "M" (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+7]..[327,7916+8])
      module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+9]..[327,7916+51])
        Pmod_constraint
        module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+28]..[327,7916+51])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+35]..[327,7916+47])
              Pstr_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+40]..[327,7916+41]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+35]..[327,7916+47])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+44]..[327,7916+47])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+44]..[327,7916+47])
                        []
              ]
          ]
        module_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+11]..[327,7916+25])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+15]..[327,7916+21])
              Psig_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+20]..[327,7916+21]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[327,7916+15]..[327,7916+21])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+0]..[328,7968+51])
    Pstr_module
    "N" (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+7]..[328,7968+8])
      module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+9]..[328,7968+51])
        Pmod_constraint
        module_expr (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+28]..[328,7968+51])
          Pmod_structure
          [
            structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+35]..[328,7968+47])
              Pstr_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+40]..[328,7968+41]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+35]..[328,7968+47])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+44]..[328,7968+47])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+44]..[328,7968+47])
                        []
              ]
          ]
        module_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+11]..[328,7968+25])
          Pmty_signature
          [
            signature_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+15]..[328,7968+21])
              Psig_type Rec
              [
                type_declaration "t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+20]..[328,7968+21]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[328,7968+15]..[328,7968+21])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
          ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[330,8023+0]..[333,8087+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[330,8023+9]..[333,8087+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[330,8023+9]..[333,8087+2])
          Pexp_constant PConst_string ("\nmodule M : sig type t end\nmodule N : sig type t end\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[330,8023+11]..[333,8087+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+0]..[335,8092+49])
    Pstr_type Rec
    [
      type_declaration "foo" (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+8]..[335,8092+11]) (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+0]..[335,8092+49])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+5]..[335,8092+7])
              Ptyp_var a
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+16]..[335,8092+23])
                Immutable
                "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+16]..[335,8092+17])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+20]..[335,8092+22])
                  Ptyp_var a
              (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+24]..[335,8092+47])
                Immutable
                "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+24]..[335,8092+26])                core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+29]..[335,8092+47])
                  Ptyp_constr "eq3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+44]..[335,8092+47])
                  [
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+30]..[335,8092+33])
                      Ptyp_constr "M.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+30]..[335,8092+33])
                      []
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+35]..[335,8092+38])
                      Ptyp_constr "N.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+35]..[335,8092+38])
                      []
                    core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[335,8092+40]..[335,8092+42])
                      Ptyp_var a
                  ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[336,8144+0]..[338,8207+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[336,8144+9]..[338,8207+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[336,8144+9]..[338,8207+2])
          Pexp_constant PConst_string ("\ntype 'a foo = { x : 'a; eq : (M.t, N.t, 'a) eq3; }\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[336,8144+11]..[338,8207+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[340,8212+0]..[342,8239+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[340,8212+4]..[340,8212+7])
          Ppat_var "foo" (testsuite/tests/typing-gadts/principality-and-gadts.ml[340,8212+4]..[340,8212+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[340,8212+8]..[342,8239+30]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[340,8212+8]..[340,8212+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[340,8212+8]..[340,8212+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[341,8224+2]..[342,8239+30])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[341,8224+8]..[341,8224+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[341,8224+8]..[341,8224+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+4]..[342,8239+25])
                  Ppat_record Closed
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+6]..[342,8239+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+10]..[342,8239+11])
                        Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+10]..[342,8239+11])
                    "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+13]..[342,8239+15])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+18]..[342,8239+23])
                        Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+18]..[342,8239+23])
                        None
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+29]..[342,8239+30])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[342,8239+29]..[342,8239+30])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[344,8273+0]..[353,8598+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[344,8273+9]..[353,8598+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[344,8273+9]..[353,8598+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[344,8273+9]..[346,8318+2])
              Pexp_constant PConst_string ("\nval foo : M.t foo -> M.t = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[344,8273+11]..[346,8318+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[346,8318+4]..[353,8598+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[346,8318+4]..[346,8318+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[346,8318+13]..[353,8598+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 18-23:\n3 |   | { x = x; eq = Refl3 } -> x\n                      ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering M.t and N.t as equal.\nBut the knowledge of these types is not principal.\nval foo : M.t foo -> M.t = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[346,8318+15]..[353,8598+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[355,8603+0]..[357,8630+38])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[355,8603+4]..[355,8603+7])
          Ppat_var "foo" (testsuite/tests/typing-gadts/principality-and-gadts.ml[355,8603+4]..[355,8603+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[355,8603+8]..[357,8630+38]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[355,8603+8]..[355,8603+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[355,8603+8]..[355,8603+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[356,8615+2]..[357,8630+38])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[356,8615+8]..[356,8615+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[356,8615+8]..[356,8615+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+4]..[357,8630+33])
                  Ppat_record Closed
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+6]..[357,8630+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+10]..[357,8630+19])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+11]..[357,8630+12])
                          Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+11]..[357,8630+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+15]..[357,8630+18])
                          Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+15]..[357,8630+18])
                          []
                    "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+21]..[357,8630+23])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+26]..[357,8630+31])
                        Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+26]..[357,8630+31])
                        None
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+37]..[357,8630+38])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[357,8630+37]..[357,8630+38])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[359,8672+0]..[368,9013+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[359,8672+9]..[368,9013+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[359,8672+9]..[368,9013+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[359,8672+9]..[361,8717+2])
              Pexp_constant PConst_string ("\nval foo : int foo -> int = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[359,8672+11]..[361,8717+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[361,8717+4]..[368,9013+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[361,8717+4]..[361,8717+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[361,8717+13]..[368,9013+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 26-31:\n3 |   | { x = (x : int); eq = Refl3 } -> x\n                              ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering M.t and int as equal.\nBut the knowledge of these types is not principal.\nval foo : int foo -> int = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[361,8717+15]..[368,9013+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[370,9018+0]..[372,9045+38])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[370,9018+4]..[370,9018+7])
          Ppat_var "foo" (testsuite/tests/typing-gadts/principality-and-gadts.ml[370,9018+4]..[370,9018+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[370,9018+8]..[372,9045+38]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[370,9018+8]..[370,9018+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[370,9018+8]..[370,9018+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[371,9030+2]..[372,9045+38])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[371,9030+8]..[371,9030+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[371,9030+8]..[371,9030+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+4]..[372,9045+33])
                  Ppat_record Closed
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+6]..[372,9045+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+10]..[372,9045+19])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+11]..[372,9045+12])
                          Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+11]..[372,9045+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+15]..[372,9045+18])
                          Ptyp_constr "N.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+15]..[372,9045+18])
                          []
                    "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+21]..[372,9045+23])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+26]..[372,9045+31])
                        Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+26]..[372,9045+31])
                        None
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+37]..[372,9045+38])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[372,9045+37]..[372,9045+38])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[374,9087+0]..[395,9990+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[374,9087+9]..[395,9990+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[374,9087+9]..[395,9990+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[374,9087+9]..[382,9413+2])
              Pexp_constant PConst_string ("\nLine 3, characters 4-33:\n3 |   | { x = (x : N.t); eq = Refl3 } -> x\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nError: This pattern matches values of type N.t foo\n       but a pattern was expected which matches values of type 'a\n       This instance of M.t is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[374,9087+11]..[382,9413+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[382,9413+4]..[395,9990+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[382,9413+4]..[382,9413+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[382,9413+13]..[395,9990+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 26-31:\n3 |   | { x = (x : N.t); eq = Refl3 } -> x\n                              ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering M.t and N.t as equal.\nBut the knowledge of these types is not principal.\nLine 3, characters 4-33:\n3 |   | { x = (x : N.t); eq = Refl3 } -> x\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nError: This pattern matches values of type N.t foo\n       but a pattern was expected which matches values of type 'a\n       This instance of M.t is ambiguous:\n       it would escape the scope of its equation\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[382,9413+15]..[395,9990+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[397,9995+0]..[399,10022+41])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[397,9995+4]..[397,9995+7])
          Ppat_var "foo" (testsuite/tests/typing-gadts/principality-and-gadts.ml[397,9995+4]..[397,9995+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[397,9995+8]..[399,10022+41]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[397,9995+8]..[397,9995+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[397,9995+8]..[397,9995+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[398,10007+2]..[399,10022+41])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[398,10007+8]..[398,10007+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[398,10007+8]..[398,10007+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+4]..[399,10022+36])
                  Ppat_record Closed
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+6]..[399,10022+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+10]..[399,10022+22])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+11]..[399,10022+12])
                          Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+11]..[399,10022+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+15]..[399,10022+21])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+15]..[399,10022+21])
                          []
                    "eq" (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+24]..[399,10022+26])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+29]..[399,10022+34])
                        Ppat_construct "Refl3" (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+29]..[399,10022+34])
                        None
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+40]..[399,10022+41])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[399,10022+40]..[399,10022+41])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[401,10067+0]..[410,10429+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[401,10067+9]..[410,10429+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[401,10067+9]..[410,10429+2])
          Pexp_tuple
          [
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[401,10067+9]..[403,10118+2])
              Pexp_constant PConst_string ("\nval foo : string foo -> string = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[401,10067+11]..[403,10118+0]),Some "")
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[403,10118+4]..[410,10429+2])
              Pexp_construct "Principal" (testsuite/tests/typing-gadts/principality-and-gadts.ml[403,10118+4]..[403,10118+13])
              Some
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[403,10118+13]..[410,10429+2])
                  Pexp_constant PConst_string ("\nLine 3, characters 29-34:\n3 |   | { x = (x : string); eq = Refl3 } -> x\n                                 ^^^^^\nWarning 18 [not-principal]: typing this pattern requires considering M.t and string as equal.\nBut the knowledge of these types is not principal.\nval foo : string foo -> string = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[403,10118+15]..[410,10429+0]),Some "")
          ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[412,10434+0]..[414,10461+21])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[412,10434+4]..[412,10434+7])
          Ppat_var "bar" (testsuite/tests/typing-gadts/principality-and-gadts.ml[412,10434+4]..[412,10434+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[412,10434+8]..[414,10461+21]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[412,10434+8]..[412,10434+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[412,10434+8]..[412,10434+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[413,10446+2]..[414,10461+21])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[413,10446+8]..[413,10446+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[413,10446+8]..[413,10446+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[414,10461+4]..[414,10461+16])
                  Ppat_record Open
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[414,10461+6]..[414,10461+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[414,10461+10]..[414,10461+11])
                        Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[414,10461+10]..[414,10461+11])
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[414,10461+20]..[414,10461+21])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[414,10461+20]..[414,10461+21])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[416,10486+0]..[418,10529+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[416,10486+9]..[418,10529+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[416,10486+9]..[418,10529+2])
          Pexp_constant PConst_string ("\nval bar : 'a foo -> 'a = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[416,10486+11]..[418,10529+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[420,10534+0]..[422,10561+29])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[420,10534+4]..[420,10534+7])
          Ppat_var "bar" (testsuite/tests/typing-gadts/principality-and-gadts.ml[420,10534+4]..[420,10534+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[420,10534+8]..[422,10561+29]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[420,10534+8]..[420,10534+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[420,10534+8]..[420,10534+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[421,10546+2]..[422,10561+29])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[421,10546+8]..[421,10546+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[421,10546+8]..[421,10546+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+4]..[422,10561+24])
                  Ppat_record Open
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+6]..[422,10561+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+10]..[422,10561+19])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+11]..[422,10561+12])
                          Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+11]..[422,10561+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+15]..[422,10561+18])
                          Ptyp_constr "int" (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+15]..[422,10561+18])
                          []
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+28]..[422,10561+29])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[422,10561+28]..[422,10561+29])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[424,10594+0]..[426,10639+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[424,10594+9]..[426,10639+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[424,10594+9]..[426,10639+2])
          Pexp_constant PConst_string ("\nval bar : int foo -> int = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[424,10594+11]..[426,10639+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[428,10644+0]..[430,10671+29])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[428,10644+4]..[428,10644+7])
          Ppat_var "bar" (testsuite/tests/typing-gadts/principality-and-gadts.ml[428,10644+4]..[428,10644+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[428,10644+8]..[430,10671+29]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[428,10644+8]..[428,10644+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[428,10644+8]..[428,10644+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[429,10656+2]..[430,10671+29])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[429,10656+8]..[429,10656+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[429,10656+8]..[429,10656+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+4]..[430,10671+24])
                  Ppat_record Open
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+6]..[430,10671+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+10]..[430,10671+19])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+11]..[430,10671+12])
                          Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+11]..[430,10671+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+15]..[430,10671+18])
                          Ptyp_constr "N.t" (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+15]..[430,10671+18])
                          []
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+28]..[430,10671+29])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[430,10671+28]..[430,10671+29])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[432,10704+0]..[434,10749+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[432,10704+9]..[434,10749+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[432,10704+9]..[434,10749+2])
          Pexp_constant PConst_string ("\nval bar : N.t foo -> N.t = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[432,10704+11]..[434,10749+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[436,10754+0]..[438,10781+32])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[436,10754+4]..[436,10754+7])
          Ppat_var "bar" (testsuite/tests/typing-gadts/principality-and-gadts.ml[436,10754+4]..[436,10754+7])
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[436,10754+8]..[438,10781+32]) ghost
          Pexp_fun
          Nolabel
          None
          pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[436,10754+8]..[436,10754+9])
            Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[436,10754+8]..[436,10754+9])
          expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[437,10766+2]..[438,10781+32])
            Pexp_match
            expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[437,10766+8]..[437,10766+9])
              Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[437,10766+8]..[437,10766+9])
            [
              <case>
                pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+4]..[438,10781+27])
                  Ppat_record Open
                  [
                    "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+6]..[438,10781+7])
                      pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+10]..[438,10781+22])
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+11]..[438,10781+12])
                          Ppat_var "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+11]..[438,10781+12])
                        core_type (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+15]..[438,10781+21])
                          Ptyp_constr "string" (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+15]..[438,10781+21])
                          []
                  ]
                expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+31]..[438,10781+32])
                  Pexp_ident "x" (testsuite/tests/typing-gadts/principality-and-gadts.ml[438,10781+31]..[438,10781+32])
            ]
    ]
  structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[440,10817+0]..[442,10868+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/principality-and-gadts.ml[440,10817+9]..[442,10868+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/principality-and-gadts.ml[440,10817+9]..[442,10868+2])
          Pexp_constant PConst_string ("\nval bar : string foo -> string = <fun>\n",(testsuite/tests/typing-gadts/principality-and-gadts.ml[440,10817+11]..[442,10868+0]),Some "")
    ]
]

