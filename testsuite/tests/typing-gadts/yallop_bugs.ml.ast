[
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+0]..[7,43+35])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+12]..[7,43+14]) (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+0]..[7,43+35])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+6]..[7,43+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+9]..[7,43+10])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+17]..[7,43+35])
                "Refl" (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+17]..[7,43+21])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+24]..[7,43+35])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+33]..[7,43+35])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+25]..[7,43+27])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[7,43+29]..[7,43+31])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+0]..[17,316+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+4]..[9,80+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+4]..[9,80+9])
            Ppat_var "magic" (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+4]..[9,80+9])
          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+12]..[9,80+27]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+19]..[9,80+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+19]..[9,80+21])
                Ptyp_var a
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[9,80+25]..[9,80+27])
                Ptyp_var b
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+2]..[17,316+15])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+2]..[17,316+15])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+17]..[17,316+15]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+17]..[10,110+24])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+18]..[10,110+19])
                  Ppat_var "x" (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+18]..[10,110+19])
                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+22]..[10,110+23])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[10,110+22]..[10,110+23])
                  []
              expression (testsuite/tests/typing-gadts/yallop_bugs.ml[11,138+4]..[17,316+15])
                Pexp_letmodule "M" (testsuite/tests/typing-gadts/yallop_bugs.ml[11,138+15]..[11,138+16])
                module_expr (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+6]..[16,278+37])
                  Pmod_apply
                  module_expr (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+15]..[15,266+10])
                    Pmod_functor "T" (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+16]..[12,157+17])
                    module_type (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+20]..[12,157+37])
                      Pmty_signature
                      [
                        signature_item (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+24]..[12,157+33])
                          Psig_type Rec
                          [
                            type_declaration "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+32]..[12,157+33]) (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+24]..[12,157+33])
                              ptype_params =
                                [
                                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[12,157+29]..[12,157+31])
                                    Ptyp_var a
                                ]
                              ptype_cstrs =
                                []
                              ptype_kind =
                                Ptype_abstract
                              ptype_private = Public
                              ptype_manifest =
                                None
                          ]
                      ]
                    module_expr (testsuite/tests/typing-gadts/yallop_bugs.ml[13,199+7]..[15,266+10])
                      Pmod_structure
                      [
                        structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+9]..[14,213+52])
                          Pstr_value Nonrec
                          [
                            <def>
                              pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+13]..[14,213+14])
                                Ppat_var "f" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+13]..[14,213+14])
                              expression (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+15]..[14,213+52]) ghost
                                Pexp_fun
                                Nolabel
                                None
                                pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+15]..[14,213+41])
                                  Ppat_constraint
                                  pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+16]..[14,213+20])
                                    Ppat_construct "Refl" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+16]..[14,213+20])
                                    None
                                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+23]..[14,213+40])
                                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+38]..[14,213+40])
                                    [
                                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+24]..[14,213+29])
                                        Ptyp_constr "T.t" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+26]..[14,213+29])
                                        [
                                          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+24]..[14,213+25])
                                            Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+24]..[14,213+25])
                                            []
                                        ]
                                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+31]..[14,213+36])
                                        Ptyp_constr "T.t" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+33]..[14,213+36])
                                        [
                                          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+31]..[14,213+32])
                                            Ptyp_constr "b" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+31]..[14,213+32])
                                            []
                                        ]
                                    ]
                                expression (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+44]..[14,213+52])
                                  Pexp_coerce
                                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+45]..[14,213+46])
                                    Pexp_ident "x" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+45]..[14,213+46])
                                  None
                                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+50]..[14,213+51])
                                    Ptyp_constr "b" (testsuite/tests/typing-gadts/yallop_bugs.ml[14,213+50]..[14,213+51])
                                    []
                          ]
                      ]
                  module_expr (testsuite/tests/typing-gadts/yallop_bugs.ml[16,278+9]..[16,278+36])
                    Pmod_structure
                    [
                      structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[16,278+16]..[16,278+32])
                        Pstr_type Rec
                        [
                          type_declaration "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[16,278+24]..[16,278+25]) (testsuite/tests/typing-gadts/yallop_bugs.ml[16,278+16]..[16,278+32])
                            ptype_params =
                              [
                                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[16,278+21]..[16,278+23])
                                  Ptyp_var a
                              ]
                            ptype_cstrs =
                              []
                            ptype_kind =
                              Ptype_abstract
                            ptype_private = Public
                            ptype_manifest =
                              Some
                                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[16,278+28]..[16,278+32])
                                  Ptyp_constr "unit" (testsuite/tests/typing-gadts/yallop_bugs.ml[16,278+28]..[16,278+32])
                                  []
                        ]
                    ]
                expression (testsuite/tests/typing-gadts/yallop_bugs.ml[17,316+7]..[17,316+15])
                  Pexp_apply
                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[17,316+7]..[17,316+10])
                    Pexp_ident "M.f" (testsuite/tests/typing-gadts/yallop_bugs.ml[17,316+7]..[17,316+10])
                  [
                    <arg>
                    Nolabel
                      expression (testsuite/tests/typing-gadts/yallop_bugs.ml[17,316+11]..[17,316+15])
                        Pexp_construct "Refl" (testsuite/tests/typing-gadts/yallop_bugs.ml[17,316+11]..[17,316+15])
                        None
                  ]
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[19,335+0]..[25,559+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[19,335+9]..[25,559+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[19,335+9]..[25,559+2])
          Pexp_constant PConst_string ("\ntype (_, _) eq = Refl : ('a, 'a) eq\nLine 8, characters 44-52:\n8 |          let f (Refl : (a T.t, b T.t) eq) = (x :> b)\n                                                ^^^^^^^^\nError: Type a is not a subtype of b\n",(testsuite/tests/typing-gadts/yallop_bugs.ml[19,335+11]..[25,559+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+0]..[29,596+36])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+13]..[29,596+15]) (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+0]..[29,596+36])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+6]..[29,596+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+10]..[29,596+11])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+18]..[29,596+36])
                "Refl" (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+18]..[29,596+22])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+25]..[29,596+36])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+34]..[29,596+36])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+26]..[29,596+28])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[29,596+30]..[29,596+32])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+0]..[37,908+63])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+4]..[31,634+27]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+4]..[31,634+9])
            Ppat_var "magic" (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+4]..[31,634+9])
          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+12]..[31,634+27]) ghost
            Ptyp_poly 'a 'b
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+19]..[31,634+27])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+19]..[31,634+21])
                Ptyp_var a
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[31,634+25]..[31,634+27])
                Ptyp_var b
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+2]..[37,908+63])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+15]..[37,908+63])
            Pexp_newtype "b"
            expression (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+24]..[37,908+63]) ghost
              Pexp_fun
              Nolabel
              None
              pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+24]..[32,664+31])
                Ppat_constraint
                pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+25]..[32,664+26])
                  Ppat_var "x" (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+25]..[32,664+26])
                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+29]..[32,664+30])
                  Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[32,664+29]..[32,664+30])
                  []
              expression (testsuite/tests/typing-gadts/yallop_bugs.ml[33,699+4]..[37,908+63])
                Pexp_let Nonrec
                [
                  <def>
                    pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[33,699+8]..[33,699+17])
                      Ppat_var "bad_proof" (testsuite/tests/typing-gadts/yallop_bugs.ml[33,699+8]..[33,699+17])
                    expression (testsuite/tests/typing-gadts/yallop_bugs.ml[33,699+18]..[34,728+58])
                      Pexp_newtype "a"
                      expression (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+6]..[34,728+58])
                        Pexp_coerce
                        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+7]..[34,728+11])
                          Pexp_construct "Refl" (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+7]..[34,728+11])
                          None
                        Some
                          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+14]..[34,728+36])
                            Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+34]..[34,728+36])
                            [
                              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+15]..[34,728+23])
                                Ptyp_object Closed
                                  method m
                                    core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+21]..[34,728+22])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+21]..[34,728+22])
                                      []
                              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+25]..[34,728+32])
                                Ptyp_object Closed
                                  method m
                                    core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+30]..[34,728+31])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+30]..[34,728+31])
                                      []
                            ]
                        core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+40]..[34,728+57])
                          Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+55]..[34,728+57])
                          [
                            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+41]..[34,728+48])
                              Ptyp_object Closed
                                method m
                                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+46]..[34,728+47])
                                    Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+46]..[34,728+47])
                                    []
                            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[34,728+50]..[34,728+53])
                              Ptyp_object Closed
                          ]
                ]
                expression (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+4]..[37,908+63])
                  Pexp_let Nonrec
                  [
                    <def>
                      pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+8]..[35,790+50]) ghost
                        Ppat_constraint
                        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+8]..[35,790+16])
                          Ppat_var "downcast" (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+8]..[35,790+16])
                        core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+8]..[36,843+61]) ghost
                          Ptyp_poly 'a
                          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+27]..[35,790+50])
                            Ptyp_arrow
                            Nolabel
                            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+27]..[35,790+38])
                              Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+36]..[35,790+38])
                              [
                                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+28]..[35,790+29])
                                  Ptyp_var a
                                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+31]..[35,790+34])
                                  Ptyp_object Closed
                              ]
                            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+42]..[35,790+50])
                              Ptyp_arrow
                              Nolabel
                              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+42]..[35,790+45])
                                Ptyp_object Closed
                              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+49]..[35,790+50])
                                Ptyp_var a
                      expression (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+8]..[36,843+61])
                        Pexp_newtype "a"
                        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+8]..[36,843+61])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+6]..[36,843+61])
                            Pexp_newtype "a"
                            expression (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+19]..[36,843+61]) ghost
                              Pexp_fun
                              Nolabel
                              None
                              pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+19]..[36,843+39])
                                Ppat_constraint
                                pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+20]..[36,843+24])
                                  Ppat_construct "Refl" (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+20]..[36,843+24])
                                  None
                                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+27]..[36,843+38])
                                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+36]..[36,843+38])
                                  [
                                    core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+28]..[36,843+29])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+28]..[36,843+29])
                                      []
                                    core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+31]..[36,843+34])
                                      Ptyp_object Closed
                                  ]
                              expression (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+40]..[36,843+61]) ghost
                                Pexp_fun
                                Nolabel
                                None
                                pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+40]..[36,843+49])
                                  Ppat_constraint
                                  pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+41]..[36,843+42])
                                    Ppat_var "s" (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+41]..[36,843+42])
                                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+45]..[36,843+48])
                                    Ptyp_object Closed
                                expression (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+53]..[36,843+61])
                                  Pexp_coerce
                                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+54]..[36,843+55])
                                    Pexp_ident "s" (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+54]..[36,843+55])
                                  None
                                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+59]..[36,843+60])
                                    Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[36,843+59]..[36,843+60])
                                    []
                          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+27]..[35,790+50])
                            Ptyp_arrow
                            Nolabel
                            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+27]..[35,790+38])
                              Ptyp_constr "eq" (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+36]..[35,790+38])
                              [
                                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+28]..[35,790+29])
                                  Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+28]..[35,790+29])
                                  []
                                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+31]..[35,790+34])
                                  Ptyp_object Closed
                              ]
                            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+42]..[35,790+50])
                              Ptyp_arrow
                              Nolabel
                              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+42]..[35,790+45])
                                Ptyp_object Closed
                              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+49]..[35,790+50])
                                Ptyp_constr "a" (testsuite/tests/typing-gadts/yallop_bugs.ml[35,790+49]..[35,790+50])
                                []
                  ]
                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+4]..[37,908+63])
                    Pexp_send "m"
                    expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+4]..[37,908+59])
                      Pexp_apply
                      expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+5]..[37,908+13])
                        Pexp_ident "downcast" (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+5]..[37,908+13])
                      [
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+14]..[37,908+23])
                            Pexp_ident "bad_proof" (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+14]..[37,908+23])
                        <arg>
                        Nolabel
                          expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+24]..[37,908+58])
                            Pexp_coerce
                            expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+25]..[37,908+50])
                              Pexp_object
                              class_structure
                                pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+32]..[37,908+32]) ghost
                                  Ppat_any
                                [
                                  class_field (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+33]..[37,908+45])
                                    Pcf_method Public
                                      "m" (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+40]..[37,908+41])
                                      Concrete Fresh
                                      expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+44]..[37,908+45]) ghost
                                        Pexp_poly
                                        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+44]..[37,908+45])
                                          Pexp_ident "x" (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+44]..[37,908+45])
                                        None
                                ]
                            None
                            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[37,908+54]..[37,908+57])
                              Ptyp_object Closed
                      ]
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[39,975+0]..[45,1182+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[39,975+9]..[45,1182+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[39,975+9]..[45,1182+2])
          Pexp_constant PConst_string ("\nLine 1, characters 0-36:\n1 | type (_, +_) eq = Refl : ('a, 'a) eq\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nError: In this GADT definition, the variance of some parameter\n       cannot be checked\n",(testsuite/tests/typing-gadts/yallop_bugs.ml[39,975+11]..[45,1182+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[49,1212+0]..[51,1242+20])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[49,1212+7]..[49,1212+8]) (testsuite/tests/typing-gadts/yallop_bugs.ml[49,1212+0]..[51,1242+20])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[49,1212+5]..[49,1212+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/yallop_bugs.ml[50,1223+2]..[50,1223+18])
                "IntLit" (testsuite/tests/typing-gadts/yallop_bugs.ml[50,1223+4]..[50,1223+10])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[50,1223+13]..[50,1223+18])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[50,1223+17]..[50,1223+18])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[50,1223+13]..[50,1223+16])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/yallop_bugs.ml[50,1223+13]..[50,1223+16])
                        []
                    ]
              (testsuite/tests/typing-gadts/yallop_bugs.ml[51,1242+2]..[51,1242+20])
                "BoolLit" (testsuite/tests/typing-gadts/yallop_bugs.ml[51,1242+4]..[51,1242+11])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[51,1242+14]..[51,1242+20])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[51,1242+19]..[51,1242+20])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[51,1242+14]..[51,1242+18])
                        Ptyp_constr "bool" (testsuite/tests/typing-gadts/yallop_bugs.ml[51,1242+14]..[51,1242+18])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+0]..[55,1340+23])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+4]..[53,1264+36]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+4]..[53,1264+9])
            Ppat_var "check" (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+4]..[53,1264+9])
          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+4]..[55,1340+23]) ghost
            Ptyp_poly 's
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+36])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+28])
                Ptyp_tuple
                [
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+24])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+23]..[53,1264+24])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+22])
                        Ptyp_var s
                    ]
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+27]..[53,1264+28])
                    Ptyp_var s
                ]
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+32]..[53,1264+36])
                Ptyp_constr "bool" (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+32]..[53,1264+36])
                []
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+4]..[55,1340+23])
          Pexp_newtype "s"
          expression (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+4]..[55,1340+23])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+39]..[55,1340+23])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[54,1312+4]..[54,1312+18])
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[54,1312+4]..[54,1312+11])
                        Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/yallop_bugs.ml[54,1312+4]..[54,1312+11])
                        None
                      pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[54,1312+13]..[54,1312+18])
                        Ppat_construct "false" (testsuite/tests/typing-gadts/yallop_bugs.ml[54,1312+13]..[54,1312+18])
                        None
                    ]
                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[54,1312+22]..[54,1312+27])
                    Pexp_construct "false" (testsuite/tests/typing-gadts/yallop_bugs.ml[54,1312+22]..[54,1312+27])
                    None
                <case>
                  pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[55,1340+4]..[55,1340+14])
                    Ppat_tuple
                    [
                      pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[55,1340+4]..[55,1340+10])
                        Ppat_construct "IntLit" (testsuite/tests/typing-gadts/yallop_bugs.ml[55,1340+4]..[55,1340+10])
                        None
                      pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[55,1340+13]..[55,1340+14])
                        Ppat_constant PConst_int (6,None)
                    ]
                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[55,1340+18]..[55,1340+23])
                    Pexp_construct "false" (testsuite/tests/typing-gadts/yallop_bugs.ml[55,1340+18]..[55,1340+23])
                    None
              ]
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+36])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+28])
                Ptyp_tuple
                [
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+24])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+23]..[53,1264+24])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+22])
                        Ptyp_constr "s" (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+21]..[53,1264+22])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+27]..[53,1264+28])
                    Ptyp_constr "s" (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+27]..[53,1264+28])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+32]..[53,1264+36])
                Ptyp_constr "bool" (testsuite/tests/typing-gadts/yallop_bugs.ml[53,1264+32]..[53,1264+36])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[57,1367+0]..[67,1737+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[57,1367+9]..[67,1737+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[57,1367+9]..[67,1737+2])
          Pexp_constant PConst_string ("\ntype _ t = IntLit : int t | BoolLit : bool t\nLines 5-7, characters 39-23:\n5 | .......................................function\n6 |   | BoolLit, false -> false\n7 |   | IntLit , 6 -> false\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\n(BoolLit, true)\nval check : 's t * 's -> bool = <fun>\n",(testsuite/tests/typing-gadts/yallop_bugs.ml[57,1367+11]..[67,1737+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+0]..[69,1744+43])
    Pstr_type Rec
    [
      type_declaration "pair" (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+14]..[69,1744+18]) (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+0]..[69,1744+43])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+6]..[69,1744+8])
              Ptyp_var a
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+10]..[69,1744+12])
              Ptyp_var b
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+23]..[69,1744+32])
                Immutable
                "fst" (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+23]..[69,1744+26])                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+29]..[69,1744+31])
                  Ptyp_var a
              (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+33]..[69,1744+41])
                Immutable
                "snd" (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+33]..[69,1744+36])                core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[69,1744+39]..[69,1744+41])
                  Ptyp_var b
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+0]..[73,1885+38])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+4]..[71,1789+42]) ghost
          Ppat_constraint
          pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+4]..[71,1789+9])
            Ppat_var "check" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+4]..[71,1789+9])
          core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+4]..[73,1885+38]) ghost
            Ptyp_poly 's
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+21]..[71,1789+42])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+21]..[71,1789+34])
                Ptyp_constr "pair" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+30]..[71,1789+34])
                [
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+22]..[71,1789+25])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+24]..[71,1789+25])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+22]..[71,1789+23])
                        Ptyp_var s
                    ]
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+27]..[71,1789+28])
                    Ptyp_var s
                ]
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+38]..[71,1789+42])
                Ptyp_constr "bool" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+38]..[71,1789+42])
                []
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+4]..[73,1885+38])
          Pexp_newtype "s"
          expression (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+4]..[73,1885+38])
            Pexp_constraint
            expression (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+45]..[73,1885+38])
              Pexp_function
              [
                <case>
                  pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+4]..[72,1843+32])
                    Ppat_record Closed
                    [
                      "fst" (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+5]..[72,1843+8])
                        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+11]..[72,1843+18])
                          Ppat_construct "BoolLit" (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+11]..[72,1843+18])
                          None
                      "snd" (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+20]..[72,1843+23])
                        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+26]..[72,1843+31])
                          Ppat_construct "false" (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+26]..[72,1843+31])
                          None
                    ]
                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+36]..[72,1843+41])
                    Pexp_construct "false" (testsuite/tests/typing-gadts/yallop_bugs.ml[72,1843+36]..[72,1843+41])
                    None
                <case>
                  pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+4]..[73,1885+29])
                    Ppat_record Closed
                    [
                      "fst" (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+5]..[73,1885+8])
                        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+11]..[73,1885+17])
                          Ppat_construct "IntLit" (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+11]..[73,1885+17])
                          None
                      "snd" (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+20]..[73,1885+23])
                        pattern (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+27]..[73,1885+28])
                          Ppat_constant PConst_int (6,None)
                    ]
                  expression (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+33]..[73,1885+38])
                    Pexp_construct "false" (testsuite/tests/typing-gadts/yallop_bugs.ml[73,1885+33]..[73,1885+38])
                    None
              ]
            core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+21]..[71,1789+42])
              Ptyp_arrow
              Nolabel
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+21]..[71,1789+34])
                Ptyp_constr "pair" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+30]..[71,1789+34])
                [
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+22]..[71,1789+25])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+24]..[71,1789+25])
                    [
                      core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+22]..[71,1789+23])
                        Ptyp_constr "s" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+22]..[71,1789+23])
                        []
                    ]
                  core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+27]..[71,1789+28])
                    Ptyp_constr "s" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+27]..[71,1789+28])
                    []
                ]
              core_type (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+38]..[71,1789+42])
                Ptyp_constr "bool" (testsuite/tests/typing-gadts/yallop_bugs.ml[71,1789+38]..[71,1789+42])
                []
    ]
  structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[75,1927+0]..[85,2346+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/yallop_bugs.ml[75,1927+9]..[85,2346+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/yallop_bugs.ml[75,1927+9]..[85,2346+2])
          Pexp_constant PConst_string ("\ntype ('a, 'b) pair = { fst : 'a; snd : 'b; }\nLines 3-5, characters 45-38:\n3 | .............................................function\n4 |   | {fst = BoolLit; snd = false} -> false\n5 |   | {fst = IntLit ; snd =  6} -> false\nWarning 8 [partial-match]: this pattern-matching is not exhaustive.\nHere is an example of a case that is not matched:\n{fst=BoolLit; snd=true}\nval check : ('s t, 's) pair -> bool = <fun>\n",(testsuite/tests/typing-gadts/yallop_bugs.ml[75,1927+11]..[85,2346+0]),Some "")
    ]
]

