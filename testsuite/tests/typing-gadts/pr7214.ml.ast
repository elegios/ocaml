[
  structure_item (testsuite/tests/typing-gadts/pr7214.ml[5,24+0]..[5,24+20])
    Pstr_type Rec
    [
      type_declaration "t" (testsuite/tests/typing-gadts/pr7214.ml[5,24+7]..[5,24+8]) (testsuite/tests/typing-gadts/pr7214.ml[5,24+0]..[5,24+20])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr7214.ml[5,24+5]..[5,24+6])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr7214.ml[5,24+11]..[5,24+20])
                "I" (testsuite/tests/typing-gadts/pr7214.ml[5,24+11]..[5,24+12])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr7214.ml[5,24+15]..[5,24+20])
                    Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7214.ml[5,24+19]..[5,24+20])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7214.ml[5,24+15]..[5,24+18])
                        Ptyp_constr "int" (testsuite/tests/typing-gadts/pr7214.ml[5,24+15]..[5,24+18])
                        []
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr7214.ml[7,48+0]..[12,191+4])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr7214.ml[7,48+4]..[7,48+5])
          Ppat_var "f" (testsuite/tests/typing-gadts/pr7214.ml[7,48+4]..[7,48+5])
        expression (testsuite/tests/typing-gadts/pr7214.ml[7,48+6]..[12,191+4])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/pr7214.ml[7,48+15]..[12,191+4]) ghost
            Pexp_fun
            Nolabel
            None
            pattern (testsuite/tests/typing-gadts/pr7214.ml[7,48+15]..[7,48+24])
              Ppat_constraint
              pattern (testsuite/tests/typing-gadts/pr7214.ml[7,48+16]..[7,48+17])
                Ppat_var "x" (testsuite/tests/typing-gadts/pr7214.ml[7,48+16]..[7,48+17])
              core_type (testsuite/tests/typing-gadts/pr7214.ml[7,48+20]..[7,48+23])
                Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7214.ml[7,48+22]..[7,48+23])
                [
                  core_type (testsuite/tests/typing-gadts/pr7214.ml[7,48+20]..[7,48+21])
                    Ptyp_constr "a" (testsuite/tests/typing-gadts/pr7214.ml[7,48+20]..[7,48+21])
                    []
                ]
            expression (testsuite/tests/typing-gadts/pr7214.ml[8,75+2]..[12,191+4])
              Pexp_letmodule "M" (testsuite/tests/typing-gadts/pr7214.ml[8,75+13]..[8,75+14])
              module_expr (testsuite/tests/typing-gadts/pr7214.ml[8,75+17]..[11,182+5])
                Pmod_structure
                [
                  structure_item (testsuite/tests/typing-gadts/pr7214.ml[9,99+4]..[9,99+21])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/pr7214.ml[9,99+8]..[9,99+17])
                          Ppat_constraint
                          pattern (testsuite/tests/typing-gadts/pr7214.ml[9,99+9]..[9,99+10])
                            Ppat_construct "I" (testsuite/tests/typing-gadts/pr7214.ml[9,99+9]..[9,99+10])
                            None
                          core_type (testsuite/tests/typing-gadts/pr7214.ml[9,99+13]..[9,99+16])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7214.ml[9,99+15]..[9,99+16])
                            [
                              core_type (testsuite/tests/typing-gadts/pr7214.ml[9,99+13]..[9,99+14])
                                Ptyp_constr "a" (testsuite/tests/typing-gadts/pr7214.ml[9,99+13]..[9,99+14])
                                []
                            ]
                        expression (testsuite/tests/typing-gadts/pr7214.ml[9,99+20]..[9,99+21])
                          Pexp_ident "x" (testsuite/tests/typing-gadts/pr7214.ml[9,99+20]..[9,99+21])
                    ]
                  structure_item (testsuite/tests/typing-gadts/pr7214.ml[10,160+4]..[10,160+21])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (testsuite/tests/typing-gadts/pr7214.ml[10,160+8]..[10,160+9])
                          Ppat_var "x" (testsuite/tests/typing-gadts/pr7214.ml[10,160+8]..[10,160+9])
                        expression (testsuite/tests/typing-gadts/pr7214.ml[10,160+12]..[10,160+21])
                          Pexp_constraint
                          expression (testsuite/tests/typing-gadts/pr7214.ml[10,160+13]..[10,160+14])
                            Pexp_construct "I" (testsuite/tests/typing-gadts/pr7214.ml[10,160+13]..[10,160+14])
                            None
                          core_type (testsuite/tests/typing-gadts/pr7214.ml[10,160+17]..[10,160+20])
                            Ptyp_constr "t" (testsuite/tests/typing-gadts/pr7214.ml[10,160+19]..[10,160+20])
                            [
                              core_type (testsuite/tests/typing-gadts/pr7214.ml[10,160+17]..[10,160+18])
                                Ptyp_constr "a" (testsuite/tests/typing-gadts/pr7214.ml[10,160+17]..[10,160+18])
                                []
                            ]
                    ]
                ]
              expression (testsuite/tests/typing-gadts/pr7214.ml[12,191+2]..[12,191+4])
                Pexp_construct "()" (testsuite/tests/typing-gadts/pr7214.ml[12,191+2]..[12,191+4])
                None
    ]
  structure_item (testsuite/tests/typing-gadts/pr7214.ml[13,199+0]..[21,499+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr7214.ml[13,199+9]..[21,499+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr7214.ml[13,199+9]..[21,499+2])
          Pexp_constant PConst_string ("\ntype _ t = I : int t\nLine 5, characters 9-10:\n5 |     let (I : a t) = x     (* fail because of toplevel let *)\n             ^\nError: This pattern matches values of type int t\n       but a pattern was expected which matches values of type a t\n       Type int is not compatible with type a\n",(testsuite/tests/typing-gadts/pr7214.ml[13,199+11]..[21,499+0]),Some "")
    ]
  structure_item (testsuite/tests/typing-gadts/pr7214.ml[25,597+0]..[25,597+34])
    Pstr_type Rec
    [
      type_declaration "eq" (testsuite/tests/typing-gadts/pr7214.ml[25,597+11]..[25,597+13]) (testsuite/tests/typing-gadts/pr7214.ml[25,597+0]..[25,597+34])
        ptype_params =
          [
            core_type (testsuite/tests/typing-gadts/pr7214.ml[25,597+6]..[25,597+7])
              Ptyp_any
            core_type (testsuite/tests/typing-gadts/pr7214.ml[25,597+8]..[25,597+9])
              Ptyp_any
          ]
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (testsuite/tests/typing-gadts/pr7214.ml[25,597+16]..[25,597+34])
                "Refl" (testsuite/tests/typing-gadts/pr7214.ml[25,597+16]..[25,597+20])
                []
                Some
                  core_type (testsuite/tests/typing-gadts/pr7214.ml[25,597+23]..[25,597+34])
                    Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr7214.ml[25,597+32]..[25,597+34])
                    [
                      core_type (testsuite/tests/typing-gadts/pr7214.ml[25,597+24]..[25,597+26])
                        Ptyp_var a
                      core_type (testsuite/tests/typing-gadts/pr7214.ml[25,597+28]..[25,597+30])
                        Ptyp_var a
                    ]
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (testsuite/tests/typing-gadts/pr7214.ml[27,635+0]..[35,846+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (testsuite/tests/typing-gadts/pr7214.ml[27,635+4]..[27,635+7])
          Ppat_var "bad" (testsuite/tests/typing-gadts/pr7214.ml[27,635+4]..[27,635+7])
        expression (testsuite/tests/typing-gadts/pr7214.ml[27,635+8]..[35,846+13])
          Pexp_newtype "a"
          expression (testsuite/tests/typing-gadts/pr7214.ml[28,654+1]..[35,846+13])
            Pexp_letmodule "N" (testsuite/tests/typing-gadts/pr7214.ml[28,654+12]..[28,654+13])
            module_expr (testsuite/tests/typing-gadts/pr7214.ml[28,654+16]..[35,846+4])
              Pmod_structure
              [
                structure_item (testsuite/tests/typing-gadts/pr7214.ml[29,677+3]..[34,839+6])
                  Pstr_recmodule
                  [
                    "M" (testsuite/tests/typing-gadts/pr7214.ml[29,677+14]..[29,677+15])
                      module_expr (testsuite/tests/typing-gadts/pr7214.ml[29,677+16]..[34,839+6])
                        Pmod_constraint
                        module_expr (testsuite/tests/typing-gadts/pr7214.ml[31,724+9]..[34,839+6])
                          Pmod_structure
                          [
                            structure_item (testsuite/tests/typing-gadts/pr7214.ml[32,740+5]..[32,740+35])
                              Pstr_value Nonrec
                              [
                                <def>
                                  pattern (testsuite/tests/typing-gadts/pr7214.ml[32,740+9]..[32,740+29])
                                    Ppat_constraint
                                    pattern (testsuite/tests/typing-gadts/pr7214.ml[32,740+10]..[32,740+14])
                                      Ppat_construct "Refl" (testsuite/tests/typing-gadts/pr7214.ml[32,740+10]..[32,740+14])
                                      None
                                    core_type (testsuite/tests/typing-gadts/pr7214.ml[32,740+17]..[32,740+28])
                                      Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr7214.ml[32,740+26]..[32,740+28])
                                      [
                                        core_type (testsuite/tests/typing-gadts/pr7214.ml[32,740+18]..[32,740+21])
                                          Ptyp_constr "int" (testsuite/tests/typing-gadts/pr7214.ml[32,740+18]..[32,740+21])
                                          []
                                        core_type (testsuite/tests/typing-gadts/pr7214.ml[32,740+23]..[32,740+24])
                                          Ptyp_constr "a" (testsuite/tests/typing-gadts/pr7214.ml[32,740+23]..[32,740+24])
                                          []
                                      ]
                                  expression (testsuite/tests/typing-gadts/pr7214.ml[32,740+32]..[32,740+35])
                                    Pexp_ident "M.e" (testsuite/tests/typing-gadts/pr7214.ml[32,740+32]..[32,740+35])
                              ]
                            structure_item (testsuite/tests/typing-gadts/pr7214.ml[33,807+5]..[33,807+31])
                              Pstr_value Nonrec
                              [
                                <def>
                                  pattern (testsuite/tests/typing-gadts/pr7214.ml[33,807+9]..[33,807+24]) ghost
                                    Ppat_constraint
                                    pattern (testsuite/tests/typing-gadts/pr7214.ml[33,807+9]..[33,807+10])
                                      Ppat_var "e" (testsuite/tests/typing-gadts/pr7214.ml[33,807+9]..[33,807+10])
                                    core_type (testsuite/tests/typing-gadts/pr7214.ml[33,807+13]..[33,807+24]) ghost
                                      Ptyp_poly
                                      core_type (testsuite/tests/typing-gadts/pr7214.ml[33,807+13]..[33,807+24])
                                        Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr7214.ml[33,807+22]..[33,807+24])
                                        [
                                          core_type (testsuite/tests/typing-gadts/pr7214.ml[33,807+14]..[33,807+17])
                                            Ptyp_constr "int" (testsuite/tests/typing-gadts/pr7214.ml[33,807+14]..[33,807+17])
                                            []
                                          core_type (testsuite/tests/typing-gadts/pr7214.ml[33,807+19]..[33,807+20])
                                            Ptyp_constr "a" (testsuite/tests/typing-gadts/pr7214.ml[33,807+19]..[33,807+20])
                                            []
                                        ]
                                  expression (testsuite/tests/typing-gadts/pr7214.ml[33,807+9]..[33,807+31])
                                    Pexp_constraint
                                    expression (testsuite/tests/typing-gadts/pr7214.ml[33,807+27]..[33,807+31])
                                      Pexp_construct "Refl" (testsuite/tests/typing-gadts/pr7214.ml[33,807+27]..[33,807+31])
                                      None
                                    core_type (testsuite/tests/typing-gadts/pr7214.ml[33,807+13]..[33,807+24])
                                      Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr7214.ml[33,807+22]..[33,807+24])
                                      [
                                        core_type (testsuite/tests/typing-gadts/pr7214.ml[33,807+14]..[33,807+17])
                                          Ptyp_constr "int" (testsuite/tests/typing-gadts/pr7214.ml[33,807+14]..[33,807+17])
                                          []
                                        core_type (testsuite/tests/typing-gadts/pr7214.ml[33,807+19]..[33,807+20])
                                          Ptyp_constr "a" (testsuite/tests/typing-gadts/pr7214.ml[33,807+19]..[33,807+20])
                                          []
                                      ]
                              ]
                          ]
                        module_type (testsuite/tests/typing-gadts/pr7214.ml[29,677+18]..[31,724+6])
                          Pmty_signature
                          [
                            signature_item (testsuite/tests/typing-gadts/pr7214.ml[30,699+5]..[30,699+24])
                              Psig_value
                              value_description "e" (testsuite/tests/typing-gadts/pr7214.ml[30,699+9]..[30,699+10]) (testsuite/tests/typing-gadts/pr7214.ml[30,699+5]..[30,699+24])
                                core_type (testsuite/tests/typing-gadts/pr7214.ml[30,699+13]..[30,699+24])
                                  Ptyp_constr "eq" (testsuite/tests/typing-gadts/pr7214.ml[30,699+22]..[30,699+24])
                                  [
                                    core_type (testsuite/tests/typing-gadts/pr7214.ml[30,699+14]..[30,699+17])
                                      Ptyp_constr "int" (testsuite/tests/typing-gadts/pr7214.ml[30,699+14]..[30,699+17])
                                      []
                                    core_type (testsuite/tests/typing-gadts/pr7214.ml[30,699+19]..[30,699+20])
                                      Ptyp_constr "a" (testsuite/tests/typing-gadts/pr7214.ml[30,699+19]..[30,699+20])
                                      []
                                  ]
                                []
                          ]
                  ]
              ]
            expression (testsuite/tests/typing-gadts/pr7214.ml[35,846+8]..[35,846+13])
              Pexp_ident "N.M.e" (testsuite/tests/typing-gadts/pr7214.ml[35,846+8]..[35,846+13])
    ]
  structure_item (testsuite/tests/typing-gadts/pr7214.ml[37,863+0]..[45,1205+3])
    Pstr_extension "expect"
    [
      structure_item (testsuite/tests/typing-gadts/pr7214.ml[37,863+9]..[45,1205+2])
        Pstr_eval
        expression (testsuite/tests/typing-gadts/pr7214.ml[37,863+9]..[45,1205+2])
          Pexp_constant PConst_string ("\ntype (_, _) eq = Refl : ('a, 'a) eq\nLine 8, characters 10-14:\n8 |      let (Refl : (int, a) eq) = M.e  (* must fail for soundness *)\n              ^^^^\nError: This pattern matches values of type (int, int) eq\n       but a pattern was expected which matches values of type (int, a) eq\n       Type int is not compatible with type a\n",(testsuite/tests/typing-gadts/pr7214.ml[37,863+11]..[45,1205+0]),Some "")
    ]
]

